<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Python Crash Course: A Hands-On, Project-Based Introduction to Programming, 2nd Edition</title></head><body><div class="calibre1" id="calibre_link-128">
<h2 class="h" id="calibre_link-1245"><span type="pagebreak" id="calibre_link-1246" class="calibre"></span><strong class="calibre2">PRAISE FOR <em class="calibre3">PYTHON CRASH COURSE</em></strong></h2>
<p class="bq">“It has been interesting to see No Starch Press producing future classics that should be alongside the more traditional programming books. <em class="calibre3">Python Crash Course</em> is one of those books.”<br class="calibre4" />&mdash;G<small class="calibre5">REG</small> L<small class="calibre5">ADEN</small>, S<small class="calibre5">CIENCE</small>B<small class="calibre5">LOGS</small></p>
<p class="bq">“Deals with some rather complex projects and lays them out in a consistent, logical, and pleasant manner that draws the reader into the subject.”<br class="calibre4" />&mdash;F<small class="calibre5">ULL</small> C<small class="calibre5">IRCLE</small> M<small class="calibre5">AGAZINE</small></p>
<p class="bq">“Well presented with good explanations of the code snippets. The book works with you, one small step at a time, building more complex code, explaining what’s going on all the way.”<br class="calibre4" />&mdash;F<small class="calibre5">LICK</small>T<small class="calibre5">HROUGH</small> R<small class="calibre5">EVIEWS</small></p>
<p class="bq">“Learning Python with <em class="calibre3">Python Crash Course</em> was an extremely positive experience! A great choice if you’re new to Python.”<br class="calibre4" />&mdash;M<small class="calibre5">IKKE</small> G<small class="calibre5">OES</small> C<small class="calibre5">ODING</small></p>
<p class="bq">“Does what it says on the tin, and does it really well. . . . Presents a large number of useful exercises as well as three challenging and entertaining projects.”<br class="calibre4" />&mdash;<a href="http://REALPYTHON.COM" class="calibre6">R<small class="calibre5">EAL</small>P<small class="calibre5">YTHON.COM</small></a></p>
<p class="bq">“A fast-paced but comprehensive introduction to programming with Python, <em class="calibre3">Python Crash Course</em> is another superb book to add to your library and help you finally master Python.”<br class="calibre4" />&mdash;<a href="http://TUTORIALEDGE.NET" class="calibre6">T<small class="calibre5">UTORIAL</small>E<small class="calibre5">DGE.NET</small></a></p>
<p class="bq">“A brilliant option for complete beginners without any coding experience. If you’re looking for a solid, uncomplicated intro to this very deep language, I have to recommend this book.”<br class="calibre4" />&mdash;<a href="http://WHATPIXEL.COM" class="calibre6">W<small class="calibre5">HAT</small>P<small class="calibre5">IXEL.COM</small></a></p>
<p class="bq">“Contains literally everything you need to know about Python and even more.”<br class="calibre4" />&mdash;<a href="http://FIREBEARSTUDIO.COM" class="calibre6">F<small class="calibre5">IRE</small>B<small class="calibre5">EAR</small>S<small class="calibre5">TUDIO.COM</small></a></p>
</div>


<div class="calibre1" id="calibre_link-23">
<h1 class="h1" id="calibre_link-1247"><span type="pagebreak" id="calibre_link-1248" class="calibre"></span><span type="pagebreak" id="calibre_link-1249" class="calibre"></span><strong class="calibre2">PYTHON CRASH COURSE</strong></h1>
<p class="edition">2ND EDITION</p>
<p class="subtitle">A Hands-On, Project-Based Introduction to Programming</p>
<p class="author"><strong class="calibre2">by Eric Matthes</strong></p>
<div class="pub"><img src="images/000040.jpg" alt="image" class="calibre7" /></div>
<p class="pub1">San Francisco</p>
</div>


<div class="calibre1" id="calibre_link-135">
<p class="copy" id="calibre_link-1250"><span type="pagebreak" id="calibre_link-1251" class="calibre"></span><strong class="calibre2">PYTHON CRASH COURSE, 2ND EDITION.</strong> Copyright © 2019 by Eric Matthes.</p>
<p class="copy1">All rights reserved. No part of this work may be reproduced or transmitted in any form or by any means, electronic or mechanical, including photocopying, recording, or by any information storage or retrieval system, without the prior written permission of the copyright owner and the publisher.</p>
<p class="copy1">ISBN-10: 1-59327-928-0<br class="calibre4" />ISBN-13: 978-1-59327-928-8</p>
<p class="copy1">Publisher: William Pollock<br class="calibre4" />Production Editor: Riley Hoffman<br class="calibre4" />Cover Illustration: Josh Ellingson<br class="calibre4" />Cover and Interior Design: Octopod Studios<br class="calibre4" />Developmental Editor: Liz Chadwick<br class="calibre4" />Technical Reviewer: Kenneth Love<br class="calibre4" />Copyeditor: Anne Marie Walker<br class="calibre4" />Compositors: Riley Hoffman and Happenstance Type-O-Rama<br class="calibre4" />Proofreader: James Fraleigh</p>
<p class="copy1">For information on distribution, translations, or bulk sales, please contact No Starch Press, Inc. directly:</p>
<p class="copy1">No Starch Press, Inc.<br class="calibre4" />245 8th Street, San Francisco, CA 94103<br class="calibre4" />phone: 1.415.863.9900; <a href="mailto:info@nostarch.com" class="calibre6">info@nostarch.com</a><br class="calibre4" /><a href="http://www.nostarch.com" class="calibre6">www.nostarch.com</a></p>
<p class="copy1"><em class="calibre3">The Library of Congress has catalogued the first edition as follows:</em></p>
<p class="copy2">Matthes, Eric, 1972-<br class="calibre4" />
&nbsp;&nbsp;Python crash course : a hands-on, project-based introduction to programming / by Eric Matthes.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pages cm<br class="calibre4" />
&nbsp;&nbsp;Includes index.<br class="calibre4" />
&nbsp;&nbsp;Summary: "A project-based introduction to programming in Python, with exercises. Covers general<br class="calibre4" />
programming concepts, Python fundamentals, and problem solving. Includes three projects - how to<br class="calibre4" />
create a simple video game, use data visualization techniques to make graphs and charts, and build<br class="calibre4" />
an interactive web application"-- Provided by publisher.<br class="calibre4" />
&nbsp;&nbsp;ISBN 978-1-59327-603-4 -- ISBN 1-59327-603-6<br class="calibre4" />
&nbsp;1.&nbsp;&nbsp;Python (Computer program language)&nbsp;&nbsp;I. Title.<br class="calibre4" />
&nbsp;&nbsp;QA76.73.P98M38 2015<br class="calibre4" />
&nbsp;&nbsp;005.13'3--dc23<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2015018135</p>
<p class="copy1">No Starch Press and the No Starch Press logo are registered trademarks of No Starch Press, Inc. Other product and company names mentioned herein may be the trademarks of their respective owners. Rather than use a trademark symbol with every occurrence of a trademarked name, we are using the names only in an editorial fashion and to the benefit of the trademark owner, with no intention of infringement of the trademark.</p>
<p class="copy1">The information in this book is distributed on an “As Is” basis, without warranty. While every precaution has been taken in the preparation of this work, neither the author nor No Starch Press, Inc. shall have any liability to any person or entity with respect to any loss or damage caused or alleged to be caused directly or indirectly by the information contained in it.</p>
</div>


<div class="calibre1" id="calibre_link-31">
<h2 class="h2a" id="calibre_link-1252"><span type="pagebreak" id="calibre_link-1253" class="calibre"></span><strong class="calibre2">About the Author</strong></h2>
<p class="noindent">Eric Matthes is a high school science and math teacher living in Alaska, where he teaches an introductory Python course. He has been writing programs since he was five years old. Eric currently focuses on writing software that addresses inefficiencies in education and brings the benefits of open source software to the field of education. In his spare time he enjoys climbing mountains and spending time with his family.</p>
</div>


<div class="calibre1" id="calibre_link-79">
<h2 class="h2a" id="calibre_link-1254"><strong class="calibre2">About the Technical Reviewer</strong></h2>
<p class="noindent">Kenneth Love has been a Python programmer, teacher, and conference organizer for many years. He has spoken and taught at many conferences, been a Python and Django freelancer, and is currently a software engineer for O’Reilly Media. Kenneth is co-creator of the django-braces package, which provides several handy mixins for Django’s class-based views. You can keep up with him on Twitter at @kennethlove.<span type="pagebreak" id="calibre_link-1255" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-146">
<p class="ded" id="calibre_link-1256"><span type="pagebreak" id="calibre_link-1257" class="calibre"></span>For my father, who always made time to answer my questions about programming, and for Ever, who is just beginning to ask me his questions<span type="pagebreak" id="calibre_link-1258" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-151">
<h2 class="h" id="calibre_link-1259"><span type="pagebreak" id="calibre_link-1260" class="calibre"></span><strong class="calibre2">BRIEF CONTENTS</strong></h2>
<p class="tocchapa"><a href="#calibre_link-152" class="calibre6">Preface to the Second Edition</a></p>
<p class="tocchapa"><a href="#calibre_link-153" class="calibre6">Acknowledgments</a></p>
<p class="tocchapa"><a href="#calibre_link-154" class="calibre6">Introduction</a></p>
<p class="tocpart"><a href="#calibre_link-9" class="calibre6">PART I: BASICS</a></p>
<p class="tocchapa"><a href="#calibre_link-21" class="calibre6">Chapter 1: Getting Started</a></p>
<p class="tocchapa"><a href="#calibre_link-7" class="calibre6">Chapter 2: Variables and Simple Data Types</a></p>
<p class="tocchapa"><a href="#calibre_link-56" class="calibre6">Chapter 3: Introducing Lists</a></p>
<p class="tocchapa"><a href="#calibre_link-115" class="calibre6">Chapter 4: Working with Lists</a></p>
<p class="tocchapa"><a href="#calibre_link-61" class="calibre6">Chapter 5: if Statements</a></p>
<p class="tocchapa"><a href="#calibre_link-116" class="calibre6">Chapter 6: Dictionaries</a></p>
<p class="tocchapa"><a href="#calibre_link-117" class="calibre6">Chapter 7: User Input and while Loops</a></p>
<p class="tocchapa"><a href="#calibre_link-118" class="calibre6">Chapter 8: Functions</a></p>
<p class="tocchapa"><a href="#calibre_link-29" class="calibre6">Chapter 9: Classes</a></p>
<p class="tocchapa"><a href="#calibre_link-119" class="calibre6">Chapter 10: Files and Exceptions</a></p>
<p class="tocchapa"><a href="#calibre_link-120" class="calibre6">Chapter 11: Testing Your Code</a></p>
<p class="tocpart"><a href="#calibre_link-10" class="calibre6">PART II: PROJECTS</a></p>
<p class="tocparta"><a href="#calibre_link-155" class="calibre6">Project 1: Alien Invasion</a></p>
<p class="tocchapa"><a href="#calibre_link-11" class="calibre6">Chapter 12: A Ship that Fires Bullets</a></p>
<p class="tocchapa"><a href="#calibre_link-12" class="calibre6">Chapter 13: Aliens!</a></p>
<p class="tocchapa"><a href="#calibre_link-13" class="calibre6">Chapter 14: Scoring</a></p>
<p class="tocparta"><span type="pagebreak" id="calibre_link-1261" class="calibre"></span><a href="#calibre_link-156" class="calibre6">Project 2: Data Visualization</a></p>
<p class="tocchapa"><a href="#calibre_link-14" class="calibre6">Chapter 15: Generating Data</a></p>
<p class="tocchapa"><a href="#calibre_link-15" class="calibre6">Chapter 16: Downloading Data</a></p>
<p class="tocchapa"><a href="#calibre_link-16" class="calibre6">Chapter 17: Working with APIs</a></p>
<p class="tocparta"><a href="#calibre_link-157" class="calibre6">Project 3: Web Applications</a></p>
<p class="tocchapa"><a href="#calibre_link-17" class="calibre6">Chapter 18: Getting Started with Django</a></p>
<p class="tocchapa"><a href="#calibre_link-18" class="calibre6">Chapter 19: User Accounts</a></p>
<p class="tocchapa"><a href="#calibre_link-19" class="calibre6">Chapter 20: Styling and Deploying an App</a></p>
<p class="tocchapb"><a href="#calibre_link-158" class="calibre6">Afterword</a></p>
<p class="tocchapb"><a href="#calibre_link-1" class="calibre6">Appendix A: Installation and Troubleshooting</a></p>
<p class="tocchapa"><a href="#calibre_link-2" class="calibre6">Appendix B: Text Editors and IDEs</a></p>
<p class="tocchapa"><a href="#calibre_link-6" class="calibre6">Appendix C: Getting Help</a></p>
<p class="tocchapa"><a href="#calibre_link-67" class="calibre6">Appendix D: Using Git for Version Control</a></p>
<p class="tocchapb"><a href="#calibre_link-159" class="calibre6">Index</a></p>
</div>


<div class="calibre1" id="calibre_link-570">
<h2 class="h" id="calibre_link-1262"><span type="pagebreak" id="calibre_link-1263" class="calibre"></span><strong class="calibre2">CONTENTS IN DETAIL</strong></h2>
<p class="tocparta"><a href="#calibre_link-152" class="calibre6"><strong class="calibre2">PREFACE TO THE SECOND EDITION</strong></a></p>
<p class="tocparta"><a href="#calibre_link-153" class="calibre6"><strong class="calibre2">ACKNOWLEDGMENTS</strong></a></p>
<p class="tocparta"><a href="#calibre_link-154" class="calibre6"><strong class="calibre2">INTRODUCTION</strong></a></p>
<p class="tocsec"><a href="#calibre_link-571" class="calibre6">Who Is This Book For?</a></p>
<p class="tocsec"><a href="#calibre_link-572" class="calibre6">What Can You Expect to Learn?</a></p>
<p class="tocsec"><a href="#calibre_link-573" class="calibre6">Online Resources</a></p>
<p class="tocsec"><a href="#calibre_link-574" class="calibre6">Why Python?</a></p>
<p class="tocpart"><a href="#calibre_link-9" class="calibre6"><strong class="calibre2">PART I: BASICS</strong></a></p>
<p class="tocparta"><a href="#calibre_link-21" class="calibre6"><strong class="calibre2">1<br class="calibre4" />GETTING STARTED</strong></a></p>
<p class="tocsec"><a href="#calibre_link-575" class="calibre6">Setting Up Your Programming Environment</a></p>
<p class="tocsec1"><a href="#calibre_link-576" class="calibre6">Python Versions</a></p>
<p class="tocsec1"><a href="#calibre_link-577" class="calibre6">Running Snippets of Python Code</a></p>
<p class="tocsec1"><a href="#calibre_link-578" class="calibre6">About the Sublime Text Editor</a></p>
<p class="tocsec"><a href="#calibre_link-579" class="calibre6">Python on Different Operating Systems</a></p>
<p class="tocsec1"><a href="#calibre_link-580" class="calibre6">Python on Windows</a></p>
<p class="tocsec1"><a href="#calibre_link-581" class="calibre6">Python on macOS</a></p>
<p class="tocsec1"><a href="#calibre_link-582" class="calibre6">Python on Linux</a></p>
<p class="tocsec"><a href="#calibre_link-583" class="calibre6">Running a Hello World Program</a></p>
<p class="tocsec1"><a href="#calibre_link-584" class="calibre6">Configuring Sublime Text to Use the Correct Python Version</a></p>
<p class="tocsec1"><a href="#calibre_link-585" class="calibre6">Running hello_world.py</a></p>
<p class="tocsec"><a href="#calibre_link-586" class="calibre6">Troubleshooting</a></p>
<p class="tocsec"><a href="#calibre_link-130" class="calibre6">Running Python Programs from a Terminal</a></p>
<p class="tocsec1"><a href="#calibre_link-587" class="calibre6">On Windows</a></p>
<p class="tocsec1"><a href="#calibre_link-588" class="calibre6">On macOS and Linux</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-589" class="calibre6">Exercise 1-1: python.org</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-590" class="calibre6">Exercise 1-2: Hello World Typos</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-591" class="calibre6">Exercise 1-3: Infinite Skills</a></em></p>
<p class="tocsec"><a href="#calibre_link-592" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-7" class="calibre6"><strong class="calibre2">2<br class="calibre4" />VARIABLES AND SIMPLE DATA TYPES</strong></a></p>
<p class="tocsec"><a href="#calibre_link-593" class="calibre6">What Really Happens When You Run hello_world.py</a></p>
<p class="tocsec"><a href="#calibre_link-594" class="calibre6">Variables</a></p>
<p class="tocsec1"><a href="#calibre_link-595" class="calibre6">Naming and Using Variables</a></p>
<p class="tocsec1"><a href="#calibre_link-596" class="calibre6">Avoiding Name Errors When Using Variables</a></p>
<p class="tocsec1"><a href="#calibre_link-597" class="calibre6">Variables Are Labels</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-598" class="calibre6">Exercise 2-1: Simple Message</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-599" class="calibre6">Exercise 2-2: Simple Messages</a></em></p>
<p class="tocsec"><span type="pagebreak" id="calibre_link-1264" class="calibre"></span><a href="#calibre_link-600" class="calibre6">Strings</a></p>
<p class="tocsec1"><a href="#calibre_link-601" class="calibre6">Changing Case in a String with Methods</a></p>
<p class="tocsec1"><a href="#calibre_link-602" class="calibre6">Using Variables in Strings</a></p>
<p class="tocsec1"><a href="#calibre_link-603" class="calibre6">Adding Whitespace to Strings with Tabs or Newlines</a></p>
<p class="tocsec1"><a href="#calibre_link-604" class="calibre6">Stripping Whitespace</a></p>
<p class="tocsec1"><a href="#calibre_link-605" class="calibre6">Avoiding Syntax Errors with Strings</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-606" class="calibre6">Exercise 2-3: Personal Message</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-607" class="calibre6">Exercise 2-4: Name Cases</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-65" class="calibre6">Exercise 2-5: Famous Quote</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-608" class="calibre6">Exercise 2-6: Famous Quote 2</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-609" class="calibre6">Exercise 2-7: Stripping Names</a></em></p>
<p class="tocsec"><a href="#calibre_link-610" class="calibre6">Numbers</a></p>
<p class="tocsec1"><a href="#calibre_link-611" class="calibre6">Integers</a></p>
<p class="tocsec1"><a href="#calibre_link-612" class="calibre6">Floats</a></p>
<p class="tocsec1"><a href="#calibre_link-613" class="calibre6">Integers and Floats</a></p>
<p class="tocsec1"><a href="#calibre_link-614" class="calibre6">Underscores in Numbers</a></p>
<p class="tocsec1"><a href="#calibre_link-615" class="calibre6">Multiple Assignment</a></p>
<p class="tocsec1"><a href="#calibre_link-616" class="calibre6">Constants</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-617" class="calibre6">Exercise 2-8: Number Eight</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-618" class="calibre6">Exercise 2-9: Favorite Number</a></em></p>
<p class="tocsec"><a href="#calibre_link-619" class="calibre6">Comments</a></p>
<p class="tocsec1"><a href="#calibre_link-620" class="calibre6">How Do You Write Comments?</a></p>
<p class="tocsec1"><a href="#calibre_link-621" class="calibre6">What Kind of Comments Should You Write?</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-622" class="calibre6">Exercise 2-10: Adding Comments</a></em></p>
<p class="tocsec"><a href="#calibre_link-623" class="calibre6">The Zen of Python</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-624" class="calibre6">Exercise 2-11: Zen of Python</a></em></p>
<p class="tocsec"><a href="#calibre_link-625" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-56" class="calibre6"><strong class="calibre2">3<br class="calibre4" />INTRODUCING LISTS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-626" class="calibre6">What Is a List?</a></p>
<p class="tocsec1"><a href="#calibre_link-627" class="calibre6">Accessing Elements in a List</a></p>
<p class="tocsec1"><a href="#calibre_link-628" class="calibre6">Index Positions Start at 0, Not 1</a></p>
<p class="tocsec1"><a href="#calibre_link-629" class="calibre6">Using Individual Values from a List</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-161" class="calibre6">Exercise 3-1: Names</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-630" class="calibre6">Exercise 3-2: Greetings</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-631" class="calibre6">Exercise 3-3: Your Own List</a></em></p>
<p class="tocsec"><a href="#calibre_link-632" class="calibre6">Changing, Adding, and Removing Elements</a></p>
<p class="tocsec1"><a href="#calibre_link-633" class="calibre6">Modifying Elements in a List</a></p>
<p class="tocsec1"><a href="#calibre_link-634" class="calibre6">Adding Elements to a List</a></p>
<p class="tocsec1"><a href="#calibre_link-635" class="calibre6">Removing Elements from a List</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-162" class="calibre6">Exercise 3-4: Guest List</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-163" class="calibre6">Exercise 3-5: Changing Guest List</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-164" class="calibre6">Exercise 3-6: More Guests</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-165" class="calibre6">Exercise 3-7: Shrinking Guest List</a></em></p>
<p class="tocsec"><a href="#calibre_link-636" class="calibre6">Organizing a List</a></p>
<p class="tocsec1"><a href="#calibre_link-637" class="calibre6">Sorting a List Permanently with the sort() Method</a></p>
<p class="tocsec1"><a href="#calibre_link-638" class="calibre6">Sorting a List Temporarily with the sorted() Function</a></p>
<p class="tocsec1"><a href="#calibre_link-639" class="calibre6">Printing a List in Reverse Order</a></p>
<p class="tocsec1"><a href="#calibre_link-640" class="calibre6">Finding the Length of a List</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-641" class="calibre6">Exercise 3-8: Seeing the World</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-642" class="calibre6">Exercise 3-9: Dinner Guests</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-643" class="calibre6">Exercise 3-10: Every Function</a></em></p>
<p class="tocsec"><span type="pagebreak" id="calibre_link-1265" class="calibre"></span><a href="#calibre_link-644" class="calibre6">Avoiding Index Errors When Working with Lists</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-645" class="calibre6">Exercise 3-11: Intentional Error</a></em></p>
<p class="tocsec"><a href="#calibre_link-646" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-115" class="calibre6"><strong class="calibre2">4<br class="calibre4" />WORKING WITH LISTS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-647" class="calibre6">Looping Through an Entire List</a></p>
<p class="tocsec1"><a href="#calibre_link-648" class="calibre6">A Closer Look at Looping</a></p>
<p class="tocsec1"><a href="#calibre_link-649" class="calibre6">Doing More Work Within a for Loop</a></p>
<p class="tocsec1"><a href="#calibre_link-650" class="calibre6">Doing Something After a for Loop</a></p>
<p class="tocsec"><a href="#calibre_link-651" class="calibre6">Avoiding Indentation Errors</a></p>
<p class="tocsec1"><a href="#calibre_link-652" class="calibre6">Forgetting to Indent</a></p>
<p class="tocsec1"><a href="#calibre_link-57" class="calibre6">Forgetting to Indent Additional Lines</a></p>
<p class="tocsec1"><a href="#calibre_link-653" class="calibre6">Indenting Unnecessarily</a></p>
<p class="tocsec1"><a href="#calibre_link-654" class="calibre6">Indenting Unnecessarily After the Loop</a></p>
<p class="tocsec1"><a href="#calibre_link-655" class="calibre6">Forgetting the Colon</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-59" class="calibre6">Exercise 4-1: Pizzas</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-656" class="calibre6">Exercise 4-2: Animals</a></em></p>
<p class="tocsec"><a href="#calibre_link-657" class="calibre6">Making Numerical Lists</a></p>
<p class="tocsec1"><a href="#calibre_link-658" class="calibre6">Using the range() Function</a></p>
<p class="tocsec1"><a href="#calibre_link-659" class="calibre6">Using range() to Make a List of Numbers</a></p>
<p class="tocsec1"><a href="#calibre_link-660" class="calibre6">Simple Statistics with a List of Numbers</a></p>
<p class="tocsec1"><a href="#calibre_link-661" class="calibre6">List Comprehensions</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-662" class="calibre6">Exercise 4-3: Counting to Twenty</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-663" class="calibre6">Exercise 4-4: One Million</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-664" class="calibre6">Exercise 4-5: Summing a Million</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-665" class="calibre6">Exercise 4-6: Odd Numbers</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-666" class="calibre6">Exercise 4-7: Threes</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-667" class="calibre6">Exercise 4-8: Cubes</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-668" class="calibre6">Exercise 4-9: Cube Comprehension</a></em></p>
<p class="tocsec"><a href="#calibre_link-669" class="calibre6">Working with Part of a List</a></p>
<p class="tocsec1"><a href="#calibre_link-670" class="calibre6">Slicing a List</a></p>
<p class="tocsec1"><a href="#calibre_link-671" class="calibre6">Looping Through a Slice</a></p>
<p class="tocsec1"><a href="#calibre_link-672" class="calibre6">Copying a List</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-673" class="calibre6">Exercise 4-10: Slices</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-674" class="calibre6">Exercise 4-11: My Pizzas, Your Pizzas</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-675" class="calibre6">Exercise 4-12: More Loops</a></em></p>
<p class="tocsec"><a href="#calibre_link-676" class="calibre6">Tuples</a></p>
<p class="tocsec1"><a href="#calibre_link-677" class="calibre6">Defining a Tuple</a></p>
<p class="tocsec1"><a href="#calibre_link-678" class="calibre6">Looping Through All Values in a Tuple</a></p>
<p class="tocsec1"><a href="#calibre_link-679" class="calibre6">Writing over a Tuple</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-680" class="calibre6">Exercise 4-13: Buffet</a></em></p>
<p class="tocsec"><a href="#calibre_link-681" class="calibre6">Styling Your Code</a></p>
<p class="tocsec1"><a href="#calibre_link-682" class="calibre6">The Style Guide</a></p>
<p class="tocsec1"><a href="#calibre_link-683" class="calibre6">Indentation</a></p>
<p class="tocsec1"><a href="#calibre_link-684" class="calibre6">Line Length</a></p>
<p class="tocsec1"><a href="#calibre_link-685" class="calibre6">Blank Lines</a></p>
<p class="tocsec1"><a href="#calibre_link-686" class="calibre6">Other Style Guidelines</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-687" class="calibre6">Exercise 4-14: PEP 8</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-688" class="calibre6">Exercise 4-15: Code Review</a></em></p>
<p class="tocsec"><a href="#calibre_link-689" class="calibre6">Summary</a></p>
<p class="tocparta"><span type="pagebreak" id="calibre_link-1266" class="calibre"></span><a href="#calibre_link-61" class="calibre6"><strong class="calibre2">5<br class="calibre4" />IF STATEMENTS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-690" class="calibre6">A Simple Example</a></p>
<p class="tocsec"><a href="#calibre_link-691" class="calibre6">Conditional Tests</a></p>
<p class="tocsec1"><a href="#calibre_link-692" class="calibre6">Checking for Equality</a></p>
<p class="tocsec1"><a href="#calibre_link-693" class="calibre6">Ignoring Case When Checking for Equality</a></p>
<p class="tocsec1"><a href="#calibre_link-694" class="calibre6">Checking for Inequality</a></p>
<p class="tocsec1"><a href="#calibre_link-695" class="calibre6">Numerical Comparisons</a></p>
<p class="tocsec1"><a href="#calibre_link-696" class="calibre6">Checking Multiple Conditions</a></p>
<p class="tocsec1"><a href="#calibre_link-697" class="calibre6">Checking Whether a Value Is in a List</a></p>
<p class="tocsec1"><a href="#calibre_link-698" class="calibre6">Checking Whether a Value Is Not in a List</a></p>
<p class="tocsec1"><a href="#calibre_link-699" class="calibre6">Boolean Expressions</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-700" class="calibre6">Exercise 5-1: Conditional Tests</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-701" class="calibre6">Exercise 5-2: More Conditional Tests</a></em></p>
<p class="tocsec"><a href="#calibre_link-702" class="calibre6">if Statements</a></p>
<p class="tocsec1"><a href="#calibre_link-703" class="calibre6">Simple if Statements</a></p>
<p class="tocsec1"><a href="#calibre_link-704" class="calibre6">if-else Statements</a></p>
<p class="tocsec1"><a href="#calibre_link-705" class="calibre6">The if-elif-else Chain</a></p>
<p class="tocsec1"><a href="#calibre_link-706" class="calibre6">Using Multiple elif Blocks</a></p>
<p class="tocsec1"><a href="#calibre_link-707" class="calibre6">Omitting the else Block</a></p>
<p class="tocsec1"><a href="#calibre_link-708" class="calibre6">Testing Multiple Conditions</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-148" class="calibre6">Exercise 5-3: Alien Colors #1</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-149" class="calibre6">Exercise 5-4: Alien Colors #2</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-709" class="calibre6">Exercise 5-5: Alien Colors #3</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-710" class="calibre6">Exercise 5-6: Stages of Life</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-711" class="calibre6">Exercise 5-7: Favorite Fruit</a></em></p>
<p class="tocsec"><a href="#calibre_link-712" class="calibre6">Using if Statements with Lists</a></p>
<p class="tocsec1"><a href="#calibre_link-713" class="calibre6">Checking for Special Items</a></p>
<p class="tocsec1"><a href="#calibre_link-714" class="calibre6">Checking That a List Is Not Empty</a></p>
<p class="tocsec1"><a href="#calibre_link-715" class="calibre6">Using Multiple Lists</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-716" class="calibre6">Exercise 5-8: Hello Admin</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-717" class="calibre6">Exercise 5-9: No Users</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-718" class="calibre6">Exercise 5-10: Checking Usernames</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-719" class="calibre6">Exercise 5-11: Ordinal Numbers</a></em></p>
<p class="tocsec"><a href="#calibre_link-720" class="calibre6">Styling Your if Statements</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-721" class="calibre6">Exercise 5-12: Styling if statements</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-722" class="calibre6">Exercise 5-13: Your Ideas</a></em></p>
<p class="tocsec"><a href="#calibre_link-723" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-116" class="calibre6"><strong class="calibre2">6<br class="calibre4" />DICTIONARIES</strong></a></p>
<p class="tocsec"><a href="#calibre_link-724" class="calibre6">A Simple Dictionary</a></p>
<p class="tocsec"><a href="#calibre_link-725" class="calibre6">Working with Dictionaries</a></p>
<p class="tocsec1"><a href="#calibre_link-726" class="calibre6">Accessing Values in a Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-727" class="calibre6">Adding New Key-Value Pairs</a></p>
<p class="tocsec1"><a href="#calibre_link-728" class="calibre6">Starting with an Empty Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-729" class="calibre6">Modifying Values in a Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-730" class="calibre6">Removing Key-Value Pairs</a></p>
<p class="tocsec1"><a href="#calibre_link-731" class="calibre6">A Dictionary of Similar Objects</a></p>
<p class="tocsec1"><a href="#calibre_link-732" class="calibre6">Using get() to Access Values</a></p>
<p class="tocsec1"><span type="pagebreak" id="calibre_link-1267" class="calibre"></span><em class="calibre3"><a href="#calibre_link-126" class="calibre6">Exercise 6-1: Person</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-127" class="calibre6">Exercise 6-2: Favorite Numbers</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-123" class="calibre6">Exercise 6-3: Glossary</a></em></p>
<p class="tocsec"><a href="#calibre_link-733" class="calibre6">Looping Through a Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-734" class="calibre6">Looping Through All Key-Value Pairs</a></p>
<p class="tocsec1"><a href="#calibre_link-735" class="calibre6">Looping Through All the Keys in a Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-736" class="calibre6">Looping Through a Dictionary’s Keys in a Particular Order</a></p>
<p class="tocsec1"><a href="#calibre_link-737" class="calibre6">Looping Through All Values in a Dictionary</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-738" class="calibre6">Exercise 6-4: Glossary 2</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-739" class="calibre6">Exercise 6-5: Rivers</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-740" class="calibre6">Exercise 6-6: Polling</a></em></p>
<p class="tocsec"><a href="#calibre_link-741" class="calibre6">Nesting</a></p>
<p class="tocsec1"><a href="#calibre_link-742" class="calibre6">A List of Dictionaries</a></p>
<p class="tocsec1"><a href="#calibre_link-743" class="calibre6">A List in a Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-744" class="calibre6">A Dictionary in a Dictionary</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-745" class="calibre6">Exercise 6-7: People</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-746" class="calibre6">Exercise 6-8: Pets</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-747" class="calibre6">Exercise 6-9: Favorite Places</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-748" class="calibre6">Exercise 6-10: Favorite Numbers</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-749" class="calibre6">Exercise 6-11: Cities</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-750" class="calibre6">Exercise 6-12: Extensions</a></em></p>
<p class="tocsec"><a href="#calibre_link-751" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-117" class="calibre6"><strong class="calibre2">7<br class="calibre4" />USER INPUT AND WHILE LOOPS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-752" class="calibre6">How the input() Function Works</a></p>
<p class="tocsec1"><a href="#calibre_link-753" class="calibre6">Writing Clear Prompts</a></p>
<p class="tocsec1"><a href="#calibre_link-754" class="calibre6">Using int() to Accept Numerical Input</a></p>
<p class="tocsec1"><a href="#calibre_link-755" class="calibre6">The Modulo Operator</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-756" class="calibre6">Exercise 7-1: Rental Car</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-757" class="calibre6">Exercise 7-2: Restaurant Seating</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-758" class="calibre6">Exercise 7-3: Multiples of Ten</a></em></p>
<p class="tocsec"><a href="#calibre_link-759" class="calibre6">Introducing while Loops</a></p>
<p class="tocsec1"><a href="#calibre_link-760" class="calibre6">The while Loop in Action</a></p>
<p class="tocsec1"><a href="#calibre_link-761" class="calibre6">Letting the User Choose When to Quit</a></p>
<p class="tocsec1"><a href="#calibre_link-762" class="calibre6">Using a Flag</a></p>
<p class="tocsec1"><a href="#calibre_link-763" class="calibre6">Using break to Exit a Loop</a></p>
<p class="tocsec1"><a href="#calibre_link-764" class="calibre6">Using continue in a Loop</a></p>
<p class="tocsec1"><a href="#calibre_link-765" class="calibre6">Avoiding Infinite Loops</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-132" class="calibre6">Exercise 7-4: Pizza Toppings</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-133" class="calibre6">Exercise 7-5: Movie Tickets</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-766" class="calibre6">Exercise 7-6: Three Exits</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-767" class="calibre6">Exercise 7-7: Infinity</a></em></p>
<p class="tocsec"><a href="#calibre_link-768" class="calibre6">Using a while Loop with Lists and Dictionaries</a></p>
<p class="tocsec1"><a href="#calibre_link-769" class="calibre6">Moving Items from One List to Another</a></p>
<p class="tocsec1"><a href="#calibre_link-770" class="calibre6">Removing All Instances of Specific Values from a List</a></p>
<p class="tocsec1"><a href="#calibre_link-771" class="calibre6">Filling a Dictionary with User Input</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-134" class="calibre6">Exercise 7-8: Deli</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-772" class="calibre6">Exercise 7-9: No Pastrami</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-773" class="calibre6">Exercise 7-10: Dream Vacation</a></em></p>
<p class="tocsec"><a href="#calibre_link-774" class="calibre6">Summary</a></p>
<p class="tocparta"><span type="pagebreak" id="calibre_link-1268" class="calibre"></span><a href="#calibre_link-118" class="calibre6"><strong class="calibre2">8<br class="calibre4" />FUNCTIONS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-775" class="calibre6">Defining a Function</a></p>
<p class="tocsec1"><a href="#calibre_link-776" class="calibre6">Passing Information to a Function</a></p>
<p class="tocsec1"><a href="#calibre_link-777" class="calibre6">Arguments and Parameters</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-778" class="calibre6">Exercise 8-1: Message</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-779" class="calibre6">Exercise 8-2: Favorite Book</a></em></p>
<p class="tocsec"><a href="#calibre_link-780" class="calibre6">Passing Arguments</a></p>
<p class="tocsec1"><a href="#calibre_link-781" class="calibre6">Positional Arguments</a></p>
<p class="tocsec1"><a href="#calibre_link-782" class="calibre6">Keyword Arguments</a></p>
<p class="tocsec1"><a href="#calibre_link-783" class="calibre6">Default Values</a></p>
<p class="tocsec1"><a href="#calibre_link-784" class="calibre6">Equivalent Function Calls</a></p>
<p class="tocsec1"><a href="#calibre_link-785" class="calibre6">Avoiding Argument Errors</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-786" class="calibre6">Exercise 8-3: T-Shirt</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-787" class="calibre6">Exercise 8-4: Large Shirts</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-788" class="calibre6">Exercise 8-5: Cities</a></em></p>
<p class="tocsec"><a href="#calibre_link-789" class="calibre6">Return Values</a></p>
<p class="tocsec1"><a href="#calibre_link-790" class="calibre6">Returning a Simple Value</a></p>
<p class="tocsec1"><a href="#calibre_link-791" class="calibre6">Making an Argument Optional</a></p>
<p class="tocsec1"><a href="#calibre_link-792" class="calibre6">Returning a Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-793" class="calibre6">Using a Function with a while Loop</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-794" class="calibre6">Exercise 8-6: City Names</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-25" class="calibre6">Exercise 8-7: Album</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-795" class="calibre6">Exercise 8-8: User Albums</a></em></p>
<p class="tocsec"><a href="#calibre_link-796" class="calibre6">Passing a List</a></p>
<p class="tocsec1"><a href="#calibre_link-797" class="calibre6">Modifying a List in a Function</a></p>
<p class="tocsec1"><a href="#calibre_link-798" class="calibre6">Preventing a Function from Modifying a List</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-26" class="calibre6">Exercise 8-9: Messages</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-27" class="calibre6">Exercise 8-10: Sending Messages</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-799" class="calibre6">Exercise 8-11: Archived Messages</a></em></p>
<p class="tocsec"><a href="#calibre_link-800" class="calibre6">Passing an Arbitrary Number of Arguments</a></p>
<p class="tocsec1"><a href="#calibre_link-801" class="calibre6">Mixing Positional and Arbitrary Arguments</a></p>
<p class="tocsec1"><a href="#calibre_link-802" class="calibre6">Using Arbitrary Keyword Arguments</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-803" class="calibre6">Exercise 8-12: Sandwiches</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-804" class="calibre6">Exercise 8-13: User Profile</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-805" class="calibre6">Exercise 8-14: Cars</a></em></p>
<p class="tocsec"><a href="#calibre_link-806" class="calibre6">Storing Your Functions in Modules</a></p>
<p class="tocsec1"><a href="#calibre_link-807" class="calibre6">Importing an Entire Module</a></p>
<p class="tocsec1"><a href="#calibre_link-808" class="calibre6">Importing Specific Functions</a></p>
<p class="tocsec1"><a href="#calibre_link-809" class="calibre6">Using as to Give a Function an Alias</a></p>
<p class="tocsec1"><a href="#calibre_link-810" class="calibre6">Using as to Give a Module an Alias</a></p>
<p class="tocsec1"><a href="#calibre_link-811" class="calibre6">Importing All Functions in a Module</a></p>
<p class="tocsec"><a href="#calibre_link-812" class="calibre6">Styling Functions</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-813" class="calibre6">Exercise 8-15: Printing Models</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-814" class="calibre6">Exercise 8-16: Imports</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-815" class="calibre6">Exercise 8-17: Styling Functions</a></em></p>
<p class="tocsec"><a href="#calibre_link-816" class="calibre6">Summary</a></p>
<p class="tocparta"><span type="pagebreak" id="calibre_link-1269" class="calibre"></span><a href="#calibre_link-29" class="calibre6"><strong class="calibre2">9<br class="calibre4" />CLASSES</strong></a></p>
<p class="tocsec"><a href="#calibre_link-817" class="calibre6">Creating and Using a Class</a></p>
<p class="tocsec1"><a href="#calibre_link-818" class="calibre6">Creating the Dog Class</a></p>
<p class="tocsec1"><a href="#calibre_link-819" class="calibre6">Making an Instance from a Class</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-820" class="calibre6">Exercise 9-1: Restaurant</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-821" class="calibre6">Exercise 9-2: Three Restaurants</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-822" class="calibre6">Exercise 9-3: Users</a></em></p>
<p class="tocsec"><a href="#calibre_link-823" class="calibre6">Working with Classes and Instances</a></p>
<p class="tocsec1"><a href="#calibre_link-824" class="calibre6">The Car Class</a></p>
<p class="tocsec1"><a href="#calibre_link-825" class="calibre6">Setting a Default Value for an Attribute</a></p>
<p class="tocsec1"><a href="#calibre_link-826" class="calibre6">Modifying Attribute Values</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-827" class="calibre6">Exercise 9-4: Number Served</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-828" class="calibre6">Exercise 9-5: Login Attempts</a></em></p>
<p class="tocsec"><a href="#calibre_link-829" class="calibre6">Inheritance</a></p>
<p class="tocsec1"><a href="#calibre_link-830" class="calibre6">The __init__() Method for a Child Class</a></p>
<p class="tocsec1"><a href="#calibre_link-831" class="calibre6">Defining Attributes and Methods for the Child Class</a></p>
<p class="tocsec1"><a href="#calibre_link-832" class="calibre6">Overriding Methods from the Parent Class</a></p>
<p class="tocsec1"><a href="#calibre_link-833" class="calibre6">Instances as Attributes</a></p>
<p class="tocsec1"><a href="#calibre_link-834" class="calibre6">Modeling Real-World Objects</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-835" class="calibre6">Exercise 9-6: Ice Cream Stand</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-836" class="calibre6">Exercise 9-7: Admin</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-837" class="calibre6">Exercise 9-8: Privileges</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-838" class="calibre6">Exercise 9-9: Battery Upgrade</a></em></p>
<p class="tocsec"><a href="#calibre_link-839" class="calibre6">Importing Classes</a></p>
<p class="tocsec1"><a href="#calibre_link-840" class="calibre6">Importing a Single Class</a></p>
<p class="tocsec1"><a href="#calibre_link-841" class="calibre6">Storing Multiple Classes in a Module</a></p>
<p class="tocsec1"><a href="#calibre_link-842" class="calibre6">Importing Multiple Classes from a Module</a></p>
<p class="tocsec1"><a href="#calibre_link-843" class="calibre6">Importing an Entire Module</a></p>
<p class="tocsec1"><a href="#calibre_link-844" class="calibre6">Importing All Classes from a Module</a></p>
<p class="tocsec1"><a href="#calibre_link-845" class="calibre6">Importing a Module into a Module</a></p>
<p class="tocsec1"><a href="#calibre_link-846" class="calibre6">Using Aliases</a></p>
<p class="tocsec1"><a href="#calibre_link-847" class="calibre6">Finding Your Own Workflow</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-848" class="calibre6">Exercise 9-10: Imported Restaurant</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-849" class="calibre6">Exercise 9-11: Imported Admin</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-850" class="calibre6">Exercise 9-12: Multiple Modules</a></em></p>
<p class="tocsec"><a href="#calibre_link-851" class="calibre6">The Python Standard Library</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-852" class="calibre6">Exercise 9-13: Dice</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-853" class="calibre6">Exercise 9-14: Lottery</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-854" class="calibre6">Exercise 9-15: Lottery Analysis</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-855" class="calibre6">Exercise 9-16: Python Module of the Week</a></em></p>
<p class="tocsec"><a href="#calibre_link-856" class="calibre6">Styling Classes</a></p>
<p class="tocsec"><a href="#calibre_link-857" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-119" class="calibre6"><strong class="calibre2">10<br class="calibre4" />FILES AND EXCEPTIONS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-858" class="calibre6">Reading from a File</a></p>
<p class="tocsec1"><a href="#calibre_link-859" class="calibre6">Reading an Entire File</a></p>
<p class="tocsec1"><a href="#calibre_link-860" class="calibre6">File Paths</a></p>
<p class="tocsec1"><a href="#calibre_link-861" class="calibre6">Reading Line by Line</a></p>
<p class="tocsec1"><a href="#calibre_link-862" class="calibre6">Making a List of Lines from a File</a></p>
<p class="tocsec1"><a href="#calibre_link-863" class="calibre6">Working with a File’s Contents</a></p>
<p class="tocsec1"><span type="pagebreak" id="calibre_link-1270" class="calibre"></span><a href="#calibre_link-864" class="calibre6">Large Files: One Million Digits</a></p>
<p class="tocsec1"><a href="#calibre_link-865" class="calibre6">Is Your Birthday Contained in Pi?</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-866" class="calibre6">Exercise 10-1: Learning Python</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-867" class="calibre6">Exercise 10-2: Learning C</a></em></p>
<p class="tocsec"><a href="#calibre_link-868" class="calibre6">Writing to a File</a></p>
<p class="tocsec1"><a href="#calibre_link-869" class="calibre6">Writing to an Empty File</a></p>
<p class="tocsec1"><a href="#calibre_link-870" class="calibre6">Writing Multiple Lines</a></p>
<p class="tocsec1"><a href="#calibre_link-871" class="calibre6">Appending to a File</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-872" class="calibre6">Exercise 10-3: Guest</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-873" class="calibre6">Exercise 10-4: Guest Book</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-874" class="calibre6">Exercise 10-5: Programming Poll</a></em></p>
<p class="tocsec"><a href="#calibre_link-875" class="calibre6">Exceptions</a></p>
<p class="tocsec1"><a href="#calibre_link-876" class="calibre6">Handling the ZeroDivisionError Exception</a></p>
<p class="tocsec1"><a href="#calibre_link-877" class="calibre6">Using try-except Blocks</a></p>
<p class="tocsec1"><a href="#calibre_link-878" class="calibre6">Using Exceptions to Prevent Crashes</a></p>
<p class="tocsec1"><a href="#calibre_link-879" class="calibre6">The else Block</a></p>
<p class="tocsec1"><a href="#calibre_link-880" class="calibre6">Handling the FileNotFoundError Exception</a></p>
<p class="tocsec1"><a href="#calibre_link-881" class="calibre6">Analyzing Text</a></p>
<p class="tocsec1"><a href="#calibre_link-882" class="calibre6">Working with Multiple Files</a></p>
<p class="tocsec1"><a href="#calibre_link-883" class="calibre6">Failing Silently</a></p>
<p class="tocsec1"><a href="#calibre_link-884" class="calibre6">Deciding Which Errors to Report</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-564" class="calibre6">Exercise 10-6: Addition</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-885" class="calibre6">Exercise 10-7: Addition Calculator</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-565" class="calibre6">Exercise 10-8: Cats and Dogs</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-886" class="calibre6">Exercise 10-9: Silent Cats and Dogs</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-887" class="calibre6">Exercise 10-10: Common Words</a></em></p>
<p class="tocsec"><a href="#calibre_link-888" class="calibre6">Storing Data</a></p>
<p class="tocsec1"><a href="#calibre_link-889" class="calibre6">Using json.dump() and json.load()</a></p>
<p class="tocsec1"><a href="#calibre_link-890" class="calibre6">Saving and Reading User-Generated Data</a></p>
<p class="tocsec1"><a href="#calibre_link-891" class="calibre6">Refactoring</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-566" class="calibre6">Exercise 10-11: Favorite Number</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-892" class="calibre6">Exercise 10-12: Favorite Number Remembered</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-893" class="calibre6">Exercise 10-13: Verify User</a></em></p>
<p class="tocsec"><a href="#calibre_link-894" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-120" class="calibre6"><strong class="calibre2">11<br class="calibre4" />TESTING YOUR CODE</strong></a></p>
<p class="tocsec"><a href="#calibre_link-895" class="calibre6">Testing a Function</a></p>
<p class="tocsec1"><a href="#calibre_link-896" class="calibre6">Unit Tests and Test Cases</a></p>
<p class="tocsec1"><a href="#calibre_link-897" class="calibre6">A Passing Test</a></p>
<p class="tocsec1"><a href="#calibre_link-898" class="calibre6">A Failing Test</a></p>
<p class="tocsec1"><a href="#calibre_link-899" class="calibre6">Responding to a Failed Test</a></p>
<p class="tocsec1"><a href="#calibre_link-900" class="calibre6">Adding New Tests</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-901" class="calibre6">Exercise 11-1: City, Country</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-902" class="calibre6">Exercise 11-2: Population</a></em></p>
<p class="tocsec"><a href="#calibre_link-903" class="calibre6">Testing a Class</a></p>
<p class="tocsec1"><a href="#calibre_link-904" class="calibre6">A Variety of Assert Methods</a></p>
<p class="tocsec1"><a href="#calibre_link-905" class="calibre6">A Class to Test</a></p>
<p class="tocsec1"><a href="#calibre_link-906" class="calibre6">Testing the AnonymousSurvey Class</a></p>
<p class="tocsec1"><a href="#calibre_link-907" class="calibre6">The setUp() Method</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-908" class="calibre6">Exercise 11-3: Employee</a></em></p>
<p class="tocsec"><a href="#calibre_link-909" class="calibre6">Summary</a></p>
<p class="tocpart"><span type="pagebreak" id="calibre_link-1271" class="calibre"></span><a href="#calibre_link-10" class="calibre6"><strong class="calibre2">PART II: PROJECTS</strong></a></p>
<p class="tocparta"><a href="#calibre_link-155" class="calibre6"><strong class="calibre2">PROJECT 1: ALIEN INVASION</strong></a></p>
<p class="tocparta"><a href="#calibre_link-11" class="calibre6"><strong class="calibre2">12<br class="calibre4" />A SHIP THAT FIRES BULLETS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-910" class="calibre6">Planning Your Project</a></p>
<p class="tocsec"><a href="#calibre_link-911" class="calibre6">Installing Pygame</a></p>
<p class="tocsec"><a href="#calibre_link-912" class="calibre6">Starting the Game Project</a></p>
<p class="tocsec1"><a href="#calibre_link-913" class="calibre6">Creating a Pygame Window and Responding to User Input</a></p>
<p class="tocsec1"><a href="#calibre_link-914" class="calibre6">Setting the Background Color</a></p>
<p class="tocsec1"><a href="#calibre_link-915" class="calibre6">Creating a Settings Class</a></p>
<p class="tocsec"><a href="#calibre_link-916" class="calibre6">Adding the Ship Image</a></p>
<p class="tocsec1"><a href="#calibre_link-917" class="calibre6">Creating the Ship Class</a></p>
<p class="tocsec1"><a href="#calibre_link-918" class="calibre6">Drawing the Ship to the Screen</a></p>
<p class="tocsec"><a href="#calibre_link-919" class="calibre6">Refactoring: The _check_events() and _update_screen() Methods</a></p>
<p class="tocsec1"><a href="#calibre_link-920" class="calibre6">The _check_events() Method</a></p>
<p class="tocsec1"><a href="#calibre_link-921" class="calibre6">The _update_screen() Method</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-922" class="calibre6">Exercise 12-1: Blue Sky</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-923" class="calibre6">Exercise 12-2: Game Character</a></em></p>
<p class="tocsec"><a href="#calibre_link-924" class="calibre6">Piloting the Ship</a></p>
<p class="tocsec1"><a href="#calibre_link-925" class="calibre6">Responding to a Keypress</a></p>
<p class="tocsec1"><a href="#calibre_link-926" class="calibre6">Allowing Continuous Movement</a></p>
<p class="tocsec1"><a href="#calibre_link-927" class="calibre6">Moving Both Left and Right</a></p>
<p class="tocsec1"><a href="#calibre_link-928" class="calibre6">Adjusting the Ship’s Speed</a></p>
<p class="tocsec1"><a href="#calibre_link-929" class="calibre6">Limiting the Ship’s Range</a></p>
<p class="tocsec1"><a href="#calibre_link-930" class="calibre6">Refactoring _check_events()</a></p>
<p class="tocsec1"><a href="#calibre_link-931" class="calibre6">Pressing Q to Quit</a></p>
<p class="tocsec1"><a href="#calibre_link-932" class="calibre6">Running the Game in Fullscreen Mode</a></p>
<p class="tocsec"><a href="#calibre_link-933" class="calibre6">A Quick Recap</a></p>
<p class="tocsec1"><a href="#calibre_link-934" class="calibre6">alien_invasion.py</a></p>
<p class="tocsec1"><a href="#calibre_link-935" class="calibre6">settings.py</a></p>
<p class="tocsec1"><a href="#calibre_link-936" class="calibre6">ship.py</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-937" class="calibre6">Exercise 12-3: Pygame Documentation</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-938" class="calibre6">Exercise 12-4: Rocket</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-939" class="calibre6">Exercise 12-5: Keys</a></em></p>
<p class="tocsec"><a href="#calibre_link-940" class="calibre6">Shooting Bullets</a></p>
<p class="tocsec1"><a href="#calibre_link-941" class="calibre6">Adding the Bullet Settings</a></p>
<p class="tocsec1"><a href="#calibre_link-942" class="calibre6">Creating the Bullet Class</a></p>
<p class="tocsec1"><a href="#calibre_link-943" class="calibre6">Storing Bullets in a Group</a></p>
<p class="tocsec1"><a href="#calibre_link-944" class="calibre6">Firing Bullets</a></p>
<p class="tocsec1"><a href="#calibre_link-945" class="calibre6">Deleting Old Bullets</a></p>
<p class="tocsec1"><a href="#calibre_link-946" class="calibre6">Limiting the Number of Bullets</a></p>
<p class="tocsec1"><a href="#calibre_link-947" class="calibre6">Creating the _update_bullets() Method</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-145" class="calibre6">Exercise 12-6: Sideways Shooter</a></em></p>
<p class="tocsec"><a href="#calibre_link-948" class="calibre6">Summary</a></p>
<p class="tocparta"><span type="pagebreak" id="calibre_link-1272" class="calibre"></span><a href="#calibre_link-12" class="calibre6"><strong class="calibre2">13<br class="calibre4" />ALIENS!</strong></a></p>
<p class="tocsec"><a href="#calibre_link-949" class="calibre6">Reviewing the Project</a></p>
<p class="tocsec"><a href="#calibre_link-950" class="calibre6">Creating the First Alien</a></p>
<p class="tocsec1"><a href="#calibre_link-951" class="calibre6">Creating the Alien Class</a></p>
<p class="tocsec1"><a href="#calibre_link-952" class="calibre6">Creating an Instance of the Alien</a></p>
<p class="tocsec"><a href="#calibre_link-953" class="calibre6">Building the Alien Fleet</a></p>
<p class="tocsec1"><a href="#calibre_link-954" class="calibre6">Determining How Many Aliens Fit in a Row</a></p>
<p class="tocsec1"><a href="#calibre_link-955" class="calibre6">Creating a Row of Aliens</a></p>
<p class="tocsec1"><a href="#calibre_link-956" class="calibre6">Refactoring _create_fleet()</a></p>
<p class="tocsec1"><a href="#calibre_link-957" class="calibre6">Adding Rows</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-141" class="calibre6">Exercise 13-1: Stars</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-958" class="calibre6">Exercise 13-2: Better Stars</a></em></p>
<p class="tocsec"><a href="#calibre_link-959" class="calibre6">Making the Fleet Move</a></p>
<p class="tocsec1"><a href="#calibre_link-960" class="calibre6">Moving the Aliens Right</a></p>
<p class="tocsec1"><a href="#calibre_link-961" class="calibre6">Creating Settings for Fleet Direction</a></p>
<p class="tocsec1"><a href="#calibre_link-962" class="calibre6">Checking Whether an Alien Has Hit the Edge</a></p>
<p class="tocsec1"><a href="#calibre_link-963" class="calibre6">Dropping the Fleet and Changing Direction</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-142" class="calibre6">Exercise 13-3: Raindrops</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-964" class="calibre6">Exercise 13-4: Steady Rain</a></em></p>
<p class="tocsec"><a href="#calibre_link-965" class="calibre6">Shooting Aliens</a></p>
<p class="tocsec1"><a href="#calibre_link-966" class="calibre6">Detecting Bullet Collisions</a></p>
<p class="tocsec1"><a href="#calibre_link-967" class="calibre6">Making Larger Bullets for Testing</a></p>
<p class="tocsec1"><a href="#calibre_link-968" class="calibre6">Repopulating the Fleet</a></p>
<p class="tocsec1"><a href="#calibre_link-969" class="calibre6">Speeding Up the Bullets</a></p>
<p class="tocsec1"><a href="#calibre_link-970" class="calibre6">Refactoring _update_bullets()</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-971" class="calibre6">Exercise 13-5: Sideways Shooter Part 2</a></em></p>
<p class="tocsec"><a href="#calibre_link-972" class="calibre6">Ending the Game</a></p>
<p class="tocsec1"><a href="#calibre_link-973" class="calibre6">Detecting Alien and Ship Collisions</a></p>
<p class="tocsec1"><a href="#calibre_link-974" class="calibre6">Responding to Alien and Ship Collisions</a></p>
<p class="tocsec1"><a href="#calibre_link-975" class="calibre6">Aliens that Reach the Bottom of the Screen</a></p>
<p class="tocsec1"><a href="#calibre_link-976" class="calibre6">Game Over!</a></p>
<p class="tocsec1"><a href="#calibre_link-977" class="calibre6">Identifying When Parts of the Game Should Run</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-978" class="calibre6">Exercise 13-6: Game Over</a></em></p>
<p class="tocsec"><a href="#calibre_link-979" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-13" class="calibre6"><strong class="calibre2">14<br class="calibre4" />SCORING</strong></a></p>
<p class="tocsec"><a href="#calibre_link-980" class="calibre6">Adding the Play Button</a></p>
<p class="tocsec1"><a href="#calibre_link-981" class="calibre6">Creating a Button Class</a></p>
<p class="tocsec1"><a href="#calibre_link-982" class="calibre6">Drawing the Button to the Screen</a></p>
<p class="tocsec1"><a href="#calibre_link-983" class="calibre6">Starting the Game</a></p>
<p class="tocsec1"><a href="#calibre_link-984" class="calibre6">Resetting the Game</a></p>
<p class="tocsec1"><a href="#calibre_link-985" class="calibre6">Deactivating the Play Button</a></p>
<p class="tocsec1"><a href="#calibre_link-986" class="calibre6">Hiding the Mouse Cursor</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-987" class="calibre6">Exercise 14-1: Press P to Play</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-107" class="calibre6">Exercise 14-2: Target Practice</a></em></p>
<p class="tocsec"><a href="#calibre_link-988" class="calibre6">Leveling Up</a></p>
<p class="tocsec1"><a href="#calibre_link-989" class="calibre6">Modifying the Speed Settings</a></p>
<p class="tocsec1"><a href="#calibre_link-990" class="calibre6">Resetting the Speed</a></p>
<p class="tocsec1"><span type="pagebreak" id="calibre_link-1273" class="calibre"></span><em class="calibre3"><a href="#calibre_link-991" class="calibre6">Exercise 14-3: Challenging Target Practice</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-992" class="calibre6">Exercise 14-4: Difficulty Levels</a></em></p>
<p class="tocsec"><a href="#calibre_link-993" class="calibre6">Scoring</a></p>
<p class="tocsec1"><a href="#calibre_link-994" class="calibre6">Displaying the Score</a></p>
<p class="tocsec1"><a href="#calibre_link-995" class="calibre6">Making a Scoreboard</a></p>
<p class="tocsec1"><a href="#calibre_link-996" class="calibre6">Updating the Score as Aliens Are Shot Down</a></p>
<p class="tocsec1"><a href="#calibre_link-997" class="calibre6">Resetting the Score</a></p>
<p class="tocsec1"><a href="#calibre_link-998" class="calibre6">Making Sure to Score All Hits</a></p>
<p class="tocsec1"><a href="#calibre_link-999" class="calibre6">Increasing Point Values</a></p>
<p class="tocsec1"><a href="#calibre_link-1000" class="calibre6">Rounding the Score</a></p>
<p class="tocsec1"><a href="#calibre_link-1001" class="calibre6">High Scores</a></p>
<p class="tocsec1"><a href="#calibre_link-1002" class="calibre6">Displaying the Level</a></p>
<p class="tocsec1"><a href="#calibre_link-1003" class="calibre6">Displaying the Number of Ships</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1004" class="calibre6">Exercise 14-5: All-Time High Score</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1005" class="calibre6">Exercise 14-6: Refactoring</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1006" class="calibre6">Exercise 14-7: Expanding the Game</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1007" class="calibre6">Exercise 14-8: Sideways Shooter, Final Version</a></em></p>
<p class="tocsec"><a href="#calibre_link-1008" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-156" class="calibre6"><strong class="calibre2">PROJECT 2: DATA VISUALIZATION</strong></a></p>
<p class="tocparta"><a href="#calibre_link-14" class="calibre6"><strong class="calibre2">15<br class="calibre4" />GENERATING DATA</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1009" class="calibre6">Installing Matplotlib</a></p>
<p class="tocsec"><a href="#calibre_link-1010" class="calibre6">Plotting a Simple Line Graph</a></p>
<p class="tocsec1"><a href="#calibre_link-1011" class="calibre6">Changing the Label Type and Line Thickness</a></p>
<p class="tocsec1"><a href="#calibre_link-1012" class="calibre6">Correcting the Plot</a></p>
<p class="tocsec1"><a href="#calibre_link-1013" class="calibre6">Using Built-in Styles</a></p>
<p class="tocsec1"><a href="#calibre_link-1014" class="calibre6">Plotting and Styling Individual Points with scatter()</a></p>
<p class="tocsec1"><a href="#calibre_link-1015" class="calibre6">Plotting a Series of Points with scatter()</a></p>
<p class="tocsec1"><a href="#calibre_link-1016" class="calibre6">Calculating Data Automatically</a></p>
<p class="tocsec1"><a href="#calibre_link-1017" class="calibre6">Defining Custom Colors</a></p>
<p class="tocsec1"><a href="#calibre_link-1018" class="calibre6">Using a Colormap</a></p>
<p class="tocsec1"><a href="#calibre_link-1019" class="calibre6">Saving Your Plots Automatically</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1020" class="calibre6">Exercise 15-1: Cubes</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1021" class="calibre6">Exercise 15-2: Colored Cubes</a></em></p>
<p class="tocsec"><a href="#calibre_link-1022" class="calibre6">Random Walks</a></p>
<p class="tocsec1"><a href="#calibre_link-1023" class="calibre6">Creating the RandomWalk() Class</a></p>
<p class="tocsec1"><a href="#calibre_link-1024" class="calibre6">Choosing Directions</a></p>
<p class="tocsec1"><a href="#calibre_link-1025" class="calibre6">Plotting the Random Walk</a></p>
<p class="tocsec1"><a href="#calibre_link-1026" class="calibre6">Generating Multiple Random Walks</a></p>
<p class="tocsec1"><a href="#calibre_link-1027" class="calibre6">Styling the Walk</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1028" class="calibre6">Exercise 15-3: Molecular Motion</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1029" class="calibre6">Exercise 15-4: Modified Random Walks</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1030" class="calibre6">Exercise 15-5: Refactoring</a></em></p>
<p class="tocsec"><a href="#calibre_link-1031" class="calibre6">Rolling Dice with Plotly</a></p>
<p class="tocsec1"><a href="#calibre_link-1032" class="calibre6">Installing Plotly</a></p>
<p class="tocsec1"><a href="#calibre_link-1033" class="calibre6">Creating the Die Class</a></p>
<p class="tocsec1"><a href="#calibre_link-1034" class="calibre6">Rolling the Die</a></p>
<p class="tocsec1"><span type="pagebreak" id="calibre_link-1274" class="calibre"></span><a href="#calibre_link-1035" class="calibre6">Analyzing the Results</a></p>
<p class="tocsec1"><a href="#calibre_link-1036" class="calibre6">Making a Histogram</a></p>
<p class="tocsec1"><a href="#calibre_link-1037" class="calibre6">Rolling Two Dice</a></p>
<p class="tocsec1"><a href="#calibre_link-1038" class="calibre6">Rolling Dice of Different Sizes</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1039" class="calibre6">Exercise 15-6: Two D8s</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1040" class="calibre6">Exercise 15-7: Three Dice</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1041" class="calibre6">Exercise 15-8: Multiplication</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1042" class="calibre6">Exercise 15-9: Die Comprehensions</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1043" class="calibre6">Exercise 15-10: Practicing with Both Libraries</a></em></p>
<p class="tocsec"><a href="#calibre_link-1044" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-15" class="calibre6"><strong class="calibre2">16<br class="calibre4" />DOWNLOADING DATA</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1045" class="calibre6">The CSV File Format</a></p>
<p class="tocsec1"><a href="#calibre_link-1046" class="calibre6">Parsing the CSV File Headers</a></p>
<p class="tocsec1"><a href="#calibre_link-1047" class="calibre6">Printing the Headers and Their Positions</a></p>
<p class="tocsec1"><a href="#calibre_link-1048" class="calibre6">Extracting and Reading Data</a></p>
<p class="tocsec1"><a href="#calibre_link-1049" class="calibre6">Plotting Data in a Temperature Chart</a></p>
<p class="tocsec1"><a href="#calibre_link-1050" class="calibre6">The datetime Module</a></p>
<p class="tocsec1"><a href="#calibre_link-1051" class="calibre6">Plotting Dates</a></p>
<p class="tocsec1"><a href="#calibre_link-1052" class="calibre6">Plotting a Longer Timeframe</a></p>
<p class="tocsec1"><a href="#calibre_link-1053" class="calibre6">Plotting a Second Data Series</a></p>
<p class="tocsec1"><a href="#calibre_link-1054" class="calibre6">Shading an Area in the Chart</a></p>
<p class="tocsec1"><a href="#calibre_link-1055" class="calibre6">Error Checking</a></p>
<p class="tocsec1"><a href="#calibre_link-1056" class="calibre6">Downloading Your Own Data</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1057" class="calibre6">Exercise 16-1: Sitka Rainfall</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1058" class="calibre6">Exercise 16-2: Sitka&ndash;Death Valley Comparison</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1059" class="calibre6">Exercise 16-3: San Francisco</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1060" class="calibre6">Exercise 16-4: Automatic Indexes</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1061" class="calibre6">Exercise 16-5: Explore</a></em></p>
<p class="tocsec"><a href="#calibre_link-1062" class="calibre6">Mapping Global Data Sets: JSON Format</a></p>
<p class="tocsec1"><a href="#calibre_link-1063" class="calibre6">Downloading Earthquake Data</a></p>
<p class="tocsec1"><a href="#calibre_link-1064" class="calibre6">Examining JSON Data</a></p>
<p class="tocsec1"><a href="#calibre_link-1065" class="calibre6">Making a List of All Earthquakes</a></p>
<p class="tocsec1"><a href="#calibre_link-1066" class="calibre6">Extracting Magnitudes</a></p>
<p class="tocsec1"><a href="#calibre_link-1067" class="calibre6">Extracting Location Data</a></p>
<p class="tocsec1"><a href="#calibre_link-1068" class="calibre6">Building a World Map</a></p>
<p class="tocsec1"><a href="#calibre_link-1069" class="calibre6">A Different Way of Specifying Chart Data</a></p>
<p class="tocsec1"><a href="#calibre_link-1070" class="calibre6">Customizing Marker Size</a></p>
<p class="tocsec1"><a href="#calibre_link-1071" class="calibre6">Customizing Marker Colors</a></p>
<p class="tocsec1"><a href="#calibre_link-1072" class="calibre6">Other Colorscales</a></p>
<p class="tocsec1"><a href="#calibre_link-1073" class="calibre6">Adding Hover Text</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1074" class="calibre6">Exercise 16-6: Refactoring</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1075" class="calibre6">Exercise 16-7: Automated Title</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1076" class="calibre6">Exercise 16-8: Recent Earthquakes</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1077" class="calibre6">Exercise 16-9: World Fires</a></em></p>
<p class="tocsec"><a href="#calibre_link-1078" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-16" class="calibre6"><strong class="calibre2">17<br class="calibre4" />WORKING WITH APIS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1079" class="calibre6">Using a Web API</a></p>
<p class="tocsec1"><a href="#calibre_link-1080" class="calibre6">Git and GitHub</a></p>
<p class="tocsec1"><span type="pagebreak" id="calibre_link-1275" class="calibre"></span><a href="#calibre_link-1081" class="calibre6">Requesting Data Using an API Call</a></p>
<p class="tocsec1"><a href="#calibre_link-1082" class="calibre6">Installing Requests</a></p>
<p class="tocsec1"><a href="#calibre_link-1083" class="calibre6">Processing an API Response</a></p>
<p class="tocsec1"><a href="#calibre_link-1084" class="calibre6">Working with the Response Dictionary</a></p>
<p class="tocsec1"><a href="#calibre_link-1085" class="calibre6">Summarizing the Top Repositories</a></p>
<p class="tocsec1"><a href="#calibre_link-1086" class="calibre6">Monitoring API Rate Limits</a></p>
<p class="tocsec"><a href="#calibre_link-1087" class="calibre6">Visualizing Repositories Using Plotly</a></p>
<p class="tocsec1"><a href="#calibre_link-1088" class="calibre6">Refining Plotly Charts</a></p>
<p class="tocsec1"><a href="#calibre_link-1089" class="calibre6">Adding Custom Tooltips</a></p>
<p class="tocsec1"><a href="#calibre_link-1090" class="calibre6">Adding Clickable Links to Our Graph</a></p>
<p class="tocsec1"><a href="#calibre_link-1091" class="calibre6">More About Plotly and the GitHub API</a></p>
<p class="tocsec"><a href="#calibre_link-1092" class="calibre6">The Hacker News API</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1093" class="calibre6">Exercise 17-1: Other Languages</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1094" class="calibre6">Exercise 17-2: Active Discussions</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1095" class="calibre6">Exercise 17-3: Testing python_repos.py</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1096" class="calibre6">Exercise 17-4: Further Exploration</a></em></p>
<p class="tocsec"><a href="#calibre_link-1097" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-157" class="calibre6"><strong class="calibre2">PROJECT 3: WEB APPLICATIONS</strong></a></p>
<p class="tocparta"><a href="#calibre_link-17" class="calibre6"><strong class="calibre2">18<br class="calibre4" />GETTING STARTED WITH DJANGO</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1098" class="calibre6">Setting Up a Project</a></p>
<p class="tocsec1"><a href="#calibre_link-1099" class="calibre6">Writing a Spec</a></p>
<p class="tocsec1"><a href="#calibre_link-1100" class="calibre6">Creating a Virtual Environment</a></p>
<p class="tocsec1"><a href="#calibre_link-1101" class="calibre6">Activating the Virtual Environment</a></p>
<p class="tocsec1"><a href="#calibre_link-1102" class="calibre6">Installing Django</a></p>
<p class="tocsec1"><a href="#calibre_link-1103" class="calibre6">Creating a Project in Django</a></p>
<p class="tocsec1"><a href="#calibre_link-1104" class="calibre6">Creating the Database</a></p>
<p class="tocsec1"><a href="#calibre_link-1105" class="calibre6">Viewing the Project</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1106" class="calibre6">Exercise 18-1: New Projects</a></em></p>
<p class="tocsec"><a href="#calibre_link-1107" class="calibre6">Starting an App</a></p>
<p class="tocsec1"><a href="#calibre_link-1108" class="calibre6">Defining Models</a></p>
<p class="tocsec1"><a href="#calibre_link-1109" class="calibre6">Activating Models</a></p>
<p class="tocsec1"><a href="#calibre_link-1110" class="calibre6">The Django Admin Site</a></p>
<p class="tocsec1"><a href="#calibre_link-1111" class="calibre6">Defining the Entry Model</a></p>
<p class="tocsec1"><a href="#calibre_link-1112" class="calibre6">Migrating the Entry Model</a></p>
<p class="tocsec1"><a href="#calibre_link-1113" class="calibre6">Registering Entry with the Admin Site</a></p>
<p class="tocsec1"><a href="#calibre_link-1114" class="calibre6">The Django Shell</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1115" class="calibre6">Exercise 18-2: Short Entries</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1116" class="calibre6">Exercise 18-3: The Django API</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-49" class="calibre6">Exercise 18-4: Pizzeria</a></em></p>
<p class="tocsec"><a href="#calibre_link-1117" class="calibre6">Making Pages: The Learning Log Home Page</a></p>
<p class="tocsec1"><a href="#calibre_link-1118" class="calibre6">Mapping a URL</a></p>
<p class="tocsec1"><a href="#calibre_link-1119" class="calibre6">Writing a View</a></p>
<p class="tocsec1"><a href="#calibre_link-1120" class="calibre6">Writing a Template</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1121" class="calibre6">Exercise 18-5: Meal Planner</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-53" class="calibre6">Exercise 18-6: Pizzeria Home Page</a></em></p>
<p class="tocsec"><a href="#calibre_link-1122" class="calibre6">Building Additional Pages</a></p>
<p class="tocsec1"><a href="#calibre_link-1123" class="calibre6">Template Inheritance</a></p>
<p class="tocsec1"><span type="pagebreak" id="calibre_link-1276" class="calibre"></span><a href="#calibre_link-1124" class="calibre6">The Topics Page</a></p>
<p class="tocsec1"><a href="#calibre_link-1125" class="calibre6">Individual Topic Pages</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1126" class="calibre6">Exercise 18-7: Template Documentation</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1127" class="calibre6">Exercise 18-8: Pizzeria Pages</a></em></p>
<p class="tocsec"><a href="#calibre_link-1128" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-18" class="calibre6"><strong class="calibre2">19<br class="calibre4" />USER ACCOUNTS</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1129" class="calibre6">Allowing Users to Enter Data</a></p>
<p class="tocsec1"><a href="#calibre_link-1130" class="calibre6">Adding New Topics</a></p>
<p class="tocsec1"><a href="#calibre_link-1131" class="calibre6">Adding New Entries</a></p>
<p class="tocsec1"><a href="#calibre_link-1132" class="calibre6">Editing Entries</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-77" class="calibre6">Exercise 19-1: Blog</a></em></p>
<p class="tocsec"><a href="#calibre_link-1133" class="calibre6">Setting Up User Accounts</a></p>
<p class="tocsec1"><a href="#calibre_link-1134" class="calibre6">The users App</a></p>
<p class="tocsec1"><a href="#calibre_link-1135" class="calibre6">The Login Page</a></p>
<p class="tocsec1"><a href="#calibre_link-1136" class="calibre6">Logging Out</a></p>
<p class="tocsec1"><a href="#calibre_link-1137" class="calibre6">The Registration Page</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1138" class="calibre6">Exercise 19-2: Blog Accounts</a></em></p>
<p class="tocsec"><a href="#calibre_link-1139" class="calibre6">Allowing Users to Own Their Data</a></p>
<p class="tocsec1"><a href="#calibre_link-1140" class="calibre6">Restricting Access with @login_required</a></p>
<p class="tocsec1"><a href="#calibre_link-1141" class="calibre6">Connecting Data to Certain Users</a></p>
<p class="tocsec1"><a href="#calibre_link-1142" class="calibre6">Restricting Topics Access to Appropriate Users</a></p>
<p class="tocsec1"><a href="#calibre_link-1143" class="calibre6">Protecting a User’s Topics</a></p>
<p class="tocsec1"><a href="#calibre_link-1144" class="calibre6">Protecting the edit_entry Page</a></p>
<p class="tocsec1"><a href="#calibre_link-1145" class="calibre6">Associating New Topics with the Current User</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1146" class="calibre6">Exercise 19-3: Refactoring</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1147" class="calibre6">Exercise 19-4: Protecting new_entry</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1148" class="calibre6">Exercise 19-5: Protected Blog</a></em></p>
<p class="tocsec"><a href="#calibre_link-1149" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-19" class="calibre6"><strong class="calibre2">20<br class="calibre4" />STYLING AND DEPLOYING AN APP</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1150" class="calibre6">Styling Learning Log</a></p>
<p class="tocsec1"><a href="#calibre_link-1151" class="calibre6">The django-bootstrap4 App</a></p>
<p class="tocsec1"><a href="#calibre_link-1152" class="calibre6">Using Bootstrap to Style Learning Log</a></p>
<p class="tocsec1"><a href="#calibre_link-1153" class="calibre6">Modifying base.html</a></p>
<p class="tocsec1"><a href="#calibre_link-1154" class="calibre6">Styling the Home Page Using a Jumbotron</a></p>
<p class="tocsec1"><a href="#calibre_link-1155" class="calibre6">Styling the Login Page</a></p>
<p class="tocsec1"><a href="#calibre_link-1156" class="calibre6">Styling the Topics Page</a></p>
<p class="tocsec1"><a href="#calibre_link-1157" class="calibre6">Styling the Entries on the Topic Page</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1158" class="calibre6">Exercise 20-1: Other Forms</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1159" class="calibre6">Exercise 20-2: Stylish Blog</a></em></p>
<p class="tocsec"><a href="#calibre_link-1160" class="calibre6">Deploying Learning Log</a></p>
<p class="tocsec1"><a href="#calibre_link-1161" class="calibre6">Making a Heroku Account</a></p>
<p class="tocsec1"><a href="#calibre_link-1162" class="calibre6">Installing the Heroku CLI</a></p>
<p class="tocsec1"><a href="#calibre_link-1163" class="calibre6">Installing Required Packages</a></p>
<p class="tocsec1"><a href="#calibre_link-1164" class="calibre6">Creating a requirements.txt File</a></p>
<p class="tocsec1"><a href="#calibre_link-1165" class="calibre6">Specifying the Python Runtime</a></p>
<p class="tocsec1"><a href="#calibre_link-1166" class="calibre6">Modifying settings.py for Heroku</a></p>
<p class="tocsec1"><a href="#calibre_link-1167" class="calibre6">Making a Procfile to Start Processes</a></p>
<p class="tocsec1"><span type="pagebreak" id="calibre_link-1277" class="calibre"></span><a href="#calibre_link-1168" class="calibre6">Using Git to Track the Project’s Files</a></p>
<p class="tocsec1"><a href="#calibre_link-1169" class="calibre6">Pushing to Heroku</a></p>
<p class="tocsec1"><a href="#calibre_link-1170" class="calibre6">Setting Up the Database on Heroku</a></p>
<p class="tocsec1"><a href="#calibre_link-1171" class="calibre6">Refining the Heroku Deployment</a></p>
<p class="tocsec1"><a href="#calibre_link-1172" class="calibre6">Securing the Live Project</a></p>
<p class="tocsec1"><a href="#calibre_link-1173" class="calibre6">Committing and Pushing Changes</a></p>
<p class="tocsec1"><a href="#calibre_link-1174" class="calibre6">Setting Environment Variables on Heroku</a></p>
<p class="tocsec1"><a href="#calibre_link-1175" class="calibre6">Creating Custom Error Pages</a></p>
<p class="tocsec1"><a href="#calibre_link-1176" class="calibre6">Ongoing Development</a></p>
<p class="tocsec1"><a href="#calibre_link-1177" class="calibre6">The SECRET_KEY Setting</a></p>
<p class="tocsec1"><a href="#calibre_link-1178" class="calibre6">Deleting a Project on Heroku</a></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1179" class="calibre6">Exercise 20-3: Live Blog</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1180" class="calibre6">Exercise 20-4: More 404s</a></em></p>
<p class="tocsec1"><em class="calibre3"><a href="#calibre_link-1181" class="calibre6">Exercise 20-5: Extended Learning Log</a></em></p>
<p class="tocsec"><a href="#calibre_link-1182" class="calibre6">Summary</a></p>
<p class="tocparta"><a href="#calibre_link-158" class="calibre6"><strong class="calibre2">AFTERWORD</strong></a></p>
<p class="tocparta"><a href="#calibre_link-1" class="calibre6"><strong class="calibre2">A<br class="calibre4" />INSTALLATION AND TROUBLESHOOTING</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1183" class="calibre6">Python on Windows</a></p>
<p class="tocsec1"><a href="#calibre_link-1184" class="calibre6">Finding the Python Interpreter</a></p>
<p class="tocsec1"><a href="#calibre_link-1185" class="calibre6">Adding Python to Your Path Variable</a></p>
<p class="tocsec1"><a href="#calibre_link-1186" class="calibre6">Reinstalling Python</a></p>
<p class="tocsec"><a href="#calibre_link-1187" class="calibre6">Python on macOS</a></p>
<p class="tocsec1"><a href="#calibre_link-1188" class="calibre6">Installing Homebrew</a></p>
<p class="tocsec1"><a href="#calibre_link-1189" class="calibre6">Installing Python</a></p>
<p class="tocsec"><a href="#calibre_link-1190" class="calibre6">Python on Linux</a></p>
<p class="tocsec"><a href="#calibre_link-63" class="calibre6">Python Keywords and Built-in Functions</a></p>
<p class="tocsec1"><a href="#calibre_link-1191" class="calibre6">Python Keywords</a></p>
<p class="tocsec1"><a href="#calibre_link-1192" class="calibre6">Python Built-in Functions</a></p>
<p class="tocparta"><a href="#calibre_link-2" class="calibre6"><strong class="calibre2">B<br class="calibre4" />TEXT EDITORS AND IDES</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1193" class="calibre6">Customizing Sublime Text Settings</a></p>
<p class="tocsec1"><a href="#calibre_link-1194" class="calibre6">Converting Tabs to Spaces</a></p>
<p class="tocsec1"><a href="#calibre_link-1195" class="calibre6">Setting the Line Length Indicator</a></p>
<p class="tocsec1"><a href="#calibre_link-1196" class="calibre6">Indenting and Unindenting Code Blocks</a></p>
<p class="tocsec1"><a href="#calibre_link-1197" class="calibre6">Commenting Out Blocks of Code</a></p>
<p class="tocsec1"><a href="#calibre_link-1198" class="calibre6">Saving Your Configuration</a></p>
<p class="tocsec1"><a href="#calibre_link-1199" class="calibre6">Further Customizations</a></p>
<p class="tocsec"><a href="#calibre_link-1200" class="calibre6">Other Text Editors and IDEs</a></p>
<p class="tocsec1"><a href="#calibre_link-1201" class="calibre6">IDLE</a></p>
<p class="tocsec1"><a href="#calibre_link-1202" class="calibre6">Geany</a></p>
<p class="tocsec1"><a href="#calibre_link-1203" class="calibre6">Emacs and Vim</a></p>
<p class="tocsec1"><a href="#calibre_link-1204" class="calibre6">Atom</a></p>
<p class="tocsec1"><a href="#calibre_link-1205" class="calibre6">Visual Studio Code</a></p>
<p class="tocsec1"><a href="#calibre_link-1206" class="calibre6">PyCharm</a></p>
<p class="tocsec1"><a href="#calibre_link-1207" class="calibre6">Jupyter Notebooks</a></p>
<p class="tocparta"><span type="pagebreak" id="calibre_link-1278" class="calibre"></span><a href="#calibre_link-6" class="calibre6"><strong class="calibre2">C<br class="calibre4" />GETTING HELP</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1208" class="calibre6">First Steps</a></p>
<p class="tocsec1"><a href="#calibre_link-1209" class="calibre6">Try It Again</a></p>
<p class="tocsec1"><a href="#calibre_link-1210" class="calibre6">Take a Break</a></p>
<p class="tocsec1"><a href="#calibre_link-1211" class="calibre6">Refer to This Book’s Resources</a></p>
<p class="tocsec"><a href="#calibre_link-1212" class="calibre6">Searching Online</a></p>
<p class="tocsec1"><a href="#calibre_link-1213" class="calibre6">Stack Overflow</a></p>
<p class="tocsec1"><a href="#calibre_link-1214" class="calibre6">The Official Python Documentation</a></p>
<p class="tocsec1"><a href="#calibre_link-1215" class="calibre6">Official Library Documentation</a></p>
<p class="tocsec1"><a href="#calibre_link-1216" class="calibre6">r/learnpython</a></p>
<p class="tocsec1"><a href="#calibre_link-1217" class="calibre6">Blog Posts</a></p>
<p class="tocsec"><a href="#calibre_link-1218" class="calibre6">Internet Relay Chat</a></p>
<p class="tocsec1"><a href="#calibre_link-1219" class="calibre6">Making an IRC Account</a></p>
<p class="tocsec1"><a href="#calibre_link-1220" class="calibre6">Channels to Join</a></p>
<p class="tocsec1"><a href="#calibre_link-1221" class="calibre6">IRC Culture</a></p>
<p class="tocsec"><a href="#calibre_link-1222" class="calibre6">Slack</a></p>
<p class="tocsec"><a href="#calibre_link-1223" class="calibre6">Discord</a></p>
<p class="tocparta"><a href="#calibre_link-67" class="calibre6"><strong class="calibre2">D<br class="calibre4" />USING GIT FOR VERSION CONTROL</strong></a></p>
<p class="tocsec"><a href="#calibre_link-1224" class="calibre6">Installing Git</a></p>
<p class="tocsec1"><a href="#calibre_link-1225" class="calibre6">Installing Git on Windows</a></p>
<p class="tocsec1"><a href="#calibre_link-1226" class="calibre6">Installing Git on macOS</a></p>
<p class="tocsec1"><a href="#calibre_link-1227" class="calibre6">Installing Git on Linux</a></p>
<p class="tocsec1"><a href="#calibre_link-1228" class="calibre6">Configuring Git</a></p>
<p class="tocsec"><a href="#calibre_link-1229" class="calibre6">Making a Project</a></p>
<p class="tocsec"><a href="#calibre_link-1230" class="calibre6">Ignoring Files</a></p>
<p class="tocsec"><a href="#calibre_link-1231" class="calibre6">Initializing a Repository</a></p>
<p class="tocsec"><a href="#calibre_link-1232" class="calibre6">Checking the Status</a></p>
<p class="tocsec"><a href="#calibre_link-1233" class="calibre6">Adding Files to the Repository</a></p>
<p class="tocsec"><a href="#calibre_link-1234" class="calibre6">Making a Commit</a></p>
<p class="tocsec"><a href="#calibre_link-1235" class="calibre6">Checking the Log</a></p>
<p class="tocsec"><a href="#calibre_link-1236" class="calibre6">The Second Commit</a></p>
<p class="tocsec"><a href="#calibre_link-1237" class="calibre6">Reverting a Change</a></p>
<p class="tocsec"><a href="#calibre_link-1238" class="calibre6">Checking Out Previous Commits</a></p>
<p class="tocsec"><a href="#calibre_link-1239" class="calibre6">Deleting the Repository</a></p>
<p class="tocparta"><a href="#calibre_link-159" class="calibre6"><strong class="calibre2">INDEX</strong></a></p>
</div>


<div class="calibre1" id="calibre_link-1243">
<h2 class="h2c" id="calibre_link-152"><span type="pagebreak" id="calibre_link-1279" class="calibre"></span><strong class="calibre2">PREFACE TO THE SECOND EDITION</strong></h2>
<p class="noindent">The response to the first edition of <em class="calibre3">Python Crash Course</em> has been overwhelmingly positive. More than 500,000 copies are in print, including translations in eight languages. I’ve received letters and emails from readers as young as 10, as well as from retirees who want to learn to program in their free time. <em class="calibre3">Python Crash Course</em> is being used in middle schools and high schools, and also in college classes. Students who are assigned more advanced textbooks are using <em class="calibre3">Python Crash Course</em> as a companion text for their classes and finding it a worthwhile supplement. People are using it to enhance their skills on the job and to start working on their own side projects. In short, people are using the book for the full range of purposes I had hoped they would.</p>
<p class="indent">The opportunity to write a second edition of <em class="calibre3">Python Crash Course</em> has been thoroughly enjoyable. Although Python is a mature language, it continues to evolve as every language does. My goal in revising the book was to make it leaner and simpler. There is no longer any reason to learn Python 2, so this edition focuses on Python 3 only. Many Python packages have become easier to install, so setup and installation instructions are easier. I’ve added a few topics that I’ve realized readers would benefit from, and I’ve updated some sections to reflect new, simpler ways of doing things in Python. I’ve also clarified some sections where certain details of the <span type="pagebreak" id="calibre_link-1280" class="calibre"></span>language were not presented as accurately as they could have been. All the projects have been completely updated using popular, well-maintained libraries that you can confidently use to build your own projects.</p>
<p class="indent">The following is a summary of specific changes that have been made in the second edition:</p>
<ul class="calibre8">
<li class="noindent1">In <a href="#calibre_link-21" class="calibre6">Chapter 1</a>, the instructions for installing Python have been simplified for users of all major operating systems. I now recommend the text editor Sublime Text, which is popular among beginner and professional programmers and works well on all operating systems.</li>
<li class="noindent1"><a href="#calibre_link-7" class="calibre6">Chapter 2</a> includes a more accurate description of how variables are implemented in Python. Variables are described as <em class="calibre3">labels</em> for values, which leads to a better understanding of how variables behave in Python. The book now uses f-strings, introduced in Python 3.6. This is a much simpler way to use variable values in strings. The use of underscores to represent large numbers, such as <span class="literal">1_000_000</span>, was also introduced in Python 3.6 and is included in this edition. Multiple assignment of variables was previously introduced in one of the projects, and that description has been generalized and moved to <a href="#calibre_link-7" class="calibre6">Chapter 2</a> for the benefit of all readers. Finally, a clear convention for representing constant values in Python is included in this chapter.</li>
<li class="noindent1">In <a href="#calibre_link-116" class="calibre6">Chapter 6</a>, I introduce the <span class="literal">get()</span> method for retrieving values from a dictionary, which can return a default value if a key does not exist.</li>
<li class="noindent1">The Alien Invasion project (<a href="#calibre_link-11" class="calibre6">Chapters 12</a>&ndash;<a href="#calibre_link-13" class="calibre6">14</a>) is now entirely class-based. The game itself is a class, rather than a series of functions. This greatly simplifies the overall structure of the game, vastly reducing the number of function calls and parameters required. Readers familiar with the first edition will appreciate the simplicity this new class-based approach provides. Pygame can now be installed in one line on all systems, and readers are given the option of running the game in fullscreen mode or in a windowed mode.</li>
<li class="noindent1">In the data visualization projects, the installation instructions for Matplotlib are simpler for all operating systems. The visualizations featuring Matplotlib use the <span class="literal">subplots()</span> function, which will be easier to build upon as you learn to create more complex visualizations. The Rolling Dice project in <a href="#calibre_link-14" class="calibre6">Chapter 15</a> uses Plotly, a well-maintained visualization library that features a clean syntax and beautiful, fully customizable output.</li>
<li class="noindent1">In <a href="#calibre_link-15" class="calibre6">Chapter 16</a>, the weather project is based on data from NOAA, which should be more stable over the next few years than the site used in the first edition. The mapping project focuses on global earthquake activity; by the end of this project you’ll have a stunning visualization showing Earth’s tectonic plate boundaries through a focus on the locations of all earthquakes over a given time period. You’ll learn to plot any data set involving geographic points.</li>
<li class="noindent1"><a href="#calibre_link-16" class="calibre6">Chapter 17</a> uses Plotly to visualize Python-related activity in open source projects on GitHub.</li>
<li class="noindent1"><span type="pagebreak" id="calibre_link-1281" class="calibre"></span>The Learning Log project (<a href="#calibre_link-17" class="calibre6">Chapters 18</a>&ndash;<a href="#calibre_link-19" class="calibre6">20</a>) is built using the latest version of Django and styled using the latest version of Bootstrap. The process of deploying the project to Heroku has been simplified using the <span class="literal">django-heroku</span> package, and uses environment variables rather than modifying the <em class="calibre3">settings.py</em> files. This is a simpler approach and is more consistent with how professional programmers deploy modern Django projects.</li>
<li class="noindent1"><a href="#calibre_link-1" class="calibre6">Appendix A</a> has been fully updated to recommend current best practices in installing Python. <a href="#calibre_link-2" class="calibre6">Appendix B</a> includes detailed instructions for setting up Sublime Text and brief descriptions of most of the major text editors and IDEs in current use. <a href="#calibre_link-6" class="calibre6">Appendix C</a> directs readers to newer, more popular online resources for getting help, and <a href="#calibre_link-67" class="calibre6">Appendix D</a> continues to offer a mini crash course in using Git for version control.</li>
<li class="noindent1">The index has been thoroughly updated to allow you to use <em class="calibre3">Python Crash Course</em> as a reference for all of your future Python projects.</li>
</ul>
<p class="indent">Thank you for reading <em class="calibre3">Python Crash Course</em>! If you have any feedback or questions, please feel free to get in touch.<span type="pagebreak" id="calibre_link-1282" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-22">
<h2 class="h2c" id="calibre_link-153"><span type="pagebreak" id="calibre_link-1283" class="calibre"></span><strong class="calibre2">ACKNOWLEDGMENTS</strong></h2>
<p class="noindent">This book would not have been possible without the wonderful and extremely professional staff at No Starch Press. Bill Pollock invited me to write an introductory book, and I deeply appreciate that original offer. Tyler Ortman helped shape my thinking in the early stages of drafting. Liz Chadwick’s and Leslie Shen’s initial feedback on each chapter was invaluable, and Anne Marie Walker helped to clarify many parts of the book. Riley Hoffman answered every question I had about the process of assembling a complete book and patiently turned my work into a beautiful finished product.</p>
<p class="indent">I’d like to thank Kenneth Love, the technical reviewer for <em class="calibre3">Python Crash Course</em>. I met Kenneth at PyCon one year, and his enthusiasm for the language and the Python community has been a constant source of professional inspiration ever since. Kenneth went beyond simple fact-checking and reviewed the book with the goal of helping beginning programmers develop a solid understanding of the Python language and programming in general. That said, any inaccuracies that remain are completely my own.</p>
<p class="indent">I’d like to thank my father for introducing me to programming at a young age and for not being afraid that I’d break his equipment. I’d like to thank my wife, Erin, for supporting and encouraging me through the writing of this book, and I’d like to thank my son, Ever, whose curiosity inspires me every single day.<span type="pagebreak" id="calibre_link-1284" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-33">
<h2 class="h" id="calibre_link-154"><span type="pagebreak" id="calibre_link-1285" class="calibre"></span><strong class="calibre2">INTRODUCTION</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Every programmer has a story about how they learned to write their first program. I started programming as a child when my father was working for Digital Equipment Corporation, one of the pioneering companies of the modern computing era. I wrote my first program on a kit computer that my dad had assembled in our basement. The computer consisted of nothing more than a bare motherboard connected to a keyboard without a case, and its monitor was a bare cathode ray tube. My initial program was a simple number guessing game, which looked something like this:</p>
<p class="programs">I'm thinking of a number! Try to guess the number I'm thinking of: <span class="codestrong">25</span><br class="calibre4" />
Too low! Guess again: <span class="codestrong">50</span><br class="calibre4" />
Too high! Guess again: <span class="codestrong">42</span><br class="calibre4" />
That's it! Would you like to play again? (yes/no) <span class="codestrong">no</span><br class="calibre4" />
Thanks for playing!</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1286" class="calibre"></span>I’ll always remember how satisfied I felt watching my family play a game that I created and that worked as I intended it to.</p>
<p class="indent">That early experience had a lasting impact. There is real satisfaction in building something with a purpose, something that solves a problem. The software I write now meets a more significant need than my childhood efforts, but the sense of satisfaction I get from creating a program that works is still largely the same.</p>
<h3 class="h2" id="calibre_link-571"><strong class="calibre2">Who Is This Book For?</strong></h3>
<p class="noindent">The goal of this book is to bring you up to speed with Python as quickly as possible so you can build programs that work&mdash;games, data visualizations, and web applications&mdash;while developing a foundation in programming that will serve you well for the rest of your life. <em class="calibre3">Python Crash Course</em> is written for people of any age who have never before programmed in Python or have never programmed at all. This book is for those who want to learn the basics of programming quickly so they can focus on interesting projects, and those who like to test their understanding of new concepts by solving meaningful problems. <em class="calibre3">Python Crash Course</em> is also perfect for middle school and high school teachers who want to offer their students a project-based introduction to programming. If you’re taking a college class and want a friendlier introduction to Python than the text you’ve been assigned, this book could make your class easier as well.</p>
<h3 class="h2" id="calibre_link-572"><strong class="calibre2">What Can You Expect to Learn?</strong></h3>
<p class="noindent">The purpose of this book is to make you a good programmer in general and a good Python programmer in particular. You’ll learn efficiently and adopt good habits as I provide you with a solid foundation in general programming concepts. After working your way through <em class="calibre3">Python Crash Course</em>, you should be ready to move on to more advanced Python techniques, and your next programming language will be even easier to grasp.</p>
<p class="indent">In the first part of this book, you’ll learn basic programming concepts you need to know to write Python programs. These concepts are the same as those you’d learn when starting out in almost any programming language. You’ll learn about different kinds of data and the ways you can store data in lists and dictionaries within your programs. You’ll learn to build collections of data and work through those collections in efficient ways. You’ll learn to use <span class="literal">while</span> loops and <span class="literal">if</span> statements to test for certain conditions so you can run specific sections of code while those conditions are true and run other sections when they’re not&mdash;a technique that greatly helps you automate processes.</p>
<p class="indent">You’ll learn to accept input from users to make your programs interactive and to keep your programs running as long as the user is active. You’ll explore how to write functions to make parts of your program reusable, so you only have to write blocks of code that perform certain actions once and then use that code as many times as you like. You’ll then extend <span type="pagebreak" id="calibre_link-1287" class="calibre"></span>this concept to more complicated behavior with classes, making fairly simple programs respond to a variety of situations. You’ll learn to write programs that handle common errors gracefully. After working through each of these basic concepts, you’ll write a few short programs that solve some well-defined problems. Finally, you’ll take your first step toward intermediate programming by learning how to write tests for your code so you can develop your programs further without worrying about introducing bugs. All the information in <a href="#calibre_link-9" class="calibre6">Part I</a> will prepare you for taking on larger, more complex projects.</p>
<p class="indent">In <a href="#calibre_link-10" class="calibre6">Part II</a>, you’ll apply what you learned in <a href="#calibre_link-9" class="calibre6">Part I</a> to three projects. You can do any or all of these projects in whichever order works best for you. In the first project (<a href="#calibre_link-11" class="calibre6">Chapters 12</a>&ndash;<a href="#calibre_link-13" class="calibre6">14</a>), you’ll create a <em class="calibre3">Space Invaders</em>&ndash;style shooting game called <em class="calibre3">Alien Invasion</em>, which consists of levels of increasing difficulty. After you’ve completed this project, you should be well on your way to being able to develop your own 2D games.</p>
<p class="indent">The second project (<a href="#calibre_link-14" class="calibre6">Chapters 15</a>&ndash;<a href="#calibre_link-16" class="calibre6">17</a>) introduces you to data visualization. Data scientists aim to make sense of the vast amount of information available to them through a variety of visualization techniques. You’ll work with data sets that you generate through code, data sets that you download from online sources, and data sets your programs download automatically. After you’ve completed this project, you’ll be able to write programs that sift through large data sets and make visual representations of that stored information.</p>
<p class="indent">In the third project (<a href="#calibre_link-17" class="calibre6">Chapters 18</a>&ndash;<a href="#calibre_link-19" class="calibre6">20</a>), you’ll build a small web application called Learning Log. This project allows you to keep a journal of ideas and concepts you’ve learned about a specific topic. You’ll be able to keep separate logs for different topics and allow others to create an account and start their own journals. You’ll also learn how to deploy your project so anyone can access it online from anywhere.</p>
<h3 class="h2" id="calibre_link-573"><strong class="calibre2">Online Resources</strong></h3>
<p class="noindent">You can find all the supplementary resources for the book online at <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em> or <em class="calibre3"><a href="http://ehmatthes.github.io/pcc_2e/" class="calibre6">http://ehmatthes.github.io/pcc_2e/</a></em>. These resources include:</p>
<p class="hangt"><strong class="calibre2">Setup instructions</strong> These instructions are identical to what’s in the book but include active links you can click for all the different pieces. If you’re having any setup issues, refer to this resource.</p>
<p class="hang"><strong class="calibre2">Updates</strong> Python, like all languages, is constantly evolving. I maintain a thorough set of updates, so if anything isn’t working, check here to see whether instructions have changed.</p>
<p class="hang"><strong class="calibre2">Solutions to exercises</strong> You should spend significant time on your own attempting the exercises in the “Try It Yourself” sections. But if you’re stuck and can’t make any progress, solutions to most of the exercises are online.</p>
<p class="hang"><strong class="calibre2">Cheat sheets</strong> A full set of downloadable cheat sheets for a quick reference to major concepts is also online.</p>
<h3 class="h2" id="calibre_link-574"><span type="pagebreak" id="calibre_link-1288" class="calibre"></span><strong class="calibre2">Why Python?</strong></h3>
<p class="noindent">Every year I consider whether to continue using Python or whether to move on to a different language&mdash;perhaps one that’s newer to the programming world. But I continue to focus on Python for many reasons. Python is an incredibly efficient language: your programs will do more in fewer lines of code than many other languages would require. Python’s syntax will also help you write “clean” code. Your code will be easy to read, easy to debug, and easy to extend and build upon compared to other languages.</p>
<p class="indent">People use Python for many purposes: to make games, build web applications, solve business problems, and develop internal tools at all kinds of interesting companies. Python is also used heavily in scientific fields for academic research and applied work.</p>
<p class="indent">One of the most important reasons I continue to use Python is because of the Python community, which includes an incredibly diverse and welcoming group of people. Community is essential to programmers because programming isn’t a solitary pursuit. Most of us, even the most experienced programmers, need to ask advice from others who have already solved similar problems. Having a well-connected and supportive community is critical in helping you solve problems, and the Python community is fully supportive of people like you who are learning Python as your first programming language.</p>
<p class="indent">Python is a great language to learn, so let’s get started!</p>
</div>


<div class="calibre1" id="calibre_link-114">
<h1 class="h1" id="calibre_link-9"><span type="pagebreak" id="calibre_link-1289" class="calibre"></span><strong class="calibre2">PART I<br class="calibre4" /><span class="f">BASICS</span></strong></h1>
<p class="noindenta"><a href="#calibre_link-9" class="calibre6">Part I</a> of this book teaches you the basic concepts you’ll need to write Python programs. Many of these concepts are common to all programming languages, so they’ll be useful throughout your life as a programmer.</p>
<p class="indent">In <strong class="calibre2"><a href="#calibre_link-21" class="calibre6">Chapter 1</a></strong> you’ll install Python on your computer and run your first program, which prints the message <em class="calibre3">Hello world!</em> to the screen.</p>
<p class="indent">In <strong class="calibre2"><a href="#calibre_link-7" class="calibre6">Chapter 2</a></strong> you’ll learn to store information in variables and work with text and numerical values.</p>
<p class="indent"><strong class="calibre2"><a href="#calibre_link-56" class="calibre6">Chapters 3</a></strong> and <strong class="calibre2"><a href="#calibre_link-115" class="calibre6">4</a></strong> introduce lists. Lists can store as much information as you want in one variable, allowing you to work with that data efficiently. You’ll be able to work with hundreds, thousands, and even millions of values in just a few lines of code.</p>
<p class="indent">In <strong class="calibre2"><a href="#calibre_link-61" class="calibre6">Chapter 5</a></strong> you’ll use <span class="literal">if</span> statements to write code that responds one way if certain conditions are true, and responds in a different way if those conditions are not true.</p>
<p class="indent"><strong class="calibre2"><a href="#calibre_link-116" class="calibre6">Chapter 6</a></strong> shows you how to use Python’s dictionaries, which let you make connections between different pieces of information. Like lists, dictionaries can contain as much information as you need to store.</p>
<p class="indent">In <strong class="calibre2"><a href="#calibre_link-117" class="calibre6">Chapter 7</a></strong> you’ll learn how to accept input from users to make your programs interactive. You’ll also learn about <span class="literal">while</span> loops, which run blocks of code repeatedly as long as certain conditions remain true.</p>
<p class="indent">In <strong class="calibre2"><a href="#calibre_link-118" class="calibre6">Chapter 8</a></strong> you’ll write functions, which are named blocks of code that perform a specific task and can be run whenever you need them.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1290" class="calibre"></span><strong class="calibre2"><a href="#calibre_link-29" class="calibre6">Chapter 9</a></strong> introduces classes, which allow you to model real-world objects, such as dogs, cats, people, cars, rockets, and much more, so your code can represent anything real or abstract.</p>
<p class="indent"><strong class="calibre2"><a href="#calibre_link-119" class="calibre6">Chapter 10</a></strong> shows you how to work with files and handle errors so your programs won’t crash unexpectedly. You’ll store data before your program closes, and read the data back in when the program runs again. You’ll learn about Python’s exceptions, which allow you to anticipate errors, and make your programs handle those errors gracefully.</p>
<p class="indent">In <strong class="calibre2"><a href="#calibre_link-120" class="calibre6">Chapter 11</a></strong> you’ll learn to write tests for your code to check that your programs work the way you intend them to. As a result, you’ll be able to expand your programs without worrying about introducing new bugs. Testing your code is one of the first skills that will help you transition from beginner to intermediate programmer.</p>
</div>


<div class="calibre1" id="calibre_link-0">
<h2 class="h" id="calibre_link-21"><span type="pagebreak" id="calibre_link-1291" class="calibre"></span><strong class="calibre2"><span class="big">1</span><br class="calibre4" />GETTING STARTED</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter, you’ll run your first Python program, <em class="calibre3">hello_world.py</em>. First, you’ll need to check whether a recent version of Python is installed on your computer; if it isn’t, you’ll install it. You’ll also install a text editor to work with your Python programs. Text editors recognize Python code and highlight sections as you write, making it easy to understand your code’s structure.</p>
<h3 class="h2" id="calibre_link-575"><strong class="calibre2">Setting Up Your Programming Environment</strong></h3>
<p class="noindent">Python differs slightly on different operating systems, so you’ll need to keep a few considerations in mind. In the following sections, we’ll make sure Python is set up correctly on your system.</p>
<h4 class="h3" id="calibre_link-576"><span type="pagebreak" id="calibre_link-531" class="calibre"></span><strong class="calibre2"><em class="calibre3">Python Versions</em></strong></h4>
<p class="noindent">Every programming language evolves as new ideas and technologies emerge, and the developers of Python have continually made the language more versatile and powerful. As of this writing, the latest version is Python 3.7, but everything in this book should run on Python 3.6 or later. In this section, we’ll find out if Python is already installed on your system and whether you need to install a newer version. <a href="#calibre_link-1" class="calibre6">Appendix A</a> contains a comprehensive guide to installing the latest version of Python on each major operating system as well.</p>
<p class="indent">Some old Python projects still use Python 2, but you should use Python 3. If Python 2 is installed on your system, it’s probably there to support some older programs that your system needs. We’ll leave this installation as is, and make sure you have a more recent version to work with.</p>
<h4 class="h3" id="calibre_link-577"><strong class="calibre2"><em class="calibre3">Running Snippets of Python Code</em></strong></h4>
<p class="noindent">You can run Python’s interpreter in a terminal window, allowing you to try bits of Python code without having to save and run an entire program.</p>
<p class="indent">Throughout this book, you’ll see code snippets that look like this:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">print("Hello Python interpreter!")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Hello Python interpreter!</p>
<p class="indent">The <span class="literal">&gt;&gt;&gt;</span> prompt indicates that you should be using the terminal window, and the bold text is the code you should type in and then execute by pressing <small class="calibre5">ENTER</small>. Most of the examples in the book are small, self-contained programs that you’ll run from your text editor rather than the terminal, because you’ll write most of your code in the text editor. But sometimes basic concepts will be shown in a series of snippets run through a Python terminal session to demonstrate particular concepts more efficiently. When you see three angle brackets in a code listing <span class="ent">➊</span>, you’re looking at code and output from a terminal session. We’ll try coding in the interpreter on your system in a moment.</p>
<p class="indent">We’ll also use a text editor to create a simple program called <em class="calibre3">Hello World!</em> that has become a staple of learning to program. There’s a long-held tradition in the programming world that printing a <span class="literal">Hello world!</span> message to the screen as your first program in a new language will bring you good luck. Such a simple program serves a very real purpose. If it runs correctly on your system, any Python program you write should work as well.</p>
<h4 class="h3" id="calibre_link-578"><strong class="calibre2"><em class="calibre3">About the Sublime Text Editor</em></strong></h4>
<p class="noindent">Sublime Text is a simple text editor that can be installed on all modern operating systems. Sublime Text lets you run almost all of your programs directly from the editor instead of through a terminal. Your code runs in a terminal session embedded in the Sublime Text window, which makes it easy to see the output.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-532" class="calibre"></span>Sublime Text is a beginner-friendly editor, but many professional programmers use it as well. If you become comfortable using it while learning Python, you can continue using it as you progress to larger and more complicated projects. Sublime Text has a very liberal licensing policy: you can use the editor free of charge as long as you want, but the developers request that you purchase a license if you like it and want to keep using it.</p>
<p class="indent"><a href="#calibre_link-2" class="calibre6">Appendix B</a> provides information on other text editors. If you’re curious about the other options, you might want to skim that appendix at this point. If you want to begin programming quickly, you can use Sublime Text to start and consider other editors once you’ve gained some experience as a programmer. In this chapter, I’ll walk you through installing Sublime Text on your operating system.</p>
<h3 class="h2" id="calibre_link-579"><strong class="calibre2">Python on Different Operating Systems</strong></h3>
<p class="noindent">Python is a cross-platform programming language, which means it runs on all the major operating systems. Any Python program you write should run on any modern computer that has Python installed. However, the methods for setting up Python on different operating systems vary slightly.</p>
<p class="indent">In this section, you’ll learn how to set up Python on your system. You’ll first check whether a recent version of Python is installed on your system and install it if it’s not. Then you’ll install Sublime Text. These are the only two steps that are different for each operating system.</p>
<p class="indent">In the sections that follow, you’ll run the <em class="calibre3">Hello World!</em> program and troubleshoot anything that didn’t work. I’ll walk you through this process for each operating system, so you’ll have a beginner-friendly Python programming environment.</p>
<h4 class="h3" id="calibre_link-580"><strong class="calibre2"><em class="calibre3">Python on Windows</em></strong></h4>
<p class="noindent">Windows doesn’t always come with Python, so you’ll probably need to install it, and then install Sublime Text.</p>
<h5 class="h4" id="calibre_link-1292"><strong class="calibre2">Installing Python</strong></h5>
<p class="noindent">First, check whether Python is installed on your system. Open a command window by entering <span class="codestrong1">command</span> into the Start menu or by holding down the <small class="calibre5">SHIFT</small> key while right-clicking on your desktop and selecting <strong class="calibre2">Open command window here</strong> from the menu. In the terminal window, enter <span class="codestrong1">python</span> in lowercase. If you get a Python prompt (<span class="literal">&gt;&gt;&gt;</span>) in response, Python is installed on your system. If you see an error message telling you that <span class="literal">python</span> is not a recognized command, Python isn’t installed.</p>
<p class="indent">In that case, or if you see a version of Python earlier than Python 3.6, you need to download a Python installer for Windows. Go to <em class="calibre3"><a href="https://python.org/" class="calibre6">https://python.org/</a></em> and hover over the <strong class="calibre2">Downloads</strong> link. You should see a button for downloading the latest version of Python. Click the button, which should automatically start downloading the correct installer for your system. After <span type="pagebreak" id="calibre_link-533" class="calibre"></span>you’ve downloaded the file, run the installer. Make sure you select the option <strong class="calibre2">Add Python to PATH</strong>, which will make it easier to configure your system correctly. <a href="#calibre_link-3" class="calibre6">Figure 1-1</a> shows this option selected.</p>
<div class="image1"><a id="calibre_link-3" class="calibre6"></a><img src="images/000000.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 1-1: Make sure you select the checkbox labeled</em> Add Python to PATH.</p>
<h5 class="h4" id="calibre_link-1293"><strong class="calibre2">Running Python in a Terminal Session</strong></h5>
<p class="noindent">Open a command window and enter <span class="codestrong1">python</span> in lowercase. You should see a Python prompt (<span class="literal">&gt;&gt;&gt;</span>), which means Windows has found the version of Python you just installed.</p>
<p class="programs">C:\&gt; <span class="codestrong">python</span><br class="calibre4" />
Python 3.7.2 (v3.7.2:9a3ffc0492, Dec 23 2018, 23:09:28) [MSC v.1916 64 bit<br class="calibre4" />
(AMD64)] on win32<br class="calibre4" />
Type "help", "copyright", "credits" or "license" for more information.<br class="calibre4" />
&gt;&gt;&gt;</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you don’t see this output or something similar, see the more detailed setup instructions in <a href="#calibre_link-1" class="calibre6">Appendix A</a>.</em></p>
</div>
<p class="indent">Enter the following line in your Python session, and make sure you see the output <span class="literal">Hello Python interpreter!</span></p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">print("Hello Python interpreter!")</span><br class="calibre4" />
Hello Python interpreter!<br class="calibre4" />
&gt;&gt;&gt;</p>
<p class="indent">Any time you want to run a snippet of Python code, open a command window and start a Python terminal session. To close the terminal session, press <small class="calibre5">CTRL</small>-Z and then press <small class="calibre5">ENTER</small>, or enter the command <span class="literal">exit()</span>.</p>
<h5 class="h4" id="calibre_link-1294"><span type="pagebreak" id="calibre_link-479" class="calibre"></span><strong class="calibre2">Installing Sublime Text</strong></h5>
<p class="noindent">You can download an installer for Sublime Text at <em class="calibre3"><a href="https://sublimetext.com/" class="calibre6">https://sublimetext.com/</a></em>. Click the download link and look for a Windows installer. After downloading the installer, run the installer and accept all of its defaults.</p>
<h4 class="h3" id="calibre_link-581"><strong class="calibre2"><em class="calibre3">Python on macOS</em></strong></h4>
<p class="noindent">Python is already installed on most macOS systems, but it’s most likely an outdated version that you won’t want to learn on. In this section, you’ll install the latest version of Python, and then you’ll install Sublime Text and make sure it’s configured correctly.</p>
<h5 class="h4" id="calibre_link-1295"><strong class="calibre2">Checking Whether Python 3 Is Installed</strong></h5>
<p class="noindent">Open a terminal window by going to <strong class="calibre2">Applications <span class="ent">▸</span> Utilities <span class="ent">▸</span> Terminal</strong>. You can also press <img class="middle" src="images/000044.jpg" alt="Image" />-spacebar, type <span class="codestrong1">terminal</span>, and then press <small class="calibre5">ENTER</small>. To see which version of Python is installed, enter <span class="codestrong1">python</span> with a lowercase <em class="calibre3">p</em>&mdash;this also starts the Python interpreter within the terminal, allowing you to enter Python commands. You should see output telling you which Python version is installed on your system and a <span class="literal">&gt;&gt;&gt;</span> prompt where you can start entering Python commands, like this:</p>
<p class="programs">$ <span class="codestrong">python</span><br class="calibre4" />
Python 2.7.15 (default, Aug 17 2018, 22:39:05)<br class="calibre4" />
[GCC 4.2.1 Compatible Apple LLVM 9.1.0 (clang-902.0.39.2)] on darwin<br class="calibre4" />
Type "help", "copyright", "credits", or "license" for more information.<br class="calibre4" />
&gt;&gt;&gt;</p>
<p class="indent">This output indicates that Python 2.7.15 is currently the default version installed on this computer. Once you’ve seen this output, press <small class="calibre5">CTRL</small>-D or enter <span class="codestrong1">exit()</span> to leave the Python prompt and return to a terminal prompt.</p>
<p class="indent">To check whether you have Python 3 installed, enter the command <span class="codestrong1">python3</span>. You’ll probably get an error message, meaning you don’t have any versions of Python 3 installed. If the output shows you have Python 3.6 or a later version installed, you can skip ahead to “<a href="#calibre_link-4" class="calibre6">Running Python in a Terminal Session</a>” on <a href="#calibre_link-5" class="calibre6">page 8</a>. If Python 3 isn’t installed by default, you’ll need to install it manually. Note that whenever you see the <span class="literal">python</span> command in this book, you need to use the <span class="literal">python3</span> command instead to make sure you’re using Python 3, not Python 2; they differ significantly enough that you’ll run into trouble trying to run the code in this book using Python 2.</p>
<p class="indent">If you see any version earlier than Python 3.6, follow the instructions in the next section to install the latest version.</p>
<h5 class="h4" id="calibre_link-1296"><strong class="calibre2">Installing the Latest Version of Python</strong></h5>
<p class="noindent">You can find a Python installer for your system at <em class="calibre3"><a href="https://python.org/" class="calibre6">https://python.org/</a></em>. Hover over the <strong class="calibre2">Download</strong> link, and you should see a button for downloading the latest Python version. Click the button, which should automatically start <span type="pagebreak" id="calibre_link-5" class="calibre"></span>downloading the correct installer for your system. After the file downloads, run the installer.</p>
<p class="indent">When you’re finished, enter the following at a terminal prompt:</p>
<p class="programs">$ <span class="codestrong">python3 --version</span><br class="calibre4" />
Python 3.7.2</p>
<p class="indent">You should see output similar to this, in which case, you’re ready to try out Python. Whenever you see the command <span class="codestrong1">python</span>, make sure you use <span class="codestrong1">python3</span>.</p>
<h5 class="h4" id="calibre_link-4"><strong class="calibre2">Running Python in a Terminal Session</strong></h5>
<p class="noindent">You can now try running snippets of Python code by opening a terminal and typing <span class="codestrong1">python3</span>. Enter the following line in the terminal session:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">print("Hello Python interpreter!")</span><br class="calibre4" />
Hello Python interpreter!<br class="calibre4" />
&gt;&gt;&gt;</p>
<p class="indent">Your message should print directly in the current terminal window. Remember that you can close the Python interpreter by pressing <small class="calibre5">CTRL</small>-D or by entering the command <span class="literal">exit()</span>.</p>
<h5 class="h4" id="calibre_link-1297"><strong class="calibre2">Installing Sublime Text</strong></h5>
<p class="noindent">To install the Sublime Text editor, you need to download the installer at <em class="calibre3"><a href="https://sublimetext.com/" class="calibre6">https://sublimetext.com/</a></em>. Click the <strong class="calibre2">Download</strong> link and look for an installer for macOS. After the installer downloads, open it and then drag the Sublime Text icon into your <em class="calibre3">Applications</em> folder.</p>
<h4 class="h3" id="calibre_link-582"><strong class="calibre2"><em class="calibre3">Python on Linux</em></strong></h4>
<p class="noindent">Linux systems are designed for programming, so Python is already installed on most Linux computers. The people who write and maintain Linux expect you to do your own programming at some point and encourage you to do so. For this reason, there’s very little to install and only a few settings to change to start programming.</p>
<h5 class="h4" id="calibre_link-1298"><strong class="calibre2">Checking Your Version of Python</strong></h5>
<p class="noindent">Open a terminal window by running the Terminal application on your system (in Ubuntu, you can press <small class="calibre5">CTRL</small>-<small class="calibre5">ALT</small>-T). To find out which version of Python is installed, enter <span class="codestrong1">python3</span> with a lowercase <em class="calibre3">p</em>. When Python is installed, this command starts the Python interpreter. You should see output indicating which version of Python is installed and a <span class="literal">&gt;&gt;&gt;</span> prompt where you can start entering Python commands, like this:</p>
<p class="programs">$ <span class="codestrong">python3</span><br class="calibre4" />
Python 3.7.2 (default, Dec 27 2018, 04:01:51)<br class="calibre4" />
[GCC 7.3.0] on linux<br class="calibre4" />
<span type="pagebreak" id="calibre_link-426" class="calibre"></span>Type "help", "copyright", "credits" or "license" for more information.<br class="calibre4" />
&gt;&gt;&gt;</p>
<p class="indent">This output indicates that Python 3.7.2 is currently the default version of Python installed on this computer. When you’ve seen this output, press <small class="calibre5">CTRL</small>-D or enter <span class="codestrong1">exit()</span> to leave the Python prompt and return to a terminal prompt. Whenever you see the <span class="codestrong1">python</span> command in this book, enter <span class="codestrong1">python3</span> instead.</p>
<p class="indent">You’ll need Python 3.6 or later to run the code in this book. If the Python version installed on your system is earlier than Python 3.6, refer to <a href="#calibre_link-1" class="calibre6">Appendix A</a> to install the latest version.</p>
<h5 class="h4" id="calibre_link-1299"><strong class="calibre2">Running Python in a Terminal Session</strong></h5>
<p class="noindent">You can try running snippets of Python code by opening a terminal and entering <span class="codestrong1">python3</span>, as you did when checking your version. Do this again, and when you have Python running, enter the following line in the terminal session:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">print("Hello Python interpreter!")</span><br class="calibre4" />
Hello Python interpreter!<br class="calibre4" />
&gt;&gt;&gt;</p>
<p class="indent">The message should print directly in the current terminal window. Remember that you can close the Python interpreter by pressing <small class="calibre5">CTRL</small>-D or by entering the command <span class="literal">exit()</span>.</p>
<h5 class="h4" id="calibre_link-1300"><strong class="calibre2">Installing Sublime Text</strong></h5>
<p class="noindent">On Linux, you can install Sublime Text from the Ubuntu Software Center. Click the Ubuntu Software icon in your menu, and search for <strong class="calibre2">Sublime Text</strong>. Click to install it, and then launch it.</p>
<h3 class="h2" id="calibre_link-583"><strong class="calibre2">Running a Hello World Program</strong></h3>
<p class="noindent">With a recent version of Python and Sublime Text installed, you’re almost ready to run your first Python program written in a text editor. But before doing so, you need to make sure Sublime Text is set up to use the correct version of Python on your system. Then you’ll write the <em class="calibre3">Hello World!</em> program and run it.</p>
<h4 class="h3" id="calibre_link-584"><strong class="calibre2"><em class="calibre3">Configuring Sublime Text to Use the Correct Python Version</em></strong></h4>
<p class="noindent">If the <span class="literal">python</span> command on your system runs Python 3, you won’t need to configure anything and can skip to the next section. If you use the <span class="literal">python3</span> command, you’ll need to configure Sublime Text to use the correct Python version when it runs your programs.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-427" class="calibre"></span>Click the Sublime Text icon to launch it, or search for Sublime Text in your system’s search bar and then launch it. Go to <strong class="calibre2">Tools <span class="ent">▸</span> Build System <span class="ent">▸</span> New Build System</strong>, which will open a new configuration file for you. Delete what you see and enter the following:</p>
<p class="margin"><em class="calibre3">Python3.sublime-build</em></p>
<p class="programs">{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"cmd": ["python3", "-u", "$file"],<br class="calibre4" />
}</p>
<p class="indent">This code tells Sublime Text to use your system’s <span class="literal">python3</span> command when running your Python program files. Save the file as <em class="calibre3">Python3.sublime-build</em> in the default directory that Sublime Text opens when you choose Save.</p>
<h4 class="h3" id="calibre_link-585"><strong class="calibre2"><em class="calibre3">Running hello_world.py</em></strong></h4>
<p class="noindent">Before you write your first program, make a folder called <em class="calibre3">python_work</em> somewhere on your system for your projects. It’s best to use lowercase letters and underscores for spaces in file and folder names, because Python uses these naming conventions.</p>
<p class="indent">Open Sublime Text, and save an empty Python file (<strong class="calibre2">File <span class="ent">▸</span> Save As</strong>) called <em class="calibre3">hello_world.py</em> in your <em class="calibre3">python_work</em> folder. The extension <em class="calibre3">.py</em> tells Sublime Text that the code in your file is written in Python, which tells it how to run the program and highlight the text in a helpful way.</p>
<p class="indent">After you’ve saved your file, enter the following line in the text editor:</p>
<p class="margin"><em class="calibre3">hello_world.py</em></p>
<p class="programs">print("Hello Python world!")</p>
<p class="indent">If the <span class="literal">python</span> command works on your system, you can run your program by selecting <strong class="calibre2">Tools <span class="ent">▸</span> Build</strong> in the menu or by pressing <small class="calibre5">CTRL</small>-B (<img class="middle" src="images/000044.jpg" alt="Image" />-B on macOS). If you had to configure Sublime Text in the previous section, select <strong class="calibre2">Tools <span class="ent">▸</span> Build System</strong> and then select <strong class="calibre2">Python 3</strong>. From now on you’ll be able to select <strong class="calibre2">Tools <span class="ent">▸</span> Build</strong> or just press <small class="calibre5">CTRL</small>-B (or <img class="middle" src="images/000044.jpg" alt="Image" />-B) to run your programs.</p>
<p class="indent">A terminal screen should appear at the bottom of the Sublime Text window, showing the following output:</p>
<p class="programs">Hello Python world!<br class="calibre4" />
[Finished in 0.1s]</p>
<p class="indent">If you don’t see this output, something might have gone wrong in the program. Check every character on the line you entered. Did you accidentally capitalize <span class="literal">print</span>? Did you forget one or both of the quotation marks or parentheses? Programming languages expect very specific syntax, and if you don’t provide that, you’ll get errors. If you can’t get the program to run, see the suggestions in the next section.</p>
<h3 class="h2" id="calibre_link-586"><span type="pagebreak" id="calibre_link-467" class="calibre"></span><strong class="calibre2">Troubleshooting</strong></h3>
<p class="noindent">If you can’t get <em class="calibre3">hello_world.py</em> to run, here are a few remedies you can try that are also good general solutions for any programming problem:</p>
<ul class="calibre8">
<li class="noindent1">When a program contains a significant error, Python displays a <em class="calibre3">traceback</em>, which is an error report. Python looks through the file and tries to identify the problem. Check the traceback; it might give you a clue as to what issue is preventing the program from running.</li>
<li class="noindent1">Step away from your computer, take a short break, and then try again. Remember that syntax is very important in programming, so even a missing colon, a mismatched quotation mark, or mismatched parentheses can prevent a program from running properly. Reread the relevant parts of this chapter, look over your code, and try to find the mistake.</li>
<li class="noindent1">Start over again. You probably don’t need to uninstall any software, but it might make sense to delete your <em class="calibre3">hello_world.py</em> file and re-create it from scratch.</li>
<li class="noindent1">Ask someone else to follow the steps in this chapter, on your computer or a different one, and watch what they do carefully. You might have missed one small step that someone else happens to catch.</li>
<li class="noindent1">Find someone who knows Python and ask them to help you get set up. If you ask around, you might find that you unexpectedly know someone who uses Python.</li>
<li class="noindent1">The setup instructions in this chapter are also available through the book’s companion website at <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em>. The online version of these instructions might work better for you because you can simply cut and paste code.</li>
<li class="noindent1">Ask for help online. <a href="#calibre_link-6" class="calibre6">Appendix C</a> provides a number of resources, such as forums and live chat sites, where you can ask for solutions from people who’ve already worked through the issue you’re currently facing.</li>
</ul>
<p class="indent">Never worry that you’re bothering experienced programmers. Every programmer has been stuck at some point, and most programmers are happy to help you set up your system correctly. As long as you can state clearly what you’re trying to do, what you’ve already tried, and the results you’re getting, there’s a good chance someone will be able to help you. As mentioned in the Introduction, the Python community is very friendly and welcoming to beginners.</p>
<p class="indent">Python should run well on any modern computer. Early setup issues can be frustrating, but they’re well worth sorting out. Once you get <em class="calibre3">hello_world.py</em> running, you can start to learn Python, and your programming work will become more interesting and satisfying.</p>
<h3 class="h2" id="calibre_link-130"><span type="pagebreak" id="calibre_link-131" class="calibre"></span><strong class="calibre2">Running Python Programs from a Terminal</strong></h3>
<p class="noindent">Most of the programs you write in your text editor you’ll run directly from the editor. But sometimes it’s useful to run programs from a terminal instead. For example, you might want to run an existing program without opening it for editing.</p>
<p class="indent">You can do this on any system with Python installed if you know how to access the directory where the program file is stored. To try this, make sure you’ve saved the <em class="calibre3">hello_world.py</em> file in the <em class="calibre3">python_work</em> folder on your desktop.</p>
<h4 class="h3" id="calibre_link-587"><strong class="calibre2"><em class="calibre3">On Windows</em></strong></h4>
<p class="noindent">You can use the terminal command <span class="literal">cd</span>, for <em class="calibre3">change directory</em>, to navigate through your filesystem in a command window. The command <span class="literal">dir</span>, for <em class="calibre3">directory</em>, shows you all the files that exist in the current directory.</p>
<p class="indent">Open a new terminal window and enter the following commands to run <em class="calibre3">hello_world.py</em>:</p>
<p class="programs"><span class="ent">➊</span> C:\&gt; <span class="codestrong">cd Desktop\python_work</span><br class="calibre4" />
<span class="ent">➋</span> C:\Desktop\python_work&gt; <span class="codestrong">dir</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;hello_world.py<br class="calibre4" />
<span class="ent">➌</span> C:\Desktop\python_work&gt; <span class="codestrong">python hello_world.py</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Hello Python world!</p>
<p class="indent">At <span class="ent">➊</span> you use the <span class="literal">cd</span> command to navigate to the <em class="calibre3">python_work</em> folder, which is in the <em class="calibre3">Desktop</em> folder. Next, you use the <span class="literal">dir</span> command to make sure <em class="calibre3">hello_world.py</em> is in this folder <span class="ent">➋</span>. Then you run the file using the command <span class="literal">python hello_world.py</span> <span class="ent">➌</span>.</p>
<p class="indent">Most of your programs will run fine directly from your editor. But as your work becomes more complex, you’ll want to run some of your programs from a terminal.</p>
<h4 class="h3" id="calibre_link-588"><strong class="calibre2"><em class="calibre3">On macOS and Linux</em></strong></h4>
<p class="noindent">Running a Python program from a terminal session is the same on Linux and macOS. You can use the terminal command <span class="literal">cd</span>, for <em class="calibre3">change directory</em>, to navigate through your filesystem in a terminal session. The command <span class="literal">ls</span>, for <em class="calibre3">list</em>, shows you all the nonhidden files that exist in the current directory.</p>
<p class="indent">Open a new terminal window and enter the following commands to run <em class="calibre3">hello_world.py</em>:</p>
<p class="programs"><span class="ent">➊</span> ~$ <span class="codestrong">cd Desktop/python_work/</span><br class="calibre4" />
<span class="ent">➋</span> ~/Desktop/python_work$ <span class="codestrong">ls</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;hello_world.py<br class="calibre4" />
<span class="ent">➌</span> ~/Desktop/python_work$ <span class="codestrong">python hello_world.py</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Hello Python world!</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1301" class="calibre"></span>At <span class="ent">➊</span> you use the <span class="literal">cd</span> command to navigate to the <em class="calibre3">python_work</em> folder, which is in the <em class="calibre3">Desktop</em> folder. Next, you use the <span class="literal">ls</span> command to make sure <em class="calibre3">hello_world.py</em> is in this folder <span class="ent">➋</span>. Then you run the file using the command <span class="literal">python hello_world.py</span> <span class="ent">➌</span>.</p>
<p class="indent">It’s that simple. You just use the <span class="literal">python</span> (or <span class="literal">python3</span>) command to run Python programs.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="spara">The exercises in this chapter are exploratory in nature. Starting in <a href="#calibre_link-7" class="calibre6">Chapter 2</a>, the challenges you’ll solve will be based on what you’ve learned.</p>
<p class="sparal" id="calibre_link-589"><strong class="calibre2">1-1. python.org:</strong> Explore the Python home page (<em class="calibre3"><a href="https://python.org/" class="calibre6">https://python.org/</a></em>) to find topics that interest you. As you become familiar with Python, different parts of the site will be more useful to you.</p>
<p class="sparal" id="calibre_link-590"><strong class="calibre2">1-2. Hello World Typos:</strong> Open the <em class="calibre3">hello_world.py</em> file you just created. Make a typo somewhere in the line and run the program again. Can you make a typo that generates an error? Can you make sense of the error message? Can you make a typo that doesn’t generate an error? Why do you think it didn’t make an error?</p>
<p class="sparal" id="calibre_link-591"><strong class="calibre2">1-3. Infinite Skills:</strong> If you had infinite programming skills, what would you build? You’re about to learn how to program. If you have an end goal in mind, you’ll have an immediate use for your new skills; now is a great time to draft descriptions of what you want to create. It’s a good habit to keep an “ideas” notebook that you can refer to whenever you want to start a new project. Take a few minutes now to describe three programs you want to create.</p>
</div>
<h3 class="h2" id="calibre_link-592"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned a bit about Python in general, and you installed Python on your system if it wasn’t already there. You also installed a text editor to make it easier to write Python code. You ran snippets of Python code in a terminal session, and you ran your first program, <em class="calibre3">hello_world.py</em>. You probably learned a bit about troubleshooting as well.</p>
<p class="indent">In the next chapter, you’ll learn about the different kinds of data you can work with in your Python programs, and you’ll use variables as well.<span type="pagebreak" id="calibre_link-1302" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-62">
<h2 class="h" id="calibre_link-7"><span type="pagebreak" id="calibre_link-428" class="calibre"></span><strong class="calibre2"><span class="big">2</span><br class="calibre4" />VARIABLES AND SIMPLE DATA TYPES</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter you’ll learn about the different kinds of data you can work with in your Python programs. You’ll also learn how to use variables to represent data in your programs.</p>
<h3 class="h2" id="calibre_link-593"><strong class="calibre2">What Really Happens When You Run hello_world.py</strong></h3>
<p class="noindent">Let’s take a closer look at what Python does when you run <em class="calibre3">hello_world.py</em>. As it turns out, Python does a fair amount of work, even when it runs a simple program:</p>
<p class="margin"><em class="calibre3">hello_world.py</em></p>
<p class="programs">print("Hello Python world!")</p>
<p class="indent">When you run this code, you should see this output:</p>
<p class="programs">Hello Python world!</p>
<p class="indent"><span type="pagebreak" id="calibre_link-523" class="calibre"></span>When you run the file <em class="calibre3">hello_world.py</em>, the ending <em class="calibre3">.py</em> indicates that the file is a Python program. Your editor then runs the file through the <em class="calibre3">Python interpreter</em>, which reads through the program and determines what each word in the program means. For example, when the interpreter sees the word <span class="literal">print</span> followed by parentheses, it prints to the screen whatever is inside the parentheses.</p>
<p class="indent">As you write your programs, your editor highlights different parts of your program in different ways. For example, it recognizes that <span class="literal">print()</span> is the name of a function and displays that word in one color. It recognizes that <span class="literal">"Hello Python world!"</span> is not Python code and displays that phrase in a different color. This feature is called <em class="calibre3">syntax highlighting</em> and is quite useful as you start to write your own programs.</p>
<h3 class="h2" id="calibre_link-594"><strong class="calibre2">Variables</strong></h3>
<p class="noindent">Let’s try using a variable in <em class="calibre3">hello_world.py</em>. Add a new line at the beginning of the file, and modify the second line:</p>
<p class="margin"><em class="calibre3">hello_world.py</em></p>
<p class="programs">message = "Hello Python world!"<br class="calibre4" />
print(message)</p>
<p class="indent">Run this program to see what happens. You should see the same output you saw previously:</p>
<p class="programs">Hello Python world!</p>
<p class="indent">We’ve added a <em class="calibre3">variable</em> named <span class="literal">message</span>. Every variable is connected to a <em class="calibre3">value</em>, which is the information associated with that variable. In this case the value is the <span class="literal">"Hello Python world!"</span> text.</p>
<p class="indent">Adding a variable makes a little more work for the Python interpreter. When it processes the first line, it associates the variable <span class="literal">message</span> with the <span class="literal">"Hello Python world!"</span> text. When it reaches the second line, it prints the value associated with <span class="literal">message</span> to the screen.</p>
<p class="indent">Let’s expand on this program by modifying <em class="calibre3">hello_world.py</em> to print a second message. Add a blank line to <em class="calibre3">hello_world.py</em>, and then add two new lines of code:</p>
<p class="programs"><span class="ash">message = "Hello Python world!"</span><br class="calibre4" />
<span class="ash">print(message)</span><br class="calibre4" />
<br class="calibre4" />
message = "Hello Python Crash Course world!"<br class="calibre4" />
print(message)</p>
<p class="indent">Now when you run <em class="calibre3">hello_world.py</em>, you should see two lines of output:</p>
<p class="programs">Hello Python world!<br class="calibre4" />
Hello Python Crash Course world!</p>
<p class="indent"><span type="pagebreak" id="calibre_link-504" class="calibre"></span>You can change the value of a variable in your program at any time, and Python will always keep track of its current value.</p>
<h4 class="h3" id="calibre_link-595"><strong class="calibre2"><em class="calibre3">Naming and Using Variables</em></strong></h4>
<p class="noindent">When you’re using variables in Python, you need to adhere to a few rules and guidelines. Breaking some of these rules will cause errors; other guidelines just help you write code that’s easier to read and understand. Be sure to keep the following variable rules in mind:</p>
<ul class="calibre8">
<li class="noindent1">Variable names can contain only letters, numbers, and underscores. They can start with a letter or an underscore, but not with a number. For instance, you can call a variable <em class="calibre3">message_1</em> but not <em class="calibre3">1_message</em>.</li>
<li class="noindent1">Spaces are not allowed in variable names, but underscores can be used to separate words in variable names. For example, <em class="calibre3">greeting_message</em> works, but <em class="calibre3">greeting message</em> will cause errors.</li>
<li class="noindent1">Avoid using Python keywords and function names as variable names; that is, do not use words that Python has reserved for a particular programmatic purpose, such as the word <span class="literal">print</span>. (See “<a href="#calibre_link-63" class="calibre6">Python Keywords and Built-in Functions</a>” on <a href="#calibre_link-64" class="calibre6">page 471</a>.)</li>
<li class="noindent1">Variable names should be short but descriptive. For example, <em class="calibre3">name</em> is better than <em class="calibre3">n</em>, <em class="calibre3">student_name</em> is better than <em class="calibre3">s_n</em>, and <em class="calibre3">name_length</em> is better than <em class="calibre3">length_of_persons_name</em>.</li>
<li class="noindent1">Be careful when using the lowercase letter <em class="calibre3">l</em> and the uppercase letter <em class="calibre3">O</em> because they could be confused with the numbers <em class="calibre3">1</em> and <em class="calibre3">0</em>.</li>
</ul>
<p class="indent">It can take some practice to learn how to create good variable names, especially as your programs become more interesting and complicated. As you write more programs and start to read through other people’s code, you’ll get better at coming up with meaningful names.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The Python variables you’re using at this point should be lowercase. You won’t get errors if you use uppercase letters, but uppercase letters in variable names have special meanings that we’ll discuss in later chapters.</em></p>
</div>
<h4 class="h3" id="calibre_link-596"><strong class="calibre2"><em class="calibre3">Avoiding Name Errors When Using Variables</em></strong></h4>
<p class="noindent">Every programmer makes mistakes, and most make mistakes every day. Although good programmers might create errors, they also know how to respond to those errors efficiently. Let’s look at an error you’re likely to make early on and learn how to fix it.</p>
<p class="indent">We’ll write some code that generates an error on purpose. Enter the following code, including the misspelled word <em class="calibre3">mesage</em> shown in bold:</p>
<p class="programs">message = "Hello Python Crash Course reader!"<br class="calibre4" />
print(<span class="codestrong">mesage</span>)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-560" class="calibre"></span>When an error occurs in your program, the Python interpreter does its best to help you figure out where the problem is. The interpreter provides a traceback when a program cannot run successfully. A <em class="calibre3">traceback</em> is a record of where the interpreter ran into trouble when trying to execute your code. Here’s an example of the traceback that Python provides after you’ve accidentally misspelled a variable’s name:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;Traceback (most recent call last):<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;File "hello_world.py", line 2, in &lt;module&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(mesage)<br class="calibre4" />
<span class="ent">➌</span> NameError: name 'mesage' is not defined</p>
<p class="indent">The output at <span class="ent">➊</span> reports that an error occurs in line 2 of the file <em class="calibre3">hello_world.py</em>. The interpreter shows this line <span class="ent">➋</span> to help us spot the error quickly and tells us what kind of error it found <span class="ent">➌</span>. In this case it found a <em class="calibre3">name error</em> and reports that the variable being printed, <span class="literal">mesage</span>, has not been defined. Python can’t identify the variable name provided. A name error usually means we either forgot to set a variable’s value before using it, or we made a spelling mistake when entering the variable’s name.</p>
<p class="indent">Of course, in this example we omitted the letter <em class="calibre3">s</em> in the variable name <span class="literal">message</span> in the second line. The Python interpreter doesn’t spellcheck your code, but it does ensure that variable names are spelled consistently. For example, watch what happens when we spell <em class="calibre3">message</em> incorrectly in another place in the code as well:</p>
<p class="programs">mesage = "Hello Python Crash Course reader!"<br class="calibre4" />
<span class="ash">print(mesage)</span></p>
<p class="indent">In this case, the program runs successfully!</p>
<p class="programs">Hello Python Crash Course reader!</p>
<p class="indent">Programming languages are strict, but they disregard good and bad spelling. As a result, you don’t need to consider English spelling and grammar rules when you’re trying to create variable names and writing code.</p>
<p class="indent">Many programming errors are simple, single-character typos in one line of a program. If you’re spending a long time searching for one of these errors, know that you’re in good company. Many experienced and talented programmers spend hours hunting down these kinds of tiny errors. Try to laugh about it and move on, knowing it will happen frequently throughout your programming life.</p>
<h4 class="h3" id="calibre_link-597"><strong class="calibre2"><em class="calibre3">Variables Are Labels</em></strong></h4>
<p class="noindent">Variables are often described as boxes you can store values in. This idea can be helpful the first few times you use a variable, but it isn’t an accurate way to describe how variables are represented internally in Python. It’s much better to think of variables as labels that you can assign to values. You can also say that a variable references a certain value.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-429" class="calibre"></span>This distinction probably won’t matter much in your initial programs, but it’s worth learning earlier rather than later. At some point, you’ll see unexpected behavior from a variable, and an accurate understanding of how variables work will help you identify what’s happening in your code.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The best way to understand new programming concepts is to try using them in your programs. If you get stuck while working on an exercise in this book, try doing something else for a while. If you’re still stuck, review the relevant part of that chapter. If you still need help, see the suggestions in <a href="#calibre_link-6" class="calibre6">Appendix C</a>.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="spara">Write a separate program to accomplish each of these exercises. Save each program with a filename that follows standard Python conventions, using lowercase letters and underscores, such as <em class="calibre3">simple_message.py</em> and <em class="calibre3">simple_messages.py</em>.</p>
<p class="sparal" id="calibre_link-598"><strong class="calibre2">2-1. Simple Message:</strong> Assign a message to a variable, and then print that message.</p>
<p class="sparal" id="calibre_link-599"><strong class="calibre2">2-2. Simple Messages:</strong> Assign a message to a variable, and print that message. Then change the value of the variable to a new message, and print the new message.</p>
</div>
<h3 class="h2" id="calibre_link-600"><strong class="calibre2">Strings</strong></h3>
<p class="noindent">Because most programs define and gather some sort of data, and then do something useful with it, it helps to classify different types of data. The first data type we’ll look at is the string. Strings are quite simple at first glance, but you can use them in many different ways.</p>
<p class="indent">A <em class="calibre3">string</em> is a series of characters. Anything inside quotes is considered a string in Python, and you can use single or double quotes around your strings like this:</p>
<p class="programs">"This is a string."<br class="calibre4" />
'This is also a string.'</p>
<p class="indent">This flexibility allows you to use quotes and apostrophes within your strings:</p>
<p class="programs">'I told my friend, "Python is my favorite language!"'<br class="calibre4" />
"The language 'Python' is named after Monty Python, not the snake."<br class="calibre4" />
"One of Python's strengths is its diverse and supportive community."</p>
<p class="indent">Let’s explore some of the ways you can use strings.</p>
<h4 class="h3" id="calibre_link-601"><span type="pagebreak" id="calibre_link-499" class="calibre"></span><strong class="calibre2"><em class="calibre3">Changing Case in a String with Methods</em></strong></h4>
<p class="noindent">One of the simplest tasks you can do with strings is change the case of the words in a string. Look at the following code, and try to determine what’s happening:</p>
<p class="margin"><em class="calibre3">name.py</em></p>
<p class="programs">name = "ada lovelace"<br class="calibre4" />
print(name.title())</p>
<p class="indent">Save this file as <em class="calibre3">name.py</em>, and then run it. You should see this output:</p>
<p class="programs">Ada Lovelace</p>
<p class="indent">In this example, the variable <span class="literal">name</span> refers to the lowercase string <span class="literal">"ada lovelace"</span>. The method <span class="literal">title()</span> appears after the variable in the <span class="literal">print()</span> call. A <em class="calibre3">method</em> is an action that Python can perform on a piece of data. The dot (<span class="literal">.</span>) after <span class="literal">name</span> in <span class="literal">name.title()</span> tells Python to make the <span class="literal">title()</span> method act on the variable <span class="literal">name</span>. Every method is followed by a set of parentheses, because methods often need additional information to do their work. That information is provided inside the parentheses. The <span class="literal">title()</span> function doesn’t need any additional information, so its parentheses are empty.</p>
<p class="indent">The <span class="literal">title()</span> method changes each word to title case, where each word begins with a capital letter. This is useful because you’ll often want to think of a name as a piece of information. For example, you might want your program to recognize the input values <span class="literal">Ada</span>, <span class="literal">ADA</span>, and <span class="literal">ada</span> as the same name, and display all of them as <span class="literal">Ada</span>.</p>
<p class="indent">Several other useful methods are available for dealing with case as well. For example, you can change a string to all uppercase or all lowercase letters like this:</p>
<p class="programs">name = "Ada Lovelace"<br class="calibre4" />
print(name.upper())<br class="calibre4" />
print(name.lower())</p>
<p class="indent">This will display the following:</p>
<p class="programs">ADA LOVELACE<br class="calibre4" />
ada lovelace</p>
<p class="indent">The <span class="literal">lower()</span> method is particularly useful for storing data. Many times you won’t want to trust the capitalization that your users provide, so you’ll convert strings to lowercase before storing them. Then when you want to display the information, you’ll use the case that makes the most sense for each string.</p>
<h4 class="h3" id="calibre_link-602"><span type="pagebreak" id="calibre_link-391" class="calibre"></span><strong class="calibre2"><em class="calibre3">Using Variables in Strings</em></strong></h4>
<p class="noindent">In some situations, you’ll want to use a variable’s value inside a string. For example, you might want two variables to represent a first name and a last name respectively, and then want to combine those values to display someone’s full name:</p>
<p class="margin"><em class="calibre3">full_name.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;first_name = "ada"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;last_name = "lovelace"<br class="calibre4" />
<span class="ent">➊</span> full_name = f"{first_name} {last_name}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(full_name)</p>
<p class="indent">To insert a variable’s value into a string, place the letter <span class="literal">f</span> immediately before the opening quotation mark <span class="ent">➊</span>. Put braces around the name or names of any variable you want to use inside the string. Python will replace each variable with its value when the string is displayed.</p>
<p class="indent">These strings are called <em class="calibre3">f-strings</em>. The <em class="calibre3">f</em> is for <em class="calibre3">format</em>, because Python formats the string by replacing the name of any variable in braces with its value. The output from the previous code is:</p>
<p class="programs">ada lovelace</p>
<p class="indent">You can do a lot with f-strings. For example, you can use f-strings to compose complete messages using the information associated with a variable, as shown here:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">first_name = "ada"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">last_name = "lovelace"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">full_name = f"{first_name} {last_name}"</span><br class="calibre4" />
<span class="ent">➊</span> print(f"Hello, {full_name.title()}!")</p>
<p class="indent">The full name is used in a sentence that greets the user <span class="ent">➊</span>, and the <span class="literal">title()</span> method changes the name to title case. This code returns a simple but nicely formatted greeting:</p>
<p class="programs">Hello, Ada Lovelace!</p>
<p class="indent">You can also use f-strings to compose a message, and then assign the entire message to a variable:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">first_name = "ada"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">last_name = "lovelace"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">full_name = f"{first_name} {last_name}"</span><br class="calibre4" />
<span class="ent">➊</span> message = f"Hello, {full_name.title()}!"<br class="calibre4" />
<span class="ent">➋</span> print(message)</p>
<p class="indent">This code displays the message <span class="literal">Hello, Ada Lovelace!</span> as well, but by assigning the message to a variable <span class="ent">➊</span> we make the final <span class="literal">print()</span> call much simpler <span class="ent">➋</span>.</p>
<div class="note">
<p class="notet"><span type="pagebreak" id="calibre_link-181" class="calibre"></span><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">F-strings were first introduced in Python 3.6. If you’re using Python 3.5 or earlier, you’ll need to use the <span class="codeitalic">format()</span> method rather than this <span class="codeitalic">f</span> syntax. To use <span class="codeitalic">format()</span>, list the variables you want to use in the string inside the parentheses following <span class="codeitalic">format</span>. Each variable is referred to by a set of braces; the braces will be filled by the values listed in parentheses in the order provided:</em></p>
<p class="programs">full_name = "{} {}".format(first_name, last_name)</p>
</div>
<h4 class="h3" id="calibre_link-603"><strong class="calibre2"><em class="calibre3">Adding Whitespace to Strings with Tabs or Newlines</em></strong></h4>
<p class="noindent">In programming, <em class="calibre3">whitespace</em> refers to any nonprinting character, such as spaces, tabs, and end-of-line symbols. You can use whitespace to organize your output so it’s easier for users to read.</p>
<p class="indent">To add a tab to your text, use the character combination <span class="literal">\t</span> as shown at <span class="ent">➊</span>:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">print("Python")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Python<br class="calibre4" />
<span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">print("\tPython")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Python</p>
<p class="indent">To add a newline in a string, use the character combination <span class="literal">\n</span>:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">print("Languages:\nPython\nC\nJavaScript")</span><br class="calibre4" />
Languages:<br class="calibre4" />
Python<br class="calibre4" />
C<br class="calibre4" />
JavaScript</p>
<p class="indent">You can also combine tabs and newlines in a single string. The string <span class="literal">"\n\t"</span> tells Python to move to a new line, and start the next line with a tab. The following example shows how you can use a one-line string to generate four lines of output:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">print("Languages:\n\tPython\n\tC\n\tJavaScript")</span><br class="calibre4" />
Languages:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Python<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;C<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;JavaScript</p>
<p class="indent">Newlines and tabs will be very useful in the next two chapters when you start to produce many lines of output from just a few lines of code.</p>
<h4 class="h3" id="calibre_link-604"><strong class="calibre2"><em class="calibre3">Stripping Whitespace</em></strong></h4>
<p class="noindent">Extra whitespace can be confusing in your programs. To programmers <span class="literal">'python'</span> and <span class="literal">'python '</span> look pretty much the same. But to a program, they are two different strings. Python detects the extra space in <span class="literal">'python '</span> and considers it significant unless you tell it otherwise.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1303" class="calibre"></span>It’s important to think about whitespace, because often you’ll want to compare two strings to determine whether they are the same. For example, one important instance might involve checking people’s usernames when they log in to a website. Extra whitespace can be confusing in much simpler situations as well. Fortunately, Python makes it easy to eliminate extraneous whitespace from data that people enter.</p>
<p class="indent">Python can look for extra whitespace on the right and left sides of a string. To ensure that no whitespace exists at the right end of a string, use the <span class="literal">rstrip()</span> method.</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">favorite_language = 'python '</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">favorite_language</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;'python '<br class="calibre4" />
<span class="ent">➌</span> &gt;&gt;&gt; <span class="codestrong">favorite_language.rstrip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;'python'<br class="calibre4" />
<span class="ent">➍</span> &gt;&gt;&gt; <span class="codestrong">favorite_language</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;'python '</p>
<p class="indent">The value associated with <span class="literal">favorite_language</span> at <span class="ent">➊</span> contains extra whitespace at the end of the string. When you ask Python for this value in a terminal session, you can see the space at the end of the value <span class="ent">➋</span>. When the <span class="literal">rstrip()</span> method acts on the variable <span class="literal">favorite_language</span> at <span class="ent">➌</span>, this extra space is removed. However, it is only removed temporarily. If you ask for the value of <span class="literal">favorite_language</span> again, you can see that the string looks the same as when it was entered, including the extra whitespace <span class="ent">➍</span>.</p>
<p class="indent">To remove the whitespace from the string permanently, you have to associate the stripped value with the variable name:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">favorite_language = 'python '</span><br class="calibre4" />
<span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">favorite_language = favorite_language.rstrip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">favorite_language</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;'python'</p>
<p class="indent">To remove the whitespace from the string, you strip the whitespace from the right side of the string and then associate this new value with the original variable, as shown at <span class="ent">➊</span>. Changing a variable’s value is done often in programming. This is how a variable’s value can be updated as a program is executed or in response to user input.</p>
<p class="indent">You can also strip whitespace from the left side of a string using the <span class="literal">lstrip()</span> method, or from both sides at once using <span class="literal">strip()</span>:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">favorite_language = ' python '</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">favorite_language.rstrip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;' python'<br class="calibre4" />
<span class="ent">➌</span> &gt;&gt;&gt; <span class="codestrong">favorite_language.lstrip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;'python '<br class="calibre4" />
<span class="ent">➍</span> &gt;&gt;&gt; <span class="codestrong">favorite_language.strip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;'python'</p>
<p class="indent"><span type="pagebreak" id="calibre_link-241" class="calibre"></span>In this example, we start with a value that has whitespace at the beginning and the end <span class="ent">➊</span>. We then remove the extra space from the right side at <span class="ent">➋</span>, from the left side at <span class="ent">➌</span>, and from both sides at <span class="ent">➍</span>. Experimenting with these stripping functions can help you become familiar with manipulating strings. In the real world, these stripping functions are used most often to clean up user input before it’s stored in a program.</p>
<h4 class="h3" id="calibre_link-605"><strong class="calibre2"><em class="calibre3">Avoiding Syntax Errors with Strings</em></strong></h4>
<p class="noindent">One kind of error that you might see with some regularity is a syntax error. A <em class="calibre3">syntax error</em> occurs when Python doesn’t recognize a section of your program as valid Python code. For example, if you use an apostrophe within single quotes, you’ll produce an error. This happens because Python interprets everything between the first single quote and the apostrophe as a string. It then tries to interpret the rest of the text as Python code, which causes errors.</p>
<p class="indent">Here’s how to use single and double quotes correctly. Save this program as <em class="calibre3">apostrophe.py</em> and then run it:</p>
<p class="margin"><em class="calibre3">apostrophe.py</em></p>
<p class="programs">message = "One of Python's strengths is its diverse community."<br class="calibre4" />
print(message)</p>
<p class="indent">The apostrophe appears inside a set of double quotes, so the Python interpreter has no trouble reading the string correctly:</p>
<p class="programs">One of Python's strengths is its diverse community.</p>
<p class="indent">However, if you use single quotes, Python can’t identify where the string should end:</p>
<p class="programs">message = 'One of Python's strengths is its diverse community.'<br class="calibre4" />
<span class="ash">print(message)</span></p>
<p class="indent">You’ll see the following output:</p>
<p class="programs">&nbsp;&nbsp;File "apostrophe.py", line 1<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;message = 'One of Python's strengths is its diverse community.'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<span class="ent">➊</span><br class="calibre4" />
SyntaxError: invalid syntax</p>
<p class="indent">In the output you can see that the error occurs at <span class="ent">➊</span> right after the second single quote. This syntax error indicates that the interpreter doesn’t recognize something in the code as valid Python code. Errors can come from a variety of sources, and I’ll point out some common ones as they arise. You might see syntax errors often as you learn to write proper Python code. Syntax errors are also the least specific kind of error, so they can be difficult and frustrating to identify and correct. If you get stuck on a particularly stubborn error, see the suggestions in <a href="#calibre_link-6" class="calibre6">Appendix C</a>.</p>
<div class="note">
<p class="notet"><span type="pagebreak" id="calibre_link-513" class="calibre"></span><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Your editor’s syntax highlighting feature should help you spot some syntax errors quickly as you write your programs. If you see Python code highlighted as if it’s English or English highlighted as if it’s Python code, you probably have a mismatched quotation mark somewhere in your file.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="spara">Save each of the following exercises as a separate file with a name like <em class="calibre3">name_cases.py</em>. If you get stuck, take a break or see the suggestions in <a href="#calibre_link-6" class="calibre6">Appendix C</a>.</p>
<p class="sparal" id="calibre_link-606"><strong class="calibre2">2-3. Personal Message:</strong> Use a variable to represent a person’s name, and print a message to that person. Your message should be simple, such as, “Hello Eric, would you like to learn some Python today?”</p>
<p class="sparal" id="calibre_link-607"><strong class="calibre2">2-4. Name Cases:</strong> Use a variable to represent a person’s name, and then print that person’s name in lowercase, uppercase, and title case.</p>
<p class="sparal" id="calibre_link-65"><strong class="calibre2">2-5. Famous Quote:</strong> Find a quote from a famous person you admire. Print the quote and the name of its author. Your output should look something like the following, including the quotation marks:</p>
<p class="quote"><em class="calibre3">Albert Einstein once said, “A person who never made a mistake never tried anything new.”</em></p>
<p class="sparal" id="calibre_link-608"><strong class="calibre2">2-6. Famous Quote 2:</strong> Repeat <a href="#calibre_link-65" class="calibre6">Exercise 2-5</a>, but this time, represent the famous person’s name using a variable called <span class="literal1">famous_person</span>. Then compose your message and represent it with a new variable called <span class="literal1">message</span>. Print your message.</p>
<p class="sparal" id="calibre_link-609"><strong class="calibre2">2-7. Stripping Names:</strong> Use a variable to represent a person’s name, and include some whitespace characters at the beginning and end of the name. Make sure you use each character combination, <span class="literal1">"\t"</span> and <span class="literal1">"\n"</span>, at least once.</p>
<p class="sparai">Print the name once, so the whitespace around the name is displayed. Then print the name using each of the three stripping functions, <span class="literal1">lstrip()</span>, <span class="literal1">rstrip()</span>, and <span class="literal1">strip()</span>.</p>
</div>
<h3 class="h2" id="calibre_link-610"><strong class="calibre2">Numbers</strong></h3>
<p class="noindent">Numbers are used quite often in programming to keep score in games, represent data in visualizations, store information in web applications, and so on. Python treats numbers in several different ways, depending on how they’re being used. Let’s first look at how Python manages integers, because they’re the simplest to work with.</p>
<h4 class="h3" id="calibre_link-611"><span type="pagebreak" id="calibre_link-168" class="calibre"></span><strong class="calibre2"><em class="calibre3">Integers</em></strong></h4>
<p class="noindent">You can add (<span class="literal">+</span>), subtract (<span class="literal">-</span>), multiply (<span class="literal">*</span>), and divide (<span class="literal">/</span>) integers in Python.</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">2 + 3</span><br class="calibre4" />
5<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">3 - 2</span><br class="calibre4" />
1<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">2 * 3</span><br class="calibre4" />
6<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">3 / 2</span><br class="calibre4" />
1.5</p>
<p class="indent">In a terminal session, Python simply returns the result of the operation. Python uses two multiplication symbols to represent exponents:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">3 ** 2</span><br class="calibre4" />
9<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">3 ** 3</span><br class="calibre4" />
27<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">10 ** 6</span><br class="calibre4" />
1000000</p>
<p class="indent">Python supports the order of operations too, so you can use multiple operations in one expression. You can also use parentheses to modify the order of operations so Python can evaluate your expression in the order you specify. For example:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">2 + 3*4</span><br class="calibre4" />
14<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">(2 + 3) * 4</span><br class="calibre4" />
20</p>
<p class="indent">The spacing in these examples has no effect on how Python evaluates the expressions; it simply helps you more quickly spot the operations that have priority when you’re reading through the code.</p>
<h4 class="h3" id="calibre_link-612"><strong class="calibre2"><em class="calibre3">Floats</em></strong></h4>
<p class="noindent">Python calls any number with a decimal point a <em class="calibre3">float</em>. This term is used in most programming languages, and it refers to the fact that a decimal point can appear at any position in a number. Every programming language must be carefully designed to properly manage decimal numbers so numbers behave appropriately no matter where the decimal point appears.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-514" class="calibre"></span>For the most part, you can use decimals without worrying about how they behave. Simply enter the numbers you want to use, and Python will most likely do what you expect:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">0.1 + 0.1</span><br class="calibre4" />
0.2<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">0.2 + 0.2</span><br class="calibre4" />
0.4<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">2 * 0.1</span><br class="calibre4" />
0.2<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">2 * 0.2</span><br class="calibre4" />
0.4</p>
<p class="indent">But be aware that you can sometimes get an arbitrary number of decimal places in your answer:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">0.2 + 0.1</span><br class="calibre4" />
0.30000000000000004<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">3 * 0.1</span><br class="calibre4" />
0.30000000000000004</p>
<p class="indent">This happens in all languages and is of little concern. Python tries to find a way to represent the result as precisely as possible, which is sometimes difficult given how computers have to represent numbers internally. Just ignore the extra decimal places for now; you’ll learn ways to deal with the extra places when you need to in the projects in <a href="#calibre_link-10" class="calibre6">Part II</a>.</p>
<h4 class="h3" id="calibre_link-613"><strong class="calibre2"><em class="calibre3">Integers and Floats</em></strong></h4>
<p class="noindent">When you divide any two numbers, even if they are integers that result in a whole number, you’ll always get a float:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">4/2</span><br class="calibre4" />
2.0</p>
<p class="indent">If you mix an integer and a float in any other operation, you’ll get a float as well:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">1 + 2.0</span><br class="calibre4" />
3.0<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">2 * 3.0</span><br class="calibre4" />
6.0<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">3.0 ** 2</span><br class="calibre4" />
9.0</p>
<p class="indent">Python defaults to a float in any operation that uses a float, even if the output is a whole number.</p>
<h4 class="h3" id="calibre_link-614"><span type="pagebreak" id="calibre_link-279" class="calibre"></span><strong class="calibre2"><em class="calibre3">Underscores in Numbers</em></strong></h4>
<p class="noindent">When you’re writing long numbers, you can group digits using underscores to make large numbers more readable:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">universe_age = 14_000_000_000</span></p>
<p class="indent">When you print a number that was defined using underscores, Python prints only the digits:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">print(universe_age)</span><br class="calibre4" />
14000000000</p>
<p class="indent">Python ignores the underscores when storing these kinds of values. Even if you don’t group the digits in threes, the value will still be unaffected. To Python, <span class="literal">1000</span> is the same as <span class="literal">1_000</span>, which is the same as <span class="literal">10_00</span>. This feature works for integers and floats, but it’s only available in Python 3.6 and later.</p>
<h4 class="h3" id="calibre_link-615"><strong class="calibre2"><em class="calibre3">Multiple Assignment</em></strong></h4>
<p class="noindent">You can assign values to more than one variable using just a single line. This can help shorten your programs and make them easier to read; you’ll use this technique most often when initializing a set of numbers.</p>
<p class="indent">For example, here’s how you can initialize the variables <span class="literal">x</span>, <span class="literal">y</span>, and <span class="literal">z</span> to zero:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">x, y, z = 0, 0, 0</span></p>
<p class="indent">You need to separate the variable names with commas, and do the same with the values, and Python will assign each value to its respectively positioned variable. As long as the number of values matches the number of variables, Python will match them up correctly.</p>
<h4 class="h3" id="calibre_link-616"><strong class="calibre2"><em class="calibre3">Constants</em></strong></h4>
<p class="noindent">A <em class="calibre3">constant</em> is like a variable whose value stays the same throughout the life of a program. Python doesn’t have built-in constant types, but Python programmers use all capital letters to indicate a variable should be treated as a constant and never be changed:</p>
<p class="programs">MAX_CONNECTIONS = 5000</p>
<p class="indent">When you want to treat a variable as a constant in your code, make the name of the variable all capital letters.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-176" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-617"><strong class="calibre2">2-8. Number Eight:</strong> Write addition, subtraction, multiplication, and division operations that each result in the number 8. Be sure to enclose your operations in <span class="literal1">print()</span> calls to see the results. You should create four lines that look like this:</p>
<p class="programs">print(5+3)</p>
<p class="sparai">Your output should simply be four lines with the number 8 appearing once on each line.</p>
<p class="sparal" id="calibre_link-618"><strong class="calibre2">2-9. Favorite Number:</strong> Use a variable to represent your favorite number. Then, using that variable, create a message that reveals your favorite number. Print that message.</p>
</div>
<h3 class="h2" id="calibre_link-619"><strong class="calibre2">Comments</strong></h3>
<p class="noindent">Comments are an extremely useful feature in most programming languages. Everything you’ve written in your programs so far is Python code. As your programs become longer and more complicated, you should add notes within your programs that describe your overall approach to the problem you’re solving. A <em class="calibre3">comment</em> allows you to write notes in English within your programs.</p>
<h4 class="h3" id="calibre_link-620"><strong class="calibre2"><em class="calibre3">How Do You Write Comments?</em></strong></h4>
<p class="noindent">In Python, the hash mark (<span class="literal">#</span>) indicates a comment. Anything following a hash mark in your code is ignored by the Python interpreter. For example:</p>
<p class="margin"><em class="calibre3">comment.py</em></p>
<p class="programs"># Say hello to everyone.<br class="calibre4" />
print("Hello Python people!")</p>
<p class="indent">Python ignores the first line and executes the second line.</p>
<p class="programs">Hello Python people!</p>
<h4 class="h3" id="calibre_link-621"><strong class="calibre2"><em class="calibre3">What Kind of Comments Should You Write?</em></strong></h4>
<p class="noindent">The main reason to write comments is to explain what your code is supposed to do and how you are making it work. When you’re in the middle of working on a project, you understand how all of the pieces fit together. But when you return to a project after some time away, you’ll likely have forgotten <span type="pagebreak" id="calibre_link-277" class="calibre"></span>some of the details. You can always study your code for a while and figure out how segments were supposed to work, but writing good comments can save you time by summarizing your overall approach in clear English.</p>
<p class="indent">If you want to become a professional programmer or collaborate with other programmers, you should write meaningful comments. Today, most software is written collaboratively, whether by a group of employees at one company or a group of people working together on an open source project. Skilled programmers expect to see comments in code, so it’s best to start adding descriptive comments to your programs now. Writing clear, concise comments in your code is one of the most beneficial habits you can form as a new programmer.</p>
<p class="indent">When you’re determining whether to write a comment, ask yourself if you had to consider several approaches before coming up with a reasonable way to make something work; if so, write a comment about your solution. It’s much easier to delete extra comments later on than it is to go back and write comments for a sparsely commented program. From now on, I’ll use comments in examples throughout this book to help explain sections of code.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-622"><strong class="calibre2">2-10. Adding Comments:</strong> Choose two of the programs you’ve written, and add at least one comment to each. If you don’t have anything specific to write because your programs are too simple at this point, just add your name and the current date at the top of each program file. Then write one sentence describing what the program does.</p>
</div>
<h3 class="h2" id="calibre_link-623"><strong class="calibre2">The Zen of Python</strong></h3>
<p class="noindent">Experienced Python programmers will encourage you to avoid complexity and aim for simplicity whenever possible. The Python community’s philosophy is contained in “The Zen of Python” by Tim Peters. You can access this brief set of principles for writing good Python code by entering <span class="literal">import this</span> into your interpreter. I won’t reproduce the entire “Zen of Python” here, but I’ll share a few lines to help you understand why they should be important to you as a beginning Python programmer.</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">import this</span><br class="calibre4" />
The Zen of Python, by Tim Peters<br class="calibre4" />
Beautiful is better than ugly.</p>
<p class="indent">Python programmers embrace the notion that code can be beautiful and elegant. In programming, people solve problems. Programmers have always respected well-designed, efficient, and even beautiful solutions to <span type="pagebreak" id="calibre_link-536" class="calibre"></span>problems. As you learn more about Python and use it to write more code, someone might look over your shoulder one day and say, “Wow, that’s some beautiful code!”</p>
<p class="programs">Simple is better than complex.</p>
<p class="indent">If you have a choice between a simple and a complex solution, and both work, use the simple solution. Your code will be easier to maintain, and it will be easier for you and others to build on that code later on.</p>
<p class="programs">Complex is better than complicated.</p>
<p class="indent">Real life is messy, and sometimes a simple solution to a problem is unattainable. In that case, use the simplest solution that works.</p>
<p class="programs">Readability counts.</p>
<p class="indent">Even when your code is complex, aim to make it readable. When you’re working on a project that involves complex coding, focus on writing informative comments for that code.</p>
<p class="programs">There should be one-- and preferably only one --obvious way to do it.</p>
<p class="indent">If two Python programmers are asked to solve the same problem, they should come up with fairly compatible solutions. This is not to say there’s no room for creativity in programming. On the contrary! But much of programming consists of using small, common approaches to simple situations within a larger, more creative project. The nuts and bolts of your programs should make sense to other Python programmers.</p>
<p class="programs">Now is better than never.</p>
<p class="indent">You could spend the rest of your life learning all the intricacies of Python and of programming in general, but then you’d never complete any projects. Don’t try to write perfect code; write code that works, and then decide whether to improve your code for that project or move on to something new.</p>
<p class="indent">As you continue to the next chapter and start digging into more involved topics, try to keep this philosophy of simplicity and clarity in mind. Experienced programmers will respect your code more and will be happy to give you feedback and collaborate with you on interesting projects.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-624"><strong class="calibre2">2-11. Zen of Python:</strong> Enter <span class="codestrong2">import this</span> into a Python terminal session and skim through the additional principles.</p>
</div>
<h3 class="h2" id="calibre_link-625"><span type="pagebreak" id="calibre_link-1304" class="calibre"></span><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned to work with variables. You learned to use descriptive variable names and how to resolve name errors and syntax errors when they arise. You learned what strings are and how to display strings using lowercase, uppercase, and title case. You started using whitespace to organize output neatly, and you learned to strip unneeded whitespace from different parts of a string. You started working with integers and floats, and learned some of the ways you can work with numerical data. You also learned to write explanatory comments to make your code easier for you and others to read. Finally, you read about the philosophy of keeping your code as simple as possible, whenever possible.</p>
<p class="indent">In <a href="#calibre_link-56" class="calibre6">Chapter 3</a> you’ll learn to store collections of information in data structures called <em class="calibre3">lists</em>. You’ll learn to work through a list, manipulating any information in that list.</p>
</div>


<div class="calibre1" id="calibre_link-160">
<h2 class="h" id="calibre_link-56"><span type="pagebreak" id="calibre_link-468" class="calibre"></span><strong class="calibre2"><span class="big">3</span><br class="calibre4" />INTRODUCING LISTS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter and the next you’ll learn what lists are and how to start working with the elements in a list. Lists allow you to store sets of information in one place, whether you have just a few items or millions of items. Lists are one of Python’s most powerful features readily accessible to new programmers, and they tie together many important concepts in programming.</p>
<h3 class="h2" id="calibre_link-626"><strong class="calibre2">What Is a List?</strong></h3>
<p class="noindent">A <em class="calibre3">list</em> is a collection of items in a particular order. You can make a list that includes the letters of the alphabet, the digits from 0&ndash;9, or the names of all the people in your family. You can put anything you want into a list, and <span type="pagebreak" id="calibre_link-183" class="calibre"></span>the items in your list don’t have to be related in any particular way. Because a list usually contains more than one element, it’s a good idea to make the name of your list plural, such as <span class="literal">letters</span>, <span class="literal">digits</span>, or <span class="literal">names</span>.</p>
<p class="indent">In Python, square brackets (<span class="literal">[]</span>) indicate a list, and individual elements in the list are separated by commas. Here’s a simple example of a list that contains a few kinds of bicycles:</p>
<p class="margin"><em class="calibre3">bicycles.py</em></p>
<p class="programs">bicycles = ['trek', 'cannondale', 'redline', 'specialized']<br class="calibre4" />
print(bicycles)</p>
<p class="indent">If you ask Python to print a list, Python returns its representation of the list, including the square brackets:</p>
<p class="programs">['trek', 'cannondale', 'redline', 'specialized']</p>
<p class="indent">Because this isn’t the output you want your users to see, let’s learn how to access the individual items in a list.</p>
<h4 class="h3" id="calibre_link-627"><strong class="calibre2"><em class="calibre3">Accessing Elements in a List</em></strong></h4>
<p class="noindent">Lists are ordered collections, so you can access any element in a list by telling Python the position, or <em class="calibre3">index</em>, of the item desired. To access an element in a list, write the name of the list followed by the index of the item enclosed in square brackets.</p>
<p class="indent">For example, let’s pull out the first bicycle in the list <span class="literal">bicycles</span>:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">bicycles = ['trek', 'cannondale', 'redline', 'specialized']</span><br class="calibre4" />
<span class="ent">➊</span> print(bicycles[0])</p>
<p class="indent">The syntax for this is shown at <span class="ent">➊</span>. When we ask for a single item from a list, Python returns just that element without square brackets:</p>
<p class="programs">trek</p>
<p class="indent">This is the result you want your users to see&mdash;clean, neatly formatted output.</p>
<p class="indent">You can also use the string methods from <a href="#calibre_link-7" class="calibre6">Chapter 2</a> on any element in this list. For example, you can format the element <span class="literal">'trek'</span> more neatly by using the <span class="literal">title()</span> method:</p>
<p class="programs"><span class="ash">bicycles = ['trek', 'cannondale', 'redline', 'specialized']</span><br class="calibre4" />
print(bicycles[0].title())</p>
<p class="indent">This example produces the same output as the preceding example except <span class="literal">'Trek'</span> is capitalized.</p>
<h4 class="h3" id="calibre_link-628"><span type="pagebreak" id="calibre_link-469" class="calibre"></span><strong class="calibre2"><em class="calibre3">Index Positions Start at 0, Not 1</em></strong></h4>
<p class="noindent">Python considers the first item in a list to be at position 0, not position 1. This is true of most programming languages, and the reason has to do with how the list operations are implemented at a lower level. If you’re receiving unexpected results, determine whether you are making a simple off-by-one error.</p>
<p class="indent">The second item in a list has an index of 1. Using this counting system, you can get any element you want from a list by subtracting one from its position in the list. For instance, to access the fourth item in a list, you request the item at index 3.</p>
<p class="indent">The following asks for the bicycles at index <span class="literal">1</span> and index <span class="literal">3</span>:</p>
<p class="programs"><span class="ash">bicycles = ['trek', 'cannondale', 'redline', 'specialized']</span><br class="calibre4" />
print(bicycles[1])<br class="calibre4" />
print(bicycles[3])</p>
<p class="indent">This code returns the second and fourth bicycles in the list:</p>
<p class="programs">cannondale<br class="calibre4" />
specialized</p>
<p class="indent">Python has a special syntax for accessing the last element in a list. By asking for the item at index <span class="literal">-1</span>, Python always returns the last item in the list:</p>
<p class="programs"><span class="ash">bicycles = ['trek', 'cannondale', 'redline', 'specialized']</span><br class="calibre4" />
print(bicycles[-1])</p>
<p class="indent">This code returns the value <span class="literal">'specialized'</span>. This syntax is quite useful, because you’ll often want to access the last items in a list without knowing exactly how long the list is. This convention extends to other negative index values as well. The index -<span class="literal">2</span> returns the second item from the end of the list, the index -<span class="literal">3</span> returns the third item from the end, and so forth.</p>
<h4 class="h3" id="calibre_link-629"><strong class="calibre2"><em class="calibre3">Using Individual Values from a List</em></strong></h4>
<p class="noindent">You can use individual values from a list just as you would any other variable. For example, you can use f-strings to create a message based on a value from a list.</p>
<p class="indent">Let’s try pulling the first bicycle from the list and composing a message using that value.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">bicycles = ['trek', 'cannondale', 'redline', 'specialized']</span><br class="calibre4" />
<span class="ent">➊</span> message = f"My first bicycle was a {bicycles[0].title()}."<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(message)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-249" class="calibre"></span>At <span class="ent">➊</span>, we build a sentence using the value at <span class="literal">bicycles[0]</span> and assign it to the variable <span class="literal">message</span>. The output is a simple sentence about the first bicycle in the list:</p>
<p class="programs">My first bicycle was a Trek.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="spara">Try these short programs to get some firsthand experience with Python’s lists. You might want to create a new folder for each chapter’s exercises to keep them organized.</p>
<p class="sparal" id="calibre_link-161"><strong class="calibre2">3-1. Names:</strong> Store the names of a few of your friends in a list called <span class="literal1">names</span>. Print each person’s name by accessing each element in the list, one at a time.</p>
<p class="sparal" id="calibre_link-630"><strong class="calibre2">3-2. Greetings:</strong> Start with the list you used in <a href="#calibre_link-161" class="calibre6">Exercise 3-1</a>, but instead of just printing each person’s name, print a message to them. The text of each message should be the same, but each message should be personalized with the person’s name.</p>
<p class="sparal" id="calibre_link-631"><strong class="calibre2">3-3. Your Own List:</strong> Think of your favorite mode of transportation, such as a motorcycle or a car, and make a list that stores several examples. Use your list to print a series of statements about these items, such as “I would like to own a Honda motorcycle.”</p>
</div>
<h3 class="h2" id="calibre_link-632"><strong class="calibre2">Changing, Adding, and Removing Elements</strong></h3>
<p class="noindent">Most lists you create will be dynamic, meaning you’ll build a list and then add and remove elements from it as your program runs its course. For example, you might create a game in which a player has to shoot aliens out of the sky. You could store the initial set of aliens in a list and then remove an alien from the list each time one is shot down. Each time a new alien appears on the screen, you add it to the list. Your list of aliens will increase and decrease in length throughout the course of the game.</p>
<h4 class="h3" id="calibre_link-633"><strong class="calibre2"><em class="calibre3">Modifying Elements in a List</em></strong></h4>
<p class="noindent">The syntax for modifying an element is similar to the syntax for accessing an element in a list. To change an element, use the name of the list followed by the index of the element you want to change, and then provide the new value you want that item to have.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-242" class="calibre"></span>For example, let’s say we have a list of motorcycles, and the first item in the list is <span class="literal">'honda'</span>. How would we change the value of this first item?</p>
<p class="margin"><em class="calibre3">motorcycles.py</em></p>
<p class="programs"><span class="ent">➊</span> motorcycles = ['honda', 'yamaha', 'suzuki']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> motorcycles[0] = 'ducati'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)</p>
<p class="indent">The code at <span class="ent">➊</span> defines the original list, with <span class="literal">'honda'</span> as the first element. The code at <span class="ent">➋</span> changes the value of the first item to <span class="literal">'ducati'</span>. The output shows that the first item has indeed been changed, and the rest of the list stays the same:</p>
<p class="programs">['honda', 'yamaha', 'suzuki']<br class="calibre4" />
['ducati', 'yamaha', 'suzuki']</p>
<p class="indent">You can change the value of any item in a list, not just the first item.</p>
<h4 class="h3" id="calibre_link-634"><strong class="calibre2"><em class="calibre3">Adding Elements to a List</em></strong></h4>
<p class="noindent">You might want to add a new element to a list for many reasons. For example, you might want to make new aliens appear in a game, add new data to a visualization, or add new registered users to a website you’ve built. Python provides several ways to add new data to existing lists.</p>
<h5 class="h4" id="calibre_link-1305"><strong class="calibre2">Appending Elements to the End of a List</strong></h5>
<p class="noindent">The simplest way to add a new element to a list is to <em class="calibre3">append</em> the item to the list. When you append an item to a list, the new element is added to the end of the list. Using the same list we had in the previous example, we’ll add the new element <span class="literal">'ducati'</span> to the end of the list:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">motorcycles = ['honda', 'yamaha', 'suzuki']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(motorcycles)</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> motorcycles.append('ducati')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)</p>
<p class="indent">The <span class="literal">append()</span> method at <span class="ent">➊</span> adds <span class="literal">'ducati'</span> to the end of the list without affecting any of the other elements in the list:</p>
<p class="programs">['honda', 'yamaha', 'suzuki']<br class="calibre4" />
['honda', 'yamaha', 'suzuki', 'ducati']</p>
<p class="indent"><span type="pagebreak" id="calibre_link-452" class="calibre"></span>The <span class="literal">append()</span> method makes it easy to build lists dynamically. For example, you can start with an empty list and then add items to the list using a series of <span class="literal">append()</span> calls. Using an empty list, let’s add the elements <span class="literal">'honda'</span>, <span class="literal">'yamaha'</span>, and <span class="literal">'suzuki'</span> to the list:</p>
<p class="programs">motorcycles = []<br class="calibre4" />
<br class="calibre4" />
motorcycles.append('honda')<br class="calibre4" />
motorcycles.append('yamaha')<br class="calibre4" />
motorcycles.append('suzuki')<br class="calibre4" />
<br class="calibre4" />
print(motorcycles)</p>
<p class="indent">The resulting list looks exactly the same as the lists in the previous examples:</p>
<p class="programs">['honda', 'yamaha', 'suzuki']</p>
<p class="indent">Building lists this way is very common, because you often won’t know the data your users want to store in a program until after the program is running. To put your users in control, start by defining an empty list that will hold the users’ values. Then append each new value provided to the list you just created.</p>
<h5 class="h4" id="calibre_link-1306"><strong class="calibre2">Inserting Elements into a List</strong></h5>
<p class="noindent">You can add a new element at any position in your list by using the <span class="literal">insert()</span> method. You do this by specifying the index of the new element and the value of the new item.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;motorcycles = ['honda', 'yamaha', 'suzuki']<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> motorcycles.insert(0, 'ducati')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)</p>
<p class="indent">In this example, the code at <span class="ent">➊</span> inserts the value <span class="literal">'ducati'</span> at the beginning of the list. The <span class="literal">insert()</span> method opens a space at position <span class="literal">0</span> and stores the value <span class="literal">'ducati'</span> at that location. This operation shifts every other value in the list one position to the right:</p>
<p class="programs">['ducati', 'honda', 'yamaha', 'suzuki']</p>
<h4 class="h3" id="calibre_link-635"><strong class="calibre2"><em class="calibre3">Removing Elements from a List</em></strong></h4>
<p class="noindent">Often, you’ll want to remove an item or a set of items from a list. For example, when a player shoots down an alien from the sky, you’ll most likely want to remove it from the list of active aliens. Or when a user <span type="pagebreak" id="calibre_link-292" class="calibre"></span>decides to cancel their account on a web application you created, you’ll want to remove that user from the list of active users. You can remove an item according to its position in the list or according to its value.</p>
<h5 class="h4" id="calibre_link-1307"><strong class="calibre2">Removing an Item Using the del Statement</strong></h5>
<p class="noindent">If you know the position of the item you want to remove from a list, you can use the <span class="literal">del</span> statement.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;motorcycles = ['honda', 'yamaha', 'suzuki']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> del motorcycles[0]<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)</p>
<p class="indent">The code at <span class="ent">➊</span> uses <span class="literal">del</span> to remove the first item, <span class="literal">'honda'</span>, from the list of motorcycles:</p>
<p class="programs">['honda', 'yamaha', 'suzuki']<br class="calibre4" />
['yamaha', 'suzuki']</p>
<p class="indent">You can remove an item from any position in a list using the <span class="literal">del</span> statement if you know its index. For example, here’s how to remove the second item, <span class="literal">'yamaha'</span>, in the list:</p>
<p class="programs"><span class="ash">motorcycles = ['honda', 'yamaha', 'suzuki']</span><br class="calibre4" />
<span class="ash">print(motorcycles)</span><br class="calibre4" />
<br class="calibre4" />
del motorcycles[1]<br class="calibre4" />
print(motorcycles)</p>
<p class="indent">The second motorcycle is deleted from the list:</p>
<p class="programs">['honda', 'yamaha', 'suzuki']<br class="calibre4" />
['honda', 'suzuki']</p>
<p class="indent">In both examples, you can no longer access the value that was removed from the list after the <span class="literal">del</span> statement is used.</p>
<h5 class="h4" id="calibre_link-1308"><strong class="calibre2">Removing an Item Using the pop() Method</strong></h5>
<p class="noindent">Sometimes you’ll want to use the value of an item after you remove it from a list. For example, you might want to get the <em class="calibre3">x</em> and <em class="calibre3">y</em> position of an alien that was just shot down, so you can draw an explosion at that position. In a web application, you might want to remove a user from a list of active members and then add that user to a list of inactive members.</p>
<p class="indent">The <span class="literal">pop()</span> method removes the last item in a list, but it lets you work with that item after removing it. The term <em class="calibre3">pop</em> comes from thinking of a list as a stack of items and popping one item off the top of the stack. In this analogy, the top of a stack corresponds to the end of a list.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1309" class="calibre"></span>Let’s pop a motorcycle from the list of motorcycles:</p>
<p class="programs"><span class="ent">➊</span> motorcycles = ['honda', 'yamaha', 'suzuki']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> popped_motorcycle = motorcycles.pop()<br class="calibre4" />
<span class="ent">➌</span> print(motorcycles)<br class="calibre4" />
<span class="ent">➍</span> print(popped_motorcycle)</p>
<p class="indent">We start by defining and printing the list <span class="literal">motorcycles</span> at <span class="ent">➊</span>. At <span class="ent">➋</span> we pop a value from the list and store that value in the variable <span class="literal">popped_motorcycle</span>. We print the list at <span class="ent">➌</span> to show that a value has been removed from the list. Then we print the popped value at <span class="ent">➍</span> to prove that we still have access to the value that was removed.</p>
<p class="indent">The output shows that the value <span class="literal">'suzuki'</span> was removed from the end of the list and is now assigned to the variable <span class="literal">popped_motorcycle</span>:</p>
<p class="programs">['honda', 'yamaha', 'suzuki']<br class="calibre4" />
['honda', 'yamaha']<br class="calibre4" />
suzuki</p>
<p class="indent">How might this <span class="literal">pop()</span> method be useful? Imagine that the motorcycles in the list are stored in chronological order according to when we owned them. If this is the case, we can use the <span class="literal">pop()</span> method to print a statement about the last motorcycle we bought:</p>
<p class="programs">motorcycles = ['honda', 'yamaha', 'suzuki']<br class="calibre4" />
<br class="calibre4" />
last_owned = motorcycles.pop()<br class="calibre4" />
print(f"The last motorcycle I owned was a {last_owned.title()}.")</p>
<p class="indent">The output is a simple sentence about the most recent motorcycle we owned:</p>
<p class="programs">The last motorcycle I owned was a Suzuki.</p>
<h5 class="h4" id="calibre_link-1310"><strong class="calibre2">Popping Items from any Position in a List</strong></h5>
<p class="noindent">You can use <span class="literal">pop()</span> to remove an item from any position in a list by including the index of the item you want to remove in parentheses.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">motorcycles = ['honda', 'yamaha', 'suzuki']</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> first_owned = motorcycles.pop(0)<br class="calibre4" />
<span class="ent">➋</span> print(f"The first motorcycle I owned was a {first_owned.title()}.")</p>
<p class="indent"><span type="pagebreak" id="calibre_link-470" class="calibre"></span>We start by popping the first motorcycle in the list at <span class="ent">➊</span>, and then we print a message about that motorcycle at <span class="ent">➋</span>. The output is a simple sentence describing the first motorcycle I ever owned:</p>
<p class="programs">The first motorcycle I owned was a Honda.</p>
<p class="indent">Remember that each time you use <span class="literal">pop()</span>, the item you work with is no longer stored in the list.</p>
<p class="indent">If you’re unsure whether to use the <span class="literal">del</span> statement or the <span class="literal">pop()</span> method, here’s a simple way to decide: when you want to delete an item from a list and not use that item in any way, use the <span class="literal">del</span> statement; if you want to use an item as you remove it, use the <span class="literal">pop()</span> method.</p>
<h5 class="h4" id="calibre_link-1311"><strong class="calibre2">Removing an Item by Value</strong></h5>
<p class="noindent">Sometimes you won’t know the position of the value you want to remove from a list. If you only know the value of the item you want to remove, you can use the <span class="literal">remove()</span> method.</p>
<p class="indent">For example, let’s say we want to remove the value <span class="literal">'ducati'</span> from the list of motorcycles.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;motorcycles = ['honda', 'yamaha', 'suzuki', 'ducati']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> motorcycles.remove('ducati')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)</p>
<p class="indent">The code at <span class="ent">➊</span> tells Python to figure out where <span class="literal">'ducati'</span> appears in the list and remove that element:</p>
<p class="programs">['honda', 'yamaha', 'suzuki', 'ducati']<br class="calibre4" />
['honda', 'yamaha', 'suzuki']</p>
<p class="indent">You can also use the <span class="literal">remove()</span> method to work with a value that’s being removed from a list. Let’s remove the value <span class="literal">'ducati'</span> and print a reason for removing it from the list:</p>
<p class="programs"><span class="ent">➊</span> <span class="ash">motorcycles = ['honda', 'yamaha', 'suzuki', 'ducati']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(motorcycles)</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> too_expensive = 'ducati'<br class="calibre4" />
<span class="ent">➌</span> motorcycles.remove(too_expensive)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(motorcycles)<br class="calibre4" />
<span class="ent">➍</span> print(f"\nA {too_expensive.title()} is too expensive for me.")</p>
<p class="indent">After defining the list at <span class="ent">➊</span>, we assign the value <span class="literal">'ducati'</span> to a variable called <span class="literal">too_expensive</span> <span class="ent">➋</span>. We then use this variable to tell Python which value to remove from the list at <span class="ent">➌</span>. At <span class="ent">➍</span> the value <span class="literal">'ducati'</span> has been removed <span type="pagebreak" id="calibre_link-166" class="calibre"></span>from the list but is still accessible through the variable <span class="literal">too_expensive</span>, allowing us to print a statement about why we removed <span class="literal">'ducati'</span> from the list of motorcycles:</p>
<p class="programs">['honda', 'yamaha', 'suzuki', 'ducati']<br class="calibre4" />
['honda', 'yamaha', 'suzuki']<br class="calibre4" />
<br class="calibre4" />
A Ducati is too expensive for me.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The <span class="codeitalic">remove()</span> method deletes only the first occurrence of the value you specify. If there’s a possibility the value appears more than once in the list, you’ll need to use a loop to make sure all occurrences of the value are removed. You’ll learn how to do this in <a href="#calibre_link-117" class="calibre6">Chapter 7</a>.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="spara">The following exercises are a bit more complex than those in <a href="#calibre_link-7" class="calibre6">Chapter 2</a>, but they give you an opportunity to use lists in all of the ways described.</p>
<p class="sparal" id="calibre_link-162"><strong class="calibre2">3-4. Guest List:</strong> If you could invite anyone, living or deceased, to dinner, who would you invite? Make a list that includes at least three people you’d like to invite to dinner. Then use your list to print a message to each person, inviting them to dinner.</p>
<p class="sparal" id="calibre_link-163"><strong class="calibre2">3-5. Changing Guest List:</strong> You just heard that one of your guests can’t make the dinner, so you need to send out a new set of invitations. You’ll have to think of someone else to invite.</p>
<ul class="calibre8">
<li class="noindent1">Start with your program from <a href="#calibre_link-162" class="calibre6">Exercise 3-4</a>. Add a <span class="literal">print()</span> call at the end of your program stating the name of the guest who can’t make it.</li>
<li class="noindent1">Modify your list, replacing the name of the guest who can’t make it with the name of the new person you are inviting.</li>
<li class="noindent1">Print a second set of invitation messages, one for each person who is still in your list.</li>
</ul>
<p class="sparal" id="calibre_link-164"><strong class="calibre2">3-6. More Guests:</strong> You just found a bigger dinner table, so now more space is available. Think of three more guests to invite to dinner.</p>
<ul class="calibre8">
<li class="noindent1">Start with your program from <a href="#calibre_link-162" class="calibre6">Exercise 3-4</a> or <a href="#calibre_link-163" class="calibre6">Exercise 3-5</a>. Add a <span class="literal">print()</span> call to the end of your program informing people that you found a bigger dinner table.</li>
<li class="noindent1">Use <span class="literal">insert()</span> to add one new guest to the beginning of your list.</li>
<li class="noindent1">Use <span class="literal">insert()</span> to add one new guest to the middle of your list.</li>
<li class="noindent1">Use <span class="literal">append()</span> to add one new guest to the end of your list.</li>
<li class="noindent1">Print a new set of invitation messages, one for each person in your list.</li>
</ul>
<p class="sparal" id="calibre_link-165"><span type="pagebreak" id="calibre_link-258" class="calibre"></span><strong class="calibre2">3-7. Shrinking Guest List:</strong> You just found out that your new dinner table won’t arrive in time for the dinner, and you have space for only two guests.</p>
<ul class="calibre8">
<li class="noindent1">Start with your program from <a href="#calibre_link-164" class="calibre6">Exercise 3-6</a>. Add a new line that prints a message saying that you can invite only two people for dinner.</li>
<li class="noindent1">Use <span class="literal">pop()</span> to remove guests from your list one at a time until only two names remain in your list. Each time you pop a name from your list, print a message to that person letting them know you’re sorry you can’t invite them to dinner.</li>
<li class="noindent1">Print a message to each of the two people still on your list, letting them know they’re still invited.</li>
<li class="noindent1">Use <span class="literal">del</span> to remove the last two names from your list, so you have an empty list. Print your list to make sure you actually have an empty list at the end of your program.</li>
</ul>
</div>
<h3 class="h2" id="calibre_link-636"><strong class="calibre2">Organizing a List</strong></h3>
<p class="noindent">Often, your lists will be created in an unpredictable order, because you can’t always control the order in which your users provide their data. Although this is unavoidable in most circumstances, you’ll frequently want to present your information in a particular order. Sometimes you’ll want to preserve the original order of your list, and other times you’ll want to change the original order. Python provides a number of different ways to organize your lists, depending on the situation.</p>
<h4 class="h3" id="calibre_link-637"><strong class="calibre2"><em class="calibre3">Sorting a List Permanently with the sort() Method</em></strong></h4>
<p class="noindent">Python’s <span class="literal">sort()</span> method makes it relatively easy to sort a list. Imagine we have a list of cars and want to change the order of the list to store them alphabetically. To keep the task simple, let’s assume that all the values in the list are lowercase.</p>
<p class="margin"><em class="calibre3">cars.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;cars = ['bmw', 'audi', 'toyota', 'subaru']<br class="calibre4" />
<span class="ent">➊</span> cars.sort()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(cars)</p>
<p class="indent">The <span class="literal">sort()</span> method, shown at <span class="ent">➊</span>, changes the order of the list permanently. The cars are now in alphabetical order, and we can never revert to the original order:</p>
<p class="programs">['audi', 'bmw', 'subaru', 'toyota']</p>
<p class="indent"><span type="pagebreak" id="calibre_link-478" class="calibre"></span>You can also sort this list in reverse alphabetical order by passing the argument <span class="literal">reverse=True</span> to the <span class="literal">sort()</span> method. The following example sorts the list of cars in reverse alphabetical order:</p>
<p class="programs"><span class="ash">cars = ['bmw', 'audi', 'toyota', 'subaru']</span><br class="calibre4" />
cars.sort(reverse=True)<br class="calibre4" />
print(cars)</p>
<p class="indent">Again, the order of the list is permanently changed:</p>
<p class="programs">['toyota', 'subaru', 'bmw', 'audi']</p>
<h4 class="h3" id="calibre_link-638"><strong class="calibre2"><em class="calibre3">Sorting a List Temporarily with the sorted() Function</em></strong></h4>
<p class="noindent">To maintain the original order of a list but present it in a sorted order, you can use the <span class="literal">sorted()</span> function. The <span class="literal">sorted()</span> function lets you display your list in a particular order but doesn’t affect the actual order of the list.</p>
<p class="indent">Let’s try this function on the list of cars.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">cars = ['bmw', 'audi', 'toyota', 'subaru']</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> print("Here is the original list:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(cars)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> print("\nHere is the sorted list:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(sorted(cars))<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> print("\nHere is the original list again:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(cars)</p>
<p class="indent">We first print the list in its original order at <span class="ent">➊</span> and then in alphabetical order at <span class="ent">➋</span>. After the list is displayed in the new order, we show that the list is still stored in its original order at <span class="ent">➌</span>.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;Here is the original list:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;['bmw', 'audi', 'toyota', 'subaru']<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Here is the sorted list:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;['audi', 'bmw', 'subaru', 'toyota']<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> Here is the original list again:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;['bmw', 'audi', 'toyota', 'subaru']</p>
<p class="indent">Notice that the list still exists in its original order at <span class="ent">➍</span> after the <span class="literal">sorted()</span> function has been used. The <span class="literal">sorted()</span> function can also accept a <span class="literal">reverse=True</span> argument if you want to display a list in reverse alphabetical order.</p>
<div class="note">
<p class="notet"><span type="pagebreak" id="calibre_link-259" class="calibre"></span><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Sorting a list alphabetically is a bit more complicated when all the values are not in lowercase. There are several ways to interpret capital letters when determining a sort order, and specifying the exact order can be more complex than we want to deal with at this time. However, most approaches to sorting will build directly on what you learned in this section.</em></p>
</div>
<h4 class="h3" id="calibre_link-639"><strong class="calibre2"><em class="calibre3">Printing a List in Reverse Order</em></strong></h4>
<p class="noindent">To reverse the original order of a list, you can use the <span class="literal">reverse()</span> method. If we originally stored the list of cars in chronological order according to when we owned them, we could easily rearrange the list into reverse chronological order:</p>
<p class="programs"><span class="ash">cars = ['bmw', 'audi', 'toyota', 'subaru']</span><br class="calibre4" />
print(cars)<br class="calibre4" />
<br class="calibre4" />
cars.reverse()<br class="calibre4" />
print(cars)</p>
<p class="indent">Notice that <span class="literal">reverse()</span> doesn’t sort backward alphabetically; it simply reverses the order of the list:</p>
<p class="programs">['bmw', 'audi', 'toyota', 'subaru']<br class="calibre4" />
['subaru', 'toyota', 'audi', 'bmw']</p>
<p class="indent">The <span class="literal">reverse()</span> method changes the order of a list permanently, but you can revert to the original order anytime by applying <span class="literal">reverse()</span> to the same list a second time.</p>
<h4 class="h3" id="calibre_link-640"><strong class="calibre2"><em class="calibre3">Finding the Length of a List</em></strong></h4>
<p class="noindent">You can quickly find the length of a list by using the <span class="literal">len()</span> function. The list in this example has four items, so its length is <span class="literal">4</span>:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">cars = ['bmw', 'audi', 'toyota', 'subaru']</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">len(cars)</span><br class="calibre4" />
4</p>
<p class="indent">You’ll find <span class="literal">len()</span> useful when you need to identify the number of aliens that still need to be shot down in a game, determine the amount of data you have to manage in a visualization, or figure out the number of registered users on a website, among other tasks.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Python counts the items in a list starting with one, so you shouldn’t run into any off-by-one errors when determining the length of a list.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-473" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-641"><strong class="calibre2">3-8. Seeing the World:</strong> Think of at least five places in the world you’d like to visit.</p>
<ul class="calibre8">
<li class="noindent1">Store the locations in a list. Make sure the list is not in alphabetical order.</li>
<li class="noindent1">Print your list in its original order. Don’t worry about printing the list neatly, just print it as a raw Python list.</li>
<li class="noindent1">Use <span class="literal">sorted()</span> to print your list in alphabetical order without modifying the actual list.</li>
<li class="noindent1">Show that your list is still in its original order by printing it.</li>
<li class="noindent1">Use <span class="literal">sorted()</span> to print your list in reverse alphabetical order without changing the order of the original list.</li>
<li class="noindent1">Show that your list is still in its original order by printing it again.</li>
<li class="noindent1">Use <span class="literal">reverse()</span> to change the order of your list. Print the list to show that its order has changed.</li>
<li class="noindent1">Use <span class="literal">reverse()</span> to change the order of your list again. Print the list to show it’s back to its original order.</li>
<li class="noindent1">Use <span class="literal">sort()</span> to change your list so it’s stored in alphabetical order. Print the list to show that its order has been changed.</li>
<li class="noindent1">Use <span class="literal">sort()</span> to change your list so it’s stored in reverse alphabetical order. Print the list to show that its order has changed.</li>
</ul>
<p class="sparal" id="calibre_link-642"><strong class="calibre2">3-9. Dinner Guests:</strong> Working with one of the programs from <a href="#calibre_link-162" class="calibre6">Exercises 3-4</a> through <a href="#calibre_link-165" class="calibre6">3-7</a> (<a href="#calibre_link-166" class="calibre6">page 42</a>), use <span class="literal1">len()</span> to print a message indicating the number of people you are inviting to dinner.</p>
<p class="sparal" id="calibre_link-643"><strong class="calibre2">3-10. Every Function:</strong> Think of something you could store in a list. For example, you could make a list of mountains, rivers, countries, cities, languages, or anything else you’d like. Write a program that creates a list containing these items and then uses each function introduced in this chapter at least once.</p>
</div>
<h3 class="h2" id="calibre_link-644"><strong class="calibre2">Avoiding Index Errors When Working with Lists</strong></h3>
<p class="noindent">One type of error is common to see when you’re working with lists for the first time. Let’s say you have a list with three items, and you ask for the fourth item:</p>
<p class="margin"><em class="calibre3">motorcycles.py</em></p>
<p class="programs">motorcycles = ['honda', 'yamaha', 'suzuki']<br class="calibre4" />
print(motorcycles[3])</p>
<p class="indent"><span type="pagebreak" id="calibre_link-451" class="calibre"></span>This example results in an <em class="calibre3">index error</em>:</p>
<p class="programs">Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;File "motorcycles.py", line 2, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(motorcycles[3])<br class="calibre4" />
IndexError: list index out of range</p>
<p class="indent">Python attempts to give you the item at index 3. But when it searches the list, no item in <span class="literal">motorcycles</span> has an index of 3. Because of the off-by-one nature of indexing in lists, this error is typical. People think the third item is item number 3, because they start counting at 1. But in Python the third item is number 2, because it starts indexing at 0.</p>
<p class="indent">An index error means Python can’t find an item at the index you requested. If an index error occurs in your program, try adjusting the index you’re asking for by one. Then run the program again to see if the results are correct.</p>
<p class="indent">Keep in mind that whenever you want to access the last item in a list you use the index <span class="literal">-1</span>. This will always work, even if your list has changed size since the last time you accessed it:</p>
<p class="programs"><span class="ash">motorcycles = ['honda', 'yamaha', 'suzuki']</span><br class="calibre4" />
print(motorcycles[-1])</p>
<p class="indent">The index <span class="literal">-1</span> always returns the last item in a list, in this case the value <span class="literal">'suzuki'</span>:</p>
<p class="programs">'suzuki'</p>
<p class="indent">The only time this approach will cause an error is when you request the last item from an empty list:</p>
<p class="programs">motorcycles = []<br class="calibre4" />
print(motorcycles[-1])</p>
<p class="indent">No items are in <span class="literal">motorcycles</span>, so Python returns another index error:</p>
<p class="programs">Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;File "motorcyles.py", line 3, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(motorcycles[-1])<br class="calibre4" />
IndexError: list index out of range</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If an index error occurs and you can’t figure out how to resolve it, try printing your list or just printing the length of your list. Your list might look much different than you thought it did, especially if it has been managed dynamically by your program. Seeing the actual list, or the exact number of items in your list, can help you sort out such logical errors.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-309" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-645"><strong class="calibre2">3-11. Intentional Error:</strong> If you haven’t received an index error in one of your programs yet, try to make one happen. Change an index in one of your programs to produce an index error. Make sure you correct the error before closing the program.</p>
</div>
<h3 class="h2" id="calibre_link-646"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned what lists are and how to work with the individual items in a list. You learned how to define a list and how to add and remove elements. You learned to sort lists permanently and temporarily for display purposes. You also learned how to find the length of a list and how to avoid index errors when you’re working with lists.</p>
<p class="indent">In <a href="#calibre_link-115" class="calibre6">Chapter 4</a> you’ll learn how to work with items in a list more efficiently. By looping through each item in a list using just a few lines of code you’ll be able to work efficiently, even when your list contains thousands or millions of items.</p>
</div>


<div class="calibre1" id="calibre_link-55">
<h2 class="h" id="calibre_link-115"><span type="pagebreak" id="calibre_link-388" class="calibre"></span><strong class="calibre2"><span class="big">4</span><br class="calibre4" />WORKING WITH LISTS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In <a href="#calibre_link-56" class="calibre6">Chapter 3</a> you learned how to make a simple list, and you learned to work with the individual elements in a list. In this chapter you’ll learn how to <em class="calibre3">loop</em> through an entire list using just a few lines of code regardless of how long the list is. Looping allows you to take the same action, or set of actions, with every item in a list. As a result, you’ll be able to work efficiently with lists of any length, including those with thousands or even millions of items.</p>
<h3 class="h2" id="calibre_link-647"><strong class="calibre2">Looping Through an Entire List</strong></h3>
<p class="noindent">You’ll often want to run through all entries in a list, performing the same task with each item. For example, in a game you might want to move every element on the screen by the same amount, or in a list of numbers you might want to perform the same statistical operation on every element. Or perhaps you’ll want to display each headline from a list of articles on a website. When you want to do the same action with every item in a list, you can use Python’s <span class="literal">for</span> loop.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-480" class="calibre"></span>Let’s say we have a list of magicians’ names, and we want to print out each name in the list. We could do this by retrieving each name from the list individually, but this approach could cause several problems. For one, it would be repetitive to do this with a long list of names. Also, we’d have to change our code each time the list’s length changed. A <span class="literal">for</span> loop avoids both of these issues by letting Python manage these issues internally.</p>
<p class="indent">Let’s use a <span class="literal">for</span> loop to print out each name in a list of magicians:</p>
<p class="margin"><em class="calibre3">magicians.py</em></p>
<p class="programs"><span class="ent">➊</span> magicians = ['alice', 'david', 'carolina']<br class="calibre4" />
<span class="ent">➋</span> for magician in magicians:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(magician)</p>
<p class="indent">We begin by defining a list at <span class="ent">➊</span>, just as we did in <a href="#calibre_link-56" class="calibre6">Chapter 3</a>. At <span class="ent">➋</span>, we define a <span class="literal">for</span> loop. This line tells Python to pull a name from the list <span class="literal">magicians</span>, and associate it with the variable <span class="literal">magician</span>. At <span class="ent">➌</span> we tell Python to print the name that’s just been assigned to <span class="literal">magician</span>. Python then repeats lines <span class="ent">➋</span> and <span class="ent">➌</span>, once for each name in the list. It might help to read this code as “For every magician in the list of magicians, print the magician’s name.” The output is a simple printout of each name in the list:</p>
<p class="programs">alice<br class="calibre4" />
david<br class="calibre4" />
carolina</p>
<h4 class="h3" id="calibre_link-648"><strong class="calibre2"><em class="calibre3">A Closer Look at Looping</em></strong></h4>
<p class="noindent">The concept of looping is important because it’s one of the most common ways a computer automates repetitive tasks. For example, in a simple loop like we used in <em class="calibre3">magicians.py</em>, Python initially reads the first line of the loop:</p>
<p class="programs">for magician in magicians:</p>
<p class="indent">This line tells Python to retrieve the first value from the list <span class="literal">magicians</span> and associate it with the variable <span class="literal">magician</span>. This first value is <span class="literal">'alice'</span>. Python then reads the next line:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;print(magician)</p>
<p class="indent">Python prints the current value of <span class="literal">magician</span>, which is still <span class="literal">'alice'</span>. Because the list contains more values, Python returns to the first line of the loop:</p>
<p class="programs">for magician in magicians:</p>
<p class="indent">Python retrieves the next name in the list, <span class="literal">'david'</span>, and associates that value with the variable <span class="literal">magician</span>. Python then executes the line:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;print(magician)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1312" class="calibre"></span>Python prints the current value of <span class="literal">magician</span> again, which is now <span class="literal">'david'</span>. Python repeats the entire loop once more with the last value in the list, <span class="literal">'carolina'</span>. Because no more values are in the list, Python moves on to the next line in the program. In this case nothing comes after the <span class="literal">for</span> loop, so the program simply ends.</p>
<p class="indent">When you’re using loops for the first time, keep in mind that the set of steps is repeated once for each item in the list, no matter how many items are in the list. If you have a million items in your list, Python repeats these steps a million times&mdash;and usually very quickly.</p>
<p class="indent">Also keep in mind when writing your own <span class="literal">for</span> loops that you can choose any name you want for the temporary variable that will be associated with each value in the list. However, it’s helpful to choose a meaningful name that represents a single item from the list. For example, here’s a good way to start a <span class="literal">for</span> loop for a list of cats, a list of dogs, and a general list of items:</p>
<p class="programs">for cat in cats:<br class="calibre4" />
for dog in dogs:<br class="calibre4" />
for item in list_of_items:</p>
<p class="indent">These naming conventions can help you follow the action being done on each item within a <span class="literal">for</span> loop. Using singular and plural names can help you identify whether a section of code is working with a single element from the list or the entire list.</p>
<h4 class="h3" id="calibre_link-649"><strong class="calibre2"><em class="calibre3">Doing More Work Within a for Loop</em></strong></h4>
<p class="noindent">You can do just about anything with each item in a <span class="literal">for</span> loop. Let’s build on the previous example by printing a message to each magician, telling them that they performed a great trick:</p>
<p class="margin"><em class="calibre3">magicians.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">magicians = ['alice', 'david', 'carolina']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for magician in magicians:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{magician.title()}, that was a great trick!")</p>
<p class="indent">The only difference in this code is at <span class="ent">➊</span> where we compose a message to each magician, starting with that magician’s name. The first time through the loop the value of magician is <span class="literal">'alice'</span>, so Python starts the first message with the name <span class="literal">'Alice'</span>. The second time through the message will begin with <span class="literal">'David'</span>, and the third time through the message will begin with <span class="literal">'Carolina'</span>.</p>
<p class="indent">The output shows a personalized message for each magician in the list:</p>
<p class="programs">Alice, that was a great trick!<br class="calibre4" />
David, that was a great trick!<br class="calibre4" />
Carolina, that was a great trick!</p>
<p class="indent">You can also write as many lines of code as you like in the <span class="literal">for</span> loop. Every indented line following the line <span class="literal">for magician in magicians</span> is considered <em class="calibre3">inside the loop</em>, and each indented line is executed once for each <span type="pagebreak" id="calibre_link-1313" class="calibre"></span>value in the list. Therefore, you can do as much work as you like with each value in the list.</p>
<p class="indent">Let’s add a second line to our message, telling each magician that we’re looking forward to their next trick:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">magicians = ['alice', 'david', 'carolina']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for magician in magicians:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"{magician.title()}, that was a great trick!")</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"I can't wait to see your next trick, {magician.title()}.\n")</p>
<p class="indent">Because we have indented both calls to <span class="literal">print()</span>, each line will be executed once for every magician in the list. The newline (<span class="literal">"\n"</span>) in the second <span class="literal">print()</span> call <span class="ent">➊</span> inserts a blank line after each pass through the loop. This creates a set of messages that are neatly grouped for each person in the list:</p>
<p class="programs">Alice, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, Alice.<br class="calibre4" />
<br class="calibre4" />
David, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, David.<br class="calibre4" />
<br class="calibre4" />
Carolina, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, Carolina.</p>
<p class="indent">You can use as many lines as you like in your <span class="literal">for</span> loops. In practice you’ll often find it useful to do a number of different operations with each item in a list when you use a <span class="literal">for</span> loop.</p>
<h4 class="h3" id="calibre_link-650"><strong class="calibre2"><em class="calibre3">Doing Something After a for Loop</em></strong></h4>
<p class="noindent">What happens once a <span class="literal">for</span> loop has finished executing? Usually, you’ll want to summarize a block of output or move on to other work that your program must accomplish.</p>
<p class="indent">Any lines of code after the <span class="literal">for</span> loop that are not indented are executed once without repetition. Let’s write a thank you to the group of magicians as a whole, thanking them for putting on an excellent show. To display this group message after all of the individual messages have been printed, we place the thank you message after the <span class="literal">for</span> loop without indentation:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">magicians = ['alice', 'david', 'carolina']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for magician in magicians:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"{magician.title()}, that was a great trick!")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"I can't wait to see your next trick, {magician.title()}.\n")</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> print("Thank you, everyone. That was a great magic show!")</p>
<p class="indent"><span type="pagebreak" id="calibre_link-450" class="calibre"></span>The first two calls to <span class="literal">print()</span> are repeated once for each magician in the list, as you saw earlier. However, because the line at <span class="ent">➊</span> is not indented, it’s printed only once:</p>
<p class="programs">Alice, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, Alice.<br class="calibre4" />
<br class="calibre4" />
David, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, David.<br class="calibre4" />
<br class="calibre4" />
Carolina, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, Carolina.<br class="calibre4" />
<br class="calibre4" />
Thank you, everyone. That was a great magic show!</p>
<p class="indent">When you’re processing data using a <span class="literal">for</span> loop, you’ll find that this is a good way to summarize an operation that was performed on an entire data set. For example, you might use a <span class="literal">for</span> loop to initialize a game by running through a list of characters and displaying each character on the screen. You might then write some additional code after this loop that displays a <em class="calibre3">Play Now</em> button after all the characters have been drawn to the screen.</p>
<h3 class="h2" id="calibre_link-651"><strong class="calibre2">Avoiding Indentation Errors</strong></h3>
<p class="noindent">Python uses indentation to determine how a line, or group of lines, is related to the rest of the program. In the previous examples, the lines that printed messages to individual magicians were part of the <span class="literal">for</span> loop because they were indented. Python’s use of indentation makes code very easy to read. Basically, it uses whitespace to force you to write neatly formatted code with a clear visual structure. In longer Python programs, you’ll notice blocks of code indented at a few different levels. These indentation levels help you gain a general sense of the overall program’s organization.</p>
<p class="indent">As you begin to write code that relies on proper indentation, you’ll need to watch for a few common <em class="calibre3">indentation errors</em>. For example, people sometimes indent lines of code that don’t need to be indented or forget to indent lines that need to be indented. Seeing examples of these errors now will help you avoid them in the future and correct them when they do appear in your own programs.</p>
<p class="indent">Let’s examine some of the more common indentation errors.</p>
<h4 class="h3" id="calibre_link-652"><strong class="calibre2"><em class="calibre3">Forgetting to Indent</em></strong></h4>
<p class="noindent">Always indent the line after the <span class="literal">for</span> statement in a loop. If you forget, Python will remind you:</p>
<p class="margin"><em class="calibre3">magicians.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;magicians = ['alice', 'david', 'carolina']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for magician in magicians:<br class="calibre4" />
<span class="ent">➊</span> print(magician)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-58" class="calibre"></span>The call to <span class="literal">print()</span> <span class="ent">➊</span> should be indented, but it’s not. When Python expects an indented block and doesn’t find one, it lets you know which line it had a problem with.</p>
<p class="programs">&nbsp;&nbsp;File "magicians.py", line 3<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(magician)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^<br class="calibre4" />
IndentationError: expected an indented block</p>
<p class="indent">You can usually resolve this kind of indentation error by indenting the line or lines immediately after the <span class="literal">for</span> statement.</p>
<h4 class="h3" id="calibre_link-57"><strong class="calibre2"><em class="calibre3">Forgetting to Indent Additional Lines</em></strong></h4>
<p class="noindent">Sometimes your loop will run without any errors but won’t produce the expected result. This can happen when you’re trying to do several tasks in a loop and you forget to indent some of its lines.</p>
<p class="indent">For example, this is what happens when we forget to indent the second line in the loop that tells each magician we’re looking forward to their next trick:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;magicians = ['alice', 'david', 'carolina']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for magician in magicians:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{magician.title()}, that was a great trick!")<br class="calibre4" />
<span class="ent">➊</span> print(f"I can't wait to see your next trick, {magician.title()}.\n")</p>
<p class="indent">The call to <span class="literal">print()</span> <span class="ent">➊</span> is supposed to be indented, but because Python finds at least one indented line after the <span class="literal">for</span> statement, it doesn’t report an error. As a result, the first <span class="literal">print()</span> call is executed once for each name in the list because it is indented. The second <span class="literal">print()</span> call is not indented, so it is executed only once after the loop has finished running. Because the final value associated with <span class="literal">magician</span> is <span class="literal">'carolina'</span>, she is the only one who receives the “looking forward to the next trick” message:</p>
<p class="programs">Alice, that was a great trick!<br class="calibre4" />
David, that was a great trick!<br class="calibre4" />
Carolina, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, Carolina.</p>
<p class="indent">This is a <em class="calibre3">logical error</em>. The syntax is valid Python code, but the code does not produce the desired result because a problem occurs in its logic. If you expect to see a certain action repeated once for each item in a list and it’s executed only once, determine whether you need to simply indent a line or a group of lines.</p>
<h4 class="h3" id="calibre_link-653"><span type="pagebreak" id="calibre_link-1314" class="calibre"></span><strong class="calibre2"><em class="calibre3">Indenting Unnecessarily</em></strong></h4>
<p class="noindent">If you accidentally indent a line that doesn’t need to be indented, Python informs you about the unexpected indent:</p>
<p class="margin"><em class="calibre3">hello_world.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;message = "Hello Python world!"<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(message)</p>
<p class="indent">We don’t need to indent the <span class="literal">print()</span> call <span class="ent">➊</span>, because it isn’t part of a loop; hence, Python reports that error:</p>
<p class="programs">&nbsp;&nbsp;File "hello_world.py", line 2<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(message)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;^<br class="calibre4" />
IndentationError: unexpected indent</p>
<p class="indent">You can avoid unexpected indentation errors by indenting only when you have a specific reason to do so. In the programs you’re writing at this point, the only lines you should indent are the actions you want to repeat for each item in a <span class="literal">for</span> loop.</p>
<h4 class="h3" id="calibre_link-654"><strong class="calibre2"><em class="calibre3">Indenting Unnecessarily After the Loop</em></strong></h4>
<p class="noindent">If you accidentally indent code that should run after a loop has finished, that code will be repeated once for each item in the list. Sometimes this prompts Python to report an error, but often this will result in a logical error.</p>
<p class="indent">For example, let’s see what happens when we accidentally indent the line that thanked the magicians as a group for putting on a good show:</p>
<p class="margin"><em class="calibre3">magicians.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;magicians = ['alice', 'david', 'carolina']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for magician in magicians:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{magician.title()}, that was a great trick!")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"I can't wait to see your next trick, {magician.title()}.\n")<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Thank you everyone, that was a great magic show!")</p>
<p class="indent">Because the line at <span class="ent">➊</span> is indented, it’s printed once for each person in the list, as shown here:</p>
<p class="programs">Alice, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, Alice.<br class="calibre4" />
<br class="calibre4" />
Thank you everyone, that was a great magic show!<br class="calibre4" />
David, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, David.<br class="calibre4" />
<br class="calibre4" />
Thank you everyone, that was a great magic show!<br class="calibre4" />
Carolina, that was a great trick!<br class="calibre4" />
I can't wait to see your next trick, Carolina.<br class="calibre4" />
<br class="calibre4" />
Thank you everyone, that was a great magic show!</p>
<p class="indent"><span type="pagebreak" id="calibre_link-60" class="calibre"></span>This is another logical error, similar to the one in “<a href="#calibre_link-57" class="calibre6">Forgetting to Indent Additional Lines</a>” on <a href="#calibre_link-58" class="calibre6">page 54</a>. Because Python doesn’t know what you’re trying to accomplish with your code, it will run all code that is written in valid syntax. If an action is repeated many times when it should be executed only once, you probably need to unindent the code for that action.</p>
<h4 class="h3" id="calibre_link-655"><strong class="calibre2"><em class="calibre3">Forgetting the Colon</em></strong></h4>
<p class="noindent">The colon at the end of a <span class="literal">for</span> statement tells Python to interpret the next line as the start of a loop.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;magicians = ['alice', 'david', 'carolina']<br class="calibre4" />
<span class="ent">➊</span> for magician in magicians<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(magician)</p>
<p class="indent">If you accidentally forget the colon, as shown at <span class="ent">➊</span>, you’ll get a syntax error because Python doesn’t know what you’re trying to do. Although this is an easy error to fix, it’s not always an easy error to find. You’d be surprised by the amount of time programmers spend hunting down single-character errors like this. Such errors are difficult to find because we often just see what we expect to see.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-59"><strong class="calibre2">4-1. Pizzas:</strong> Think of at least three kinds of your favorite pizza. Store these pizza names in a list, and then use a <span class="literal1">for</span> loop to print the name of each pizza.</p>
<ul class="calibre8">
<li class="noindent1">Modify your <span class="literal">for</span> loop to print a sentence using the name of the pizza instead of printing just the name of the pizza. For each pizza you should have one line of output containing a simple statement like <em class="calibre3">I like pepperoni pizza</em>.</li>
<li class="noindent1">Add a line at the end of your program, outside the <span class="literal">for</span> loop, that states how much you like pizza. The output should consist of three or more lines about the kinds of pizza you like and then an additional sentence, such as <em class="calibre3">I really love pizza!</em></li>
</ul>
<p class="sparal" id="calibre_link-656"><strong class="calibre2">4-2. Animals:</strong> Think of at least three different animals that have a common characteristic. Store the names of these animals in a list, and then use a <span class="literal1">for</span> loop to print out the name of each animal.</p>
<ul class="calibre8">
<li class="noindent1">Modify your program to print a statement about each animal, such as <em class="calibre3">A dog would make a great pet.</em></li>
<li class="noindent1">Add a line at the end of your program stating what these animals have in common. You could print a sentence such as <em class="calibre3">Any of these animals would make a great pet!</em></li>
</ul>
</div>
<h3 class="h2" id="calibre_link-657"><span type="pagebreak" id="calibre_link-384" class="calibre"></span><strong class="calibre2">Making Numerical Lists</strong></h3>
<p class="noindent">Many reasons exist to store a set of numbers. For example, you’ll need to keep track of the positions of each character in a game, and you might want to keep track of a player’s high scores as well. In data visualizations, you’ll almost always work with sets of numbers, such as temperatures, distances, population sizes, or latitude and longitude values, among other types of numerical sets.</p>
<p class="indent">Lists are ideal for storing sets of numbers, and Python provides a variety of tools to help you work efficiently with lists of numbers. Once you understand how to use these tools effectively, your code will work well even when your lists contain millions of items.</p>
<h4 class="h3" id="calibre_link-658"><strong class="calibre2"><em class="calibre3">Using the range() Function</em></strong></h4>
<p class="noindent">Python’s <span class="literal">range()</span> function makes it easy to generate a series of numbers. For example, you can use the <span class="literal">range()</span> function to print a series of numbers like this:</p>
<p class="margin"><em class="calibre3">first_numbers.py</em></p>
<p class="programs">for value in range(1, 5):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(value)</p>
<p class="indent">Although this code looks like it should print the numbers from 1 to 5, it doesn’t print the number 5:</p>
<p class="programs">1<br class="calibre4" />
2<br class="calibre4" />
3<br class="calibre4" />
4</p>
<p class="indent">In this example, <span class="literal">range()</span> prints only the numbers 1 through 4. This is another result of the off-by-one behavior you’ll see often in programming languages. The <span class="literal">range()</span> function causes Python to start counting at the first value you give it, and it stops when it reaches the second value you provide. Because it stops at that second value, the output never contains the end value, which would have been 5 in this case.</p>
<p class="indent">To print the numbers from 1 to 5, you would use <span class="literal">range(1, 6)</span>:</p>
<p class="programs">for value in range(1, 6):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(value)</span></p>
<p class="indent">This time the output starts at 1 and ends at 5:</p>
<p class="programs">1<br class="calibre4" />
2<br class="calibre4" />
3<br class="calibre4" />
4<br class="calibre4" />
5</p>
<p class="indent"><span type="pagebreak" id="calibre_link-367" class="calibre"></span>If your output is different than what you expect when you’re using <span class="literal">range()</span>, try adjusting your end value by 1.</p>
<p class="indent">You can also pass <span class="literal">range()</span> only one argument, and it will start the sequence of numbers at 0. For example, <span class="literal">range(6)</span> would return the numbers from 0 through 5.</p>
<h4 class="h3" id="calibre_link-659"><strong class="calibre2"><em class="calibre3">Using range() to Make a List of Numbers</em></strong></h4>
<p class="noindent">If you want to make a list of numbers, you can convert the results of <span class="literal">range()</span> directly into a list using the <span class="literal">list()</span> function. When you wrap <span class="literal">list()</span> around a call to the <span class="literal">range()</span> function, the output will be a list of numbers.</p>
<p class="indent">In the example in the previous section, we simply printed out a series of numbers. We can use <span class="literal">list()</span> to convert that same set of numbers into a list:</p>
<p class="programs">numbers = list(range(1, 6))<br class="calibre4" />
print(numbers)</p>
<p class="indent">And this is the result:</p>
<p class="programs">[1, 2, 3, 4, 5]</p>
<p class="indent">We can also use the <span class="literal">range()</span> function to tell Python to skip numbers in a given range. If you pass a third argument to <span class="literal">range()</span>, Python uses that value as a step size when generating numbers.</p>
<p class="indent">For example, here’s how to list the even numbers between 1 and 10:</p>
<p class="margin"><em class="calibre3">even_numbers.py</em></p>
<p class="programs">even_numbers = list(range(2, 11, 2))<br class="calibre4" />
print(even_numbers)</p>
<p class="indent">In this example, the <span class="literal">range()</span> function starts with the value 2 and then adds 2 to that value. It adds 2 repeatedly until it reaches or passes the end value, 11, and produces this result:</p>
<p class="programs">[2, 4, 6, 8, 10]</p>
<p class="indent">You can create almost any set of numbers you want to using the <span class="literal">range()</span> function. For example, consider how you might make a list of the first 10 square numbers (that is, the square of each integer from 1 through 10). In Python, two asterisks (<span class="literal">**</span>) represent exponents. Here’s how you might put the first 10 square numbers into a list:</p>
<p class="margin"><em class="calibre3">squares.py</em></p>
<p class="programs"><span class="ent">➊</span> squares = []<br class="calibre4" />
<span class="ent">➋</span> for value in range(1, 11):<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;square = value ** 2<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;squares.append(square)<br class="calibre4" />
<span class="ent">➎</span> print(squares)</p>
<p class="indent">We start with an empty list called <span class="literal">squares</span> <span class="ent">➊</span>. At <span class="ent">➋</span>, we tell Python to loop through each value from 1 to 10 using the <span class="literal">range()</span> function. Inside the loop, <span type="pagebreak" id="calibre_link-474" class="calibre"></span>the current value is raised to the second power and assigned to the variable <span class="literal">square</span> <span class="ent">➌</span>. At <span class="ent">➍</span>, each new value of <span class="literal">square</span> is appended to the list <span class="literal">squares</span>. Finally, when the loop has finished running, the list of squares is printed <span class="ent">➎</span>:</p>
<p class="programs">[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]</p>
<p class="indent">To write this code more concisely, omit the temporary variable <span class="literal">square</span> and append each new value directly to the list:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">squares = []</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for value in range(1,11):</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;squares.append(value**2)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(squares)</span></p>
<p class="indent">The code at <span class="ent">➊</span> does the same work as the lines at <span class="ent">➌</span> and <span class="ent">➍</span> in <em class="calibre3">squares.py</em>. Each value in the loop is raised to the second power and then immediately appended to the list of squares.</p>
<p class="indent">You can use either of these two approaches when you’re making more complex lists. Sometimes using a temporary variable makes your code easier to read; other times it makes the code unnecessarily long. Focus first on writing code that you understand clearly, which does what you want it to do. Then look for more efficient approaches as you review your code.</p>
<h4 class="h3" id="calibre_link-660"><strong class="calibre2"><em class="calibre3">Simple Statistics with a List of Numbers</em></strong></h4>
<p class="noindent">A few Python functions are helpful when working with lists of numbers. For example, you can easily find the minimum, maximum, and sum of a list of numbers:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">digits = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">min(digits)</span><br class="calibre4" />
0<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">max(digits)</span><br class="calibre4" />
9<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">sum(digits)</span><br class="calibre4" />
45</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The examples in this section use short lists of numbers in order to fit easily on the page. They would work just as well if your list contained a million or more numbers.</em></p>
</div>
<h4 class="h3" id="calibre_link-661"><strong class="calibre2"><em class="calibre3">List Comprehensions</em></strong></h4>
<p class="noindent">The approach described earlier for generating the list <span class="literal">squares</span> consisted of using three or four lines of code. A <em class="calibre3">list comprehension</em> allows you to generate this same list in just one line of code. A list comprehension combines the <span class="literal">for</span> loop and the creation of new elements into one line, and automatically appends each new element. List comprehensions are not always presented to beginners, but I have included them here because you’ll most likely see them as soon as you start looking at other people’s code.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-475" class="calibre"></span>The following example builds the same list of square numbers you saw earlier but uses a list comprehension:</p>
<p class="margin"><em class="calibre3">squares.py</em></p>
<p class="programs">squares = [value**2 for value in range(1, 11)]<br class="calibre4" />
print(squares)</p>
<p class="indent">To use this syntax, begin with a descriptive name for the list, such as <span class="literal">squares</span>. Next, open a set of square brackets and define the expression for the values you want to store in the new list. In this example the expression is <span class="literal">value**2</span>, which raises the value to the second power. Then, write a <span class="literal">for</span> loop to generate the numbers you want to feed into the expression, and close the square brackets. The <span class="literal">for</span> loop in this example is <span class="literal">for value in range(1, 11)</span>, which feeds the values 1 through 10 into the expression <span class="literal">value**2</span>. Notice that no colon is used at the end of the <span class="literal">for</span> statement.</p>
<p class="indent">The result is the same list of square numbers you saw earlier:</p>
<p class="programs">[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]</p>
<p class="indent">It takes practice to write your own list comprehensions, but you’ll find them worthwhile once you become comfortable creating ordinary lists. When you’re writing three or four lines of code to generate lists and it begins to feel repetitive, consider writing your own list comprehensions.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-662"><strong class="calibre2">4-3. Counting to Twenty:</strong> Use a <span class="literal1">for</span> loop to print the numbers from 1 to 20, inclusive.</p>
<p class="sparal" id="calibre_link-663"><strong class="calibre2">4-4. One Million:</strong> Make a list of the numbers from one to one million, and then use a <span class="literal1">for</span> loop to print the numbers. (If the output is taking too long, stop it by pressing <small class="calibre9">CTRL</small>-C or by closing the output window.)</p>
<p class="sparal" id="calibre_link-664"><strong class="calibre2">4-5. Summing a Million:</strong> Make a list of the numbers from one to one million, and then use <span class="literal1">min()</span> and <span class="literal1">max()</span> to make sure your list actually starts at one and ends at one million. Also, use the <span class="literal1">sum()</span> function to see how quickly Python can add a million numbers.</p>
<p class="sparal" id="calibre_link-665"><strong class="calibre2">4-6. Odd Numbers:</strong> Use the third argument of the <span class="literal1">range()</span> function to make a list of the odd numbers from 1 to 20. Use a <span class="literal1">for</span> loop to print each number.</p>
<p class="sparal" id="calibre_link-666"><strong class="calibre2">4-7. Threes:</strong> Make a list of the multiples of 3 from 3 to 30. Use a <span class="literal1">for</span> loop to print the numbers in your list.</p>
<p class="sparal" id="calibre_link-667"><strong class="calibre2">4-8. Cubes:</strong> A number raised to the third power is called a <em class="calibre3">cube</em>. For example, the cube of 2 is written as <span class="literal1">2**3</span> in Python. Make a list of the first 10 cubes (that is, the cube of each integer from 1 through 10), and use a <span class="literal1">for</span> loop to print out the value of each cube.</p>
<p class="sparal" id="calibre_link-668"><strong class="calibre2">4-9. Cube Comprehension:</strong> Use a list comprehension to generate a list of the first 10 cubes.</p>
</div>
<h3 class="h2" id="calibre_link-669"><span type="pagebreak" id="calibre_link-477" class="calibre"></span><strong class="calibre2">Working with Part of a List</strong></h3>
<p class="noindent">In <a href="#calibre_link-56" class="calibre6">Chapter 3</a> you learned how to access single elements in a list, and in this chapter you’ve been learning how to work through all the elements in a list. You can also work with a specific group of items in a list, which Python calls a <em class="calibre3">slice</em>.</p>
<h4 class="h3" id="calibre_link-670"><strong class="calibre2"><em class="calibre3">Slicing a List</em></strong></h4>
<p class="noindent">To make a slice, you specify the index of the first and last elements you want to work with. As with the <span class="literal">range()</span> function, Python stops one item before the second index you specify. To output the first three elements in a list, you would request indices <span class="literal">0</span> through <span class="literal">3</span>, which would return elements <span class="literal">0</span>, <span class="literal">1</span>, and <span class="literal">2</span>.</p>
<p class="indent">The following example involves a list of players on a team:</p>
<p class="margin"><em class="calibre3">players.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;players = ['charles', 'martina', 'michael', 'florence', 'eli']<br class="calibre4" />
<span class="ent">➊</span> print(players[0:3])</p>
<p class="indent">The code at <span class="ent">➊</span> prints a slice of this list, which includes just the first three players. The output retains the structure of the list and includes the first three players in the list:</p>
<p class="programs">['charles', 'martina', 'michael']</p>
<p class="indent">You can generate any subset of a list. For example, if you want the second, third, and fourth items in a list, you would start the slice at index <span class="literal">1</span> and end at index <span class="literal">4</span>:</p>
<p class="programs"><span class="ash">players = ['charles', 'martina', 'michael', 'florence', 'eli']</span><br class="calibre4" />
print(players[1:4])</p>
<p class="indent">This time the slice starts with <span class="literal">'martina'</span> and ends with <span class="literal">'florence'</span>:</p>
<p class="programs">['martina', 'michael', 'florence']</p>
<p class="indent">If you omit the first index in a slice, Python automatically starts your slice at the beginning of the list:</p>
<p class="programs"><span class="ash">players = ['charles', 'martina', 'michael', 'florence', 'eli']</span><br class="calibre4" />
print(players[:4])</p>
<p class="indent">Without a starting index, Python starts at the beginning of the list:</p>
<p class="programs">['charles', 'martina', 'michael', 'florence']</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1315" class="calibre"></span>A similar syntax works if you want a slice that includes the end of a list. For example, if you want all items from the third item through the last item, you can start with index <span class="literal">2</span> and omit the second index:</p>
<p class="programs"><span class="ash">players = ['charles', 'martina', 'michael', 'florence', 'eli']</span><br class="calibre4" />
print(players[2:])</p>
<p class="indent">Python returns all items from the third item through the end of the list:</p>
<p class="programs">['michael', 'florence', 'eli']</p>
<p class="indent">This syntax allows you to output all of the elements from any point in your list to the end regardless of the length of the list. Recall that a negative index returns an element a certain distance from the end of a list; therefore, you can output any slice from the end of a list. For example, if we want to output the last three players on the roster, we can use the slice <span class="literal">players[-3:]</span>:</p>
<p class="programs"><span class="ash">players = ['charles', 'martina', 'michael', 'florence', 'eli']</span><br class="calibre4" />
print(players[-3:])</p>
<p class="indent">This prints the names of the last three players and would continue to work as the list of players changes in size.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You can include a third value in the brackets indicating a slice. If a third value is included, this tells Python how many items to skip between items in the specified range.</em></p>
</div>
<h4 class="h3" id="calibre_link-671"><strong class="calibre2"><em class="calibre3">Looping Through a Slice</em></strong></h4>
<p class="noindent">You can use a slice in a <span class="literal">for</span> loop if you want to loop through a subset of the elements in a list. In the next example we loop through the first three players and print their names as part of a simple roster:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;players = ['charles', 'martina', 'michael', 'florence', 'eli']<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("Here are the first three players on my team:")<br class="calibre4" />
<span class="ent">➊</span> for player in players[:3]:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(player.title())</p>
<p class="indent">Instead of looping through the entire list of players at <span class="ent">➊</span>, Python loops through only the first three names:</p>
<p class="programs">Here are the first three players on my team:<br class="calibre4" />
Charles<br class="calibre4" />
Martina<br class="calibre4" />
Michael</p>
<p class="indent">Slices are very useful in a number of situations. For instance, when you’re creating a game, you could add a player’s final score to a list every time that <span type="pagebreak" id="calibre_link-386" class="calibre"></span>player finishes playing. You could then get a player’s top three scores by sorting the list in decreasing order and taking a slice that includes just the first three scores. When you’re working with data, you can use slices to process your data in chunks of a specific size. Or, when you’re building a web application, you could use slices to display information in a series of pages with an appropriate amount of information on each page.</p>
<h4 class="h3" id="calibre_link-672"><strong class="calibre2"><em class="calibre3">Copying a List</em></strong></h4>
<p class="noindent">Often, you’ll want to start with an existing list and make an entirely new list based on the first one. Let’s explore how copying a list works and examine one situation in which copying a list is useful.</p>
<p class="indent">To copy a list, you can make a slice that includes the entire original list by omitting the first index and the second index (<span class="literal">[:]</span>). This tells Python to make a slice that starts at the first item and ends with the last item, producing a copy of the entire list.</p>
<p class="indent">For example, imagine we have a list of our favorite foods and want to make a separate list of foods that a friend likes. This friend likes everything in our list so far, so we can create their list by copying ours:</p>
<p class="margin"><em class="calibre3">foods.py</em></p>
<p class="programs"><span class="ent">➊</span> my_foods = ['pizza', 'falafel', 'carrot cake']<br class="calibre4" />
<span class="ent">➋</span> friend_foods = my_foods[:]<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("My favorite foods are:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_foods)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("\nMy friend's favorite foods are:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(friend_foods)</p>
<p class="indent">At <span class="ent">➊</span> we make a list of the foods we like called <span class="literal">my_foods</span>. At <span class="ent">➋</span> we make a new list called <span class="literal">friend_foods</span>. We make a copy of <span class="literal">my_foods</span> by asking for a slice of <span class="literal">my_foods</span> without specifying any indices and store the copy in <span class="literal">friend_foods</span>. When we print each list, we see that they both contain the same foods:</p>
<p class="programs">My favorite foods are:<br class="calibre4" />
['pizza', 'falafel', 'carrot cake']<br class="calibre4" />
<br class="calibre4" />
My friend's favorite foods are:<br class="calibre4" />
['pizza', 'falafel', 'carrot cake']</p>
<p class="indent">To prove that we actually have two separate lists, we’ll add a new food to each list and show that each list keeps track of the appropriate person’s favorite foods:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">my_foods = ['pizza', 'falafel', 'carrot cake']</span><br class="calibre4" />
<span class="ent">➊</span> <span class="ash">friend_foods = my_foods[:]</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> my_foods.append('cannoli')<br class="calibre4" />
<span class="ent">➌</span> friend_foods.append('ice cream')<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1316" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash">print("My favorite foods are:")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_foods)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print("\nMy friend's favorite foods are:")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(friend_foods)</span></p>
<p class="indent">At <span class="ent">➊</span> we copy the original items in <span class="literal">my_foods</span> to the new list <span class="literal">friend_foods</span>, as we did in the previous example. Next, we add a new food to each list: at <span class="ent">➋</span> we add <span class="literal">'cannoli'</span> to <span class="literal">my_foods</span>, and at <span class="ent">➌</span> we add <span class="literal">'ice cream'</span> to <span class="literal">friend_foods</span>. We then print the two lists to see whether each of these foods is in the appropriate list.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;My favorite foods are:<br class="calibre4" />
<span class="ent">➍</span> ['pizza', 'falafel', 'carrot cake', 'cannoli']<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;My friend's favorite foods are:<br class="calibre4" />
<span class="ent">➎</span> ['pizza', 'falafel', 'carrot cake', 'ice cream']</p>
<p class="indent">The output at <span class="ent">➍</span> shows that <span class="literal">'cannoli'</span> now appears in our list of favorite foods but <span class="literal">'ice cream'</span> doesn’t. At <span class="ent">➎</span> we can see that <span class="literal">'ice cream'</span> now appears in our friend’s list but <span class="literal">'cannoli'</span> doesn’t. If we had simply set <span class="literal">friend_foods</span> equal to <span class="literal">my_foods</span>, we would not produce two separate lists. For example, here’s what happens when you try to copy a list without using a slice:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">my_foods = ['pizza', 'falafel', 'carrot cake']</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# This doesn't work:<br class="calibre4" />
<span class="ent">➊</span> friend_foods = my_foods<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_foods.append('cannoli')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">friend_foods.append('ice cream')</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print("My favorite foods are:")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_foods)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print("\nMy friend's favorite foods are:")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(friend_foods)</span></p>
<p class="indent">Instead of storing a copy of <span class="literal">my_foods</span> in <span class="literal">friend_foods</span> at <span class="ent">➊</span>, we set <span class="literal">friend_foods</span> equal to <span class="literal">my_foods</span>. This syntax actually tells Python to associate the new variable <span class="literal">friend_foods</span> with the list that is already associated with <span class="literal">my_foods</span>, so now both variables point to the same list. As a result, when we add <span class="literal">'cannoli'</span> to <span class="literal">my_foods</span>, it will also appear in <span class="literal">friend_foods</span>. Likewise <span class="literal">'ice cream'</span> will appear in both lists, even though it appears to be added only to <span class="literal">friend_foods</span>.</p>
<p class="indent">The output shows that both lists are the same now, which is not what we wanted:</p>
<p class="programs">My favorite foods are:<br class="calibre4" />
['pizza', 'falafel', 'carrot cake', 'cannoli', 'ice cream']<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-387" class="calibre"></span>My friend's favorite foods are:<br class="calibre4" />
['pizza', 'falafel', 'carrot cake', 'cannoli', 'ice cream']</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Don’t worry about the details in this example for now. Basically, if you’re trying to work with a copy of a list and you see unexpected behavior, make sure you are copying the list using a slice, as we did in the first example.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-673"><strong class="calibre2">4-10. Slices:</strong> Using one of the programs you wrote in this chapter, add several lines to the end of the program that do the following:</p>
<ul class="calibre8">
<li class="noindent1">Print the message <em class="calibre3">The first three items in the list are:</em>. Then use a slice to print the first three items from that program’s list.</li>
<li class="noindent1">Print the message <em class="calibre3">Three items from the middle of the list are:</em>. Use a slice to print three items from the middle of the list.</li>
<li class="noindent1">Print the message <em class="calibre3">The last three items in the list are:</em>. Use a slice to print the last three items in the list.</li>
</ul>
<p class="sparal" id="calibre_link-674"><strong class="calibre2">4-11. My Pizzas, Your Pizzas:</strong> Start with your program from <a href="#calibre_link-59" class="calibre6">Exercise 4-1</a> (<a href="#calibre_link-60" class="calibre6">page 56</a>). Make a copy of the list of pizzas, and call it <span class="literal1">friend_pizzas</span>. Then, do the following:</p>
<ul class="calibre8">
<li class="noindent1">Add a new pizza to the original list.</li>
<li class="noindent1">Add a different pizza to the list <span class="literal">friend_pizzas</span>.</li>
<li class="noindent1">Prove that you have two separate lists. Print the message <em class="calibre3">My favorite pizzas are:</em>, and then use a <span class="literal">for</span> loop to print the first list. Print the message <em class="calibre3">My friend’s favorite pizzas are:</em>, and then use a <span class="literal">for</span> loop to print the second list. Make sure each new pizza is stored in the appropriate list.</li>
</ul>
<p class="sparal" id="calibre_link-675"><strong class="calibre2">4-12. More Loops:</strong> All versions of <em class="calibre3">foods.py</em> in this section have avoided using <span class="literal1">for</span> loops when printing to save space. Choose a version of <em class="calibre3">foods.py</em>, and write two <span class="literal1">for</span> loops to print each list of foods.</p>
</div>
<h3 class="h2" id="calibre_link-676"><strong class="calibre2">Tuples</strong></h3>
<p class="noindent">Lists work well for storing collections of items that can change throughout the life of a program. The ability to modify lists is particularly important when you’re working with a list of users on a website or a list of characters in a game. However, sometimes you’ll want to create a list of items that cannot change. Tuples allow you to do just that. Python refers to values that cannot change as <em class="calibre3">immutable</em>, and an immutable list is called a <em class="calibre3">tuple</em>.</p>
<h4 class="h3" id="calibre_link-677"><span type="pagebreak" id="calibre_link-307" class="calibre"></span><strong class="calibre2"><em class="calibre3">Defining a Tuple</em></strong></h4>
<p class="noindent">A tuple looks just like a list except you use parentheses instead of square brackets. Once you define a tuple, you can access individual elements by using each item’s index, just as you would for a list.</p>
<p class="indent">For example, if we have a rectangle that should always be a certain size, we can ensure that its size doesn’t change by putting the dimensions into a tuple:</p>
<p class="margin"><em class="calibre3">dimensions.py</em></p>
<p class="programs"><span class="ent">➊</span> dimensions = (200, 50)<br class="calibre4" />
<span class="ent">➋</span> print(dimensions[0])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(dimensions[1])</p>
<p class="indent">We define the tuple <span class="literal">dimensions</span> at <span class="ent">➊</span>, using parentheses instead of square brackets. At <span class="ent">➋</span> we print each element in the tuple individually, using the same syntax we’ve been using to access elements in a list:</p>
<p class="programs">200<br class="calibre4" />
50</p>
<p class="indent">Let’s see what happens if we try to change one of the items in the tuple <span class="literal">dimensions</span>:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">dimensions = (200, 50)</span><br class="calibre4" />
<span class="ent">➊</span> dimensions[0] = 250</p>
<p class="indent">The code at <span class="ent">➊</span> tries to change the value of the first dimension, but Python returns a type error. Basically, because we’re trying to alter a tuple, which can’t be done to that type of object, Python tells us we can’t assign a new value to an item in a tuple:</p>
<p class="programs">Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;File "dimensions.py", line 2, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;dimensions[0] = 250<br class="calibre4" />
TypeError: 'tuple' object does not support item assignment</p>
<p class="indent">This is beneficial because we want Python to raise an error when a line of code tries to change the dimensions of the rectangle.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Tuples are technically defined by the presence of a comma; the parentheses make them look neater and more readable. If you want to define a tuple with one element, you need to include a trailing comma:</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;my_t = (3,)</p>
<p class="notepi"><em class="calibre3">It doesn’t often make sense to build a tuple with one element, but this can happen when tuples are generated automatically.</em></p>
</div>
<h4 class="h3" id="calibre_link-678"><span type="pagebreak" id="calibre_link-308" class="calibre"></span><strong class="calibre2"><em class="calibre3">Looping Through All Values in a Tuple</em></strong></h4>
<p class="noindent">You can loop over all the values in a tuple using a <span class="literal">for</span> loop, just as you did with a list:</p>
<p class="programs"><span class="ash">dimensions = (200, 50)</span><br class="calibre4" />
for dimension in dimensions:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(dimension)</p>
<p class="indent">Python returns all the elements in the tuple, just as it would for a list:</p>
<p class="programs">200<br class="calibre4" />
50</p>
<h4 class="h3" id="calibre_link-679"><strong class="calibre2"><em class="calibre3">Writing over a Tuple</em></strong></h4>
<p class="noindent">Although you can’t modify a tuple, you can assign a new value to a variable that represents a tuple. So if we wanted to change our dimensions, we could redefine the entire tuple:</p>
<p class="programs"><span class="ent">➊</span> <span class="ash">dimensions = (200, 50)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("Original dimensions:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for dimension in dimensions:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(dimension)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> dimensions = (400, 100)<br class="calibre4" />
<span class="ent">➌</span> print("\nModified dimensions:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for dimension in dimensions:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(dimension)</p>
<p class="indent">The lines starting at <span class="ent">➊</span> define the original tuple and print the initial dimensions. At <span class="ent">➋</span>, we associate a new tuple with the variable <span class="literal">dimensions</span>. We then print the new dimensions at <span class="ent">➌</span>. Python doesn’t raise any errors this time, because reassigning a variable is valid:</p>
<p class="programs">Original dimensions:<br class="calibre4" />
200<br class="calibre4" />
50<br class="calibre4" />
<br class="calibre4" />
Modified dimensions:<br class="calibre4" />
400<br class="calibre4" />
100</p>
<p class="indent">When compared with lists, tuples are simple data structures. Use them when you want to store a set of values that should not be changed throughout the life of a program.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-515" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-680"><strong class="calibre2">4-13. Buffet:</strong> A buffet-style restaurant offers only five basic foods. Think of five simple foods, and store them in a tuple.</p>
<ul class="calibre8">
<li class="noindent1">Use a <span class="literal">for</span> loop to print each food the restaurant offers.</li>
<li class="noindent1">Try to modify one of the items, and make sure that Python rejects the change.</li>
<li class="noindent1">The restaurant changes its menu, replacing two of the items with different foods. Add a line that rewrites the tuple, and then use a <span class="literal">for</span> loop to print each of the items on the revised menu.</li>
</ul>
</div>
<h3 class="h2" id="calibre_link-681"><strong class="calibre2">Styling Your Code</strong></h3>
<p class="noindent">Now that you’re writing longer programs, ideas about how to style your code are worthwhile to know. Take the time to make your code as easy as possible to read. Writing easy-to-read code helps you keep track of what your programs are doing and helps others understand your code as well.</p>
<p class="indent">Python programmers have agreed on a number of styling conventions to ensure that everyone’s code is structured in roughly the same way. Once you’ve learned to write clean Python code, you should be able to understand the overall structure of anyone else’s Python code, as long as they follow the same guidelines. If you’re hoping to become a professional programmer at some point, you should begin following these guidelines as soon as possible to develop good habits.</p>
<h4 class="h3" id="calibre_link-682"><strong class="calibre2"><em class="calibre3">The Style Guide</em></strong></h4>
<p class="noindent">When someone wants to make a change to the Python language, they write a <em class="calibre3">Python Enhancement Proposal (PEP)</em>. One of the oldest PEPs is <em class="calibre3">PEP 8</em>, which instructs Python programmers on how to style their code. PEP 8 is fairly lengthy, but much of it relates to more complex coding structures than what you’ve seen so far.</p>
<p class="indent">The Python style guide was written with the understanding that code is read more often than it is written. You’ll write your code once and then start reading it as you begin debugging. When you add features to a program, you’ll spend more time reading your code. When you share your code with other programmers, they’ll read your code as well.</p>
<p class="indent">Given the choice between writing code that’s easier to write or code that’s easier to read, Python programmers will almost always encourage you to write code that’s easier to read. The following guidelines will help you write clear code from the start.</p>
<h4 class="h3" id="calibre_link-683"><span type="pagebreak" id="calibre_link-550" class="calibre"></span><strong class="calibre2"><em class="calibre3">Indentation</em></strong></h4>
<p class="noindent">PEP 8 recommends that you use four spaces per indentation level. Using four spaces improves readability while leaving room for multiple levels of indentation on each line.</p>
<p class="indent">In a word processing document, people often use tabs rather than spaces to indent. This works well for word processing documents, but the Python interpreter gets confused when tabs are mixed with spaces. Every text editor provides a setting that lets you use the <small class="calibre5">TAB</small> key but then converts each tab to a set number of spaces. You should definitely use your <small class="calibre5">TAB</small> key, but also make sure your editor is set to insert spaces rather than tabs into your document.</p>
<p class="indent">Mixing tabs and spaces in your file can cause problems that are very difficult to diagnose. If you think you have a mix of tabs and spaces, you can convert all tabs in a file to spaces in most editors.</p>
<h4 class="h3" id="calibre_link-684"><strong class="calibre2"><em class="calibre3">Line Length</em></strong></h4>
<p class="noindent">Many Python programmers recommend that each line should be less than 80 characters. Historically, this guideline developed because most computers could fit only 79 characters on a single line in a terminal window. Currently, people can fit much longer lines on their screens, but other reasons exist to adhere to the 79-character standard line length. Professional programmers often have several files open on the same screen, and using the standard line length allows them to see entire lines in two or three files that are open side by side onscreen. PEP 8 also recommends that you limit all of your comments to 72 characters per line, because some of the tools that generate automatic documentation for larger projects add formatting characters at the beginning of each commented line.</p>
<p class="indent">The PEP 8 guidelines for line length are not set in stone, and some teams prefer a 99-character limit. Don’t worry too much about line length in your code as you’re learning, but be aware that people who are working collaboratively almost always follow the PEP 8 guidelines. Most editors allow you to set up a visual cue, usually a vertical line on your screen, that shows you where these limits are.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3"><a href="#calibre_link-2" class="calibre6">Appendix B</a> shows you how to configure your text editor so it always inserts four spaces each time you press the <small class="calibre5">TAB</small> key and shows a vertical guideline to help you follow the 79-character limit.</em></p>
</div>
<h4 class="h3" id="calibre_link-685"><strong class="calibre2"><em class="calibre3">Blank Lines</em></strong></h4>
<p class="noindent">To group parts of your program visually, use blank lines. You should use blank lines to organize your files, but don’t do so excessively. By following the examples provided in this book, you should strike the right balance. For example, if you have five lines of code that build a list, and then another three lines that do something with that list, it’s appropriate to place a blank line between the two sections. However, you should not place three or four blank lines between the two sections.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-516" class="calibre"></span>Blank lines won’t affect how your code runs, but they will affect the readability of your code. The Python interpreter uses horizontal indentation to interpret the meaning of your code, but it disregards vertical spacing.</p>
<h4 class="h3" id="calibre_link-686"><strong class="calibre2"><em class="calibre3">Other Style Guidelines</em></strong></h4>
<p class="noindent">PEP 8 has many additional styling recommendations, but most of the guidelines refer to more complex programs than what you’re writing at this point. As you learn more complex Python structures, I’ll share the relevant parts of the PEP 8 guidelines.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-687"><strong class="calibre2">4-14. PEP 8:</strong> Look through the original PEP 8 style guide at <em class="calibre3"><a href="https://python.org/dev/peps/pep-0008/" class="calibre6">https://python.org/dev/peps/pep-0008/</a></em>. You won’t use much of it now, but it might be interesting to skim through it.</p>
<p class="sparal" id="calibre_link-688"><strong class="calibre2">4-15. Code Review:</strong> Choose three of the programs you’ve written in this chapter and modify each one to comply with PEP 8:</p>
<ul class="calibre8">
<li class="noindent1">Use four spaces for each indentation level. Set your text editor to insert four spaces every time you press <small class="calibre5">TAB</small>, if you haven’t already done so (see <a href="#calibre_link-2" class="calibre6">Appendix B</a> for instructions on how to do this).</li>
<li class="noindent1">Use less than 80 characters on each line, and set your editor to show a vertical guideline at the 80th character position.</li>
<li class="noindent1">Don’t use blank lines excessively in your program files.</li>
</ul>
</div>
<h3 class="h2" id="calibre_link-689"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned how to work efficiently with the elements in a list. You learned how to work through a list using a <span class="literal">for</span> loop, how Python uses indentation to structure a program, and how to avoid some common indentation errors. You learned to make simple numerical lists, as well as a few operations you can perform on numerical lists. You learned how to slice a list to work with a subset of items and how to copy lists properly using a slice. You also learned about tuples, which provide a degree of protection to a set of values that shouldn’t change, and how to style your increasingly complex code to make it easy to read.</p>
<p class="indent">In <a href="#calibre_link-61" class="calibre6">Chapter 5</a>, you’ll learn to respond appropriately to different conditions by using <span class="literal">if</span> statements. You’ll learn to string together relatively complex sets of conditional tests to respond appropriately to exactly the kind of situation or information you’re looking for. You’ll also learn to use <span class="literal">if</span> statements while looping through a list to take specific actions with selected elements from a list.</p>
</div>


<div class="calibre1" id="calibre_link-147">
<h2 class="h" id="calibre_link-61"><span type="pagebreak" id="calibre_link-1317" class="calibre"></span><strong class="calibre2"><span class="big">5</span><br class="calibre4" />IF STATEMENTS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Programming often involves examining a set of conditions and deciding which action to take based on those conditions. Python’s <span class="literal">if</span> statement allows you to examine the current state of a program and respond appropriately to that state.</p>
<p class="indent">In this chapter you’ll learn to write conditional tests, which allow you to check any condition of interest. You’ll learn to write simple <span class="literal">if</span> statements, and you’ll learn how to create a more complex series of <span class="literal">if</span> statements to identify when the exact conditions you want are present. You’ll then apply this concept to lists, so you’ll be able to write a <span class="literal">for</span> loop that handles most items in a list one way but handles certain items with specific values in a different way.</p>
<h3 class="h2" id="calibre_link-690"><span type="pagebreak" id="calibre_link-172" class="calibre"></span><strong class="calibre2">A Simple Example</strong></h3>
<p class="noindent">The following short example shows how <span class="literal">if</span> tests let you respond to special situations correctly. Imagine you have a list of cars and you want to print out the name of each car. Car names are proper names, so the names of most cars should be printed in title case. However, the value <span class="literal">'bmw'</span> should be printed in all uppercase. The following code loops through a list of car names and looks for the value <span class="literal">'bmw'</span>. Whenever the value is <span class="literal">'bmw'</span>, it’s printed in uppercase instead of title case:</p>
<p class="margin"><em class="calibre3">cars.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;cars = ['audi', 'bmw', 'subaru', 'toyota']<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for car in cars:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if car == 'bmw':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(car.upper())<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(car.title())</p>
<p class="indent">The loop in this example first checks if the current value of <span class="literal">car</span> is <span class="literal">'bmw'</span> <span class="ent">➊</span>. If it is, the value is printed in uppercase. If the value of <span class="literal">car</span> is anything other than <span class="literal">'bmw'</span>, it’s printed in title case:</p>
<p class="programs">Audi<br class="calibre4" />
BMW<br class="calibre4" />
Subaru<br class="calibre4" />
Toyota</p>
<p class="indent">This example combines a number of the concepts you’ll learn about in this chapter. Let’s begin by looking at the kinds of tests you can use to examine the conditions in your program.</p>
<h3 class="h2" id="calibre_link-691"><strong class="calibre2">Conditional Tests</strong></h3>
<p class="noindent">At the heart of every <span class="literal">if</span> statement is an expression that can be evaluated as <span class="literal">True</span> or <span class="literal">False</span> and is called a <em class="calibre3">conditional test</em>. Python uses the values <span class="literal">True</span> and <span class="literal">False</span> to decide whether the code in an <span class="literal">if</span> statement should be executed. If a conditional test evaluates to <span class="literal">True</span>, Python executes the code following the <span class="literal">if</span> statement. If the test evaluates to <span class="literal">False</span>, Python ignores the code following the <span class="literal">if</span> statement.</p>
<h4 class="h3" id="calibre_link-692"><strong class="calibre2"><em class="calibre3">Checking for Equality</em></strong></h4>
<p class="noindent">Most conditional tests compare the current value of a variable to a specific value of interest. The simplest conditional test checks whether the value of a variable is equal to the value of interest:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">car = 'bmw'</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">car == 'bmw'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;True</p>
<p class="indent"><span type="pagebreak" id="calibre_link-173" class="calibre"></span>The line at <span class="ent">➊</span> sets the value of <span class="literal">car</span> to <span class="literal">'bmw'</span> using a single equal sign, as you’ve seen many times already. The line at <span class="ent">➋</span> checks whether the value of <span class="literal">car</span> is <span class="literal">'bmw'</span> using a double equal sign (<span class="literal">==</span>). This <em class="calibre3">equality operator</em> returns <span class="literal">True</span> if the values on the left and right side of the operator match, and <span class="literal">False</span> if they don’t match. The values in this example match, so Python returns <span class="literal">True</span>.</p>
<p class="indent">When the value of <span class="literal">car</span> is anything other than <span class="literal">'bmw'</span>, this test returns <span class="literal">False</span>:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">car = 'audi'</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">car == 'bmw'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;False</p>
<p class="indent">A single equal sign is really a statement; you might read the code at <span class="ent">➊</span> as “Set the value of car equal to <span class="literal">'audi'</span>.” On the other hand, a double equal sign, like the one at <span class="ent">➋</span>, asks a question: “Is the value of car equal to <span class="literal">'bmw'</span>?” Most programming languages use equal signs in this way.</p>
<h4 class="h3" id="calibre_link-693"><strong class="calibre2"><em class="calibre3">Ignoring Case When Checking for Equality</em></strong></h4>
<p class="noindent">Testing for equality is case sensitive in Python. For example, two values with different capitalization are not considered equal:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">car = 'Audi'</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">car == 'audi'</span><br class="calibre4" />
False</p>
<p class="indent">If case matters, this behavior is advantageous. But if case doesn’t matter and instead you just want to test the value of a variable, you can convert the variable’s value to lowercase before doing the comparison:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">car = 'Audi'</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">car.lower() == 'audi'</span><br class="calibre4" />
True</p>
<p class="indent">This test would return <span class="literal">True</span> no matter how the value <span class="literal">'Audi'</span> is formatted because the test is now case insensitive. The <span class="literal">lower()</span> function doesn’t change the value that was originally stored in <span class="literal">car</span>, so you can do this kind of comparison without affecting the original variable:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">car = 'Audi'</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">car.lower() == 'audi'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;True<br class="calibre4" />
<span class="ent">➌</span> &gt;&gt;&gt; <span class="codestrong">car</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;'Audi'</p>
<p class="indent">At <span class="ent">➊</span> we assign the capitalized string <span class="literal">'Audi'</span> to the variable <span class="literal">car</span>. At <span class="ent">➋</span> we convert the value of <span class="literal">car</span> to lowercase and compare the lowercase value <span type="pagebreak" id="calibre_link-177" class="calibre"></span>to the string <span class="literal">'audi'</span>. The two strings match, so Python returns <span class="literal">True</span>. At <span class="ent">➌</span> we can see that the value stored in <span class="literal">car</span> has not been affected by the <span class="literal">lower()</span> method.</p>
<p class="indent">Websites enforce certain rules for the data that users enter in a manner similar to this. For example, a site might use a conditional test like this to ensure that every user has a truly unique username, not just a variation on the capitalization of another person’s username. When someone submits a new username, that new username is converted to lowercase and compared to the lowercase versions of all existing usernames. During this check, a username like <span class="literal">'John'</span> will be rejected if any variation of <span class="literal">'john'</span> is already in use.</p>
<h4 class="h3" id="calibre_link-694"><strong class="calibre2"><em class="calibre3">Checking for Inequality</em></strong></h4>
<p class="noindent">When you want to determine whether two values are not equal, you can combine an exclamation point and an equal sign (<span class="literal">!=</span>). The exclamation point represents <em class="calibre3">not</em>, as it does in many programming languages.</p>
<p class="indent">Let’s use another <span class="literal">if</span> statement to examine how to use the inequality operator. We’ll store a requested pizza topping in a variable and then print a message if the person did not order anchovies:</p>
<p class="margin"><em class="calibre3">toppings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;requested_topping = 'mushrooms'<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> if requested_topping != 'anchovies':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Hold the anchovies!")</p>
<p class="indent">The line at <span class="ent">➊</span> compares the value of <span class="literal">requested_topping</span> to the value <span class="literal">'anchovies'</span>. If these two values do not match, Python returns <span class="literal">True</span> and executes the code following the <span class="literal">if</span> statement. If the two values match, Python returns <span class="literal">False</span> and does not run the code following the <span class="literal">if</span> statement.</p>
<p class="indent">Because the value of <span class="literal">requested_topping</span> is not <span class="literal">'anchovies'</span>, the <span class="literal">print()</span> function is executed:</p>
<p class="programs">Hold the anchovies!</p>
<p class="indent">Most of the conditional expressions you write will test for equality, but sometimes you’ll find it more efficient to test for inequality.</p>
<h4 class="h3" id="calibre_link-695"><strong class="calibre2"><em class="calibre3">Numerical Comparisons</em></strong></h4>
<p class="noindent">Testing numerical values is pretty straightforward. For example, the following code checks whether a person is 18 years old:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">age = 18</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">age == 18</span><br class="calibre4" />
True</p>
<p class="indent"><span type="pagebreak" id="calibre_link-175" class="calibre"></span>You can also test to see if two numbers are not equal. For example, the following code prints a message if the given answer is not correct:</p>
<p class="margin"><em class="calibre3">magic_number.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;answer = 17<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> if answer != 42:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("That is not the correct answer. Please try again!")</p>
<p class="indent">The conditional test at <span class="ent">➊</span> passes, because the value of <span class="literal">answer</span> (<span class="literal">17</span>) is not equal to <span class="literal">42</span>. Because the test passes, the indented code block is executed:</p>
<p class="programs">That is not the correct answer. Please try again!</p>
<p class="indent">You can include various mathematical comparisons in your conditional statements as well, such as less than, less than or equal to, greater than, and greater than or equal to:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">age = 19</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">age &lt; 21</span><br class="calibre4" />
True<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">age &lt;= 21</span><br class="calibre4" />
True<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">age &gt; 21</span><br class="calibre4" />
False<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">age &gt;= 21</span><br class="calibre4" />
False</p>
<p class="indent">Each mathematical comparison can be used as part of an <span class="literal">if</span> statement, which can help you detect the exact conditions of interest.</p>
<h4 class="h3" id="calibre_link-696"><strong class="calibre2"><em class="calibre3">Checking Multiple Conditions</em></strong></h4>
<p class="noindent">You may want to check multiple conditions at the same time. For example, sometimes you might need two conditions to be <span class="literal">True</span> to take an action. Other times you might be satisfied with just one condition being <span class="literal">True</span>. The keywords <span class="literal">and</span> and <span class="literal">or</span> can help you in these situations.</p>
<h5 class="h4" id="calibre_link-1318"><strong class="calibre2">Using and to Check Multiple Conditions</strong></h5>
<p class="noindent">To check whether two conditions are both <span class="literal">True</span> simultaneously, use the keyword <span class="literal">and</span> to combine the two conditional tests; if each test passes, the overall expression evaluates to <span class="literal">True</span>. If either test fails or if both tests fail, the expression evaluates to <span class="literal">False</span>.</p>
<p class="indent">For example, you can check whether two people are both over 21 using the following test:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">age_0 = 22</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">age_1 = 18</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">age_0 &gt;= 21 and age_1 &gt;= 21</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;False<br class="calibre4" />
<span type="pagebreak" id="calibre_link-443" class="calibre"></span><span class="ent">➌</span> &gt;&gt;&gt; <span class="codestrong">age_1 = 22</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">age_0 &gt;= 21 and age_1 &gt;= 21</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;True</p>
<p class="indent">At <span class="ent">➊</span> we define two ages, <span class="literal">age_0</span> and <span class="literal">age_1</span>. At <span class="ent">➋</span> we check whether both ages are 21 or older. The test on the left passes, but the test on the right fails, so the overall conditional expression evaluates to <span class="literal">False</span>. At <span class="ent">➌</span> we change <span class="literal">age_1</span> to 22. The value of <span class="literal">age_1</span> is now greater than 21, so both individual tests pass, causing the overall conditional expression to evaluate as <span class="literal">True</span>.</p>
<p class="indent">To improve readability, you can use parentheses around the individual tests, but they are not required. If you use parentheses, your test would look like this:</p>
<p class="programs">(age_0 &gt;= 21) and (age_1 &gt;= 21)</p>
<h5 class="h4" id="calibre_link-1319"><strong class="calibre2">Using or to Check Multiple Conditions</strong></h5>
<p class="noindent">The keyword <span class="literal">or</span> allows you to check multiple conditions as well, but it passes when either or both of the individual tests pass. An <span class="literal">or</span> expression fails only when both individual tests fail.</p>
<p class="indent">Let’s consider two ages again, but this time we’ll look for only one person to be over 21:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">age_0 = 22</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">age_1 = 18</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">age_0 &gt;= 21 or age_1 &gt;= 21</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;True<br class="calibre4" />
<span class="ent">➌</span> &gt;&gt;&gt; <span class="codestrong">age_0 = 18</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">age_0 &gt;= 21 or age_1 &gt;= 21</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;False</p>
<p class="indent">We start with two age variables again at <span class="ent">➊</span>. Because the test for <span class="literal">age_0</span> at <span class="ent">➋</span> passes, the overall expression evaluates to <span class="literal">True</span>. We then lower <span class="literal">age_0</span> to 18. In the test at <span class="ent">➌</span>, both tests now fail and the overall expression evaluates to <span class="literal">False</span>.</p>
<h4 class="h3" id="calibre_link-697"><strong class="calibre2"><em class="calibre3">Checking Whether a Value Is in a List</em></strong></h4>
<p class="noindent">Sometimes it’s important to check whether a list contains a certain value before taking an action. For example, you might want to check whether a new username already exists in a list of current usernames before completing someone’s registration on a website. In a mapping project, you might want to check whether a submitted location already exists in a list of known locations.</p>
<p class="indent">To find out whether a particular value is already in a list, use the keyword <span class="literal">in</span>. Let’s consider some code you might write for a pizzeria. We’ll make a list of toppings a customer has requested for a pizza and then check whether certain toppings are in the list.</p>
<p class="programs"><span type="pagebreak" id="calibre_link-248" class="calibre"></span>&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">requested_toppings = ['mushrooms', 'onions', 'pineapple']</span><br class="calibre4" />
<span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">'mushrooms' in requested_toppings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;True<br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">'pepperoni' in requested_toppings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;False</p>
<p class="indent">At <span class="ent">➊</span> and <span class="ent">➋</span>, the keyword <span class="literal">in</span> tells Python to check for the existence of <span class="literal">'mushrooms'</span> and <span class="literal">'pepperoni'</span> in the list <span class="literal">requested_toppings</span>. This technique is quite powerful because you can create a list of essential values, and then easily check whether the value you’re testing matches one of the values in the list.</p>
<h4 class="h3" id="calibre_link-698"><strong class="calibre2"><em class="calibre3">Checking Whether a Value Is Not in a List</em></strong></h4>
<p class="noindent">Other times, it’s important to know if a value does not appear in a list. You can use the keyword <span class="literal">not</span> in this situation. For example, consider a list of users who are banned from commenting in a forum. You can check whether a user has been banned before allowing that person to submit a comment:</p>
<p class="margin"><em class="calibre3">banned_users.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;banned_users = ['andrew', 'carolina', 'david']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;user = 'marie'<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> if user not in banned_users:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{user.title()}, you can post a response if you wish.")</p>
<p class="indent">The line at <span class="ent">➊</span> reads quite clearly. If the value of <span class="literal">user</span> is not in the list <span class="literal">banned_users</span>, Python returns <span class="literal">True</span> and executes the indented line.</p>
<p class="indent">The user <span class="literal">'marie'</span> is not in the list <span class="literal">banned_users</span>, so she sees a message inviting her to post a response:</p>
<p class="programs">Marie, you can post a response if you wish.</p>
<h4 class="h3" id="calibre_link-699"><strong class="calibre2"><em class="calibre3">Boolean Expressions</em></strong></h4>
<p class="noindent">As you learn more about programming, you’ll hear the term <em class="calibre3">Boolean expression</em> at some point. A Boolean expression is just another name for a conditional test. A <em class="calibre3">Boolean value</em> is either <span class="literal">True</span> or <span class="literal">False</span>, just like the value of a conditional expression after it has been evaluated.</p>
<p class="indent">Boolean values are often used to keep track of certain conditions, such as whether a game is running or whether a user can edit certain content on a website:</p>
<p class="programs">game_active = True<br class="calibre4" />
can_edit = False</p>
<p class="indent">Boolean values provide an efficient way to track the state of a program or a particular condition that is important in your program.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-448" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-700"><strong class="calibre2">5-1. Conditional Tests:</strong> Write a series of conditional tests. Print a statement describing each test and your prediction for the results of each test. Your code should look something like this:</p>
<p class="programs">car = 'subaru'<br class="calibre4" />
print("Is car == 'subaru'? I predict True.")<br class="calibre4" />
print(car == 'subaru')<br class="calibre4" />
<br class="calibre4" />
print("\nIs car == 'audi'? I predict False.")<br class="calibre4" />
print(car == 'audi')</p>
<ul class="calibre8">
<li class="noindent1">Look closely at your results, and make sure you understand why each line evaluates to <span class="literal">True</span> or <span class="literal">False</span>.</li>
<li class="noindent1">Create at least ten tests. Have at least five tests evaluate to <span class="literal">True</span> and another five tests evaluate to <span class="literal">False</span>.</li>
</ul>
<p class="sparal" id="calibre_link-701"><strong class="calibre2">5-2. More Conditional Tests:</strong> You don’t have to limit the number of tests you create to ten. If you want to try more comparisons, write more tests and add them to <em class="calibre3">conditional_tests.py</em>. Have at least one <span class="literal1">True</span> and one <span class="literal1">False</span> result for each of the following:</p>
<ul class="calibre8">
<li class="noindent1">Tests for equality and inequality with strings</li>
<li class="noindent1">Tests using the <span class="literal">lower()</span> method</li>
<li class="noindent1">Numerical tests involving equality and inequality, greater than and less than, greater than or equal to, and less than or equal to</li>
<li class="noindent1">Tests using the <span class="literal">and</span> keyword and the <span class="literal">or</span> keyword</li>
<li class="noindent1">Test whether an item is in a list</li>
<li class="noindent1">Test whether an item is not in a list</li>
</ul>
</div>
<h3 class="h2" id="calibre_link-702"><strong class="calibre2">if Statements</strong></h3>
<p class="noindent">When you understand conditional tests, you can start writing <span class="literal">if</span> statements. Several different kinds of <span class="literal">if</span> statements exist, and your choice of which to use depends on the number of conditions you need to test. You saw several examples of <span class="literal">if</span> statements in the discussion about conditional tests, but now let’s dig deeper into the topic.</p>
<h4 class="h3" id="calibre_link-703"><strong class="calibre2"><em class="calibre3">Simple if Statements</em></strong></h4>
<p class="noindent">The simplest kind of <span class="literal">if</span> statement has one test and one action:</p>
<p class="programs">if <span class="codeitalic1">conditional_test</span>:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeitalic1">do something</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-445" class="calibre"></span>You can put any conditional test in the first line and just about any action in the indented block following the test. If the conditional test evaluates to <span class="literal">True</span>, Python executes the code following the <span class="literal">if</span> statement. If the test evaluates to <span class="literal">False</span>, Python ignores the code following the <span class="literal">if</span> statement.</p>
<p class="indent">Let’s say we have a variable representing a person’s age, and we want to know if that person is old enough to vote. The following code tests whether the person can vote:</p>
<p class="margin"><em class="calibre3">voting.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;age = 19<br class="calibre4" />
<span class="ent">➊</span> if age &gt;= 18:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("You are old enough to vote!")</p>
<p class="indent">At <span class="ent">➊</span> Python checks to see whether the value of <span class="literal">age</span> is greater than or equal to 18. It is, so Python executes the indented <span class="literal">print()</span> call at <span class="ent">➋</span>:</p>
<p class="programs">You are old enough to vote!</p>
<p class="indent">Indentation plays the same role in <span class="literal">if</span> statements as it did in <span class="literal">for</span> loops. All indented lines after an <span class="literal">if</span> statement will be executed if the test passes, and the entire block of indented lines will be ignored if the test does not pass.</p>
<p class="indent">You can have as many lines of code as you want in the block following the <span class="literal">if</span> statement. Let’s add another line of output if the person is old enough to vote, asking if the individual has registered to vote yet:</p>
<p class="programs"><span class="ash">age = 19</span><br class="calibre4" />
<span class="ash">if age &gt;= 18:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("You are old enough to vote!")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print("Have you registered to vote yet?")</p>
<p class="indent">The conditional test passes, and both <span class="literal">print()</span> calls are indented, so both lines are printed:</p>
<p class="programs">You are old enough to vote!<br class="calibre4" />
Have you registered to vote yet?</p>
<p class="indent">If the value of <span class="literal">age</span> is less than 18, this program would produce no output.</p>
<h4 class="h3" id="calibre_link-704"><strong class="calibre2"><em class="calibre3">if-else Statements</em></strong></h4>
<p class="noindent">Often, you’ll want to take one action when a conditional test passes and a different action in all other cases. Python’s <span class="literal">if</span>-<span class="literal">else</span> syntax makes this possible. An <span class="literal">if</span>-<span class="literal">else</span> block is similar to a simple <span class="literal">if</span> statement, but the <span class="literal">else</span> statement allows you to define an action or set of actions that are executed when the conditional test fails.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-231" class="calibre"></span>We’ll display the same message we had previously if the person is old enough to vote, but this time we’ll add a message for anyone who is not old enough to vote:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;age = 17<br class="calibre4" />
<span class="ent">➊</span> <span class="ash">if age &gt;= 18:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("You are old enough to vote!")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("Have you registered to vote yet?")</span><br class="calibre4" />
<span class="ent">➋</span> else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Sorry, you are too young to vote.")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Please register to vote as soon as you turn 18!")</p>
<p class="indent">If the conditional test at <span class="ent">➊</span> passes, the first block of indented <span class="literal">print()</span> calls is executed. If the test evaluates to <span class="literal">False</span>, the <span class="literal">else</span> block at <span class="ent">➋</span> is executed. Because <span class="literal">age</span> is less than 18 this time, the conditional test fails and the code in the <span class="literal">else</span> block is executed:</p>
<p class="programs">Sorry, you are too young to vote.<br class="calibre4" />
Please register to vote as soon as you turn 18!</p>
<p class="indent">This code works because it has only two possible situations to evaluate: a person is either old enough to vote or not old enough to vote. The <span class="literal">if</span>-<span class="literal">else</span> structure works well in situations in which you want Python to always execute one of two possible actions. In a simple <span class="literal">if-else</span> chain like this, one of the two actions will always be executed.</p>
<h4 class="h3" id="calibre_link-705"><strong class="calibre2"><em class="calibre3">The if-elif-else Chain</em></strong></h4>
<p class="noindent">Often, you’ll need to test more than two possible situations, and to evaluate these you can use Python’s <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> syntax. Python executes only one block in an <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain. It runs each conditional test in order until one passes. When a test passes, the code following that test is executed and Python skips the rest of the tests.</p>
<p class="indent">Many real-world situations involve more than two possible conditions. For example, consider an amusement park that charges different rates for different age groups:</p>
<ul class="calibre8">
<li class="noindent1">Admission for anyone under age 4 is free.</li>
<li class="noindent1">Admission for anyone between the ages of 4 and 18 is $25.</li>
<li class="noindent1">Admission for anyone age 18 or older is $40.</li>
</ul>
<p class="indent">How can we use an <span class="literal">if</span> statement to determine a person’s admission rate? The following code tests for the age group of a person and then prints an admission price message:</p>
<p class="margin"><em class="calibre3">amusement_park.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;age = 12<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> if age &lt; 4:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Your admission cost is $0.")<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1320" class="calibre"></span><span class="ent">➋</span> elif age &lt; 18:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Your admission cost is $25.")<br class="calibre4" />
<span class="ent">➌</span> else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Your admission cost is $40.")</p>
<p class="indent">The <span class="literal">if</span> test at <span class="ent">➊</span> tests whether a person is under 4 years old. If the test passes, an appropriate message is printed and Python skips the rest of the tests. The <span class="literal">elif</span> line at <span class="ent">➋</span> is really another <span class="literal">if</span> test, which runs only if the previous test failed. At this point in the chain, we know the person is at least 4 years old because the first test failed. If the person is under 18, an appropriate message is printed and Python skips the <span class="literal">else</span> block. If both the <span class="literal">if</span> and <span class="literal">elif</span> tests fail, Python runs the code in the <span class="literal">else</span> block at <span class="ent">➌</span>.</p>
<p class="indent">In this example the test at <span class="ent">➊</span> evaluates to <span class="literal">False</span>, so its code block is not executed. However, the second test evaluates to <span class="literal">True</span> (12 is less than 18) so its code is executed. The output is one sentence, informing the user of the admission cost:</p>
<p class="programs">Your admission cost is $25.</p>
<p class="indent">Any age greater than 17 would cause the first two tests to fail. In these situations, the <span class="literal">else</span> block would be executed and the admission price would be $40.</p>
<p class="indent">Rather than printing the admission price within the <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> block, it would be more concise to set just the price inside the <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain and then have a simple <span class="literal">print()</span> call that runs after the chain has been evaluated:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">age = 12</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">if age &lt; 4:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price = 0<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">elif age &lt; 18:</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price = 25<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price = 40<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> print(f"Your admission cost is ${price}.")</p>
<p class="indent">The lines at <span class="ent">➊</span>, <span class="ent">➋</span>, and <span class="ent">➌</span> set the value of <span class="literal">price</span> according to the person’s age, as in the previous example. After the price is set by the <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain, a separate unindented <span class="literal">print()</span> call <span class="ent">➍</span> uses this value to display a message reporting the person’s admission price.</p>
<p class="indent">This code produces the same output as the previous example, but the purpose of the <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain is narrower. Instead of determining a price and displaying a message, it simply determines the admission price. In addition to being more efficient, this revised code is easier to modify than the original approach. To change the text of the output message, you would need to change only one <span class="literal">print()</span> call rather than three separate <span class="literal">print()</span> calls.</p>
<h4 class="h3" id="calibre_link-706"><span type="pagebreak" id="calibre_link-1321" class="calibre"></span><strong class="calibre2"><em class="calibre3">Using Multiple elif Blocks</em></strong></h4>
<p class="noindent">You can use as many <span class="literal">elif</span> blocks in your code as you like. For example, if the amusement park were to implement a discount for seniors, you could add one more conditional test to the code to determine whether someone qualified for the senior discount. Let’s say that anyone 65 or older pays half the regular admission, or $20:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">age = 12</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">if age &lt; 4:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">price = 0</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">elif age &lt; 18:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">price = 25</span><br class="calibre4" />
<span class="ent">➊</span> elif age &lt; 65:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price = 40<br class="calibre4" />
<span class="ent">➋</span> else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price = 20<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Your admission cost is ${price}.")</span></p>
<p class="indent">Most of this code is unchanged. The second <span class="literal">elif</span> block at <span class="ent">➊</span> now checks to make sure a person is less than age 65 before assigning them the full admission rate of $40. Notice that the value assigned in the <span class="literal">else</span> block at <span class="ent">➋</span> needs to be changed to $20, because the only ages that make it to this block are people 65 or older.</p>
<h4 class="h3" id="calibre_link-707"><strong class="calibre2"><em class="calibre3">Omitting the else Block</em></strong></h4>
<p class="noindent">Python does not require an <span class="literal">else</span> block at the end of an <span class="literal">if</span>-<span class="literal">elif</span> chain. Sometimes an <span class="literal">else</span> block is useful; sometimes it is clearer to use an additional <span class="literal">elif</span> statement that catches the specific condition of interest:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">age = 12</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">if age &lt; 4:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">price = 0</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">elif age &lt; 18:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">price = 25</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">elif age &lt; 65:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">price = 40</span><br class="calibre4" />
<span class="ent">➊</span> elif age &gt;= 65:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">price = 20</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Your admission cost is ${price}.")</span></p>
<p class="indent">The extra <span class="literal">elif</span> block at <span class="ent">➊</span> assigns a price of $20 when the person is 65 or older, which is a bit clearer than the general <span class="literal">else</span> block. With this change, every block of code must pass a specific test in order to be executed.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-232" class="calibre"></span>The <span class="literal">else</span> block is a catchall statement. It matches any condition that wasn’t matched by a specific <span class="literal">if</span> or <span class="literal">elif</span> test, and that can sometimes include invalid or even malicious data. If you have a specific final condition you are testing for, consider using a final <span class="literal">elif</span> block and omit the <span class="literal">else</span> block. As a result, you’ll gain extra confidence that your code will run only under the correct conditions.</p>
<h4 class="h3" id="calibre_link-708"><strong class="calibre2"><em class="calibre3">Testing Multiple Conditions</em></strong></h4>
<p class="noindent">The <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain is powerful, but it’s only appropriate to use when you just need one test to pass. As soon as Python finds one test that passes, it skips the rest of the tests. This behavior is beneficial, because it’s efficient and allows you to test for one specific condition.</p>
<p class="indent">However, sometimes it’s important to check all of the conditions of interest. In this case, you should use a series of simple <span class="literal">if</span> statements with no <span class="literal">elif</span> or <span class="literal">else</span> blocks. This technique makes sense when more than one condition could be <span class="literal">True</span>, and you want to act on every condition that is <span class="literal">True</span>.</p>
<p class="indent">Let’s reconsider the pizzeria example. If someone requests a two-topping pizza, you’ll need to be sure to include both toppings on their pizza:</p>
<p class="margin"><em class="calibre3">toppings.py</em></p>
<p class="programs"><span class="ent">➊</span> requested_toppings = ['mushrooms', 'extra cheese']<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> if 'mushrooms' in requested_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Adding mushrooms.")<br class="calibre4" />
<span class="ent">➌</span> if 'pepperoni' in requested_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Adding pepperoni.")<br class="calibre4" />
<span class="ent">➍</span> if 'extra cheese' in requested_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Adding extra cheese.")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("\nFinished making your pizza!")</p>
<p class="indent">We start at <span class="ent">➊</span> with a list containing the requested toppings. The <span class="literal">if</span> statement at <span class="ent">➋</span> checks to see whether the person requested mushrooms on their pizza. If so, a message is printed confirming that topping. The test for pepperoni at <span class="ent">➌</span> is another simple <span class="literal">if</span> statement, not an <span class="literal">elif</span> or <span class="literal">else</span> statement, so this test is run regardless of whether the previous test passed or not. The code at <span class="ent">➍</span> checks whether extra cheese was requested regardless of the results from the first two tests. These three independent tests are executed every time this program is run.</p>
<p class="indent">Because every condition in this example is evaluated, both mushrooms and extra cheese are added to the pizza:</p>
<p class="programs">Adding mushrooms.<br class="calibre4" />
Adding extra cheese.<br class="calibre4" />
<br class="calibre4" />
Finished making your pizza!</p>
<p class="indent"><span type="pagebreak" id="calibre_link-444" class="calibre"></span>This code would not work properly if we used an <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> block, because the code would stop running after only one test passes. Here’s what that would look like:</p>
<p class="programs"><span class="ash">requested_toppings = ['mushrooms', 'extra cheese']</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">if 'mushrooms' in requested_toppings:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("Adding mushrooms.")</span><br class="calibre4" />
elif 'pepperoni' in requested_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("Adding pepperoni.")</span><br class="calibre4" />
elif 'extra cheese' in requested_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("Adding extra cheese.")</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">print("\nFinished making your pizza!")</span></p>
<p class="indent">The test for <span class="literal">'mushrooms'</span> is the first test to pass, so mushrooms are added to the pizza. However, the values <span class="literal">'extra cheese'</span> and <span class="literal">'pepperoni'</span> are never checked, because Python doesn’t run any tests beyond the first test that passes in an <span class="literal">if-elif-else</span> chain. The customer’s first topping will be added, but all of their other toppings will be missed:</p>
<p class="programs">Adding mushrooms.<br class="calibre4" />
<br class="calibre4" />
Finished making your pizza!</p>
<p class="indent">In summary, if you want only one block of code to run, use an <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain. If more than one block of code needs to run, use a series of independent <span class="literal">if</span> statements.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-148"><strong class="calibre2">5-3. Alien Colors #1:</strong> Imagine an alien was just shot down in a game. Create a variable called <span class="literal1">alien_color</span> and assign it a value of <span class="literal1">'green'</span>, <span class="literal1">'yellow'</span>, or <span class="literal1">'red'</span>.</p>
<ul class="calibre8">
<li class="noindent1">Write an <span class="literal">if</span> statement to test whether the alien’s color is green. If it is, print a message that the player just earned 5 points.</li>
<li class="noindent1">Write one version of this program that passes the <span class="literal">if</span> test and another that fails. (The version that fails will have no output.)</li>
</ul>
<p class="sparal" id="calibre_link-149"><strong class="calibre2">5-4. Alien Colors #2:</strong> Choose a color for an alien as you did in <a href="#calibre_link-148" class="calibre6">Exercise 5-3</a>, and write an <span class="literal1">if</span>-<span class="literal1">else</span> chain.</p>
<ul class="calibre8">
<li class="noindent1">If the alien’s color is green, print a statement that the player just earned 5 points for shooting the alien.</li>
<li class="noindent1">If the alien’s color isn’t green, print a statement that the player just earned 10 points.</li>
<li class="noindent1">Write one version of this program that runs the <span class="literal">if</span> block and another that runs the <span class="literal">else</span> block.</li>
</ul>
<p class="sparal" id="calibre_link-709"><span type="pagebreak" id="calibre_link-446" class="calibre"></span><strong class="calibre2">5-5. Alien Colors #3:</strong> Turn your <span class="literal1">if</span>-<span class="literal1">else</span> chain from <a href="#calibre_link-149" class="calibre6">Exercise 5-4</a> into an <span class="literal1">if</span>-<span class="literal1">elif</span>-<span class="literal1">else</span> chain.</p>
<ul class="calibre8">
<li class="noindent1">If the alien is green, print a message that the player earned 5 points.</li>
<li class="noindent1">If the alien is yellow, print a message that the player earned 10 points.</li>
<li class="noindent1">If the alien is red, print a message that the player earned 15 points.</li>
<li class="noindent1">Write three versions of this program, making sure each message is printed for the appropriate color alien.</li>
</ul>
<p class="sparal" id="calibre_link-710"><strong class="calibre2">5-6. Stages of Life:</strong> Write an <span class="literal1">if</span>-<span class="literal1">elif</span>-<span class="literal1">else</span> chain that determines a person’s stage of life. Set a value for the variable <span class="literal1">age</span>, and then:</p>
<ul class="calibre8">
<li class="noindent1">If the person is less than 2 years old, print a message that the person is a baby.</li>
<li class="noindent1">If the person is at least 2 years old but less than 4, print a message that the person is a toddler.</li>
<li class="noindent1">If the person is at least 4 years old but less than 13, print a message that the person is a kid.</li>
<li class="noindent1">If the person is at least 13 years old but less than 20, print a message that the person is a teenager.</li>
<li class="noindent1">If the person is at least 20 years old but less than 65, print a message that the person is an adult.</li>
<li class="noindent1">If the person is age 65 or older, print a message that the person is an elder.</li>
</ul>
<p class="sparal" id="calibre_link-711"><strong class="calibre2">5-7. Favorite Fruit:</strong> Make a list of your favorite fruits, and then write a series of independent <span class="literal1">if</span> statements that check for certain fruits in your list.</p>
<ul class="calibre8">
<li class="noindent1">Make a list of your three favorite fruits and call it <span class="literal">favorite_fruits</span>.</li>
<li class="noindent1">Write five <span class="literal">if</span> statements. Each should check whether a certain kind of fruit is in your list. If the fruit is in your list, the <span class="literal">if</span> block should print a statement, such as <em class="calibre3">You really like bananas!</em></li>
</ul>
</div>
<h3 class="h2" id="calibre_link-712"><strong class="calibre2">Using if Statements with Lists</strong></h3>
<p class="noindent">You can do some interesting work when you combine lists and <span class="literal">if</span> statements. You can watch for special values that need to be treated differently than other values in the list. You can manage changing conditions efficiently, such as the availability of certain items in a restaurant throughout a shift. You can also begin to prove that your code works as you expect it to in all possible situations.</p>
<h4 class="h3" id="calibre_link-713"><span type="pagebreak" id="calibre_link-1322" class="calibre"></span><strong class="calibre2"><em class="calibre3">Checking for Special Items</em></strong></h4>
<p class="noindent">This chapter began with a simple example that showed how to handle a special value like <span class="literal">'bmw'</span>, which needed to be printed in a different format than other values in the list. Now that you have a basic understanding of conditional tests and <span class="literal">if</span> statements, let’s take a closer look at how you can watch for special values in a list and handle those values appropriately.</p>
<p class="indent">Let’s continue with the pizzeria example. The pizzeria displays a message whenever a topping is added to your pizza, as it’s being made. The code for this action can be written very efficiently by making a list of toppings the customer has requested and using a loop to announce each topping as it’s added to the pizza:</p>
<p class="margin"><em class="calibre3">toppings.py</em></p>
<p class="programs">requested_toppings = ['mushrooms', 'green peppers', 'extra cheese']<br class="calibre4" />
<br class="calibre4" />
for requested_topping in requested_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"Adding {requested_topping}.")<br class="calibre4" />
<br class="calibre4" />
print("\nFinished making your pizza!")</p>
<p class="indent">The output is straightforward because this code is just a simple <span class="literal">for</span> loop:</p>
<p class="programs">Adding mushrooms.<br class="calibre4" />
Adding green peppers.<br class="calibre4" />
Adding extra cheese.<br class="calibre4" />
<br class="calibre4" />
Finished making your pizza!</p>
<p class="indent">But what if the pizzeria runs out of green peppers? An <span class="literal">if</span> statement inside the <span class="literal">for</span> loop can handle this situation appropriately:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">requested_toppings = ['mushrooms', 'green peppers', 'extra cheese']</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for requested_topping in requested_toppings:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if requested_topping == 'green peppers':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Sorry, we are out of green peppers right now.")<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Adding {requested_topping}.")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print("\nFinished making your pizza!")</span></p>
<p class="indent">This time we check each requested item before adding it to the pizza. The code at <span class="ent">➊</span> checks to see if the person requested green peppers. If so, we display a message informing them why they can’t have green peppers. The <span class="literal">else</span> block at <span class="ent">➋</span> ensures that all other toppings will be added to the pizza.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-442" class="calibre"></span>The output shows that each requested topping is handled appropriately.</p>
<p class="programs">Adding mushrooms.<br class="calibre4" />
Sorry, we are out of green peppers right now.<br class="calibre4" />
Adding extra cheese.<br class="calibre4" />
<br class="calibre4" />
Finished making your pizza!</p>
<h4 class="h3" id="calibre_link-714"><strong class="calibre2"><em class="calibre3">Checking That a List Is Not Empty</em></strong></h4>
<p class="noindent">We’ve made a simple assumption about every list we’ve worked with so far; we’ve assumed that each list has at least one item in it. Soon we’ll let users provide the information that’s stored in a list, so we won’t be able to assume that a list has any items in it each time a loop is run. In this situation, it’s useful to check whether a list is empty before running a <span class="literal">for</span> loop.</p>
<p class="indent">As an example, let’s check whether the list of requested toppings is empty before building the pizza. If the list is empty, we’ll prompt the user and make sure they want a plain pizza. If the list is not empty, we’ll build the pizza just as we did in the previous examples:</p>
<p class="programs"><span class="ent">➊</span> requested_toppings = []<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> if requested_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for requested_topping in requested_toppings:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Adding {requested_topping}.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("\nFinished making your pizza!")</span><br class="calibre4" />
<span class="ent">➌</span> else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Are you sure you want a plain pizza?")</p>
<p class="indent">This time we start out with an empty list of requested toppings at <span class="ent">➊</span>. Instead of jumping right into a <span class="literal">for</span> loop, we do a quick check at <span class="ent">➋</span>. When the name of a list is used in an <span class="literal">if</span> statement, Python returns <span class="literal">True</span> if the list contains at least one item; an empty list evaluates to <span class="literal">False</span>. If <span class="literal">requested_toppings</span> passes the conditional test, we run the same <span class="literal">for</span> loop we used in the previous example. If the conditional test fails, we print a message asking the customer if they really want a plain pizza with no toppings <span class="ent">➌</span>.</p>
<p class="indent">The list is empty in this case, so the output asks if the user really wants a plain pizza:</p>
<p class="programs">Are you sure you want a plain pizza?</p>
<p class="indent">If the list is not empty, the output will show each requested topping being added to the pizza.</p>
<h4 class="h3" id="calibre_link-715"><span type="pagebreak" id="calibre_link-447" class="calibre"></span><strong class="calibre2"><em class="calibre3">Using Multiple Lists</em></strong></h4>
<p class="noindent">People will ask for just about anything, especially when it comes to pizza toppings. What if a customer actually wants french fries on their pizza? You can use lists and <span class="literal">if</span> statements to make sure your input makes sense before you act on it.</p>
<p class="indent">Let’s watch out for unusual topping requests before we build a pizza. The following example defines two lists. The first is a list of available toppings at the pizzeria, and the second is the list of toppings that the user has requested. This time, each item in <span class="literal">requested_toppings</span> is checked against the list of available toppings before it’s added to the pizza:</p>
<p class="programs"><span class="ent">➊</span> available_toppings = ['mushrooms', 'olives', 'green peppers',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pepperoni', 'pineapple', 'extra cheese']<br class="calibre4" />
<span class="ent">➋</span> requested_toppings = ['mushrooms', 'french fries', 'extra cheese']<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> for requested_topping in requested_toppings:<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if requested_topping in available_toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Adding {requested_topping}.")<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Sorry, we don't have {requested_topping}.")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("\nFinished making your pizza!")</p>
<p class="indent">At <span class="ent">➊</span> we define a list of available toppings at this pizzeria. Note that this could be a tuple if the pizzeria has a stable selection of toppings. At <span class="ent">➋</span>, we make a list of toppings that a customer has requested. Note the unusual request, <span class="literal">'french fries'</span>. At <span class="ent">➌</span> we loop through the list of requested toppings. Inside the loop, we first check to see if each requested topping is actually in the list of available toppings <span class="ent">➍</span>. If it is, we add that topping to the pizza. If the requested topping is not in the list of available toppings, the <span class="literal">else</span> block will run <span class="ent">➎</span>. The <span class="literal">else</span> block prints a message telling the user which toppings are unavailable.</p>
<p class="indent">This code syntax produces clean, informative output:</p>
<p class="programs">Adding mushrooms.<br class="calibre4" />
Sorry, we don't have french fries.<br class="calibre4" />
Adding extra cheese.<br class="calibre4" />
<br class="calibre4" />
Finished making your pizza!</p>
<p class="indent">In just a few lines of code, we’ve managed a real-world situation pretty effectively!</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-1323" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-716"><strong class="calibre2">5-8. Hello Admin:</strong> Make a list of five or more usernames, including the name <span class="literal1">'admin'</span>. Imagine you are writing code that will print a greeting to each user after they log in to a website. Loop through the list, and print a greeting to each user:</p>
<ul class="calibre8">
<li class="noindent1">If the username is <span class="literal">'admin'</span>, print a special greeting, such as <em class="calibre3">Hello admin, would you like to see a status report?</em></li>
<li class="noindent1">Otherwise, print a generic greeting, such as <em class="calibre3">Hello Jaden, thank you for logging in again.</em></li>
</ul>
<p class="sparal" id="calibre_link-717"><strong class="calibre2">5-9. No Users:</strong> Add an <span class="literal1">if</span> test to <em class="calibre3">hello_admin.py</em> to make sure the list of users is not empty.</p>
<ul class="calibre8">
<li class="noindent1">If the list is empty, print the message <em class="calibre3">We need to find some users!</em></li>
<li class="noindent1">Remove all of the usernames from your list, and make sure the correct message is printed.</li>
</ul>
<p class="sparal" id="calibre_link-718"><strong class="calibre2">5-10. Checking Usernames:</strong> Do the following to create a program that simulates how websites ensure that everyone has a unique username.</p>
<ul class="calibre8">
<li class="noindent1">Make a list of five or more usernames called <span class="literal">current_users</span>.</li>
<li class="noindent1">Make another list of five usernames called <span class="literal">new_users</span>. Make sure one or two of the new usernames are also in the <span class="literal">current_users</span> list.</li>
<li class="noindent1">Loop through the <span class="literal">new_users</span> list to see if each new username has already been used. If it has, print a message that the person will need to enter a new username. If a username has not been used, print a message saying that the username is available.</li>
<li class="noindent1">Make sure your comparison is case insensitive. If <span class="literal">'John'</span> has been used, <span class="literal">'JOHN'</span> should not be accepted. (To do this, you’ll need to make a copy of <span class="literal">current_users</span> containing the lowercase versions of all existing users.)</li>
</ul>
<p class="sparal" id="calibre_link-719"><strong class="calibre2">5-11. Ordinal Numbers:</strong> Ordinal numbers indicate their position in a list, such as <em class="calibre3">1st</em> or <em class="calibre3">2nd</em>. Most ordinal numbers end in <em class="calibre3">th</em>, except 1, 2, and 3.</p>
<ul class="calibre8">
<li class="noindent1">Store the numbers 1 through 9 in a list.</li>
<li class="noindent1">Loop through the list.</li>
<li class="noindent1">Use an <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain inside the loop to print the proper ordinal ending for each number. Your output should read <span class="literal">"1st 2nd 3rd 4th 5th 6th 7th 8th 9th"</span>, and each result should be on a separate line.</li>
</ul>
</div>
<h3 class="h2" id="calibre_link-720"><span type="pagebreak" id="calibre_link-449" class="calibre"></span><strong class="calibre2">Styling Your if Statements</strong></h3>
<p class="noindent">In every example in this chapter, you’ve seen good styling habits. The only recommendation PEP 8 provides for styling conditional tests is to use a single space around comparison operators, such as <span class="literal">==</span>, <span class="literal">&gt;=</span>, <span class="literal">&lt;=</span>. For example:</p>
<p class="programs">if age &lt; 4:</p>
<p class="noindent">is better than:</p>
<p class="programs">if age&lt;4:</p>
<p class="indent">Such spacing does not affect the way Python interprets your code; it just makes your code easier for you and others to read.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-721"><strong class="calibre2">5-12. Styling</strong> <span class="codestrong2">if</span> <strong class="calibre2">statements:</strong> Review the programs you wrote in this chapter, and make sure you styled your conditional tests appropriately.</p>
<p class="sparal" id="calibre_link-722"><strong class="calibre2">5-13. Your Ideas:</strong> At this point, you’re a more capable programmer than you were when you started this book. Now that you have a better sense of how real-world situations are modeled in programs, you might be thinking of some problems you could solve with your own programs. Record any new ideas you have about problems you might want to solve as your programming skills continue to improve. Consider games you might want to write, data sets you might want to explore, and web applications you’d like to create.</p>
</div>
<h3 class="h2" id="calibre_link-723"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned how to write conditional tests, which always evaluate to <span class="literal">True</span> or <span class="literal">False</span>. You learned to write simple <span class="literal">if</span> statements, <span class="literal">if</span>-<span class="literal">else</span> chains, and <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chains. You began using these structures to identify particular conditions you needed to test and to know when those conditions have been met in your programs. You learned to handle certain items in a list differently than all other items while continuing to utilize the efficiency of a <span class="literal">for</span> loop. You also revisited Python’s style recommendations to ensure that your increasingly complex programs are still relatively easy to read and understand.</p>
<p class="indent">In <a href="#calibre_link-116" class="calibre6">Chapter 6</a> you’ll learn about Python’s dictionaries. A dictionary is similar to a list, but it allows you to connect pieces of information. You’ll learn to build dictionaries, loop through them, and use them in combination with lists and <span class="literal">if</span> statements. Learning about dictionaries will enable you to model an even wider variety of real-world situations.</p>
</div>


<div class="calibre1" id="calibre_link-121">
<h2 class="h" id="calibre_link-116"><span type="pagebreak" id="calibre_link-1324" class="calibre"></span><strong class="calibre2"><span class="big">6</span><br class="calibre4" />DICTIONARIES</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter you’ll learn how to use Python’s dictionaries, which allow you to connect pieces of related information. You’ll learn how to access the information once it’s in a dictionary and how to modify that information. Because dictionaries can store an almost limitless amount of information, I’ll show you how to loop through the data in a dictionary. Additionally, you’ll learn to nest dictionaries inside lists, lists inside dictionaries, and even dictionaries inside other dictionaries.</p>
<p class="indent">Understanding dictionaries allows you to model a variety of real-world objects more accurately. You’ll be able to create a dictionary representing a person and then store as much information as you want about that person. You can store their name, age, location, profession, and any other aspect of a person you can describe. You’ll be able to store any two kinds of <span type="pagebreak" id="calibre_link-170" class="calibre"></span>information that can be matched up, such as a list of words and their meanings, a list of people’s names and their favorite numbers, a list of mountains and their elevations, and so forth.</p>
<h3 class="h2" id="calibre_link-724"><strong class="calibre2">A Simple Dictionary</strong></h3>
<p class="noindent">Consider a game featuring aliens that can have different colors and point values. This simple dictionary stores information about a particular alien:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">alien_0 = {'color': 'green', 'points': 5}<br class="calibre4" />
<br class="calibre4" />
print(alien_0['color'])<br class="calibre4" />
print(alien_0['points'])</p>
<p class="indent">The dictionary <span class="literal">alien_0</span> stores the alien’s color and point value. The last two lines access and display that information, as shown here:</p>
<p class="programs">green<br class="calibre4" />
5</p>
<p class="indent">As with most new programming concepts, using dictionaries takes practice. Once you’ve worked with dictionaries for a bit you’ll soon see how effectively they can model real-world situations.</p>
<h3 class="h2" id="calibre_link-725"><strong class="calibre2">Working with Dictionaries</strong></h3>
<p class="noindent">A <em class="calibre3">dictionary</em> in Python is a collection of <em class="calibre3">key-value pairs</em>. Each <em class="calibre3">key</em> is connected to a value, and you can use a key to access the value associated with that key. A key’s value can be a number, a string, a list, or even another dictionary. In fact, you can use any object that you can create in Python as a value in a dictionary.</p>
<p class="indent">In Python, a dictionary is wrapped in braces, <span class="literal">{}</span>, with a series of key-value pairs inside the braces, as shown in the earlier example:</p>
<p class="programs">alien_0 = {'color': 'green', 'points': 5}</p>
<p class="indent">A <em class="calibre3">key-value pair</em> is a set of values associated with each other. When you provide a key, Python returns the value associated with that key. Every key is connected to its value by a colon, and individual key-value pairs are separated by commas. You can store as many key-value pairs as you want in a dictionary.</p>
<p class="indent">The simplest dictionary has exactly one key-value pair, as shown in this modified version of the <span class="literal">alien_0</span> dictionary:</p>
<p class="programs">alien_0 = {'color': 'green'}</p>
<p class="indent"><span type="pagebreak" id="calibre_link-297" class="calibre"></span>This dictionary stores one piece of information about <span class="literal">alien_0</span>, namely the alien’s color. The string <span class="literal">'color'</span> is a key in this dictionary, and its associated value is <span class="literal">'green'</span>.</p>
<h4 class="h3" id="calibre_link-726"><strong class="calibre2"><em class="calibre3">Accessing Values in a Dictionary</em></strong></h4>
<p class="noindent">To get the value associated with a key, give the name of the dictionary and then place the key inside a set of square brackets, as shown here:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs"><span class="ash">alien_0 = {'color': 'green'}</span><br class="calibre4" />
print(alien_0['color'])</p>
<p class="indent">This returns the value associated with the key <span class="literal">'color'</span> from the dictionary <span class="literal">alien_0</span>:</p>
<p class="programs">green</p>
<p class="indent">You can have an unlimited number of key-value pairs in a dictionary. For example, here’s the original <span class="literal">alien_0</span> dictionary with two key-value pairs:</p>
<p class="programs">alien_0 = {'color': 'green', 'points': 5}</p>
<p class="indent">Now you can access either the color or the point value of <span class="literal">alien_0</span>. If a player shoots down this alien, you can look up how many points they should earn using code like this:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">alien_0 = {'color': 'green', 'points': 5}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> new_points = alien_0['points']<br class="calibre4" />
<span class="ent">➋</span> print(f"You just earned {new_points} points!")</p>
<p class="indent">Once the dictionary has been defined, the code at <span class="ent">➊</span> pulls the value associated with the key <span class="literal">'points'</span> from the dictionary. This value is then assigned to the variable <span class="literal">new_points</span>. The line at <span class="ent">➋</span> prints a statement about how many points the player just earned:</p>
<p class="programs">You just earned 5 points!</p>
<p class="indent">If you run this code every time an alien is shot down, the alien’s point value will be retrieved.</p>
<h4 class="h3" id="calibre_link-727"><strong class="calibre2"><em class="calibre3">Adding New Key-Value Pairs</em></strong></h4>
<p class="noindent">Dictionaries are dynamic structures, and you can add new key-value pairs to a dictionary at any time. For example, to add a new key-value pair, you would give the name of the dictionary followed by the new key in square brackets along with the new value.</p>
<p class="indent">Let’s add two new pieces of information to the <span class="literal">alien_0</span> dictionary: the alien’s x- and y-coordinates, which will help us display the alien in a <span type="pagebreak" id="calibre_link-295" class="calibre"></span>particular position on the screen. Let’s place the alien on the left edge of the screen, 25 pixels down from the top. Because screen coordinates usually start at the upper-left corner of the screen, we’ll place the alien on the left edge of the screen by setting the x-coordinate to 0 and 25 pixels from the top by setting its y-coordinate to positive 25, as shown here:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">alien_0 = {'color': 'green', 'points': 5}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(alien_0)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> alien_0['x_position'] = 0<br class="calibre4" />
<span class="ent">➋</span> alien_0['y_position'] = 25<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(alien_0)</p>
<p class="indent">We start by defining the same dictionary that we’ve been working with. We then print this dictionary, displaying a snapshot of its information. At <span class="ent">➊</span> we add a new key-value pair to the dictionary: key <span class="literal">'x_position'</span> and value <span class="literal">0</span>. We do the same for key <span class="literal">'y_position'</span> at <span class="ent">➋</span>. When we print the modified dictionary, we see the two additional key-value pairs:</p>
<p class="programs">{'color': 'green', 'points': 5}<br class="calibre4" />
{'color': 'green', 'points': 5, 'y_position': 25, 'x_position': 0}</p>
<p class="indent">The final version of the dictionary contains four key-value pairs. The original two specify color and point value, and two more specify the alien’s position.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">As of Python 3.7, dictionaries retain the order in which they were defined. When you print a dictionary or loop through its elements, you will see the elements in the same order in which they were added to the dictionary.</em></p>
</div>
<h4 class="h3" id="calibre_link-728"><strong class="calibre2"><em class="calibre3">Starting with an Empty Dictionary</em></strong></h4>
<p class="noindent">It’s sometimes convenient, or even necessary, to start with an empty dictionary and then add each new item to it. To start filling an empty dictionary, define a dictionary with an empty set of braces and then add each key-value pair on its own line. For example, here’s how to build the <span class="literal">alien_0</span> dictionary using this approach:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">alien_0 = {}<br class="calibre4" />
<br class="calibre4" />
alien_0['color'] = 'green'<br class="calibre4" />
alien_0['points'] = 5<br class="calibre4" />
<br class="calibre4" />
print(alien_0)</p>
<p class="indent">Here we define an empty <span class="literal">alien_0</span> dictionary, and then add color and point values to it. The result is the dictionary we’ve been using in previous examples:</p>
<p class="programs">{'color': 'green', 'points': 5}</p>
<p class="indent"><span type="pagebreak" id="calibre_link-303" class="calibre"></span>Typically, you’ll use empty dictionaries when storing user-supplied data in a dictionary or when you write code that generates a large number of key-value pairs automatically.</p>
<h4 class="h3" id="calibre_link-729"><strong class="calibre2"><em class="calibre3">Modifying Values in a Dictionary</em></strong></h4>
<p class="noindent">To modify a value in a dictionary, give the name of the dictionary with the key in square brackets and then the new value you want associated with that key. For example, consider an alien that changes from green to yellow as a game progresses:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">alien_0 = {'color': 'green'}<br class="calibre4" />
print(f"The alien is {alien_0['color']}.")<br class="calibre4" />
<br class="calibre4" />
alien_0['color'] = 'yellow'<br class="calibre4" />
print(f"The alien is now {alien_0['color']}.")</p>
<p class="indent">We first define a dictionary for <span class="literal">alien_0</span> that contains only the alien’s color; then we change the value associated with the key <span class="literal">'color'</span> to <span class="literal">'yellow'</span>. The output shows that the alien has indeed changed from green to yellow:</p>
<p class="programs">The alien is green.<br class="calibre4" />
The alien is now yellow.</p>
<p class="indent">For a more interesting example, let’s track the position of an alien that can move at different speeds. We’ll store a value representing the alien’s current speed and then use it to determine how far to the right the alien should move:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;alien_0 = {'x_position': 0, 'y_position': 25, 'speed': 'medium'}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(f"Original position: {alien_0['x_position']}")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Move the alien to the right.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Determine how far to move the alien based on its current speed.<br class="calibre4" />
<span class="ent">➊</span> if alien_0['speed'] == 'slow':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_increment = 1<br class="calibre4" />
&nbsp;&nbsp;&nbsp;elif alien_0['speed'] == 'medium':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_increment = 2<br class="calibre4" />
&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This must be a fast alien.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_increment = 3<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# The new position is the old position plus the increment.<br class="calibre4" />
<span class="ent">➋</span> alien_0['x_position'] = alien_0['x_position'] + x_increment<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(f"New position: {alien_0['x_position']}")</p>
<p class="indent">We start by defining an alien with an initial <em class="calibre3">x</em> position and <em class="calibre3">y</em> position, and a speed of <span class="literal">'medium'</span>. We’ve omitted the color and point values for the <span type="pagebreak" id="calibre_link-298" class="calibre"></span>sake of simplicity, but this example would work the same way if you included those key-value pairs as well. We also print the original value of <span class="literal">x_position</span> to see how far the alien moves to the right.</p>
<p class="indent">At <span class="ent">➊</span>, an <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> chain determines how far the alien should move to the right and assigns this value to the variable <span class="literal">x_increment</span>. If the alien’s speed is <span class="literal">'slow'</span>, it moves one unit to the right; if the speed is <span class="literal">'medium'</span>, it moves two units to the right; and if it’s <span class="literal">'fast'</span>, it moves three units to the right. Once the increment has been calculated, it’s added to the value of <span class="literal">x_position</span> at <span class="ent">➋</span>, and the result is stored in the dictionary’s <span class="literal">x_position</span>.</p>
<p class="indent">Because this is a medium-speed alien, its position shifts two units to the right:</p>
<p class="programs">Original x-position: 0<br class="calibre4" />
New x-position: 2</p>
<p class="indent">This technique is pretty cool: by changing one value in the alien’s dictionary, you can change the overall behavior of the alien. For example, to turn this medium-speed alien into a fast alien, you would add the line:</p>
<p class="programs">alien_0['speed'] = 'fast'</p>
<p class="indent">The <span class="literal">if</span>-<span class="literal">elif</span>-<span class="literal">else</span> block would then assign a larger value to <span class="literal">x_increment</span> the next time the code runs.</p>
<h4 class="h3" id="calibre_link-730"><strong class="calibre2"><em class="calibre3">Removing Key-Value Pairs</em></strong></h4>
<p class="noindent">When you no longer need a piece of information that’s stored in a dictionary, you can use the <span class="literal">del</span> statement to completely remove a key-value pair. All <span class="literal">del</span> needs is the name of the dictionary and the key that you want to remove.</p>
<p class="indent">For example, let’s remove the key <span class="literal">'points'</span> from the <span class="literal">alien_0</span> dictionary along with its value:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;alien_0 = {'color': 'green', 'points': 5}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(alien_0)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> del alien_0['points']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(alien_0)</p>
<p class="indent">The line at <span class="ent">➊</span> tells Python to delete the key <span class="literal">'points'</span> from the dictionary <span class="literal">alien_0</span> and to remove the value associated with that key as well. The output shows that the key <span class="literal">'points'</span> and its value of <span class="literal">5</span> are deleted from the dictionary, but the rest of the dictionary is unaffected:</p>
<p class="programs">{'color': 'green', 'points': 5}<br class="calibre4" />
{'color': 'green'}</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Be aware that the deleted key-value pair is removed permanently.</em></p>
</div>
<h4 class="h3" id="calibre_link-731"><span type="pagebreak" id="calibre_link-122" class="calibre"></span><strong class="calibre2"><em class="calibre3">A Dictionary of Similar Objects</em></strong></h4>
<p class="noindent">The previous example involved storing different kinds of information about one object, an alien in a game. You can also use a dictionary to store one kind of information about many objects. For example, say you want to poll a number of people and ask them what their favorite programming language is. A dictionary is useful for storing the results of a simple poll, like this:</p>
<p class="programs">favorite_languages = {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'jen': 'python',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'sarah': 'c',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'edward': 'ruby',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'phil': 'python',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="indent">As you can see, we’ve broken a larger dictionary into several lines. Each key is the name of a person who responded to the poll, and each value is their language choice. When you know you’ll need more than one line to define a dictionary, press <small class="calibre5">ENTER</small> after the opening brace. Then indent the next line one level (four spaces), and write the first key-value pair, followed by a comma. From this point forward when you press <small class="calibre5">ENTER</small>, your text editor should automatically indent all subsequent key-value pairs to match the first key-value pair.</p>
<p class="indent">Once you’ve finished defining the dictionary, add a closing brace on a new line after the last key-value pair and indent it one level so it aligns with the keys in the dictionary. It’s good practice to include a comma after the last key-value pair as well, so you’re ready to add a new key-value pair on the next line.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Most editors have some functionality that helps you format extended lists and dictionaries in a similar manner to this example. Other acceptable ways to format long dictionaries are available as well, so you may see slightly different formatting in your editor, or in other sources.</em></p>
</div>
<p class="indent">To use this dictionary, given the name of a person who took the poll, you can easily look up their favorite language:</p>
<p class="margin"><em class="calibre3">favorite_languages.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'jen': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'sarah': 'c',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'edward': 'ruby',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'phil': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> language = favorite_languages['sarah'].title()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(f"Sarah's favorite language is {language}.")</p>
<p class="indent">To see which language Sarah chose, we ask for the value at:</p>
<p class="programs">favorite_languages['sarah']</p>
<p class="indent"><span type="pagebreak" id="calibre_link-296" class="calibre"></span>We use this syntax to pull Sarah’s favorite language from the dictionary at <span class="ent">➊</span> and assign it to the variable <span class="literal">language</span>. Creating a new variable here makes for a much cleaner <span class="literal">print()</span> call. The output shows Sarah’s favorite language:</p>
<p class="programs">Sarah's favorite language is C.</p>
<p class="indent">You could use this same syntax with any individual represented in the dictionary.</p>
<h4 class="h3" id="calibre_link-732"><strong class="calibre2"><em class="calibre3">Using get() to Access Values</em></strong></h4>
<p class="noindent">Using keys in square brackets to retrieve the value you’re interested in from a dictionary might cause one potential problem: if the key you ask for doesn’t exist, you’ll get an error.</p>
<p class="indent">Let’s see what happens when you ask for the point value of an alien that doesn’t have a point value set:</p>
<p class="margin"><em class="calibre3">alien_no_points.py</em></p>
<p class="programs">alien_0 = {'color': 'green', 'speed': 'slow'}<br class="calibre4" />
print(alien_0['points'])</p>
<p class="indent">This results in a traceback, showing a <span class="literal">KeyError</span>:</p>
<p class="programs">Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;File "alien_no_points.py", line 2, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(alien_0['points'])<br class="calibre4" />
KeyError: 'points'</p>
<p class="indent">You’ll learn more about how to handle errors like this in general in <a href="#calibre_link-119" class="calibre6">Chapter 10</a>. For dictionaries, specifically, you can use the <span class="literal">get()</span> method to set a default value that will be returned if the requested key doesn’t exist.</p>
<p class="indent">The <span class="literal">get()</span> method requires a key as a first argument. As a second optional argument, you can pass the value to be returned if the key doesn’t exist:</p>
<p class="programs"><span class="ash">alien_0 = {'color': 'green', 'speed': 'slow'}</span><br class="calibre4" />
<br class="calibre4" />
point_value = alien_0.get('points', 'No point value assigned.')<br class="calibre4" />
print(point_value)</p>
<p class="indent">If the key <span class="literal">'points'</span> exists in the dictionary, you’ll get the corresponding value. If it doesn’t, you get the default value. In this case, <span class="literal">points</span> doesn’t exist, and we get a clean message instead of an error:</p>
<p class="programs">No point value assigned.</p>
<p class="indent">If there’s a chance the key you’re asking for might not exist, consider using the <span class="literal">get()</span> method instead of the square bracket notation.</p>
<div class="note">
<p class="notet"><span type="pagebreak" id="calibre_link-124" class="calibre"></span><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you leave out the second argument in the call to <span class="codeitalic">get()</span> and the key doesn’t exist, Python will return the value <span class="codeitalic">None</span>. The special value <span class="codeitalic">None</span> means “no value exists.” This is not an error: it’s a special value meant to indicate the absence of a value. You’ll see more uses for <span class="codeitalic">None</span> in <a href="#calibre_link-118" class="calibre6">Chapter 8</a>.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-126"><strong class="calibre2">6-1. Person:</strong> Use a dictionary to store information about a person you know. Store their first name, last name, age, and the city in which they live. You should have keys such as <span class="literal1">first_name</span>, <span class="literal1">last_name</span>, <span class="literal1">age</span>, and <span class="literal1">city</span>. Print each piece of information stored in your dictionary.</p>
<p class="sparal" id="calibre_link-127"><strong class="calibre2">6-2. Favorite Numbers:</strong> Use a dictionary to store people’s favorite numbers. Think of five names, and use them as keys in your dictionary. Think of a favorite number for each person, and store each as a value in your dictionary. Print each person’s name and their favorite number. For even more fun, poll a few friends and get some actual data for your program.</p>
<p class="sparal" id="calibre_link-123"><strong class="calibre2">6-3. Glossary:</strong> A Python dictionary can be used to model an actual dictionary. However, to avoid confusion, let’s call it a glossary.</p>
<ul class="calibre8">
<li class="noindent1">Think of five programming words you’ve learned about in the previous chapters. Use these words as the keys in your glossary, and store their meanings as values.</li>
<li class="noindent1">Print each word and its meaning as neatly formatted output. You might print the word followed by a colon and then its meaning, or print the word on one line and then print its meaning indented on a second line. Use the newline character (<span class="literal">\n</span>) to insert a blank line between each word-meaning pair in your output.</li>
</ul>
</div>
<h3 class="h2" id="calibre_link-733"><strong class="calibre2">Looping Through a Dictionary</strong></h3>
<p class="noindent">A single Python dictionary can contain just a few key-value pairs or millions of pairs. Because a dictionary can contain large amounts of data, Python lets you loop through a dictionary. Dictionaries can be used to store information in a variety of ways; therefore, several different ways exist to loop through them. You can loop through all of a dictionary’s key-value pairs, through its keys, or through its values.</p>
<h4 class="h3" id="calibre_link-734"><strong class="calibre2"><em class="calibre3">Looping Through All Key-Value Pairs</em></strong></h4>
<p class="noindent">Before we explore the different approaches to looping, let’s consider a new dictionary designed to store information about a user on a website. The <span type="pagebreak" id="calibre_link-125" class="calibre"></span>following dictionary would store one person’s username, first name, and last name:</p>
<p class="programs">user_0 = {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'username': 'efermi',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'first': 'enrico',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'last': 'fermi',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="indent">You can access any single piece of information about <span class="literal">user_0</span> based on what you’ve already learned in this chapter. But what if you wanted to see everything stored in this user’s dictionary? To do so, you could loop through the dictionary using a <span class="literal">for</span> loop:</p>
<p class="margin"><em class="calibre3">user.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">user_0 = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'username': 'efermi',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'first': 'enrico',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'last': 'fermi',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> for key, value in user_0.items():<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nKey: {key}")<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Value: {value}")</p>
<p class="indent">As shown at <span class="ent">➊</span>, to write a <span class="literal">for</span> loop for a dictionary, you create names for the two variables that will hold the key and value in each key-value pair. You can choose any names you want for these two variables. This code would work just as well if you had used abbreviations for the variable names, like this:</p>
<p class="programs">for k, v in user_0.items()</p>
<p class="indent">The second half of the <span class="literal">for</span> statement at <span class="ent">➊</span> includes the name of the dictionary followed by the method <span class="literal">items()</span>, which returns a list of key-value pairs. The <span class="literal">for</span> loop then assigns each of these pairs to the two variables provided. In the preceding example, we use the variables to print each <span class="literal">key</span> <span class="ent">➋</span>, followed by the associated <span class="literal">value</span> <span class="ent">➌</span>. The <span class="literal">"\n"</span> in the first <span class="literal">print()</span> call ensures that a blank line is inserted before each key-value pair in the output:</p>
<p class="programs">Key: last<br class="calibre4" />
Value: fermi<br class="calibre4" />
<br class="calibre4" />
Key: first<br class="calibre4" />
Value: enrico<br class="calibre4" />
<br class="calibre4" />
Key: username<br class="calibre4" />
Value: efermi</p>
<p class="indent"><span type="pagebreak" id="calibre_link-299" class="calibre"></span>Looping through all key-value pairs works particularly well for dictionaries like the <em class="calibre3">favorite_languages.py</em> example on <a href="#calibre_link-122" class="calibre6">page 97</a>, which stores the same kind of information for many different keys. If you loop through the <span class="literal">favorite_languages</span> dictionary, you get the name of each person in the dictionary and their favorite programming language. Because the keys always refer to a person’s name and the value is always a language, we’ll use the variables <span class="literal">name</span> and <span class="literal">language</span> in the loop instead of <span class="literal">key</span> and <span class="literal">value</span>. This will make it easier to follow what’s happening inside the loop:</p>
<p class="margin"><em class="calibre3">favorite_languages.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'jen': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'sarah': 'c',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'edward': 'ruby',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'phil': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> for name, language in favorite_languages.items():<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{name.title()}'s favorite language is {language.title()}.")</p>
<p class="indent">The code at <span class="ent">➊</span> tells Python to loop through each key-value pair in the dictionary. As it works through each pair the key is assigned to the variable <span class="literal">name</span>, and the value is assigned to the variable <span class="literal">language</span>. These descriptive names make it much easier to see what the <span class="literal">print()</span> call at <span class="ent">➋</span> is doing.</p>
<p class="indent">Now, in just a few lines of code, we can display all of the information from the poll:</p>
<p class="programs">Jen's favorite language is Python.<br class="calibre4" />
Sarah's favorite language is C.<br class="calibre4" />
Edward's favorite language is Ruby.<br class="calibre4" />
Phil's favorite language is Python.</p>
<p class="indent">This type of looping would work just as well if our dictionary stored the results from polling a thousand or even a million people.</p>
<h4 class="h3" id="calibre_link-735"><strong class="calibre2"><em class="calibre3">Looping Through All the Keys in a Dictionary</em></strong></h4>
<p class="noindent">The <span class="literal">keys()</span> method is useful when you don’t need to work with all of the values in a dictionary. Let’s loop through the <span class="literal">favorite_languages</span> dictionary and print the names of everyone who took the poll:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'jen': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'sarah': 'c',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'edward': 'ruby',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'phil': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> for name in favorite_languages.keys():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(name.title())</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1325" class="calibre"></span>The line at <span class="ent">➊</span> tells Python to pull all the keys from the dictionary <span class="literal">favorite_languages</span> and assign them one at a time to the variable <span class="literal">name</span>. The output shows the names of everyone who took the poll:</p>
<p class="programs">Jen<br class="calibre4" />
Sarah<br class="calibre4" />
Edward<br class="calibre4" />
Phil</p>
<p class="indent">Looping through the keys is actually the default behavior when looping through a dictionary, so this code would have exactly the same output if you wrote . . .</p>
<p class="programs">for name in favorite_languages:</p>
<p class="noindent">rather than . . .</p>
<p class="programs">for name in favorite_languages.keys():</p>
<p class="indent">You can choose to use the <span class="literal">keys()</span> method explicitly if it makes your code easier to read, or you can omit it if you wish.</p>
<p class="indent">You can access the value associated with any key you care about inside the loop by using the current key. Let’s print a message to a couple of friends about the languages they chose. We’ll loop through the names in the dictionary as we did previously, but when the name matches one of our friends, we’ll display a message about their favorite language:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> friends = ['phil', 'sarah']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for name in favorite_languages.keys():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(name.title())<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if name in friends:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;language = favorite_languages[name].title()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\t{name.title()}, I see you love {language}!")</p>
<p class="indent">At <span class="ent">➊</span> we make a list of friends that we want to print a message to. Inside the loop, we print each person’s name. Then at <span class="ent">➋</span> we check whether the <span class="literal">name</span> we’re working with is in the list <span class="literal">friends</span>. If it is, we determine the person’s favorite language using the name of the dictionary and the current value of <span class="literal">name</span> as the key <span class="ent">➌</span>. We then print a special greeting, including a reference to their language of choice.</p>
<p class="indent">Everyone’s name is printed, but our friends receive a special message:</p>
<p class="programs">Hi Jen.<br class="calibre4" />
Hi Sarah.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Sarah, I see you love C!<br class="calibre4" />
Hi Edward.<br class="calibre4" />
<span type="pagebreak" id="calibre_link-300" class="calibre"></span>Hi Phil.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Phil, I see you love Python!</p>
<p class="indent">You can also use the <span class="literal">keys()</span> method to find out if a particular person was polled. This time, let’s find out if Erin took the poll:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'jen': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'sarah': 'c',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'edward': 'ruby',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'phil': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> if 'erin' not in favorite_languages.keys():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Erin, please take our poll!")</p>
<p class="indent">The <span class="literal">keys()</span> method isn’t just for looping: it actually returns a list of all the keys, and the line at <span class="ent">➊</span> simply checks if <span class="literal">'erin'</span> is in this list. Because she’s not, a message is printed inviting her to take the poll:</p>
<p class="programs">Erin, please take our poll!</p>
<h4 class="h3" id="calibre_link-736"><strong class="calibre2"><em class="calibre3">Looping Through a Dictionary’s Keys in a Particular Order</em></strong></h4>
<p class="noindent">Starting in Python 3.7, looping through a dictionary returns the items in the same order they were inserted. Sometimes, though, you’ll want to loop through a dictionary in a different order.</p>
<p class="indent">One way to do this is to sort the keys as they’re returned in the <span class="literal">for</span> loop. You can use the <span class="literal">sorted()</span> function to get a copy of the keys in order:</p>
<p class="programs"><span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'jen': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'sarah': 'c',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'edward': 'ruby',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'phil': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
for name in sorted(favorite_languages.keys()):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"{name.title()}, thank you for taking the poll.")</p>
<p class="indent">This <span class="literal">for</span> statement is like other <span class="literal">for</span> statements except that we’ve wrapped the <span class="literal">sorted()</span> function around the <span class="literal">dictionary.keys()</span> method. This tells Python to list all keys in the dictionary and sort that list before looping through it. The output shows everyone who took the poll, with the names displayed in order:</p>
<p class="programs">Edward, thank you for taking the poll.<br class="calibre4" />
Jen, thank you for taking the poll.<br class="calibre4" />
Phil, thank you for taking the poll.<br class="calibre4" />
Sarah, thank you for taking the poll.</p>
<h4 class="h3" id="calibre_link-737"><span type="pagebreak" id="calibre_link-301" class="calibre"></span><strong class="calibre2"><em class="calibre3">Looping Through All Values in a Dictionary</em></strong></h4>
<p class="noindent">If you are primarily interested in the values that a dictionary contains, you can use the <span class="literal">values()</span> method to return a list of values without any keys. For example, say we simply want a list of all languages chosen in our programming language poll without the name of the person who chose each language:</p>
<p class="programs"><span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'jen': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'sarah': 'c',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'edward': 'ruby',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'phil': 'python',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
print("The following languages have been mentioned:")<br class="calibre4" />
for language in favorite_languages.values():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(language.title())</p>
<p class="indent">The <span class="literal">for</span> statement here pulls each value from the dictionary and assigns it to the variable <span class="literal">language</span>. When these values are printed, we get a list of all chosen languages:</p>
<p class="programs">The following languages have been mentioned:<br class="calibre4" />
Python<br class="calibre4" />
C<br class="calibre4" />
Python<br class="calibre4" />
Ruby</p>
<p class="indent">This approach pulls all the values from the dictionary without checking for repeats. That might work fine with a small number of values, but in a poll with a large number of respondents, this would result in a very repetitive list. To see each language chosen without repetition, we can use a set. A <em class="calibre3">set</em> is a collection in which each item must be unique:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">favorite_languages = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print("The following languages have been mentioned:")</span><br class="calibre4" />
<span class="ent">➊</span> for language in set(favorite_languages.values()):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(language.title())</span></p>
<p class="indent">When you wrap <span class="literal">set()</span> around a list that contains duplicate items, Python identifies the unique items in the list and builds a set from those items. At <span class="ent">➊</span> we use <span class="literal">set()</span> to pull out the unique languages in <span class="literal">favorite_languages.values()</span>.</p>
<p class="indent">The result is a nonrepetitive list of languages that have been mentioned by people taking the poll:</p>
<p class="programs">The following languages have been mentioned:<br class="calibre4" />
Python<br class="calibre4" />
<span type="pagebreak" id="calibre_link-171" class="calibre"></span>C<br class="calibre4" />
Ruby</p>
<p class="indent">As you continue learning about Python, you’ll often find a built-in feature of the language that helps you do exactly what you want with your data.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You can build a set directly using braces and separating the elements with commas:</em></p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">languages = {'python', 'ruby', 'python', 'c'}</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">languages</span><br class="calibre4" />
{'ruby', 'python', 'c'}</p>
<p class="notepi"><em class="calibre3">It’s easy to mistake sets for dictionaries because they’re both wrapped in braces. When you see braces but no key-value pairs, you’re probably looking at a set. Unlike lists and dictionaries, sets do not retain items in any specific order.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-738"><strong class="calibre2">6-4. Glossary 2:</strong> Now that you know how to loop through a dictionary, clean up the code from <a href="#calibre_link-123" class="calibre6">Exercise 6-3</a> (<a href="#calibre_link-124" class="calibre6">page 99</a>) by replacing your series of <span class="literal1">print()</span> calls with a loop that runs through the dictionary’s keys and values. When you’re sure that your loop works, add five more Python terms to your glossary. When you run your program again, these new words and meanings should automatically be included in the output.</p>
<p class="sparal" id="calibre_link-739"><strong class="calibre2">6-5. Rivers:</strong> Make a dictionary containing three major rivers and the country each river runs through. One key-value pair might be <span class="literal1">'nile': 'egypt'</span>.</p>
<ul class="calibre8">
<li class="noindent1">Use a loop to print a sentence about each river, such as <em class="calibre3">The Nile runs through Egypt</em>.</li>
<li class="noindent1">Use a loop to print the name of each river included in the dictionary.</li>
<li class="noindent1">Use a loop to print the name of each country included in the dictionary.</li>
</ul>
<p class="sparal" id="calibre_link-740"><strong class="calibre2">6-6. Polling:</strong> Use the code in <em class="calibre3">favorite_languages.py</em> (<a href="#calibre_link-122" class="calibre6">page 97</a>).</p>
<ul class="calibre8">
<li class="noindent1">Make a list of people who should take the favorite languages poll. Include some names that are already in the dictionary and some that are not.</li>
<li class="noindent1">Loop through the list of people who should take the poll. If they have already taken the poll, print a message thanking them for responding. If they have not yet taken the poll, print a message inviting them to take the poll.</li>
</ul>
</div>
<h3 class="h2" id="calibre_link-741"><span type="pagebreak" id="calibre_link-507" class="calibre"></span><strong class="calibre2">Nesting</strong></h3>
<p class="noindent">Sometimes you’ll want to store multiple dictionaries in a list, or a list of items as a value in a dictionary. This is called <em class="calibre3">nesting</em>. You can nest dictionaries inside a list, a list of items inside a dictionary, or even a dictionary inside another dictionary. Nesting is a powerful feature, as the following examples will demonstrate.</p>
<h4 class="h3" id="calibre_link-742"><strong class="calibre2"><em class="calibre3">A List of Dictionaries</em></strong></h4>
<p class="noindent">The <span class="literal">alien_0</span> dictionary contains a variety of information about one alien, but it has no room to store information about a second alien, much less a screen full of aliens. How can you manage a fleet of aliens? One way is to make a list of aliens in which each alien is a dictionary of information about that alien. For example, the following code builds a list of three aliens:</p>
<p class="margin"><em class="calibre3">aliens.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;alien_0 = {'color': 'green', 'points': 5}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;alien_1 = {'color': 'yellow', 'points': 10}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;alien_2 = {'color': 'red', 'points': 15}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> aliens = [alien_0, alien_1, alien_2]<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for alien in aliens:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(alien)</p>
<p class="indent">We first create three dictionaries, each representing a different alien. At <span class="ent">➊</span> we store each of these dictionaries in a list called <span class="literal">aliens</span>. Finally, we loop through the list and print out each alien:</p>
<p class="programs">{'color': 'green', 'points': 5}<br class="calibre4" />
{'color': 'yellow', 'points': 10}<br class="calibre4" />
{'color': 'red', 'points': 15}</p>
<p class="indent">A more realistic example would involve more than three aliens with code that automatically generates each alien. In the following example we use <span class="literal">range()</span> to create a fleet of 30 aliens:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;# Make an empty list for storing aliens.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;aliens = []<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Make 30 green aliens.<br class="calibre4" />
<span class="ent">➊</span> for alien_number in range(30):<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_alien = {'color': 'green', 'points': 5, 'speed': 'slow'}<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aliens.append(new_alien)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Show the first 5 aliens.<br class="calibre4" />
<span class="ent">➍</span> for alien in aliens[:5]:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(alien)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("...")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Show how many aliens have been created.<br class="calibre4" />
<span class="ent">➎</span> print(f"Total number of aliens: {len(aliens)}")</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1326" class="calibre"></span>This example begins with an empty list to hold all of the aliens that will be created. At <span class="ent">➊</span> <span class="literal">range()</span> returns a series of numbers, which just tells Python how many times we want the loop to repeat. Each time the loop runs we create a new alien <span class="ent">➋</span> and then append each new alien to the list <span class="literal">aliens</span> <span class="ent">➌</span>. At <span class="ent">➍</span> we use a slice to print the first five aliens, and then at <span class="ent">➎</span> we print the length of the list to prove we’ve actually generated the full fleet of 30 aliens:</p>
<p class="programs">{'speed': 'slow', 'color': 'green', 'points': 5}<br class="calibre4" />
{'speed': 'slow', 'color': 'green', 'points': 5}<br class="calibre4" />
{'speed': 'slow', 'color': 'green', 'points': 5}<br class="calibre4" />
{'speed': 'slow', 'color': 'green', 'points': 5}<br class="calibre4" />
{'speed': 'slow', 'color': 'green', 'points': 5}<br class="calibre4" />
...<br class="calibre4" />
<br class="calibre4" />
Total number of aliens: 30</p>
<p class="indent">These aliens all have the same characteristics, but Python considers each one a separate object, which allows us to modify each alien individually.</p>
<p class="indent">How might you work with a group of aliens like this? Imagine that one aspect of a game has some aliens changing color and moving faster as the game progresses. When it’s time to change colors, we can use a <span class="literal">for</span> loop and an <span class="literal">if</span> statement to change the color of aliens. For example, to change the first three aliens to yellow, medium-speed aliens worth 10 points each, we could do this:</p>
<p class="programs"><span class="ash"># Make an empty list for storing aliens.</span><br class="calibre4" />
<span class="ash">aliens = []</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash"># Make 30 green aliens.</span><br class="calibre4" />
<span class="ash">for alien_number in range (30):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">new_alien = {'color': 'green', 'points': 5, 'speed': 'slow'}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">aliens.append(new_alien)</span><br class="calibre4" />
<br class="calibre4" />
for alien in aliens[:3]:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if alien['color'] == 'green':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien['color'] = 'yellow'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien['speed'] = 'medium'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien['points'] = 10<br class="calibre4" />
<br class="calibre4" />
<span class="ash"># Show the first 5 aliens.</span><br class="calibre4" />
<span class="ash">for alien in aliens[:5]:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(alien)</span><br class="calibre4" />
<span class="ash">print("...")</span></p>
<p class="indent">Because we want to modify the first three aliens, we loop through a slice that includes only the first three aliens. All of the aliens are green now but that won’t always be the case, so we write an <span class="literal">if</span> statement to make sure <span type="pagebreak" id="calibre_link-511" class="calibre"></span>we’re only modifying green aliens. If the alien is green, we change the color to <span class="literal">'yellow'</span>, the speed to <span class="literal">'medium'</span>, and the point value to <span class="literal">10</span>, as shown in the following output:</p>
<p class="programs">{'speed': 'medium', 'color': 'yellow', 'points': 10}<br class="calibre4" />
{'speed': 'medium', 'color': 'yellow', 'points': 10}<br class="calibre4" />
{'speed': 'medium', 'color': 'yellow', 'points': 10}<br class="calibre4" />
{'speed': 'slow', 'color': 'green', 'points': 5}<br class="calibre4" />
{'speed': 'slow', 'color': 'green', 'points': 5}<br class="calibre4" />
...</p>
<p class="indent">You could expand this loop by adding an <span class="literal">elif</span> block that turns yellow aliens into red, fast-moving ones worth 15 points each. Without showing the entire program again, that loop would look like this:</p>
<p class="programs"><span class="ash">for alien in aliens[0:3]:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if alien['color'] == 'green':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien['color'] = 'yellow'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien['speed'] = 'medium'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien['points'] = 10</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;elif alien['color'] == 'yellow':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien['color'] = 'red'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien['speed'] = 'fast'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien['points'] = 15</p>
<p class="indent">It’s common to store a number of dictionaries in a list when each dictionary contains many kinds of information about one object. For example, you might create a dictionary for each user on a website, as we did in <em class="calibre3">user.py</em> on <a href="#calibre_link-125" class="calibre6">page 100</a>, and store the individual dictionaries in a list called <span class="literal">users</span>. All of the dictionaries in the list should have an identical structure so you can loop through the list and work with each dictionary object in the same way.</p>
<h4 class="h3" id="calibre_link-743"><strong class="calibre2"><em class="calibre3">A List in a Dictionary</em></strong></h4>
<p class="noindent">Rather than putting a dictionary inside a list, it’s sometimes useful to put a list inside a dictionary. For example, consider how you might describe a pizza that someone is ordering. If you were to use only a list, all you could really store is a list of the pizza’s toppings. With a dictionary, a list of toppings can be just one aspect of the pizza you’re describing.</p>
<p class="indent">In the following example, two kinds of information are stored for each pizza: a type of crust and a list of toppings. The list of toppings is a value associated with the key <span class="literal">'toppings'</span>. To use the items in the list, we give the name of the dictionary and the key <span class="literal">'toppings'</span>, as we would any value in the dictionary. Instead of returning a single value, we get a list of toppings:</p>
<p class="margin"><em class="calibre3">pizza.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;# Store information about a pizza being ordered.<br class="calibre4" />
<span class="ent">➊</span> pizza = {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'crust': 'thick',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'toppings': ['mushrooms', 'extra cheese'],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br class="calibre4" />
<span type="pagebreak" id="calibre_link-471" class="calibre"></span>&nbsp;&nbsp;&nbsp;# Summarize the order.<br class="calibre4" />
<span class="ent">➋</span> print(f"You ordered a {pizza['crust']}-crust pizza "<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"with the following toppings:")<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> for topping in pizza['toppings']:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("\t" + topping)</p>
<p class="indent">We begin at <span class="ent">➊</span> with a dictionary that holds information about a pizza that has been ordered. One key in the dictionary is <span class="literal">'crust'</span>, and the associated value is the string <span class="literal">'thick'</span>. The next key, <span class="literal">'toppings'</span>, has a list as its value that stores all requested toppings. At <span class="ent">➋</span> we summarize the order before building the pizza. When you need to break up a long line in a <span class="literal">print()</span> call, choose an appropriate point at which to break the line being printed, and end the line with a quotation mark. Indent the next line, add an opening quotation mark, and continue the string. Python will automatically combine all of the strings it finds inside the parentheses. To print the toppings, we write a <span class="literal">for</span> loop <span class="ent">➌</span>. To access the list of toppings, we use the key <span class="literal">'toppings'</span>, and Python grabs the list of toppings from the dictionary.</p>
<p class="indent">The following output summarizes the pizza that we plan to build:</p>
<p class="programs">You ordered a thick-crust pizza with the following toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;mushrooms<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;extra cheese</p>
<p class="indent">You can nest a list inside a dictionary any time you want more than one value to be associated with a single key in a dictionary. In the earlier example of favorite programming languages, if we were to store each person’s responses in a list, people could choose more than one favorite language. When we loop through the dictionary, the value associated with each person would be a list of languages rather than a single language. Inside the dictionary’s <span class="literal">for</span> loop, we use another <span class="literal">for</span> loop to run through the list of languages associated with each person:</p>
<p class="margin"><em class="calibre3">favorite_languages.py</em></p>
<p class="programs"><span class="ent">➊</span> favorite_languages = {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'jen': ['python', 'ruby'],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'sarah': ['c'],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'edward': ['ruby', 'go'],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'phil': ['python', 'haskell'],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> for name, languages in favorite_languages.items():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\n{name.title()}'s favorite languages are:")<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for language in languages:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\t{language.title()}")</p>
<p class="indent">As you can see at <span class="ent">➊</span> the value associated with each name is now a list. Notice that some people have one favorite language and others have <span type="pagebreak" id="calibre_link-509" class="calibre"></span>multiple favorites. When we loop through the dictionary at <span class="ent">➋</span>, we use the variable name <span class="literal">languages</span> to hold each value from the dictionary, because we know that each value will be a list. Inside the main dictionary loop, we use another <span class="literal">for</span> loop <span class="ent">➌</span> to run through each person’s list of favorite languages. Now each person can list as many favorite languages as they like:</p>
<p class="programs">Jen's favorite languages are:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Python<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Ruby<br class="calibre4" />
<br class="calibre4" />
Sarah's favorite languages are:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;C<br class="calibre4" />
<br class="calibre4" />
Phil's favorite languages are:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Python<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Haskell<br class="calibre4" />
<br class="calibre4" />
Edward's favorite languages are:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Ruby<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Go</p>
<p class="indent">To refine this program even further, you could include an <span class="literal">if</span> statement at the beginning of the dictionary’s <span class="literal">for</span> loop to see whether each person has more than one favorite language by examining the value of <span class="literal">len(languages)</span>. If a person has more than one favorite, the output would stay the same. If the person has only one favorite language, you could change the wording to reflect that. For example, you could say <span class="literal">Sarah's favorite language is C</span>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You should not nest lists and dictionaries too deeply. If you’re nesting items much deeper than what you see in the preceding examples or you’re working with someone else’s code with significant levels of nesting, most likely a simpler way to solve the problem exists.</em></p>
</div>
<h4 class="h3" id="calibre_link-744"><strong class="calibre2"><em class="calibre3">A Dictionary in a Dictionary</em></strong></h4>
<p class="noindent">You can nest a dictionary inside another dictionary, but your code can get complicated quickly when you do. For example, if you have several users for a website, each with a unique username, you can use the usernames as the keys in a dictionary. You can then store information about each user by using a dictionary as the value associated with their username. In the following listing, we store three pieces of information about each user: their first name, last name, and location. We’ll access this information by looping through the usernames and the dictionary of information associated with each username:</p>
<p class="margin"><em class="calibre3">many_users.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;users = {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'aeinstein': {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'first': 'albert',<br class="calibre4" />
<span type="pagebreak" id="calibre_link-510" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'last': 'einstein',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'location': 'princeton',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'mcurie': {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'first': 'marie',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'last': 'curie',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'location': 'paris',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> for username, user_info in users.items():<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nUsername: {username}")<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{user_info['first']} {user_info['last']}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location = user_info['location']<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\tFull name: {full_name.title()}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\tLocation: {location.title()}")</p>
<p class="indent">We first define a dictionary called <span class="literal">users</span> with two keys: one each for the usernames <span class="literal">'aeinstein'</span> and <span class="literal">'mcurie'</span>. The value associated with each key is a dictionary that includes each user’s first name, last name, and location. At <span class="ent">➊</span> we loop through the <span class="literal">users</span> dictionary. Python assigns each key to the variable <span class="literal">username</span>, and the dictionary associated with each username is assigned to the variable <span class="literal">user_info</span>. Once inside the main dictionary loop, we print the username at <span class="ent">➋</span>.</p>
<p class="indent">At <span class="ent">➌</span> we start accessing the inner dictionary. The variable <span class="literal">user_info</span>, which contains the dictionary of user information, has three keys: <span class="literal">'first'</span>, <span class="literal">'last'</span>, and <span class="literal">'location'</span>. We use each key to generate a neatly formatted full name and location for each person, and then print a summary of what we know about each user <span class="ent">➍</span>:</p>
<p class="programs">Username: aeinstein<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Full name: Albert Einstein<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Location: Princeton<br class="calibre4" />
<br class="calibre4" />
Username: mcurie<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Full name: Marie Curie<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Location: Paris</p>
<p class="indent">Notice that the structure of each user’s dictionary is identical. Although not required by Python, this structure makes nested dictionaries easier to work with. If each user’s dictionary had different keys, the code inside the <span class="literal">for</span> loop would be more complicated.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-508" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-745"><strong class="calibre2">6-7. People:</strong> Start with the program you wrote for <a href="#calibre_link-126" class="calibre6">Exercise 6-1</a> (<a href="#calibre_link-124" class="calibre6">page 99</a>). Make two new dictionaries representing different people, and store all three dictionaries in a list called <span class="literal1">people</span>. Loop through your list of people. As you loop through the list, print everything you know about each person.</p>
<p class="sparal" id="calibre_link-746"><strong class="calibre2">6-8. Pets:</strong> Make several dictionaries, where each dictionary represents a different pet. In each dictionary, include the kind of animal and the owner’s name. Store these dictionaries in a list called <span class="literal1">pets</span>. Next, loop through your list and as you do, print everything you know about each pet.</p>
<p class="sparal" id="calibre_link-747"><strong class="calibre2">6-9. Favorite Places:</strong> Make a dictionary called <span class="literal1">favorite_places</span>. Think of three names to use as keys in the dictionary, and store one to three favorite places for each person. To make this exercise a bit more interesting, ask some friends to name a few of their favorite places. Loop through the dictionary, and print each person’s name and their favorite places.</p>
<p class="sparal" id="calibre_link-748"><strong class="calibre2">6-10. Favorite Numbers:</strong> Modify your program from <a href="#calibre_link-127" class="calibre6">Exercise 6-2</a> (<a href="#calibre_link-124" class="calibre6">page 99</a>) so each person can have more than one favorite number. Then print each person’s name along with their favorite numbers.</p>
<p class="sparal" id="calibre_link-749"><strong class="calibre2">6-11. Cities:</strong> Make a dictionary called <span class="literal1">cities</span>. Use the names of three cities as keys in your dictionary. Create a dictionary of information about each city and include the country that the city is in, its approximate population, and one fact about that city. The keys for each city’s dictionary should be something like <span class="literal1">country</span>, <span class="literal1">population</span>, and <span class="literal1">fact</span>. Print the name of each city and all of the information you have stored about it.</p>
<p class="sparal" id="calibre_link-750"><strong class="calibre2">6-12. Extensions:</strong> We’re now working with examples that are complex enough that they can be extended in any number of ways. Use one of the example programs from this chapter, and extend it by adding new keys and values, changing the context of the program or improving the formatting of the output.</p>
</div>
<h3 class="h2" id="calibre_link-751"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned how to define a dictionary and how to work with the information stored in a dictionary. You learned how to access and modify individual elements in a dictionary, and how to loop through all of the information in a dictionary. You learned to loop through a dictionary’s key-value pairs, its keys, and its values. You also learned how to nest multiple dictionaries in a list, nest lists in a dictionary, and nest a dictionary inside a dictionary.</p>
<p class="indent">In the next chapter you’ll learn about <span class="literal">while</span> loops and how to accept input from people who are using your programs. This will be an exciting chapter, because you’ll learn to make all of your programs interactive: they’ll be able to respond to user input.</p>
</div>


<div class="calibre1" id="calibre_link-129">
<h2 class="h" id="calibre_link-117"><span type="pagebreak" id="calibre_link-1327" class="calibre"></span><strong class="calibre2"><span class="big">7</span><br class="calibre4" />USER INPUT AND WHILE LOOPS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Most programs are written to solve an end user’s problem. To do so, you usually need to get some information from the user. For a simple example, let’s say someone wants to find out whether they’re old enough to vote. If you write a program to answer this question, you need to know the user’s age before you can provide an answer. The program will need to ask the user to enter, or <em class="calibre3">input</em>, their age; once the program has this input, it can compare it to the voting age to determine if the user is old enough and then report the result.</p>
<p class="indent">In this chapter you’ll learn how to accept user input so your program can then work with it. When your program needs a name, you’ll be able to prompt the user for a name. When your program needs a list of names, you’ll be able to prompt the user for a series of names. To do this, you’ll use the <span class="literal">input()</span> function.</p>
<p class="indent">You’ll also learn how to keep programs running as long as users want them to, so they can enter as much information as they need to; then, your program can work with that information. You’ll use Python’s <span class="literal">while</span> loop to keep programs running as long as certain conditions remain true.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-425" class="calibre"></span>With the ability to work with user input and the ability to control how long your programs run, you’ll be able to write fully interactive programs.</p>
<h3 class="h2" id="calibre_link-752"><strong class="calibre2">How the input() Function Works</strong></h3>
<p class="noindent">The <span class="literal">input()</span> function pauses your program and waits for the user to enter some text. Once Python receives the user’s input, it assigns that input to a variable to make it convenient for you to work with.</p>
<p class="indent">For example, the following program asks the user to enter some text, then displays that message back to the user:</p>
<p class="margin"><em class="calibre3">parrot.py</em></p>
<p class="programs">message = input("Tell me something, and I will repeat it back to you: ")<br class="calibre4" />
print(message)</p>
<p class="indent">The <span class="literal">input()</span> function takes one argument: the <em class="calibre3">prompt</em>, or instructions, that we want to display to the user so they know what to do. In this example, when Python runs the first line, the user sees the prompt <span class="literal">Tell me something, and I will repeat it back to you:</span> . The program waits while the user enters their response and continues after the user presses <small class="calibre5">ENTER</small>. The response is assigned to the variable <span class="literal">message</span>, then <span class="literal">print(message)</span> displays the input back to the user:</p>
<p class="programs">Tell me something, and I will repeat it back to you: <span class="codestrong">Hello everyone!</span><br class="calibre4" />
Hello everyone!</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Sublime Text and many other editors don’t run programs that prompt the user for input. You can use these editors to write programs that prompt for input, but you’ll need to run these programs from a terminal. See “<a href="#calibre_link-130" class="calibre6">Running Python Programs from a Terminal</a>” on <a href="#calibre_link-131" class="calibre6">page 12</a>.</em></p>
</div>
<h4 class="h3" id="calibre_link-753"><strong class="calibre2"><em class="calibre3">Writing Clear Prompts</em></strong></h4>
<p class="noindent">Each time you use the <span class="literal">input()</span> function, you should include a clear, easy-to-follow prompt that tells the user exactly what kind of information you’re looking for. Any statement that tells the user what to enter should work. For example:</p>
<p class="margin"><em class="calibre3">greeter.py</em></p>
<p class="programs">name = input("Please enter your name: ")<br class="calibre4" />
print(f"\nHello, {name}!")</p>
<p class="indent">Add a space at the end of your prompts (after the colon in the preceding example) to separate the prompt from the user’s response and to make it clear to your user where to enter their text. For example:</p>
<p class="programs">Please enter your name: <span class="codestrong">Eric</span><br class="calibre4" />
Hello, Eric!</p>
<p class="indent"><span type="pagebreak" id="calibre_link-182" class="calibre"></span>Sometimes you’ll want to write a prompt that’s longer than one line. For example, you might want to tell the user why you’re asking for certain input. You can assign your prompt to a variable and pass that variable to the <span class="literal">input()</span> function. This allows you to build your prompt over several lines, then write a clean <span class="literal">input()</span> statement.</p>
<p class="margin"><em class="calibre3">greeter.py</em></p>
<p class="programs">prompt = "If you tell us who you are, we can personalize the messages you see."<br class="calibre4" />
prompt += "\nWhat is your first name? "<br class="calibre4" />
<br class="calibre4" />
name = input(prompt)<br class="calibre4" />
<span class="ash">print(f"\nHello, {name}!")</span></p>
<p class="indent">This example shows one way to build a multi-line string. The first line assigns the first part of the message to the variable <span class="literal">prompt</span>. In the second line, the operator <span class="literal">+=</span> takes the string that was assigned to <span class="literal">prompt</span> and adds the new string onto the end.</p>
<p class="indent">The prompt now spans two lines, again with space after the question mark for clarity:</p>
<p class="programs">If you tell us who you are, we can personalize the messages you see.<br class="calibre4" />
What is your first name? <span class="codestrong">Eric</span><br class="calibre4" />
<br class="calibre4" />
Hello, Eric!</p>
<h4 class="h3" id="calibre_link-754"><strong class="calibre2"><em class="calibre3">Using int() to Accept Numerical Input</em></strong></h4>
<p class="noindent">When you use the <span class="literal">input()</span> function, Python interprets everything the user enters as a string. Consider the following interpreter session, which asks for the user’s age:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">age = input("How old are you? ")</span><br class="calibre4" />
How old are you? <span class="codestrong">21</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">age</span><br class="calibre4" />
'21'</p>
<p class="indent">The user enters the number 21, but when we ask Python for the value of <span class="literal">age</span>, it returns <span class="literal">'21'</span>, the string representation of the numerical value entered. We know Python interpreted the input as a string because the number is now enclosed in quotes. If all you want to do is print the input, this works well. But if you try to use the input as a number, you’ll get an error:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">age = input("How old are you? ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;How old are you? <span class="codestrong">21</span><br class="calibre4" />
<span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">age &gt;= 18</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br class="calibre4" />
<span class="ent">➋</span> TypeError: unorderable types: str() &gt;= int()</p>
<p class="indent"><span type="pagebreak" id="calibre_link-178" class="calibre"></span>When you try to use the input to do a numerical comparison <span class="ent">➊</span>, Python produces an error because it can’t compare a string to an integer: the string <span class="literal">'21'</span> that’s assigned to <span class="literal">age</span> can’t be compared to the numerical value <span class="literal">18</span> <span class="ent">➋</span>.</p>
<p class="indent">We can resolve this issue by using the <span class="literal">int()</span> function, which tells Python to treat the input as a numerical value. The <span class="literal">int()</span> function converts a string representation of a number to a numerical representation, as shown here:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">age = input("How old are you? ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;How old are you? <span class="codestrong">21</span><br class="calibre4" />
<span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">age = int(age)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">age &gt;= 18</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;True</p>
<p class="indent">In this example, when we enter <span class="literal">21</span> at the prompt, Python interprets the number as a string, but the value is then converted to a numerical representation by <span class="literal">int()</span> <span class="ent">➊</span>. Now Python can run the conditional test: it compares <span class="literal">age</span> (which now represents the numerical value 21) and <span class="literal">18</span> to see if <span class="literal">age</span> is greater than or equal to 18. This test evaluates to <span class="literal">True</span>.</p>
<p class="indent">How do you use the <span class="literal">int()</span> function in an actual program? Consider a program that determines whether people are tall enough to ride a roller coaster:</p>
<p class="margin"><em class="calibre3">rollercoaster.py</em></p>
<p class="programs">height = input("How tall are you, in inches? ")<br class="calibre4" />
height = int(height)<br class="calibre4" />
<br class="calibre4" />
if height &gt;= 48:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print("\nYou're tall enough to ride!")<br class="calibre4" />
else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print("\nYou'll be able to ride when you're a little older.")</p>
<p class="indent">The program can compare <span class="literal">height</span> to <span class="literal">48</span> because <span class="literal">height = int(height)</span> converts the input value to a numerical representation before the comparison is made. If the number entered is greater than or equal to 48, we tell the user that they’re tall enough:</p>
<p class="programs">How tall are you, in inches? <span class="codestrong">71</span><br class="calibre4" />
<br class="calibre4" />
You're tall enough to ride!</p>
<p class="indent">When you use numerical input to do calculations and comparisons, be sure to convert the input value to a numerical representation first.</p>
<h4 class="h3" id="calibre_link-755"><strong class="calibre2"><em class="calibre3">The Modulo Operator</em></strong></h4>
<p class="noindent">A useful tool for working with numerical information is the <em class="calibre3">modulo operator</em> (<span class="literal">%</span>), which divides one number by another number and returns the remainder:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">4 % 3</span><br class="calibre4" />
1<br class="calibre4" />
<span type="pagebreak" id="calibre_link-179" class="calibre"></span>&gt;&gt;&gt; <span class="codestrong">5 % 3</span><br class="calibre4" />
2<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">6 % 3</span><br class="calibre4" />
0<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">7 % 3</span><br class="calibre4" />
1</p>
<p class="indent">The modulo operator doesn’t tell you how many times one number fits into another; it just tells you what the remainder is.</p>
<p class="indent">When one number is divisible by another number, the remainder is 0, so the modulo operator always returns 0. You can use this fact to determine if a number is even or odd:</p>
<p class="margin"><em class="calibre3">even_or_odd.py</em></p>
<p class="programs">number = input("Enter a number, and I'll tell you if it's even or odd: ")<br class="calibre4" />
number = int(number)<br class="calibre4" />
<br class="calibre4" />
if number % 2 == 0:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nThe number {number} is even.")<br class="calibre4" />
else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nThe number {number} is odd.")</p>
<p class="indent">Even numbers are always divisible by two, so if the modulo of a number and two is zero (here, <span class="literal">if number % 2 == 0</span>) the number is even. Otherwise, it’s odd.</p>
<p class="programs">Enter a number, and I'll tell you if it's even or odd: <span class="codestrong">42</span><br class="calibre4" />
<br class="calibre4" />
The number 42 is even.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-756"><strong class="calibre2">7-1. Rental Car:</strong> Write a program that asks the user what kind of rental car they would like. Print a message about that car, such as “Let me see if I can find you a Subaru.”</p>
<p class="sparal" id="calibre_link-757"><strong class="calibre2">7-2. Restaurant Seating:</strong> Write a program that asks the user how many people are in their dinner group. If the answer is more than eight, print a message saying they’ll have to wait for a table. Otherwise, report that their table is ready.</p>
<p class="sparal" id="calibre_link-758"><strong class="calibre2">7-3. Multiples of Ten:</strong> Ask the user for a number, and then report whether the number is a multiple of 10 or not.</p>
</div>
<h3 class="h2" id="calibre_link-759"><span type="pagebreak" id="calibre_link-280" class="calibre"></span><strong class="calibre2">Introducing while Loops</strong></h3>
<p class="noindent">The <span class="literal">for</span> loop takes a collection of items and executes a block of code once for each item in the collection. In contrast, the <span class="literal">while</span> loop runs as long as, or <em class="calibre3">while</em>, a certain condition is true.</p>
<h4 class="h3" id="calibre_link-760"><strong class="calibre2"><em class="calibre3">The while Loop in Action</em></strong></h4>
<p class="noindent">You can use a <span class="literal">while</span> loop to count up through a series of numbers. For example, the following <span class="literal">while</span> loop counts from 1 to 5:</p>
<p class="margin"><em class="calibre3">counting.py</em></p>
<p class="programs">current_number = 1<br class="calibre4" />
while current_number &lt;= 5:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(current_number)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;current_number += 1</p>
<p class="indent">In the first line, we start counting from 1 by assigning <span class="literal">current_number</span> the value 1. The <span class="literal">while</span> loop is then set to keep running as long as the value of <span class="literal">current_number</span> is less than or equal to 5. The code inside the loop prints the value of <span class="literal">current_number</span> and then adds 1 to that value with <span class="literal">current_number += 1</span>. (The <span class="literal">+=</span> operator is shorthand for <span class="literal">current_number = current_number + 1</span>.)</p>
<p class="indent">Python repeats the loop as long as the condition <span class="literal">current_number &lt;= 5</span> is true. Because 1 is less than 5, Python prints <span class="literal">1</span> and then adds 1, making the current number <span class="literal">2</span>. Because 2 is less than 5, Python prints <span class="literal">2</span> and adds 1 again, making the current number <span class="literal">3</span>, and so on. Once the value of <span class="literal">current_number</span> is greater than 5, the loop stops running and the program ends:</p>
<p class="programs">1<br class="calibre4" />
2<br class="calibre4" />
3<br class="calibre4" />
4<br class="calibre4" />
5</p>
<p class="indent">The programs you use every day most likely contain <span class="literal">while</span> loops. For example, a game needs a <span class="literal">while</span> loop to keep running as long as you want to keep playing, and so it can stop running as soon as you ask it to quit. Programs wouldn’t be fun to use if they stopped running before we told them to or kept running even after we wanted to quit, so <span class="literal">while</span> loops are quite useful.</p>
<h4 class="h3" id="calibre_link-761"><strong class="calibre2"><em class="calibre3">Letting the User Choose When to Quit</em></strong></h4>
<p class="noindent">We can make the <em class="calibre3">parrot.py</em> program run as long as the user wants by putting most of the program inside a <span class="literal">while</span> loop. We’ll define a <em class="calibre3">quit value</em> and then keep the program running as long as the user has not entered the quit value:</p>
<p class="margin"><em class="calibre3">parrot.py</em></p>
<p class="programs"><span class="ent">➊</span> prompt = "\nTell me something, and I will repeat it back to you:"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;prompt += "\nEnter 'quit' to end the program. "<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1328" class="calibre"></span><span class="ent">➋</span> message = ""<br class="calibre4" />
<span class="ent">➌</span> while message != 'quit':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message = input(prompt)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(message)</p>
<p class="indent">At <span class="ent">➊</span>, we define a prompt that tells the user their two options: entering a message or entering the quit value (in this case, <span class="literal">'quit'</span>). Then we set up a variable <span class="literal">message</span> <span class="ent">➋</span> to keep track of whatever value the user enters. We define <span class="literal">message</span> as an empty string, <span class="literal">""</span>, so Python has something to check the first time it reaches the <span class="literal">while</span> line. The first time the program runs and Python reaches the <span class="literal">while</span> statement, it needs to compare the value of <span class="literal">message</span> to <span class="literal">'quit'</span>, but no user input has been entered yet. If Python has nothing to compare, it won’t be able to continue running the program. To solve this problem, we make sure to give <span class="literal">message</span> an initial value. Although it’s just an empty string, it will make sense to Python and allow it to perform the comparison that makes the <span class="literal">while</span> loop work. This <span class="literal">while</span> loop <span class="ent">➌</span> runs as long as the value of <span class="literal">message</span> is not <span class="literal">'quit'</span>.</p>
<p class="indent">The first time through the loop, <span class="literal">message</span> is just an empty string, so Python enters the loop. At <span class="literal">message = input(prompt)</span>, Python displays the prompt and waits for the user to enter their input. Whatever they enter is assigned to <span class="literal">message</span> and printed; then, Python reevaluates the condition in the <span class="literal">while</span> statement. As long as the user has not entered the word <span class="literal">'quit'</span>, the prompt is displayed again and Python waits for more input. When the user finally enters <span class="literal">'quit'</span>, Python stops executing the <span class="literal">while</span> loop and the program ends:</p>
<p class="programs">Tell me something, and I will repeat it back to you:<br class="calibre4" />
Enter 'quit' to end the program. <span class="codestrong">Hello everyone!</span><br class="calibre4" />
Hello everyone!<br class="calibre4" />
<br class="calibre4" />
Tell me something, and I will repeat it back to you:<br class="calibre4" />
Enter 'quit' to end the program. <span class="codestrong">Hello again.</span><br class="calibre4" />
Hello again.<br class="calibre4" />
<br class="calibre4" />
Tell me something, and I will repeat it back to you:<br class="calibre4" />
Enter 'quit' to end the program. <span class="codestrong">quit</span><br class="calibre4" />
quit</p>
<p class="indent">This program works well, except that it prints the word <span class="literal">'quit'</span> as if it were an actual message. A simple <span class="literal">if</span> test fixes this:</p>
<p class="programs"><span class="ash">prompt = "\nTell me something, and I will repeat it back to you:"</span><br class="calibre4" />
<span class="ash">prompt += "\nEnter 'quit' to end the program. "</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">message = ""</span><br class="calibre4" />
<span class="ash">while message != 'quit':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">message = input(prompt)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if message != 'quit':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(message)</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-385" class="calibre"></span>Now the program makes a quick check before displaying the message and only prints the message if it does not match the quit value:</p>
<p class="programs">Tell me something, and I will repeat it back to you:<br class="calibre4" />
Enter 'quit' to end the program. <span class="codestrong">Hello everyone!</span><br class="calibre4" />
Hello everyone!<br class="calibre4" />
<br class="calibre4" />
Tell me something, and I will repeat it back to you:<br class="calibre4" />
Enter 'quit' to end the program. <span class="codestrong">Hello again.</span><br class="calibre4" />
Hello again.<br class="calibre4" />
<br class="calibre4" />
Tell me something, and I will repeat it back to you:<br class="calibre4" />
Enter 'quit' to end the program. <span class="codestrong">quit</span></p>
<h4 class="h3" id="calibre_link-762"><strong class="calibre2"><em class="calibre3">Using a Flag</em></strong></h4>
<p class="noindent">In the previous example, we had the program perform certain tasks while a given condition was true. But what about more complicated programs in which many different events could cause the program to stop running?</p>
<p class="indent">For example, in a game, several different events can end the game. When the player runs out of ships, their time runs out, or the cities they were supposed to protect are all destroyed, the game should end. It needs to end if any one of these events happens. If many possible events might occur to stop the program, trying to test all these conditions in one <span class="literal">while</span> statement becomes complicated and difficult.</p>
<p class="indent">For a program that should run only as long as many conditions are true, you can define one variable that determines whether or not the entire program is active. This variable, called a <em class="calibre3">flag</em>, acts as a signal to the program. We can write our programs so they run while the flag is set to <span class="literal">True</span> and stop running when any of several events sets the value of the flag to <span class="literal">False</span>. As a result, our overall <span class="literal">while</span> statement needs to check only one condition: whether or not the flag is currently <span class="literal">True</span>. Then, all our other tests (to see if an event has occurred that should set the flag to <span class="literal">False</span>) can be neatly organized in the rest of the program.</p>
<p class="indent">Let’s add a flag to <em class="calibre3">parrot.py</em> from the previous section. This flag, which we’ll call <span class="literal">active</span> (though you can call it anything), will monitor whether or not the program should continue running:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">prompt = "\nTell me something, and I will repeat it back to you:"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">prompt += "\nEnter 'quit' to end the program. "</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> active = True<br class="calibre4" />
<span class="ent">➋</span> while active:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message = input(prompt)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if message == 'quit':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;active = False<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(message)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-260" class="calibre"></span>We set the variable <span class="literal">active</span> to <span class="literal">True</span> <span class="ent">➊</span> so the program starts in an active state. Doing so makes the <span class="literal">while</span> statement simpler because no comparison is made in the <span class="literal">while</span> statement itself; the logic is taken care of in other parts of the program. As long as the <span class="literal">active</span> variable remains <span class="literal">True</span>, the loop will continue running <span class="ent">➋</span>.</p>
<p class="indent">In the <span class="literal">if</span> statement inside the <span class="literal">while</span> loop, we check the value of <span class="literal">message</span> once the user enters their input. If the user enters <span class="literal">'quit'</span> <span class="ent">➌</span>, we set <span class="literal">active</span> to <span class="literal">False</span>, and the <span class="literal">while</span> loop stops. If the user enters anything other than <span class="literal">'quit'</span> <span class="ent">➍</span>, we print their input as a message.</p>
<p class="indent">This program has the same output as the previous example where we placed the conditional test directly in the <span class="literal">while</span> statement. But now that we have a flag to indicate whether the overall program is in an active state, it would be easy to add more tests (such as <span class="literal">elif</span> statements) for events that should cause <span class="literal">active</span> to become <span class="literal">False</span>. This is useful in complicated programs like games in which there may be many events that should each make the program stop running. When any of these events causes the active flag to become <span class="literal">False</span>, the main game loop will exit, a <em class="calibre3">Game Over</em> message can be displayed, and the player can be given the option to play again.</p>
<h4 class="h3" id="calibre_link-763"><strong class="calibre2"><em class="calibre3">Using break to Exit a Loop</em></strong></h4>
<p class="noindent">To exit a <span class="literal">while</span> loop immediately without running any remaining code in the loop, regardless of the results of any conditional test, use the <span class="literal">break</span> statement. The <span class="literal">break</span> statement directs the flow of your program; you can use it to control which lines of code are executed and which aren’t, so the program only executes code that you want it to, when you want it to.</p>
<p class="indent">For example, consider a program that asks the user about places they’ve visited. We can stop the <span class="literal">while</span> loop in this program by calling <span class="literal">break</span> as soon as the user enters the <span class="literal">'quit'</span> value:</p>
<p class="margin"><em class="calibre3">cities.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;prompt = "\nPlease enter the name of a city you have visited:"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;prompt += "\n(Enter 'quit' when you are finished.) "<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> while True:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;city = input(prompt)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if city == 'quit':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"I'd love to go to {city.title()}!")</p>
<p class="indent">A loop that starts with <span class="literal">while True</span> <span class="ent">➊</span> will run forever unless it reaches a <span class="literal">break</span> statement. The loop in this program continues asking the user to enter the names of cities they’ve been to until they enter <span class="literal">'quit'</span>. When they enter <span class="literal">'quit'</span>, the <span class="literal">break</span> statement runs, causing Python to exit the loop:</p>
<p class="programs">Please enter the name of a city you have visited:<br class="calibre4" />
(Enter 'quit' when you are finished.) <span class="codestrong">New York</span><br class="calibre4" />
I'd love to go to New York!<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-180" class="calibre"></span>Please enter the name of a city you have visited:<br class="calibre4" />
(Enter 'quit' when you are finished.) <span class="codestrong">San Francisco</span><br class="calibre4" />
I'd love to go to San Francisco!<br class="calibre4" />
<br class="calibre4" />
Please enter the name of a city you have visited:<br class="calibre4" />
(Enter 'quit' when you are finished.) <span class="codestrong">quit</span></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You can use the <span class="codeitalic">break</span> statement in any of Python’s loops. For example, you could use <span class="codeitalic">break</span> to quit a <span class="codeitalic">for</span> loop that’s working through a list or a dictionary.</em></p>
</div>
<h4 class="h3" id="calibre_link-764"><strong class="calibre2"><em class="calibre3">Using continue in a Loop</em></strong></h4>
<p class="noindent">Rather than breaking out of a loop entirely without executing the rest of its code, you can use the <span class="literal">continue</span> statement to return to the beginning of the loop based on the result of a conditional test. For example, consider a loop that counts from 1 to 10 but prints only the odd numbers in that range:</p>
<p class="margin"><em class="calibre3">counting.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;current_number = 0<br class="calibre4" />
&nbsp;&nbsp;&nbsp;while current_number &lt; 10:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_number += 1<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if current_number % 2 == 0:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(current_number)</p>
<p class="indent">First we set <span class="literal">current_number</span> to 0. Because it’s less than 10, Python enters the <span class="literal">while</span> loop. Once inside the loop, we increment the count by 1 at <span class="ent">➊</span>, so <span class="literal">current_number</span> is 1. The <span class="literal">if</span> statement then checks the modulo of <span class="literal">current_number</span> and 2. If the modulo is 0 (which means <span class="literal">current_number</span> is divisible by 2), the <span class="literal">continue</span> statement tells Python to ignore the rest of the loop and return to the beginning. If the current number is not divisible by 2, the rest of the loop is executed and Python prints the current number:</p>
<p class="programs">1<br class="calibre4" />
3<br class="calibre4" />
5<br class="calibre4" />
7<br class="calibre4" />
9</p>
<h4 class="h3" id="calibre_link-765"><strong class="calibre2"><em class="calibre3">Avoiding Infinite Loops</em></strong></h4>
<p class="noindent">Every <span class="literal">while</span> loop needs a way to stop running so it won’t continue to run forever. For example, this counting loop should count from 1 to 5:</p>
<p class="margin"><em class="calibre3">counting.py</em></p>
<p class="programs">x = 1<br class="calibre4" />
while x &lt;= 5:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(x)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;x += 1</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1329" class="calibre"></span>But if you accidentally omit the line <span class="literal">x += 1</span> (as shown next), the loop will run forever:</p>
<p class="programs"># This loop runs forever!<br class="calibre4" />
x = 1<br class="calibre4" />
while x &lt;= 5:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(x)</p>
<p class="indent">Now the value of <span class="literal">x</span> will start at <span class="literal">1</span> but never change. As a result, the conditional test <span class="literal">x &lt;= 5</span> will always evaluate to <span class="literal">True</span> and the <span class="literal">while</span> loop will run forever, printing a series of 1s, like this:</p>
<p class="programs">1<br class="calibre4" />
1<br class="calibre4" />
1<br class="calibre4" />
1<br class="calibre4" />
--<span class="codeitalic1">snip</span>--</p>
<p class="indent">Every programmer accidentally writes an infinite <span class="literal">while</span> loop from time to time, especially when a program’s loops have subtle exit conditions. If your program gets stuck in an infinite loop, press <small class="calibre5">CTRL</small>-C or just close the terminal window displaying your program’s output.</p>
<p class="indent">To avoid writing infinite loops, test every <span class="literal">while</span> loop and make sure the loop stops when you expect it to. If you want your program to end when the user enters a certain input value, run the program and enter that value. If the program doesn’t end, scrutinize the way your program handles the value that should cause the loop to exit. Make sure at least one part of the program can make the loop’s condition <span class="literal">False</span> or cause it to reach a <span class="literal">break</span> statement.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Sublime Text and some other editors have an embedded output window. This can make it difficult to stop an infinite loop, and you might have to close the editor to end the loop. Try clicking in the output area of the editor before pressing <small class="calibre5">CTRL</small>-C, and you should be able to cancel an infinite loop.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-132"><strong class="calibre2">7-4. Pizza Toppings:</strong> Write a loop that prompts the user to enter a series of pizza toppings until they enter a <span class="literal1">'quit'</span> value. As they enter each topping, print a message saying you’ll add that topping to their pizza.</p>
<p class="sparal" id="calibre_link-133"><strong class="calibre2">7-5. Movie Tickets:</strong> A movie theater charges different ticket prices depending on a person’s age. If a person is under the age of 3, the ticket is free; if they are between 3 and 12, the ticket is $10; and if they are over age 12, the ticket is $15. Write a loop in which you ask users their age, and then tell them the cost of their movie ticket.</p>
<p class="sparal" id="calibre_link-766"><span type="pagebreak" id="calibre_link-278" class="calibre"></span><strong class="calibre2">7-6. Three Exits:</strong> Write different versions of either <a href="#calibre_link-132" class="calibre6">Exercise 7-4</a> or <a href="#calibre_link-133" class="calibre6">Exercise 7-5</a> that do each of the following at least once:</p>
<ul class="calibre8">
<li class="noindent1">Use a conditional test in the <span class="literal">while</span> statement to stop the loop.</li>
<li class="noindent1">Use an <span class="literal">active</span> variable to control how long the loop runs.</li>
<li class="noindent1">Use a <span class="literal">break</span> statement to exit the loop when the user enters a <span class="literal">'quit'</span> value.</li>
</ul>
<p class="sparal" id="calibre_link-767"><strong class="calibre2">7-7. Infinity:</strong> Write a loop that never ends, and run it. (To end the loop, press <small class="calibre9">CTRL</small>-C or close the window displaying the output.)</p>
</div>
<h3 class="h2" id="calibre_link-768"><strong class="calibre2">Using a while Loop with Lists and Dictionaries</strong></h3>
<p class="noindent">So far, we’ve worked with only one piece of user information at a time. We received the user’s input and then printed the input or a response to it. The next time through the <span class="literal">while</span> loop, we’d receive another input value and respond to that. But to keep track of many users and pieces of information, we’ll need to use lists and dictionaries with our <span class="literal">while</span> loops.</p>
<p class="indent">A <span class="literal">for</span> loop is effective for looping through a list, but you shouldn’t modify a list inside a <span class="literal">for</span> loop because Python will have trouble keeping track of the items in the list. To modify a list as you work through it, use a <span class="literal">while</span> loop. Using <span class="literal">while</span> loops with lists and dictionaries allows you to collect, store, and organize lots of input to examine and report on later.</p>
<h4 class="h3" id="calibre_link-769"><strong class="calibre2"><em class="calibre3">Moving Items from One List to Another</em></strong></h4>
<p class="noindent">Consider a list of newly registered but unverified users of a website. After we verify these users, how can we move them to a separate list of confirmed users? One way would be to use a <span class="literal">while</span> loop to pull users from the list of unconfirmed users as we verify them and then add them to a separate list of confirmed users. Here’s what that code might look like:</p>
<p class="margin"><em class="calibre3">confirmed_users.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;# Start with users that need to be verified,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;and an empty list to hold confirmed users.<br class="calibre4" />
<span class="ent">➊</span> unconfirmed_users = ['alice', 'brian', 'candace']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;confirmed_users = []<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Verify each user until there are no more unconfirmed users.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;Move each verified user into the list of confirmed users.<br class="calibre4" />
<span class="ent">➋</span> while unconfirmed_users:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_user = unconfirmed_users.pop()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Verifying user: {current_user.title()}")<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;confirmed_users.append(current_user)<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-476" class="calibre"></span>&nbsp;&nbsp;&nbsp;# Display all confirmed users.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("\nThe following users have been confirmed:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for confirmed_user in confirmed_users:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(confirmed_user.title())</p>
<p class="indent">We begin with a list of unconfirmed users at <span class="ent">➊</span> (Alice, Brian, and Candace) and an empty list to hold confirmed users. The <span class="literal">while</span> loop at <span class="ent">➋</span> runs as long as the list <span class="literal">unconfirmed_users</span> is not empty. Within this loop, the <span class="literal">pop()</span> function at <span class="ent">➌</span> removes unverified users one at a time from the end of <span class="literal">unconfirmed_users</span>. Here, because Candace is last in the <span class="literal">unconfirmed_users</span> list, her name will be the first to be removed, assigned to <span class="literal">current_user</span>, and added to the <span class="literal">confirmed_users</span> list at <span class="ent">➍</span>. Next is Brian, then Alice.</p>
<p class="indent">We simulate confirming each user by printing a verification message and then adding them to the list of confirmed users. As the list of unconfirmed users shrinks, the list of confirmed users grows. When the list of unconfirmed users is empty, the loop stops and the list of confirmed users is printed:</p>
<p class="programs">Verifying user: Candace<br class="calibre4" />
Verifying user: Brian<br class="calibre4" />
Verifying user: Alice<br class="calibre4" />
<br class="calibre4" />
The following users have been confirmed:<br class="calibre4" />
Candace<br class="calibre4" />
Brian<br class="calibre4" />
Alice</p>
<h4 class="h3" id="calibre_link-770"><strong class="calibre2"><em class="calibre3">Removing All Instances of Specific Values from a List</em></strong></h4>
<p class="noindent">In <a href="#calibre_link-56" class="calibre6">Chapter 3</a> we used <span class="literal">remove()</span> to remove a specific value from a list. The <span class="literal">remove()</span> function worked because the value we were interested in appeared only once in the list. But what if you want to remove all instances of a value from a list?</p>
<p class="indent">Say you have a list of pets with the value <span class="literal">'cat'</span> repeated several times. To remove all instances of that value, you can run a <span class="literal">while</span> loop until <span class="literal">'cat'</span> is no longer in the list, as shown here:</p>
<p class="margin"><em class="calibre3">pets.py</em></p>
<p class="programs">pets = ['dog', 'cat', 'dog', 'goldfish', 'cat', 'rabbit', 'cat']<br class="calibre4" />
print(pets)<br class="calibre4" />
<br class="calibre4" />
while 'cat' in pets:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;pets.remove('cat')<br class="calibre4" />
<br class="calibre4" />
print(pets)</p>
<p class="indent">We start with a list containing multiple instances of <span class="literal">'cat'</span>. After printing the list, Python enters the <span class="literal">while</span> loop because it finds the value <span class="literal">'cat'</span> in the list <span type="pagebreak" id="calibre_link-502" class="calibre"></span>at least once. Once inside the loop, Python removes the first instance of <span class="literal">'cat'</span>, returns to the <span class="literal">while</span> line, and then reenters the loop when it finds that <span class="literal">'cat'</span> is still in the list. It removes each instance of <span class="literal">'cat'</span> until the value is no longer in the list, at which point Python exits the loop and prints the list again:</p>
<p class="programs">['dog', 'cat', 'dog', 'goldfish', 'cat', 'rabbit', 'cat']<br class="calibre4" />
['dog', 'dog', 'goldfish', 'rabbit']</p>
<h4 class="h3" id="calibre_link-771"><strong class="calibre2"><em class="calibre3">Filling a Dictionary with User Input</em></strong></h4>
<p class="noindent">You can prompt for as much input as you need in each pass through a <span class="literal">while</span> loop. Let’s make a polling program in which each pass through the loop prompts for the participant’s name and response. We’ll store the data we gather in a dictionary, because we want to connect each response with a particular user:</p>
<p class="margin"><em class="calibre3">mountain_poll.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;responses = {}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Set a flag to indicate that polling is active.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;polling_active = True<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;while polling_active:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prompt for the person's name and response.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = input("\nWhat is your name? ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response = input("Which mountain would you like to climb someday? ")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store the response in the dictionary.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responses[name] = response<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find out if anyone else is going to take the poll.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat = input("Would you like to let another person respond? (yes/ no) ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if repeat == 'no':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;polling_active = False<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Polling is complete. Show the results.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("\n--- Poll Results ---")<br class="calibre4" />
<span class="ent">➍</span> for name, response in responses.items():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{name} would like to climb {response}.")</p>
<p class="indent">The program first defines an empty dictionary (<span class="literal">responses</span>) and sets a flag (<span class="literal">polling_active</span>) to indicate that polling is active. As long as <span class="literal">polling_active</span> is <span class="literal">True</span>, Python will run the code in the <span class="literal">while</span> loop.</p>
<p class="indent">Within the loop, the user is prompted to enter their name and a mountain they’d like to climb <span class="ent">➊</span>. That information is stored in the <span class="literal">responses</span> dictionary <span class="ent">➋</span>, and the user is asked whether or not to keep the poll running <span class="ent">➌</span>. If they enter <span class="literal">yes</span>, the program enters the <span class="literal">while</span> loop again. If they enter <span class="literal">no</span>, the <span class="literal">polling_active</span> flag is set to <span class="literal">False</span>, the <span class="literal">while</span> loop stops running, and the final code block at <span class="ent">➍</span> displays the results of the poll.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-562" class="calibre"></span>If you run this program and enter sample responses, you should see output like this:</p>
<p class="programs">What is your name? <span class="codestrong">Eric</span><br class="calibre4" />
Which mountain would you like to climb someday? <span class="codestrong">Denali</span><br class="calibre4" />
Would you like to let another person respond? (yes/ no) <span class="codestrong">yes</span><br class="calibre4" />
<br class="calibre4" />
What is your name? <span class="codestrong">Lynn</span><br class="calibre4" />
Which mountain would you like to climb someday? <span class="codestrong">Devil's Thumb</span><br class="calibre4" />
Would you like to let another person respond? (yes/ no) <span class="codestrong">no</span><br class="calibre4" />
<br class="calibre4" />
--- Poll Results ---<br class="calibre4" />
Lynn would like to climb Devil's Thumb.<br class="calibre4" />
Eric would like to climb Denali.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-134"><strong class="calibre2">7-8. Deli:</strong> Make a list called <span class="literal1">sandwich_orders</span> and fill it with the names of various sandwiches. Then make an empty list called <span class="literal1">finished_sandwiches</span>. Loop through the list of sandwich orders and print a message for each order, such as <span class="literal1">I made your tuna sandwich.</span> As each sandwich is made, move it to the list of finished sandwiches. After all the sandwiches have been made, print a message listing each sandwich that was made.</p>
<p class="sparal" id="calibre_link-772"><strong class="calibre2">7-9. No Pastrami:</strong> Using the list <span class="literal1">sandwich_orders</span> from <a href="#calibre_link-134" class="calibre6">Exercise 7-8</a>, make sure the sandwich <span class="literal1">'pastrami'</span> appears in the list at least three times. Add code near the beginning of your program to print a message saying the deli has run out of pastrami, and then use a <span class="literal1">while</span> loop to remove all occurrences of <span class="literal1">'pastrami'</span> from <span class="literal1">sandwich_orders</span>. Make sure no pastrami sandwiches end up in <span class="literal1">finished_sandwiches</span>.</p>
<p class="sparal" id="calibre_link-773"><strong class="calibre2">7-10. Dream Vacation:</strong> Write a program that polls users about their dream vacation. Write a prompt similar to <em class="calibre3">If you could visit one place in the world, where would you go?</em> Include a block of code that prints the results of the poll.</p>
</div>
<h3 class="h2" id="calibre_link-774"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned how to use <span class="literal">input()</span> to allow users to provide their own information in your programs. You learned to work with both text and numerical input and how to use <span class="literal">while</span> loops to make your programs run as long as your users want them to. You saw several ways to control the flow of a <span class="literal">while</span> loop by setting an <span class="literal">active</span> flag, using the <span class="literal">break</span> statement, and <span type="pagebreak" id="calibre_link-1330" class="calibre"></span>using the <span class="literal">continue</span> statement. You learned how to use a <span class="literal">while</span> loop to move items from one list to another and how to remove all instances of a value from a list. You also learned how <span class="literal">while</span> loops can be used with dictionaries.</p>
<p class="indent">In <a href="#calibre_link-118" class="calibre6">Chapter 8</a> you’ll learn about <em class="calibre3">functions</em>. Functions allow you to break your programs into small parts, each of which does one specific job. You can call a function as many times as you want, and you can store your functions in separate files. By using functions, you’ll be able to write more efficient code that’s easier to troubleshoot and maintain and that can be reused in many different programs.</p>
</div>


<div class="calibre1" id="calibre_link-24">
<h2 class="h" id="calibre_link-118"><span type="pagebreak" id="calibre_link-392" class="calibre"></span><strong class="calibre2"><span class="big">8</span><br class="calibre4" />FUNCTIONS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter you’ll learn to write <em class="calibre3">functions</em>, which are named blocks of code that are designed to do one specific job. When you want to perform a particular task that you’ve defined in a function, you <em class="calibre3">call</em> the function responsible for it. If you need to perform that task multiple times throughout your program, you don’t need to type all the code for the same task again and again; you just call the function dedicated to handling that task, and the call tells Python to run the code inside the function. You’ll find that using functions makes your programs easier to write, read, test, and fix.</p>
<p class="indent">In this chapter you’ll also learn ways to pass information to functions. You’ll learn how to write certain functions whose primary job is to display information and other functions designed to process data and return a value or set of values. Finally, you’ll learn to store functions in separate files called <em class="calibre3">modules</em> to help organize your main program files.</p>
<h3 class="h2" id="calibre_link-775"><span type="pagebreak" id="calibre_link-250" class="calibre"></span><strong class="calibre2">Defining a Function</strong></h3>
<p class="noindent">Here’s a simple function named <span class="literal">greet_user()</span> that prints a greeting:</p>
<p class="margin"><em class="calibre3">greeter.py</em></p>
<p class="programs"><span class="ent">➊</span> def greet_user():<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Display a simple greeting."""<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Hello!")<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> greet_user()</p>
<p class="indent">This example shows the simplest structure of a function. The line at <span class="ent">➊</span> uses the keyword <span class="literal">def</span> to inform Python that you’re defining a function. This is the <em class="calibre3">function definition</em>, which tells Python the name of the function and, if applicable, what kind of information the function needs to do its job. The parentheses hold that information. In this case, the name of the function is <span class="literal">greet_user()</span>, and it needs no information to do its job, so its parentheses are empty. (Even so, the parentheses are required.) Finally, the definition ends in a colon.</p>
<p class="indent">Any indented lines that follow <span class="literal">def greet_user():</span> make up the <em class="calibre3">body</em> of the function. The text at <span class="ent">➋</span> is a comment called a <em class="calibre3">docstring</em>, which describes what the function does. Docstrings are enclosed in triple quotes, which Python looks for when it generates documentation for the functions in your programs.</p>
<p class="indent">The line <span class="literal">print("Hello!")</span> <span class="ent">➌</span> is the only line of actual code in the body of this function, so <span class="literal">greet_user()</span> has just one job: <span class="literal">print("Hello!")</span>.</p>
<p class="indent">When you want to use this function, you call it. A <em class="calibre3">function call</em> tells Python to execute the code in the function. To <em class="calibre3">call</em> a function, you write the name of the function, followed by any necessary information in parentheses, as shown at <span class="ent">➍</span>. Because no information is needed here, calling our function is as simple as entering <span class="literal">greet_user()</span>. As expected, it prints <span class="literal">Hello!</span>:</p>
<p class="programs">Hello!</p>
<h4 class="h3" id="calibre_link-776"><strong class="calibre2"><em class="calibre3">Passing Information to a Function</em></strong></h4>
<p class="noindent">Modified slightly, the function <span class="literal">greet_user()</span> can not only tell the user <span class="literal">Hello!</span> but also greet them by name. For the function to do this, you enter <span class="literal">username</span> in the parentheses of the function’s definition at <span class="literal">def greet_user()</span>. By adding <span class="literal">username</span> here you allow the function to accept any value of <span class="literal">username</span> you specify. The function now expects you to provide a value for <span class="literal">username</span> each time you call it. When you call <span class="literal">greet_user()</span>, you can pass it a name, such as <span class="literal">'jesse'</span>, inside the parentheses:</p>
<p class="programs">def greet_user(username):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Display a simple greeting."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"Hello, {username.title()}!")<br class="calibre4" />
<br class="calibre4" />
greet_user('jesse')</p>
<p class="indent"><span type="pagebreak" id="calibre_link-243" class="calibre"></span>Entering <span class="literal">greet_user('jesse')</span> calls <span class="literal">greet_user()</span> and gives the function the information it needs to execute the <span class="literal">print()</span> call. The function accepts the name you passed it and displays the greeting for that name:</p>
<p class="programs">Hello, Jesse!</p>
<p class="indent">Likewise, entering <span class="literal">greet_user('sarah')</span> calls <span class="literal">greet_user()</span>, passes it <span class="literal">'sarah'</span>, and prints <span class="literal">Hello, Sarah!</span> You can call <span class="literal">greet_user()</span> as often as you want and pass it any name you want to produce a predictable output every time.</p>
<h4 class="h3" id="calibre_link-777"><strong class="calibre2"><em class="calibre3">Arguments and Parameters</em></strong></h4>
<p class="noindent">In the preceding <span class="literal">greet_user()</span> function, we defined <span class="literal">greet_user()</span> to require a value for the variable <span class="literal">username</span>. Once we called the function and gave it the information (a person’s name), it printed the right greeting.</p>
<p class="indent">The variable <span class="literal">username</span> in the definition of <span class="literal">greet_user()</span> is an example of a <em class="calibre3">parameter</em>, a piece of information the function needs to do its job. The value <span class="literal">'jesse'</span> in <span class="literal">greet_user('jesse')</span> is an example of an <em class="calibre3">argument</em>. An argument is a piece of information that’s passed from a function call to a function. When we call the function, we place the value we want the function to work with in parentheses. In this case the argument <span class="literal">'jesse'</span> was passed to the function <span class="literal">greet_user()</span>, and the value was assigned to the parameter <span class="literal">username</span>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">People sometimes speak of arguments and parameters interchangeably. Don’t be surprised if you see the variables in a function definition referred to as arguments or the variables in a function call referred to as parameters.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-778"><strong class="calibre2">8-1. Message:</strong> Write a function called <span class="literal1">display_message()</span> that prints one sentence telling everyone what you are learning about in this chapter. Call the function, and make sure the message displays correctly.</p>
<p class="sparal" id="calibre_link-779"><strong class="calibre2">8-2. Favorite Book:</strong> Write a function called <span class="literal1">favorite_book()</span> that accepts one parameter, <span class="literal1">title</span>. The function should print a message, such as <span class="literal1">One of my favorite books is Alice in Wonderland</span>. Call the function, making sure to include a book title as an argument in the function call.</p>
</div>
<h3 class="h2" id="calibre_link-780"><strong class="calibre2">Passing Arguments</strong></h3>
<p class="noindent">Because a function definition can have multiple parameters, a function call may need multiple arguments. You can pass arguments to your functions in a number of ways. You can use <em class="calibre3">positional arguments</em>, which need to be in <span type="pagebreak" id="calibre_link-398" class="calibre"></span>the same order the parameters were written; <em class="calibre3">keyword arguments</em>, where each argument consists of a variable name and a value; and lists and dictionaries of values. Let’s look at each of these in turn.</p>
<h4 class="h3" id="calibre_link-781"><strong class="calibre2"><em class="calibre3">Positional Arguments</em></strong></h4>
<p class="noindent">When you call a function, Python must match each argument in the function call with a parameter in the function definition. The simplest way to do this is based on the order of the arguments provided. Values matched up this way are called <em class="calibre3">positional arguments</em>.</p>
<p class="indent">To see how this works, consider a function that displays information about pets. The function tells us what kind of animal each pet is and the pet’s name, as shown here:</p>
<p class="margin"><em class="calibre3">pets.py</em></p>
<p class="programs"><span class="ent">➊</span> def describe_pet(animal_type, pet_name):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Display information about a pet."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nI have a {animal_type}.")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"My {animal_type}'s name is {pet_name.title()}.")<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> describe_pet('hamster', 'harry')</p>
<p class="indent">The definition shows that this function needs a type of animal and the animal’s name <span class="ent">➊</span>. When we call <span class="literal">describe_pet()</span>, we need to provide an animal type and a name, in that order. For example, in the function call, the argument <span class="literal">'hamster'</span> is assigned to the parameter <span class="literal">animal_type</span> and the argument <span class="literal">'harry'</span> is assigned to the parameter <span class="literal">pet_name</span> <span class="ent">➋</span>. In the function body, these two parameters are used to display information about the pet being described.</p>
<p class="indent">The output describes a hamster named Harry:</p>
<p class="programs">I have a hamster.<br class="calibre4" />
My hamster's name is Harry.</p>
<h5 class="h4" id="calibre_link-1331"><strong class="calibre2">Multiple Function Calls</strong></h5>
<p class="noindent">You can call a function as many times as needed. Describing a second, different pet requires just one more call to <span class="literal">describe_pet()</span>:</p>
<p class="programs"><span class="ash">def describe_pet(animal_type, pet_name):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Display information about a pet."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"\nI have a {animal_type}.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"My {animal_type}'s name is {pet_name.title()}.")</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">describe_pet('hamster', 'harry')</span><br class="calibre4" />
describe_pet('dog', 'willie')</p>
<p class="indent">In this second function call, we pass <span class="literal">describe_pet()</span> the arguments <span class="literal">'dog'</span> and <span class="literal">'willie'</span>. As with the previous set of arguments we used, Python matches <span class="literal">'dog'</span> with the parameter <span class="literal">animal_type</span> and <span class="literal">'willie'</span> with the parameter <span class="literal">pet_name</span>. <span type="pagebreak" id="calibre_link-395" class="calibre"></span>As before, the function does its job, but this time it prints values for a dog named Willie. Now we have a hamster named Harry and a dog named Willie:</p>
<p class="programs">I have a hamster.<br class="calibre4" />
My hamster's name is Harry.<br class="calibre4" />
<br class="calibre4" />
I have a dog.<br class="calibre4" />
My dog's name is Willie.</p>
<p class="indent">Calling a function multiple times is a very efficient way to work. The code describing a pet is written once in the function. Then, anytime you want to describe a new pet, you call the function with the new pet’s information. Even if the code for describing a pet were to expand to ten lines, you could still describe a new pet in just one line by calling the function again.</p>
<p class="indent">You can use as many positional arguments as you need in your functions. Python works through the arguments you provide when calling the function and matches each one with the corresponding parameter in the function’s definition.</p>
<h5 class="h4" id="calibre_link-1332"><strong class="calibre2">Order Matters in Positional Arguments</strong></h5>
<p class="noindent">You can get unexpected results if you mix up the order of the arguments in a function call when using positional arguments:</p>
<p class="programs"><span class="ash">def describe_pet(animal_type, pet_name):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Display information about a pet."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"\nI have a {animal_type}.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"My {animal_type}'s name is {pet_name.title()}.")</span><br class="calibre4" />
<br class="calibre4" />
describe_pet('harry', 'hamster')</p>
<p class="indent">In this function call we list the name first and the type of animal second. Because the argument <span class="literal">'harry'</span> is listed first this time, that value is assigned to the parameter <span class="literal">animal_type</span>. Likewise, <span class="literal">'hamster'</span> is assigned to <span class="literal">pet_name</span>. Now we have a “harry” named “Hamster”:</p>
<p class="programs">I have a harry.<br class="calibre4" />
My harry's name is Hamster.</p>
<p class="indent">If you get funny results like this, check to make sure the order of the arguments in your function call matches the order of the parameters in the function’s definition.</p>
<h4 class="h3" id="calibre_link-782"><strong class="calibre2"><em class="calibre3">Keyword Arguments</em></strong></h4>
<p class="noindent">A <em class="calibre3">keyword argument</em> is a name-value pair that you pass to a function. You directly associate the name and the value within the argument, so when you pass the argument to the function, there’s no confusion (you won’t end up <span type="pagebreak" id="calibre_link-291" class="calibre"></span>with a harry named Hamster). Keyword arguments free you from having to worry about correctly ordering your arguments in the function call, and they clarify the role of each value in the function call.</p>
<p class="indent">Let’s rewrite <em class="calibre3">pets.py</em> using keyword arguments to call <span class="literal">describe_pet()</span>:</p>
<p class="programs"><span class="ash">def describe_pet(animal_type, pet_name):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Display information about a pet."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"\nI have a {animal_type}.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"My {animal_type}'s name is {pet_name.title()}.")</span><br class="calibre4" />
<br class="calibre4" />
describe_pet(animal_type='hamster', pet_name='harry')</p>
<p class="indent">The function <span class="literal">describe_pet()</span> hasn’t changed. But when we call the function, we explicitly tell Python which parameter each argument should be matched with. When Python reads the function call, it knows to assign the argument <span class="literal">'hamster'</span> to the parameter <span class="literal">animal_type</span> and the argument <span class="literal">'harry'</span> to <span class="literal">pet_name</span>. The output correctly shows that we have a hamster named Harry.</p>
<p class="indent">The order of keyword arguments doesn’t matter because Python knows where each value should go. The following two function calls are equivalent:</p>
<p class="programs">describe_pet(animal_type='hamster', pet_name='harry')<br class="calibre4" />
describe_pet(pet_name='harry', animal_type='hamster')</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">When you use keyword arguments, be sure to use the exact names of the parameters in the function’s definition.</em></p>
</div>
<h4 class="h3" id="calibre_link-783"><strong class="calibre2"><em class="calibre3">Default Values</em></strong></h4>
<p class="noindent">When writing a function, you can define a <em class="calibre3">default value</em> for each parameter. If an argument for a parameter is provided in the function call, Python uses the argument value. If not, it uses the parameter’s default value. So when you define a default value for a parameter, you can exclude the corresponding argument you’d usually write in the function call. Using default values can simplify your function calls and clarify the ways in which your functions are typically used.</p>
<p class="indent">For example, if you notice that most of the calls to <span class="literal">describe_pet()</span> are being used to describe dogs, you can set the default value of <span class="literal">animal_type</span> to <span class="literal">'dog'</span>. Now anyone calling <span class="literal">describe_pet()</span> for a dog can omit that information:</p>
<p class="programs">def describe_pet(pet_name, animal_type='dog'):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Display information about a pet."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"\nI have a {animal_type}.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"My {animal_type}'s name is {pet_name.title()}.")</span><br class="calibre4" />
<br class="calibre4" />
describe_pet(pet_name='willie')</p>
<p class="indent"><span type="pagebreak" id="calibre_link-399" class="calibre"></span>We changed the definition of <span class="literal">describe_pet()</span> to include a default value, <span class="literal">'dog'</span>, for <span class="literal">animal_type</span>. Now when the function is called with no <span class="literal">animal_type</span> specified, Python knows to use the value <span class="literal">'dog'</span> for this parameter:</p>
<p class="programs">I have a dog.<br class="calibre4" />
My dog's name is Willie.</p>
<p class="indent">Note that the order of the parameters in the function definition had to be changed. Because the default value makes it unnecessary to specify a type of animal as an argument, the only argument left in the function call is the pet’s name. Python still interprets this as a positional argument, so if the function is called with just a pet’s name, that argument will match up with the first parameter listed in the function’s definition. This is the reason the first parameter needs to be <span class="literal">pet_name</span>.</p>
<p class="indent">The simplest way to use this function now is to provide just a dog’s name in the function call:</p>
<p class="programs">describe_pet('willie')</p>
<p class="indent">This function call would have the same output as the previous example. The only argument provided is <span class="literal">'willie'</span>, so it is matched up with the first parameter in the definition, <span class="literal">pet_name</span>. Because no argument is provided for <span class="literal">animal_type</span>, Python uses the default value <span class="literal">'dog'</span>.</p>
<p class="indent">To describe an animal other than a dog, you could use a function call like this:</p>
<p class="programs">describe_pet(pet_name='harry', animal_type='hamster')</p>
<p class="indent">Because an explicit argument for <span class="literal">animal_type</span> is provided, Python will ignore the parameter’s default value.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">When you use default values, any parameter with a default value needs to be listed after all the parameters that don’t have default values. This allows Python to continue interpreting positional arguments correctly.</em></p>
</div>
<h4 class="h3" id="calibre_link-784"><strong class="calibre2"><em class="calibre3">Equivalent Function Calls</em></strong></h4>
<p class="noindent">Because positional arguments, keyword arguments, and default values can all be used together, often you’ll have several equivalent ways to call a function. Consider the following definition for <span class="literal">describe_pet()</span> with one default value provided:</p>
<p class="programs">def describe_pet(pet_name, animal_type='dog'):</p>
<p class="indent">With this definition, an argument always needs to be provided for <span class="literal">pet_name</span>, and this value can be provided using the positional or keyword <span type="pagebreak" id="calibre_link-394" class="calibre"></span>format. If the animal being described is not a dog, an argument for <span class="literal">animal_type</span> must be included in the call, and this argument can also be specified using the positional or keyword format.</p>
<p class="indent">All of the following calls would work for this function:</p>
<p class="programs"># A dog named Willie.<br class="calibre4" />
describe_pet('willie')<br class="calibre4" />
describe_pet(pet_name='willie')<br class="calibre4" />
<br class="calibre4" />
# A hamster named Harry.<br class="calibre4" />
describe_pet('harry', 'hamster')<br class="calibre4" />
describe_pet(pet_name='harry', animal_type='hamster')<br class="calibre4" />
describe_pet(animal_type='hamster', pet_name='harry')</p>
<p class="indent">Each of these function calls would have the same output as the previous examples.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">It doesn’t really matter which calling style you use. As long as your function calls produce the output you want, just use the style you find easiest to understand.</em></p>
</div>
<h4 class="h3" id="calibre_link-785"><strong class="calibre2"><em class="calibre3">Avoiding Argument Errors</em></strong></h4>
<p class="noindent">When you start to use functions, don’t be surprised if you encounter errors about unmatched arguments. Unmatched arguments occur when you provide fewer or more arguments than a function needs to do its work. For example, here’s what happens if we try to call <span class="literal">describe_pet()</span> with no arguments:</p>
<p class="programs"><span class="ash">def describe_pet(animal_type, pet_name):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Display information about a pet."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"\nI have a {animal_type}.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"My {animal_type}'s name is {pet_name.title()}.")</span><br class="calibre4" />
<br class="calibre4" />
describe_pet()</p>
<p class="indent">Python recognizes that some information is missing from the function call, and the traceback tells us that:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;Traceback (most recent call last):<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;File "pets.py", line 6, in &lt;module&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;describe_pet()<br class="calibre4" />
<span class="ent">➌</span> TypeError: describe_pet() missing 2 required positional arguments: 'animal_<br class="calibre4" />
&nbsp;&nbsp;&nbsp;type' and 'pet_name'</p>
<p class="indent">At <span class="ent">➊</span> the traceback tells us the location of the problem, allowing us to look back and see that something went wrong in our function call. At <span class="ent">➋</span> the offending function call is written out for us to see. At <span class="ent">➌</span> the traceback <span type="pagebreak" id="calibre_link-244" class="calibre"></span>tells us the call is missing two arguments and reports the names of the missing arguments. If this function were in a separate file, we could probably rewrite the call correctly without having to open that file and read the function code.</p>
<p class="indent">Python is helpful in that it reads the function’s code for us and tells us the names of the arguments we need to provide. This is another motivation for giving your variables and functions descriptive names. If you do, Python’s error messages will be more useful to you and anyone else who might use your code.</p>
<p class="indent">If you provide too many arguments, you should get a similar traceback that can help you correctly match your function call to the function definition.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-786"><strong class="calibre2">8-3. T-Shirt:</strong> Write a function called <span class="literal1">make_shirt()</span> that accepts a size and the text of a message that should be printed on the shirt. The function should print a sentence summarizing the size of the shirt and the message printed on it.</p>
<p class="sparai">Call the function once using positional arguments to make a shirt. Call the function a second time using keyword arguments.</p>
<p class="sparal" id="calibre_link-787"><strong class="calibre2">8-4. Large Shirts:</strong> Modify the <span class="literal1">make_shirt()</span> function so that shirts are large by default with a message that reads <em class="calibre3">I love Python</em>. Make a large shirt and a medium shirt with the default message, and a shirt of any size with a different message.</p>
<p class="sparal" id="calibre_link-788"><strong class="calibre2">8-5. Cities:</strong> Write a function called <span class="literal1">describe_city()</span> that accepts the name of a city and its country. The function should print a simple sentence, such as <span class="literal1">Reykjavik is in Iceland</span>. Give the parameter for the country a default value. Call your function for three different cities, at least one of which is not in the default country.</p>
</div>
<h3 class="h2" id="calibre_link-789"><strong class="calibre2">Return Values</strong></h3>
<p class="noindent">A function doesn’t always have to display its output directly. Instead, it can process some data and then return a value or set of values. The value the function returns is called a <em class="calibre3">return value</em>. The <span class="literal">return</span> statement takes a value from inside a function and sends it back to the line that called the function. Return values allow you to move much of your program’s grunt work into functions, which can simplify the body of your program.</p>
<h4 class="h3" id="calibre_link-790"><span type="pagebreak" id="calibre_link-389" class="calibre"></span><strong class="calibre2"><em class="calibre3">Returning a Simple Value</em></strong></h4>
<p class="noindent">Let’s look at a function that takes a first and last name, and returns a neatly formatted full name:</p>
<p class="margin"><em class="calibre3">formatted_name.py</em></p>
<p class="programs"><span class="ent">➊</span> def get_formatted_name(first_name, last_name):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Return a full name, neatly formatted."""<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first_name} {last_name}"<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return full_name.title()<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> musician = get_formatted_name('jimi', 'hendrix')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(musician)</p>
<p class="indent">The definition of <span class="literal">get_formatted_name()</span> takes as parameters a first and last name <span class="ent">➊</span>. The function combines these two names, adds a space between them, and assigns the result to <span class="literal">full_name</span> <span class="ent">➋</span>. The value of <span class="literal">full_name</span> is converted to title case, and then returned to the calling line at <span class="ent">➌</span>.</p>
<p class="indent">When you call a function that returns a value, you need to provide a variable that the return value can be assigned to. In this case, the returned value is assigned to the variable <span class="literal">musician</span> at <span class="ent">➍</span>. The output shows a neatly formatted name made up of the parts of a person’s name:</p>
<p class="programs">Jimi Hendrix</p>
<p class="indent">This might seem like a lot of work to get a neatly formatted name when we could have just written:</p>
<p class="programs">print("Jimi Hendrix")</p>
<p class="indent">But when you consider working with a large program that needs to store many first and last names separately, functions like <span class="literal">get_formatted_name()</span> become very useful. You store first and last names separately and then call this function whenever you want to display a full name.</p>
<h4 class="h3" id="calibre_link-791"><strong class="calibre2"><em class="calibre3">Making an Argument Optional</em></strong></h4>
<p class="noindent">Sometimes it makes sense to make an argument optional so that people using the function can choose to provide extra information only if they want to. You can use default values to make an argument optional.</p>
<p class="indent">For example, say we want to expand <span class="literal">get_formatted_name()</span> to handle middle names as well. A first attempt to include middle names might look like this:</p>
<p class="programs">def get_formatted_name(first_name, middle_name, last_name):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""Return a full name, neatly formatted."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first_name} {middle_name} {last_name}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;return full_name.title()<br class="calibre4" />
<br class="calibre4" />
musician = get_formatted_name('john', 'lee', 'hooker')<br class="calibre4" />
print(musician)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1333" class="calibre"></span>This function works when given a first, middle, and last name. The function takes in all three parts of a name and then builds a string out of them. The function adds spaces where appropriate and converts the full name to title case:</p>
<p class="programs">John Lee Hooker</p>
<p class="indent">But middle names aren’t always needed, and this function as written would not work if you tried to call it with only a first name and a last name. To make the middle name optional, we can give the <span class="literal">middle_name</span> argument an empty default value and ignore the argument unless the user provides a value. To make <span class="literal">get_formatted_name()</span> work without a middle name, we set the default value of <span class="literal">middle_name</span> to an empty string and move it to the end of the list of parameters:</p>
<p class="programs"><span class="ent">➊</span> def get_formatted_name(first_name, last_name, middle_name=''):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Return a full name, neatly formatted."""</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if middle_name:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first_name} {middle_name} {last_name}"<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first_name} {last_name}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return full_name.title()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;musician = get_formatted_name('jimi', 'hendrix')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(musician)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> musician = get_formatted_name('john', 'hooker', 'lee')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(musician)</span></p>
<p class="indent">In this example, the name is built from three possible parts. Because there’s always a first and last name, these parameters are listed first in the function’s definition. The middle name is optional, so it’s listed last in the definition, and its default value is an empty string <span class="ent">➊</span>.</p>
<p class="indent">In the body of the function, we check to see if a middle name has been provided. Python interprets non-empty strings as <span class="literal">True</span>, so <span class="literal">if middle_name</span> evaluates to <span class="literal">True</span> if a middle name argument is in the function call <span class="ent">➋</span>. If a middle name is provided, the first, middle, and last names are combined to form a full name. This name is then changed to title case and returned to the function call line where it’s assigned to the variable <span class="literal">musician</span> and printed. If no middle name is provided, the empty string fails the <span class="literal">if</span> test and the <span class="literal">else</span> block runs <span class="ent">➌</span>. The full name is made with just a first and last name, and the formatted name is returned to the calling line where it’s assigned to <span class="literal">musician</span> and printed.</p>
<p class="indent">Calling this function with a first and last name is straightforward. If we’re using a middle name, however, we have to make sure the middle name is the last argument passed so Python will match up the positional arguments correctly <span class="ent">➍</span>.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-390" class="calibre"></span>This modified version of our function works for people with just a first and last name, and it works for people who have a middle name as well:</p>
<p class="programs">Jimi Hendrix<br class="calibre4" />
John Lee Hooker</p>
<p class="indent">Optional values allow functions to handle a wide range of use cases while letting function calls remain as simple as possible.</p>
<h4 class="h3" id="calibre_link-792"><strong class="calibre2"><em class="calibre3">Returning a Dictionary</em></strong></h4>
<p class="noindent">A function can return any kind of value you need it to, including more complicated data structures like lists and dictionaries. For example, the following function takes in parts of a name and returns a dictionary representing a person:</p>
<p class="margin"><em class="calibre3">person.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;def build_person(first_name, last_name):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Return a dictionary of information about a person."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;person = {'first': first_name, 'last': last_name}<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return person<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;musician = build_person('jimi', 'hendrix')<br class="calibre4" />
<span class="ent">➌</span> print(musician)</p>
<p class="indent">The function <span class="literal">build_person()</span> takes in a first and last name, and puts these values into a dictionary at <span class="ent">➊</span>. The value of <span class="literal">first_name</span> is stored with the key <span class="literal">'first'</span>, and the value of <span class="literal">last_name</span> is stored with the key <span class="literal">'last'</span>. The entire dictionary representing the person is returned at <span class="ent">➋</span>. The return value is printed at <span class="ent">➌</span> with the original two pieces of textual information now stored in a dictionary:</p>
<p class="programs">{'first': 'jimi', 'last': 'hendrix'}</p>
<p class="indent">This function takes in simple textual information and puts it into a more meaningful data structure that lets you work with the information beyond just printing it. The strings <span class="literal">'jimi'</span> and <span class="literal">'hendrix'</span> are now labeled as a first name and last name. You can easily extend this function to accept optional values like a middle name, an age, an occupation, or any other information you want to store about a person. For example, the following change allows you to store a person’s age as well:</p>
<p class="programs">def build_person(first_name, last_name, age=None):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Return a dictionary of information about a person."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">person = {'first': first_name, 'last': last_name}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if age:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;person['age'] = age<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return person</span><br class="calibre4" />
<br class="calibre4" />
musician = build_person('jimi', 'hendrix', age=27)<br class="calibre4" />
<span class="ash">print(musician)</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-1334" class="calibre"></span>We add a new optional parameter <span class="literal">age</span> to the function definition and assign the parameter the special value <span class="literal">None</span>, which is used when a variable has no specific value assigned to it. You can think of <span class="literal">None</span> as a placeholder value. In conditional tests, <span class="literal">None</span> evaluates to <span class="literal">False</span>. If the function call includes a value for <span class="literal">age</span>, that value is stored in the dictionary. This function always stores a person’s name, but it can also be modified to store any other information you want about a person.</p>
<h4 class="h3" id="calibre_link-793"><strong class="calibre2"><em class="calibre3">Using a Function with a while Loop</em></strong></h4>
<p class="noindent">You can use functions with all the Python structures you’ve learned about so far. For example, let’s use the <span class="literal">get_formatted_name()</span> function with a <span class="literal">while</span> loop to greet users more formally. Here’s a first attempt at greeting people using their first and last names:</p>
<p class="margin"><em class="calibre3">greeter.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">def get_formatted_name(first_name, last_name):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Return a full name, neatly formatted."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">full_name = f"{first_name} {last_name}"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return full_name.title()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# This is an infinite loop!<br class="calibre4" />
&nbsp;&nbsp;&nbsp;while True:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("\nPlease tell me your name:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_name = input("First name: ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_name = input("Last name: ")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted_name = get_formatted_name(f_name, l_name)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nHello, {formatted_name}!")</p>
<p class="indent">For this example, we use a simple version of <span class="literal">get_formatted_name()</span> that doesn’t involve middle names. The <span class="literal">while</span> loop asks the user to enter their name, and we prompt for their first and last name separately <span class="ent">➊</span>.</p>
<p class="indent">But there’s one problem with this <span class="literal">while</span> loop: We haven’t defined a quit condition. Where do you put a quit condition when you ask for a series of inputs? We want the user to be able to quit as easily as possible, so each prompt should offer a way to quit. The <span class="literal">break</span> statement offers a straightforward way to exit the loop at either prompt:</p>
<p class="programs"><span class="ash">def get_formatted_name(first_name, last_name):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Return a full name, neatly formatted."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">full_name = f"{first_name} {last_name}"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return full_name.title()</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("\nPlease tell me your name:")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print("(enter 'q' at any time to quit)")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">f_name = input("First name: ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if f_name == 'q':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-404" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">l_name = input("Last name: ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if l_name == 'q':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">formatted_name = get_formatted_name(f_name, l_name)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"\nHello, {formatted_name}!")</span></p>
<p class="indent">We add a message that informs the user how to quit, and then we break out of the loop if the user enters the quit value at either prompt. Now the program will continue greeting people until someone enters <span class="literal">'q'</span> for either name:</p>
<p class="programs">Please tell me your name:<br class="calibre4" />
(enter 'q' at any time to quit)<br class="calibre4" />
First name: <span class="codestrong">eric</span><br class="calibre4" />
Last name: <span class="codestrong">matthes</span><br class="calibre4" />
<br class="calibre4" />
Hello, Eric Matthes!<br class="calibre4" />
<br class="calibre4" />
Please tell me your name:<br class="calibre4" />
(enter 'q' at any time to quit)<br class="calibre4" />
First name: <span class="codestrong">q</span></p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-794"><strong class="calibre2">8-6. City Names:</strong> Write a function called <span class="literal1">city_country()</span> that takes in the name of a city and its country. The function should return a string formatted like this:</p>
<p class="programs">"Santiago, Chile"</p>
<p class="sparai">Call your function with at least three city-country pairs, and print the values that are returned.</p>
<p class="sparal" id="calibre_link-25"><strong class="calibre2">8-7. Album:</strong> Write a function called <span class="literal1">make_album()</span> that builds a dictionary describing a music album. The function should take in an artist name and an album title, and it should return a dictionary containing these two pieces of information. Use the function to make three dictionaries representing different albums. Print each return value to show that the dictionaries are storing the album information correctly.</p>
<p class="sparai">Use <span class="literal1">None</span> to add an optional parameter to <span class="literal1">make_album()</span> that allows you to store the number of songs on an album. If the calling line includes a value for the number of songs, add that value to the album’s dictionary. Make at least one new function call that includes the number of songs on an album.</p>
<p class="sparal" id="calibre_link-795"><strong class="calibre2">8-8. User Albums:</strong> Start with your program from <a href="#calibre_link-25" class="calibre6">Exercise 8-7</a>. Write a <span class="literal1">while</span> loop that allows users to enter an album’s artist and title. Once you have that information, call <span class="literal1">make_album()</span> with the user’s input and print the dictionary that’s created. Be sure to include a quit value in the <span class="literal1">while</span> loop.</p>
</div>
<h3 class="h2" id="calibre_link-796"><span type="pagebreak" id="calibre_link-396" class="calibre"></span><strong class="calibre2">Passing a List</strong></h3>
<p class="noindent">You’ll often find it useful to pass a list to a function, whether it’s a list of names, numbers, or more complex objects, such as dictionaries. When you pass a list to a function, the function gets direct access to the contents of the list. Let’s use functions to make working with lists more efficient.</p>
<p class="indent">Say we have a list of users and want to print a greeting to each. The following example sends a list of names to a function called <span class="literal">greet_users()</span>, which greets each person in the list individually:</p>
<p class="margin"><em class="calibre3">greet_users.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;def greet_users(names):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Print a simple greeting to each user in the list."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for name in names:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = f"Hello, {name.title()}!"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(msg)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> usernames = ['hannah', 'ty', 'margot']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;greet_users(usernames)</p>
<p class="indent">We define <span class="literal">greet_users()</span> so it expects a list of names, which it assigns to the parameter <span class="literal">names</span>. The function loops through the list it receives and prints a greeting to each user. At <span class="ent">➊</span> we define a list of users and then pass the list <span class="literal">usernames</span> to <span class="literal">greet_users()</span> in our function call:</p>
<p class="programs">Hello, Hannah!<br class="calibre4" />
Hello, Ty!<br class="calibre4" />
Hello, Margot!</p>
<p class="indent">This is the output we wanted. Every user sees a personalized greeting, and you can call the function any time you want to greet a specific set of users.</p>
<h4 class="h3" id="calibre_link-797"><strong class="calibre2"><em class="calibre3">Modifying a List in a Function</em></strong></h4>
<p class="noindent">When you pass a list to a function, the function can modify the list. Any changes made to the list inside the function’s body are permanent, allowing you to work efficiently even when you’re dealing with large amounts of data.</p>
<p class="indent">Consider a company that creates 3D printed models of designs that users submit. Designs that need to be printed are stored in a list, and after being printed they’re moved to a separate list. The following code does this without using functions:</p>
<p class="margin"><em class="calibre3">printing_models.py</em></p>
<p class="programs"># Start with some designs that need to be printed.<br class="calibre4" />
unprinted_designs = ['phone case', 'robot pendant', 'dodecahedron']<br class="calibre4" />
completed_models = []<br class="calibre4" />
<br class="calibre4" />
# Simulate printing each design, until none are left.<br class="calibre4" />
#&nbsp;&nbsp;Move each design to completed_models after printing.<br class="calibre4" />
while unprinted_designs:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;current_design = unprinted_designs.pop()<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1335" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;print(f"Printing model: {current_design}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;completed_models.append(current_design)<br class="calibre4" />
<br class="calibre4" />
# Display all completed models.<br class="calibre4" />
print("\nThe following models have been printed:")<br class="calibre4" />
for completed_model in completed_models:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(completed_model)</p>
<p class="indent">This program starts with a list of designs that need to be printed and an empty list called <span class="literal">completed_models</span> that each design will be moved to after it has been printed. As long as designs remain in <span class="literal">unprinted_designs</span>, the <span class="literal">while</span> loop simulates printing each design by removing a design from the end of the list, storing it in <span class="literal">current_design</span>, and displaying a message that the current design is being printed. It then adds the design to the list of completed models. When the loop is finished running, a list of the designs that have been printed is displayed:</p>
<p class="programs">Printing model: dodecahedron<br class="calibre4" />
Printing model: robot pendant<br class="calibre4" />
Printing model: phone case<br class="calibre4" />
<br class="calibre4" />
The following models have been printed:<br class="calibre4" />
dodecahedron<br class="calibre4" />
robot pendant<br class="calibre4" />
phone case</p>
<p class="indent">We can reorganize this code by writing two functions, each of which does one specific job. Most of the code won’t change; we’re just making it more carefully structured. The first function will handle printing the designs, and the second will summarize the prints that have been made:</p>
<p class="programs"><span class="ent">➊</span> def print_models(unprinted_designs, completed_models):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simulate printing each design, until none are left.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Move each design to completed_models after printing.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while unprinted_designs:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_design = unprinted_designs.pop()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Printing model: {current_design}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;completed_models.append(current_design)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> def show_completed_models(completed_models):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Show all the models that were printed."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("\nThe following models have been printed:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for completed_model in completed_models:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(completed_model)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;unprinted_designs = ['phone case', 'robot pendant', 'dodecahedron']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;completed_models = []<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print_models(unprinted_designs, completed_models)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;show_completed_models(completed_models)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-400" class="calibre"></span>At <span class="ent">➊</span> we define the function <span class="literal">print_models()</span> with two parameters: a list of designs that need to be printed and a list of completed models. Given these two lists, the function simulates printing each design by emptying the list of unprinted designs and filling up the list of completed models. At <span class="ent">➋</span> we define the function <span class="literal">show_completed_models()</span> with one parameter: the list of completed models. Given this list, <span class="literal">show_completed_models()</span> displays the name of each model that was printed.</p>
<p class="indent">This program has the same output as the version without functions, but the code is much more organized. The code that does most of the work has been moved to two separate functions, which makes the main part of the program easier to understand. Look at the body of the program to see how much easier it is to understand what this program is doing:</p>
<p class="programs">unprinted_designs = ['phone case', 'robot pendant', 'dodecahedron']<br class="calibre4" />
completed_models = []<br class="calibre4" />
<br class="calibre4" />
print_models(unprinted_designs, completed_models)<br class="calibre4" />
show_completed_models(completed_models)</p>
<p class="indent">We set up a list of unprinted designs and an empty list that will hold the completed models. Then, because we’ve already defined our two functions, all we have to do is call them and pass them the right arguments. We call <span class="literal">print_models()</span> and pass it the two lists it needs; as expected, <span class="literal">print_models()</span> simulates printing the designs. Then we call <span class="literal">show_completed_models()</span> and pass it the list of completed models so it can report the models that have been printed. The descriptive function names allow others to read this code and understand it, even without comments.</p>
<p class="indent">This program is easier to extend and maintain than the version without functions. If we need to print more designs later on, we can simply call <span class="literal">print_models()</span> again. If we realize the printing code needs to be modified, we can change the code once, and our changes will take place everywhere the function is called. This technique is more efficient than having to update code separately in several places in the program.</p>
<p class="indent">This example also demonstrates the idea that every function should have one specific job. The first function prints each design, and the second displays the completed models. This is more beneficial than using one function to do both jobs. If you’re writing a function and notice the function is doing too many different tasks, try to split the code into two functions. Remember that you can always call a function from another function, which can be helpful when splitting a complex task into a series of steps.</p>
<h4 class="h3" id="calibre_link-798"><strong class="calibre2"><em class="calibre3">Preventing a Function from Modifying a List</em></strong></h4>
<p class="noindent">Sometimes you’ll want to prevent a function from modifying a list. For example, say that you start with a list of unprinted designs and write a function to move them to a list of completed models, as in the previous example. You may decide that even though you’ve printed all the designs, you want to keep the original list of unprinted designs for your records. <span type="pagebreak" id="calibre_link-397" class="calibre"></span>But because you moved all the design names out of <span class="literal">unprinted_designs</span>, the list is now empty, and the empty list is the only version you have; the original is gone. In this case, you can address this issue by passing the function a copy of the list, not the original. Any changes the function makes to the list will affect only the copy, leaving the original list intact.</p>
<p class="indent">You can send a copy of a list to a function like this:</p>
<p class="programs"><span class="codeitalic1">function_name</span>(<span class="codeitalic1">list_name</span>[:])</p>
<p class="indent">The slice notation <span class="literal">[:]</span> makes a copy of the list to send to the function. If we didn’t want to empty the list of unprinted designs in <em class="calibre3">printing_models.py</em>, we could call <span class="literal">print_models()</span> like this:</p>
<p class="programs">print_models(unprinted_designs[:], completed_models)</p>
<p class="indent">The function <span class="literal">print_models()</span> can do its work because it still receives the names of all unprinted designs. But this time it uses a copy of the original unprinted designs list, not the actual <span class="literal">unprinted_designs</span> list. The list <span class="literal">completed_models</span> will fill up with the names of printed models like it did before, but the original list of unprinted designs will be unaffected by the function.</p>
<p class="indent">Even though you can preserve the contents of a list by passing a copy of it to your functions, you should pass the original list to functions unless you have a specific reason to pass a copy. It’s more efficient for a function to work with an existing list to avoid using the time and memory needed to make a separate copy, especially when you’re working with large lists.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-26"><strong class="calibre2">8-9. Messages:</strong> Make a list containing a series of short text messages. Pass the list to a function called <span class="literal1">show_messages()</span>, which prints each text message.</p>
<p class="sparal" id="calibre_link-27"><strong class="calibre2">8-10. Sending Messages:</strong> Start with a copy of your program from <a href="#calibre_link-26" class="calibre6">Exercise 8-9</a>. Write a function called <span class="literal1">send_messages()</span> that prints each text message and moves each message to a new list called <span class="literal1">sent_messages</span> as it’s printed. After calling the function, print both of your lists to make sure the messages were moved correctly.</p>
<p class="sparal" id="calibre_link-799"><strong class="calibre2">8-11. Archived Messages:</strong> Start with your work from <a href="#calibre_link-27" class="calibre6">Exercise 8-10</a>. Call the function <span class="literal1">send_messages()</span> with a copy of the list of messages. After calling the function, print both of your lists to show that the original list has retained its messages.</p>
</div>
<h3 class="h2" id="calibre_link-800"><span type="pagebreak" id="calibre_link-169" class="calibre"></span><strong class="calibre2">Passing an Arbitrary Number of Arguments</strong></h3>
<p class="noindent">Sometimes you won’t know ahead of time how many arguments a function needs to accept. Fortunately, Python allows a function to collect an arbitrary number of arguments from the calling statement.</p>
<p class="indent">For example, consider a function that builds a pizza. It needs to accept a number of toppings, but you can’t know ahead of time how many toppings a person will want. The function in the following example has one parameter, <span class="literal">*toppings</span>, but this parameter collects as many arguments as the calling line provides:</p>
<p class="margin"><em class="calibre3">pizza.py</em></p>
<p class="programs">def make_pizza(*toppings):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""Print the list of toppings that have been requested."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(toppings)<br class="calibre4" />
<br class="calibre4" />
make_pizza('pepperoni')<br class="calibre4" />
make_pizza('mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">The asterisk in the parameter name <span class="literal">*toppings</span> tells Python to make an empty tuple called <span class="literal">toppings</span> and pack whatever values it receives into this tuple. The <span class="literal">print()</span> call in the function body produces output showing that Python can handle a function call with one value and a call with three values. It treats the different calls similarly. Note that Python packs the arguments into a tuple, even if the function receives only one value:</p>
<p class="programs">('pepperoni',)<br class="calibre4" />
('mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">Now we can replace the <span class="literal">print()</span> call with a loop that runs through the list of toppings and describes the pizza being ordered:</p>
<p class="programs"><span class="ash">def make_pizza(*toppings):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""Summarize the pizza we are about to make."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print("\nMaking a pizza with the following toppings:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;for topping in toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"- {topping}")<br class="calibre4" />
<br class="calibre4" />
<span class="ash">make_pizza('pepperoni')</span><br class="calibre4" />
<span class="ash">make_pizza('mushrooms', 'green peppers', 'extra cheese')</span></p>
<p class="indent">The function responds appropriately, whether it receives one value or three values:</p>
<p class="programs">Making a pizza with the following toppings:<br class="calibre4" />
- pepperoni<br class="calibre4" />
<br class="calibre4" />
Making a pizza with the following toppings:<br class="calibre4" />
- mushrooms<br class="calibre4" />
- green peppers<br class="calibre4" />
- extra cheese</p>
<p class="indent"><span type="pagebreak" id="calibre_link-393" class="calibre"></span>This syntax works no matter how many arguments the function receives.</p>
<h4 class="h3" id="calibre_link-801"><strong class="calibre2"><em class="calibre3">Mixing Positional and Arbitrary Arguments</em></strong></h4>
<p class="noindent">If you want a function to accept several different kinds of arguments, the parameter that accepts an arbitrary number of arguments must be placed last in the function definition. Python matches positional and keyword arguments first and then collects any remaining arguments in the final parameter.</p>
<p class="indent">For example, if the function needs to take in a size for the pizza, that parameter must come before the parameter <span class="literal">*toppings</span>:</p>
<p class="programs">def make_pizza(size, *toppings):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Summarize the pizza we are about to make."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nMaking a {size}-inch pizza with the following toppings:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for topping in toppings:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"- {topping}")</span><br class="calibre4" />
<br class="calibre4" />
make_pizza(16, 'pepperoni')<br class="calibre4" />
make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">In the function definition, Python assigns the first value it receives to the parameter <span class="literal">size</span>. All other values that come after are stored in the tuple <span class="literal">toppings</span>. The function calls include an argument for the size first, followed by as many toppings as needed.</p>
<p class="indent">Now each pizza has a size and a number of toppings, and each piece of information is printed in the proper place, showing size first and toppings after:</p>
<p class="programs">Making a 16-inch pizza with the following toppings:<br class="calibre4" />
- pepperoni<br class="calibre4" />
<br class="calibre4" />
Making a 12-inch pizza with the following toppings:<br class="calibre4" />
- mushrooms<br class="calibre4" />
- green peppers<br class="calibre4" />
- extra cheese</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You’ll often see the generic parameter name <span class="codeitalic">*args</span>, which collects arbitrary positional arguments like this.</em></p>
</div>
<h4 class="h3" id="calibre_link-802"><strong class="calibre2"><em class="calibre3">Using Arbitrary Keyword Arguments</em></strong></h4>
<p class="noindent">Sometimes you’ll want to accept an arbitrary number of arguments, but you won’t know ahead of time what kind of information will be passed to the function. In this case, you can write functions that accept as many key-value pairs as the calling statement provides. One example involves building user profiles: you know you’ll get information about a user, but you’re not sure what kind of information you’ll receive. The function <span class="literal">build_profile()</span> in the <span type="pagebreak" id="calibre_link-28" class="calibre"></span>following example always takes in a first and last name, but it accepts an arbitrary number of keyword arguments as well:</p>
<p class="margin"><em class="calibre3">user_profile.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;def build_profile(first, last, **user_info):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Build a dictionary containing everything we know about a user."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_info['first_name'] = first<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_info['last_name'] = last<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return user_info<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;user_profile = build_profile('albert', 'einstein',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location='princeton',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field='physics')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(user_profile)</p>
<p class="indent">The definition of <span class="literal">build_profile()</span> expects a first and last name, and then it allows the user to pass in as many name-value pairs as they want. The double asterisks before the parameter <span class="literal">**user_info</span> cause Python to create an empty dictionary called <span class="literal">user_info</span> and pack whatever name-value pairs it receives into this dictionary. Within the function, you can access the key-value pairs in <span class="literal">user_info</span> just as you would for any dictionary.</p>
<p class="indent">In the body of <span class="literal">build_profile()</span>, we add the first and last names to the <span class="literal">user_info</span> dictionary because we’ll always receive these two pieces of information from the user <span class="ent">➊</span>, and they haven’t been placed into the dictionary yet. Then we return the <span class="literal">user_info</span> dictionary to the function call line.</p>
<p class="indent">We call <span class="literal">build_profile()</span>, passing it the first name <span class="literal">'albert'</span>, the last name <span class="literal">'einstein'</span>, and the two key-value pairs <span class="literal">location='princeton'</span> and <span class="literal">field='physics'</span>. We assign the returned <span class="literal">profile</span> to <span class="literal">user_profile</span> and print <span class="literal">user_profile</span>:</p>
<p class="programs">{'location': 'princeton', 'field': 'physics',<br class="calibre4" />
'first_name': 'albert', 'last_name': 'einstein'}</p>
<p class="indent">The returned dictionary contains the user’s first and last names and, in this case, the location and field of study as well. The function would work no matter how many additional key-value pairs are provided in the function call.</p>
<p class="indent">You can mix positional, keyword, and arbitrary values in many different ways when writing your own functions. It’s useful to know that all these argument types exist because you’ll see them often when you start reading other people’s code. It takes practice to learn to use the different types correctly and to know when to use each type. For now, remember to use the simplest approach that gets the job done. As you progress you’ll learn to use the most efficient approach each time.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You’ll often see the parameter name <span class="codeitalic">**kwargs</span> used to collect non-specific keyword arguments.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-401" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-803"><strong class="calibre2">8-12. Sandwiches:</strong> Write a function that accepts a list of items a person wants on a sandwich. The function should have one parameter that collects as many items as the function call provides, and it should print a summary of the sandwich that’s being ordered. Call the function three times, using a different number of arguments each time.</p>
<p class="sparal" id="calibre_link-804"><strong class="calibre2">8-13. User Profile:</strong> Start with a copy of <em class="calibre3">user_profile.py</em> from <a href="#calibre_link-28" class="calibre6">page 149</a>. Build a profile of yourself by calling <span class="literal1">build_profile()</span>, using your first and last names and three other key-value pairs that describe you.</p>
<p class="sparal" id="calibre_link-805"><strong class="calibre2">8-14. Cars:</strong> Write a function that stores information about a car in a dictionary. The function should always receive a manufacturer and a model name. It should then accept an arbitrary number of keyword arguments. Call the function with the required information and two other name-value pairs, such as a color or an optional feature. Your function should work for a call like this one:</p>
<p class="programs">car = make_car('subaru', 'outback', color='blue', tow_package=True)</p>
<p class="sparai">Print the dictionary that’s returned to make sure all the information was stored correctly.</p>
</div>
<h3 class="h2" id="calibre_link-806"><strong class="calibre2">Storing Your Functions in Modules</strong></h3>
<p class="noindent">One advantage of functions is the way they separate blocks of code from your main program. By using descriptive names for your functions, your main program will be much easier to follow. You can go a step further by storing your functions in a separate file called a <em class="calibre3">module</em> and then <em class="calibre3">importing</em> that module into your main program. An <span class="literal">import</span> statement tells Python to make the code in a module available in the currently running program file.</p>
<p class="indent">Storing your functions in a separate file allows you to hide the details of your program’s code and focus on its higher-level logic. It also allows you to reuse functions in many different programs. When you store your functions in separate files, you can share those files with other programmers without having to share your entire program. Knowing how to import functions also allows you to use libraries of functions that other programmers have written.</p>
<p class="indent">There are several ways to import a module, and I’ll show you each of these briefly.</p>
<h4 class="h3" id="calibre_link-807"><strong class="calibre2"><em class="calibre3">Importing an Entire Module</em></strong></h4>
<p class="noindent">To start importing functions, we first need to create a module. A <em class="calibre3">module</em> is a file ending in <em class="calibre3">.py</em> that contains the code you want to import into your <span type="pagebreak" id="calibre_link-362" class="calibre"></span>program. Let’s make a module that contains the function <span class="literal">make_pizza()</span>. To make this module, we’ll remove everything from the file <em class="calibre3">pizza.py</em> except the function <span class="literal">make_pizza()</span>:</p>
<p class="margin"><em class="calibre3">pizza.py</em></p>
<p class="programs">def make_pizza(size, *toppings):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""Summarize the pizza we are about to make."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nMaking a {size}-inch pizza with the following toppings:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;for topping in toppings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"- {topping}")</p>
<p class="indent">Now we’ll make a separate file called <em class="calibre3">making_pizzas.py</em> in the same directory as <em class="calibre3">pizza.py</em>. This file imports the module we just created and then makes two calls to <span class="literal">make_pizza()</span>:</p>
<p class="margin"><em class="calibre3">making_pizzas.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import pizza<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> pizza.make_pizza(16, 'pepperoni')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;pizza.make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">When Python reads this file, the line <span class="literal">import pizza</span> tells Python to open the file <em class="calibre3">pizza.py</em> and copy all the functions from it into this program. You don’t actually see code being copied between files because Python copies the code behind the scenes just before the program runs. All you need to know is that any function defined in <em class="calibre3">pizza.py</em> will now be available in <em class="calibre3">making_pizzas.py</em>.</p>
<p class="indent">To call a function from an imported module, enter the name of the module you imported, <span class="literal">pizza</span>, followed by the name of the function, <span class="literal">make_pizza()</span>, separated by a dot <span class="ent">➊</span>. This code produces the same output as the original program that didn’t import a module:</p>
<p class="programs">Making a 16-inch pizza with the following toppings:<br class="calibre4" />
- pepperoni<br class="calibre4" />
<br class="calibre4" />
Making a 12-inch pizza with the following toppings:<br class="calibre4" />
- mushrooms<br class="calibre4" />
- green peppers<br class="calibre4" />
- extra cheese</p>
<p class="indent">This first approach to importing, in which you simply write <span class="literal">import</span> followed by the name of the module, makes every function from the module available in your program. If you use this kind of <span class="literal">import</span> statement to import an entire module named <em class="calibre3">module_name.py</em>, each function in the module is available through the following syntax:</p>
<p class="programs"><span class="codeitalic1">module_name.function_name</span>()</p>
<h4 class="h3" id="calibre_link-808"><span type="pagebreak" id="calibre_link-184" class="calibre"></span><strong class="calibre2"><em class="calibre3">Importing Specific Functions</em></strong></h4>
<p class="noindent">You can also import a specific function from a module. Here’s the general syntax for this approach:</p>
<p class="programs">from <span class="codeitalic1">module_name</span> import <span class="codeitalic1">function_name</span></p>
<p class="indent">You can import as many functions as you want from a module by separating each function’s name with a comma:</p>
<p class="programs">from <span class="codeitalic1">module_name</span> import <span class="codeitalic1">function_0</span>, <span class="codeitalic1">function_1</span>, <span class="codeitalic1">function_2</span></p>
<p class="indent">The <em class="calibre3">making_pizzas.py</em> example would look like this if we want to import just the function we’re going to use:</p>
<p class="programs">from pizza import make_pizza<br class="calibre4" />
<br class="calibre4" />
make_pizza(16, 'pepperoni')<br class="calibre4" />
make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">With this syntax, you don’t need to use the dot notation when you call a function. Because we’ve explicitly imported the function <span class="literal">make_pizza()</span> in the <span class="literal">import</span> statement, we can call it by name when we use the function.</p>
<h4 class="h3" id="calibre_link-809"><strong class="calibre2"><em class="calibre3">Using as to Give a Function an Alias</em></strong></h4>
<p class="noindent">If the name of a function you’re importing might conflict with an existing name in your program or if the function name is long, you can use a short, unique <em class="calibre3">alias</em>&mdash;an alternate name similar to a nickname for the function. You’ll give the function this special nickname when you import the function.</p>
<p class="indent">Here we give the function <span class="literal">make_pizza()</span> an alias, <span class="literal">mp()</span>, by importing <span class="literal">make_pizza as mp</span>. The <span class="literal">as</span> keyword renames a function using the alias you provide:</p>
<p class="programs">from pizza import make_pizza as mp<br class="calibre4" />
<br class="calibre4" />
mp(16, 'pepperoni')<br class="calibre4" />
mp(12, 'mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">The <span class="literal">import</span> statement shown here renames the function <span class="literal">make_pizza()</span> to <span class="literal">mp()</span> in this program. Any time we want to call <span class="literal">make_pizza()</span> we can simply write <span class="literal">mp()</span> instead, and Python will run the code in <span class="literal">make_pizza()</span> while avoiding any confusion with another <span class="literal">make_pizza()</span> function you might have written in this program file.</p>
<p class="indent">The general syntax for providing an alias is:</p>
<p class="programs">from <span class="codeitalic1">module_name</span> import <span class="codeitalic1">function_name</span> as <span class="codeitalic1">fn</span></p>
<h4 class="h3" id="calibre_link-810"><span type="pagebreak" id="calibre_link-403" class="calibre"></span><strong class="calibre2"><em class="calibre3">Using as to Give a Module an Alias</em></strong></h4>
<p class="noindent">You can also provide an alias for a module name. Giving a module a short alias, like <span class="literal">p</span> for <span class="literal">pizza</span>, allows you to call the module’s functions more quickly. Calling <span class="literal">p.make_pizza()</span> is more concise than calling <span class="literal">pizza.make_pizza()</span>:</p>
<p class="programs">import pizza as p<br class="calibre4" />
<br class="calibre4" />
p.make_pizza(16, 'pepperoni')<br class="calibre4" />
p.make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">The module <span class="literal">pizza</span> is given the alias <span class="literal">p</span> in the <span class="literal">import</span> statement, but all of the module’s functions retain their original names. Calling the functions by writing <span class="literal">p.make_pizza()</span> is not only more concise than writing <span class="literal">pizza.make_pizza()</span>, but also redirects your attention from the module name and allows you to focus on the descriptive names of its functions. These function names, which clearly tell you what each function does, are more important to the readability of your code than using the full module name.</p>
<p class="indent">The general syntax for this approach is:</p>
<p class="programs">import <span class="codeitalic1">module_name</span> as <span class="codeitalic1">mn</span></p>
<h4 class="h3" id="calibre_link-811"><strong class="calibre2"><em class="calibre3">Importing All Functions in a Module</em></strong></h4>
<p class="noindent">You can tell Python to import every function in a module by using the asterisk (<span class="literal">*</span>) operator:</p>
<p class="programs">from pizza import *<br class="calibre4" />
<br class="calibre4" />
make_pizza(16, 'pepperoni')<br class="calibre4" />
make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')</p>
<p class="indent">The asterisk in the <span class="literal">import</span> statement tells Python to copy every function from the module <span class="literal">pizza</span> into this program file. Because every function is imported, you can call each function by name without using the dot notation. However, it’s best not to use this approach when you’re working with larger modules that you didn’t write: if the module has a function name that matches an existing name in your project, you can get some unexpected results. Python may see several functions or variables with the same name, and instead of importing all the functions separately, it will overwrite the functions.</p>
<p class="indent">The best approach is to import the function or functions you want, or import the entire module and use the dot notation. This leads to clear code that’s easy to read and understand. I include this section so you’ll recognize <span class="literal">import</span> statements like the following when you see them in other people’s code:</p>
<p class="programs">from <span class="codeitalic1">module_name</span> import *</p>
<h3 class="h2" id="calibre_link-812"><span type="pagebreak" id="calibre_link-405" class="calibre"></span><strong class="calibre2">Styling Functions</strong></h3>
<p class="noindent">You need to keep a few details in mind when you’re styling functions. Functions should have descriptive names, and these names should use lowercase letters and underscores. Descriptive names help you and others understand what your code is trying to do. Module names should use these conventions as well.</p>
<p class="indent">Every function should have a comment that explains concisely what the function does. This comment should appear immediately after the function definition and use the docstring format. In a well-documented function, other programmers can use the function by reading only the description in the docstring. They should be able to trust that the code works as described, and as long as they know the name of the function, the arguments it needs, and the kind of value it returns, they should be able to use it in their programs.</p>
<p class="indent">If you specify a default value for a parameter, no spaces should be used on either side of the equal sign:</p>
<p class="programs">def <span class="codeitalic1">function_name</span>(<span class="codeitalic1">parameter_0</span>, <span class="codeitalic1">parameter_1</span>='<span class="codeitalic1">default value</span>')</p>
<p class="indent">The same convention should be used for keyword arguments in function calls:</p>
<p class="programs"><span class="codeitalic1">function_name</span>(<span class="codeitalic1">value_0</span>, <span class="codeitalic1">parameter_1</span>='<span class="codeitalic1">value</span>')</p>
<p class="indent">PEP 8 (<em class="calibre3"><a href="https://www.python.org/dev/peps/pep-0008/" class="calibre6">https://www.python.org/dev/peps/pep-0008/</a></em>) recommends that you limit lines of code to 79 characters so every line is visible in a reasonably sized editor window. If a set of parameters causes a function’s definition to be longer than 79 characters, press <small class="calibre5">ENTER</small> after the opening parenthesis on the definition line. On the next line, press <small class="calibre5">TAB</small> twice to separate the list of arguments from the body of the function, which will only be indented one level.</p>
<p class="indent">Most editors automatically line up any additional lines of parameters to match the indentation you have established on the first line:</p>
<p class="programs">def <span class="codeitalic1">function_name</span>(<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeitalic1">parameter_0</span>, <span class="codeitalic1">parameter_1</span>, <span class="codeitalic1">parameter_2</span>,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeitalic1">parameter_3</span>, <span class="codeitalic1">parameter_4</span>, <span class="codeitalic1">parameter_5</span>):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeitalic1">function body...</span></p>
<p class="indent">If your program or module has more than one function, you can separate each by two blank lines to make it easier to see where one function ends and the next one begins.</p>
<p class="indent">All <span class="literal">import</span> statements should be written at the beginning of a file. The only exception is if you use comments at the beginning of your file to describe the overall program.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-402" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-813"><strong class="calibre2">8-15. Printing Models:</strong> Put the functions for the example <em class="calibre3">printing_models.py</em> in a separate file called <em class="calibre3">printing_functions.py</em>. Write an <span class="literal1">import</span> statement at the top of <em class="calibre3">printing_models.py</em>, and modify the file to use the imported functions.</p>
<p class="sparal" id="calibre_link-814"><strong class="calibre2">8-16. Imports:</strong> Using a program you wrote that has one function in it, store that function in a separate file. Import the function into your main program file, and call the function using each of these approaches:</p>
<p class="programs">import <span class="codeitalic1">module_name</span><br class="calibre4" />
from <span class="codeitalic1">module_name</span> import <span class="codeitalic1">function_name</span><br class="calibre4" />
from <span class="codeitalic1">module_name</span> import <span class="codeitalic1">function_name</span> as <span class="codeitalic1">fn</span><br class="calibre4" />
import <span class="codeitalic1">module_name</span> as <span class="codeitalic1">mn</span><br class="calibre4" />
from <span class="codeitalic1">module_name</span> import *</p>
<p class="sparal" id="calibre_link-815"><strong class="calibre2">8-17. Styling Functions:</strong> Choose any three programs you wrote for this chapter, and make sure they follow the styling guidelines described in this section.</p>
</div>
<h3 class="h2" id="calibre_link-816"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned how to write functions and to pass arguments so that your functions have access to the information they need to do their work. You learned how to use positional and keyword arguments, and how to accept an arbitrary number of arguments. You saw functions that display output and functions that return values. You learned how to use functions with lists, dictionaries, <span class="literal">if</span> statements, and <span class="literal">while</span> loops. You also saw how to store your functions in separate files called <em class="calibre3">modules</em>, so your program files will be simpler and easier to understand. Finally, you learned to style your functions so your programs will continue to be well-structured and as easy as possible for you and others to read.</p>
<p class="indent">One of your goals as a programmer should be to write simple code that does what you want it to, and functions help you do this. They allow you to write blocks of code and leave them alone once you know they work. When you know a function does its job correctly, you can trust that it will continue to work and move on to your next coding task.</p>
<p class="indent">Functions allow you to write code once and then reuse that code as many times as you want. When you need to run the code in a function, all you need to do is write a one-line call and the function does its job. When you need to modify a function’s behavior, you only have to modify one block of code, and your change takes effect everywhere you’ve made a call to that function.</p>
<p class="indent">Using functions makes your programs easier to read, and good function names summarize what each part of a program does. Reading a series of function calls gives you a much quicker sense of what a program does than reading a long series of code blocks.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1336" class="calibre"></span>Functions also make your code easier to test and debug. When the bulk of your program’s work is done by a set of functions, each of which has a specific job, it’s much easier to test and maintain the code you’ve written. You can write a separate program that calls each function and tests whether each function works in all the situations it may encounter. When you do this, you can be confident that your functions will work properly each time you call them.</p>
<p class="indent">In <a href="#calibre_link-29" class="calibre6">Chapter 9</a> you’ll learn to write classes. <em class="calibre3">Classes</em> combine functions and data into one neat package that can be used in flexible and efficient ways.</p>
</div>


<div class="calibre1" id="calibre_link-1241">
<h2 class="h" id="calibre_link-29"><span type="pagebreak" id="calibre_link-275" class="calibre"></span><strong class="calibre2"><span class="big">9</span><br class="calibre4" />CLASSES</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent"><em class="calibre3">Object-oriented programming</em> is one of the most effective approaches to writing software. In object-oriented programming you write <em class="calibre3">classes</em> that represent real-world things and situations, and you create <em class="calibre3">objects</em> based on these classes. When you write a class, you define the general behavior that a whole category of objects can have. When you create individual objects from the class, each object is automatically equipped with the general behavior; you can then give each object whatever unique traits you desire. You’ll be amazed how well real-world situations can be modeled with object-oriented programming.</p>
<p class="indent">Making an object from a class is called <em class="calibre3">instantiation</em>, and you work with <em class="calibre3">instances</em> of a class. In this chapter you’ll write classes and create instances of those classes. You’ll specify the kind of information that can be stored in instances, and you’ll define actions that can be taken with these instances. You’ll also write classes that extend the functionality of existing classes, so <span type="pagebreak" id="calibre_link-265" class="calibre"></span>similar classes can share code efficiently. You’ll store your classes in modules and import classes written by other programmers into your own program files.</p>
<p class="indent">Understanding object-oriented programming will help you see the world as a programmer does. It’ll help you really know your code, not just what’s happening line by line, but also the bigger concepts behind it. Knowing the logic behind classes will train you to think logically so you can write programs that effectively address almost any problem you encounter.</p>
<p class="indent">Classes also make life easier for you and the other programmers you’ll work with as you take on increasingly complex challenges. When you and other programmers write code based on the same kind of logic, you’ll be able to understand each other’s work. Your programs will make sense to many collaborators, allowing everyone to accomplish more.</p>
<h3 class="h2" id="calibre_link-817"><strong class="calibre2">Creating and Using a Class</strong></h3>
<p class="noindent">You can model almost anything using classes. Let’s start by writing a simple class, <span class="literal">Dog</span>, that represents a dog&mdash;not one dog in particular, but any dog. What do we know about most pet dogs? Well, they all have a name and age. We also know that most dogs sit and roll over. Those two pieces of information (name and age) and those two behaviors (sit and roll over) will go in our <span class="literal">Dog</span> class because they’re common to most dogs. This class will tell Python how to make an object representing a dog. After our class is written, we’ll use it to make individual instances, each of which represents one specific dog.</p>
<h4 class="h3" id="calibre_link-818"><strong class="calibre2"><em class="calibre3">Creating the Dog Class</em></strong></h4>
<p class="noindent">Each instance created from the <span class="literal">Dog</span> class will store a <span class="literal">name</span> and an <span class="literal">age</span>, and we’ll give each dog the ability to <span class="literal">sit()</span> and <span class="literal">roll_over()</span>:</p>
<p class="margin"><em class="calibre3">dog.py</em></p>
<p class="programs"><span class="ent">➊</span> class Dog:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A simple attempt to model a dog."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, name, age):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize name and age attributes."""<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.name = name<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.age = age<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def sit(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Simulate a dog sitting in response to a command."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{self.name} is now sitting.")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def roll_over(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Simulate rolling over in response to a command."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"{self.name} rolled over!")</p>
<p class="indent">There’s a lot to notice here, but don’t worry. You’ll see this structure throughout this chapter and have lots of time to get used to it. At <span class="ent">➊</span> we <span type="pagebreak" id="calibre_link-247" class="calibre"></span>define a class called <span class="literal">Dog</span>. By convention, capitalized names refer to classes in Python. There are no parentheses in the class definition because we’re creating this class from scratch. At <span class="ent">➋</span> we write a docstring describing what this class does.</p>
<h5 class="h4" id="calibre_link-1337"><strong class="calibre2">The __init__() Method</strong></h5>
<p class="noindent">A function that’s part of a class is a <em class="calibre3">method</em>. Everything you learned about functions applies to methods as well; the only practical difference for now is the way we’ll call methods. The <span class="literal">__init__()</span> method at <span class="ent">➌</span> is a special method that Python runs automatically whenever we create a new instance based on the <span class="literal">Dog</span> class. This method has two leading underscores and two trailing underscores, a convention that helps prevent Python’s default method names from conflicting with your method names. Make sure to use two underscores on each side of <span class="literal">__init__()</span>. If you use just one on each side, the method won’t be called automatically when you use your class, which can result in errors that are difficult to identify.</p>
<p class="indent">We define the <span class="literal">__init__()</span> method to have three parameters: <span class="literal">self</span>, <span class="literal">name</span>, and <span class="literal">age</span>. The <span class="literal">self</span> parameter is required in the method definition, and it must come first before the other parameters. It must be included in the definition because when Python calls this method later (to create an instance of <span class="literal">Dog</span>), the method call will automatically pass the <span class="literal">self</span> argument. Every method call associated with an instance automatically passes <span class="literal">self</span>, which is a reference to the instance itself; it gives the individual instance access to the attributes and methods in the class. When we make an instance of <span class="literal">Dog</span>, Python will call the <span class="literal">__init__()</span> method from the <span class="literal">Dog</span> class. We’ll pass <span class="literal">Dog()</span> a name and an age as arguments; <span class="literal">self</span> is passed automatically, so we don’t need to pass it. Whenever we want to make an instance from the <span class="literal">Dog</span> class, we’ll provide values for only the last two parameters, <span class="literal">name</span> and <span class="literal">age</span>.</p>
<p class="indent">The two variables defined at <span class="ent">➍</span> each have the prefix <span class="literal">self</span>. Any variable prefixed with <span class="literal">self</span> is available to every method in the class, and we’ll also be able to access these variables through any instance created from the class. The line <span class="literal">self.name = name</span> takes the value associated with the parameter <span class="literal">name</span> and assigns it to the variable <span class="literal">name</span>, which is then attached to the instance being created. The same process happens with <span class="literal">self.age = age</span>. Variables that are accessible through instances like this are called <em class="calibre3">attributes</em>.</p>
<p class="indent">The <span class="literal">Dog</span> class has two other methods defined: <span class="literal">sit()</span> and <span class="literal">roll_over()</span> <span class="ent">➎</span>. Because these methods don’t need additional information to run, we just define them to have one parameter, <span class="literal">self</span>. The instances we create later will have access to these methods. In other words, they’ll be able to sit and roll over. For now, <span class="literal">sit()</span> and <span class="literal">roll_over()</span> don’t do much. They simply print a message saying the dog is sitting or rolling over. But the concept can be extended to realistic situations: if this class were part of an actual computer game, these methods would contain code to make an animated dog sit and roll over. If this class was written to control a robot, these methods would direct movements that cause a robotic dog to sit and roll over.</p>
<h4 class="h3" id="calibre_link-819"><span type="pagebreak" id="calibre_link-261" class="calibre"></span><strong class="calibre2"><em class="calibre3">Making an Instance from a Class</em></strong></h4>
<p class="noindent">Think of a class as a set of instructions for how to make an instance. The class <span class="literal">Dog</span> is a set of instructions that tells Python how to make individual instances representing specific dogs.</p>
<p class="indent">Let’s make an instance representing a specific dog:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Dog:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> my_dog = Dog('Willie', 6)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> print(f"My dog's name is {my_dog.name}.")<br class="calibre4" />
<span class="ent">➌</span> print(f"My dog is {my_dog.age} years old.")</p>
<p class="indent">The <span class="literal">Dog</span> class we’re using here is the one we just wrote in the previous example. At <span class="ent">➊</span> we tell Python to create a dog whose name is <span class="literal">'Willie'</span> and whose age is <span class="literal">6</span>. When Python reads this line, it calls the <span class="literal">__init__()</span> method in <span class="literal">Dog</span> with the arguments <span class="literal">'Willie'</span> and <span class="literal">6</span>. The <span class="literal">__init__()</span> method creates an instance representing this particular dog and sets the <span class="literal">name</span> and <span class="literal">age</span> attributes using the values we provided. Python then returns an instance representing this dog. We assign that instance to the variable <span class="literal">my_dog</span>. The naming convention is helpful here: we can usually assume that a capitalized name like <span class="literal">Dog</span> refers to a class, and a lowercase name like <span class="literal">my_dog</span> refers to a single instance created from a class.</p>
<h5 class="h4" id="calibre_link-1338"><strong class="calibre2">Accessing Attributes</strong></h5>
<p class="noindent">To access the attributes of an instance, you use dot notation. At <span class="ent">➋</span> we access the value of <span class="literal">my_dog</span>’s attribute <span class="literal">name</span> by writing:</p>
<p class="programs">my_dog.name</p>
<p class="indent">Dot notation is used often in Python. This syntax demonstrates how Python finds an attribute’s value. Here Python looks at the instance <span class="literal">my_dog</span> and then finds the attribute <span class="literal">name</span> associated with <span class="literal">my_dog</span>. This is the same attribute referred to as <span class="literal">self.name</span> in the class <span class="literal">Dog</span>. At <span class="ent">➌</span> we use the same approach to work with the attribute <span class="literal">age</span>.</p>
<p class="indent">The output is a summary of what we know about <span class="literal">my_dog</span>:</p>
<p class="programs">My dog's name is Willie.<br class="calibre4" />
My dog is 6 years old.</p>
<h5 class="h4" id="calibre_link-1339"><strong class="calibre2">Calling Methods</strong></h5>
<p class="noindent">After we create an instance from the class <span class="literal">Dog</span>, we can use dot notation to call any method defined in <span class="literal">Dog</span>. Let’s make our dog sit and roll over:</p>
<p class="programs"><span class="ash">class Dog:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-276" class="calibre"></span><span class="ash">my_dog = Dog('Willie', 6)</span><br class="calibre4" />
my_dog.sit()<br class="calibre4" />
my_dog.roll_over()</p>
<p class="indent">To call a method, give the name of the instance (in this case, <span class="literal">my_dog</span>) and the method you want to call, separated by a dot. When Python reads <span class="literal">my_dog.sit()</span>, it looks for the method <span class="literal">sit()</span> in the class <span class="literal">Dog</span> and runs that code. Python interprets the line <span class="literal">my_dog.roll_over()</span> in the same way.</p>
<p class="indent">Now Willie does what we tell him to:</p>
<p class="programs">Willie is now sitting.<br class="calibre4" />
Willie rolled over!</p>
<p class="indent">This syntax is quite useful. When attributes and methods have been given appropriately descriptive names like <span class="literal">name</span>, <span class="literal">age</span>, <span class="literal">sit()</span>, and <span class="literal">roll_over()</span>, we can easily infer what a block of code, even one we’ve never seen before, is supposed to do.</p>
<h5 class="h4" id="calibre_link-1340"><strong class="calibre2">Creating Multiple Instances</strong></h5>
<p class="noindent">You can create as many instances from a class as you need. Let’s create a second dog called <span class="literal">your_dog</span>:</p>
<p class="programs"><span class="ash">class Dog:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
my_dog = Dog('Willie', 6)<br class="calibre4" />
your_dog = Dog('Lucy', 3)<br class="calibre4" />
<br class="calibre4" />
print(f"My dog's name is {my_dog.name}.")<br class="calibre4" />
print(f"My dog is {my_dog.age} years old.")<br class="calibre4" />
my_dog.sit()<br class="calibre4" />
<br class="calibre4" />
print(f"\nYour dog's name is {your_dog.name}.")<br class="calibre4" />
print(f"Your dog is {your_dog.age} years old.")<br class="calibre4" />
your_dog.sit()</p>
<p class="indent">In this example we create a dog named Willie and a dog named Lucy. Each dog is a separate instance with its own set of attributes, capable of the same set of actions:</p>
<p class="programs">My dog's name is Willie.<br class="calibre4" />
My dog is 6 years old.<br class="calibre4" />
Willie is now sitting.<br class="calibre4" />
<br class="calibre4" />
Your dog's name is Lucy.<br class="calibre4" />
Your dog is 3 years old.<br class="calibre4" />
Lucy is now sitting.</p>
<p class="indent">Even if we used the same name and age for the second dog, Python would still create a separate instance from the <span class="literal">Dog</span> class. You can make <span type="pagebreak" id="calibre_link-256" class="calibre"></span>as many instances from one class as you need, as long as you give each instance a unique variable name or it occupies a unique spot in a list or dictionary.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-820"><strong class="calibre2">9-1. Restaurant:</strong> Make a class called <span class="literal1">Restaurant</span>. The <span class="literal1">__init__()</span> method for <span class="literal1">Restaurant</span> should store two attributes: a <span class="literal1">restaurant_name</span> and a <span class="literal1">cuisine_type</span>. Make a method called <span class="literal1">describe_restaurant()</span> that prints these two pieces of information, and a method called <span class="literal1">open_restaurant()</span> that prints a message indicating that the restaurant is open.</p>
<p class="sparai">Make an instance called <span class="literal1">restaurant</span> from your class. Print the two attributes individually, and then call both methods.</p>
<p class="sparal" id="calibre_link-821"><strong class="calibre2">9-2. Three Restaurants:</strong> Start with your class from <a href="#calibre_link-820" class="calibre6">Exercise 9-1</a>. Create three different instances from the class, and call <span class="literal1">describe_restaurant()</span> for each instance.</p>
<p class="sparal" id="calibre_link-822"><strong class="calibre2">9-3. Users:</strong> Make a class called <span class="literal1">User</span>. Create two attributes called <span class="literal1">first_name</span> and <span class="literal1">last_name</span>, and then create several other attributes that are typically stored in a user profile. Make a method called <span class="literal1">describe_user()</span> that prints a summary of the user’s information. Make another method called <span class="literal1">greet_user()</span> that prints a personalized greeting to the user.</p>
<p class="sparai">Create several instances representing different users, and call both methods for each user.</p>
</div>
<h3 class="h2" id="calibre_link-823"><strong class="calibre2">Working with Classes and Instances</strong></h3>
<p class="noindent">You can use classes to represent many real-world situations. Once you write a class, you’ll spend most of your time working with instances created from that class. One of the first tasks you’ll want to do is modify the attributes associated with a particular instance. You can modify the attributes of an instance directly or write methods that update attributes in specific ways.</p>
<h4 class="h3" id="calibre_link-824"><strong class="calibre2"><em class="calibre3">The Car Class</em></strong></h4>
<p class="noindent">Let’s write a new class representing a car. Our class will store information about the kind of car we’re working with, and it will have a method that summarizes this information:</p>
<p class="margin"><em class="calibre3">car.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;class Car:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A simple attempt to represent a car."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, make, model, year):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize attributes to describe a car."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.make = make<br class="calibre4" />
<span type="pagebreak" id="calibre_link-262" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.model = model<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.year = year<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def get_descriptive_name(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Return a neatly formatted descriptive name."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long_name = f"{self.year} {self.manufacturer} {self.model}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return long_name.title()<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> my_new_car = Car('audi', 'a4', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_new_car.get_descriptive_name())</p>
<p class="indent">At <span class="ent">➊</span> in the <span class="literal">Car</span> class, we define the <span class="literal">__init__()</span> method with the <span class="literal">self</span> parameter first, just like we did before with our <span class="literal">Dog</span> class. We also give it three other parameters: <span class="literal">make</span>, <span class="literal">model</span>, and <span class="literal">year</span>. The <span class="literal">__init__()</span> method takes in these parameters and assigns them to the attributes that will be associated with instances made from this class. When we make a new <span class="literal">Car</span> instance, we’ll need to specify a make, model, and year for our instance.</p>
<p class="indent">At <span class="ent">➋</span> we define a method called <span class="literal">get_descriptive_name()</span> that puts a car’s <span class="literal">year</span>, <span class="literal">make</span>, and <span class="literal">model</span> into one string neatly describing the car. This will spare us from having to print each attribute’s value individually. To work with the attribute values in this method, we use <span class="literal">self.make</span>, <span class="literal">self.model</span>, and <span class="literal">self.year</span>. At <span class="ent">➌</span> we make an instance from the <span class="literal">Car</span> class and assign it to the variable <span class="literal">my_new_car</span>. Then we call <span class="literal">get_descriptive_name()</span> to show what kind of car we have:</p>
<p class="programs">2019 Audi A4</p>
<p class="indent">To make the class more interesting, let’s add an attribute that changes over time. We’ll add an attribute that stores the car’s overall mileage.</p>
<h4 class="h3" id="calibre_link-825"><strong class="calibre2"><em class="calibre3">Setting a Default Value for an Attribute</em></strong></h4>
<p class="noindent">When an instance is created, attributes can be defined without being passed in as parameters. These attributes can be defined in the <span class="literal">__init__()</span> method, where they are assigned a default value.</p>
<p class="indent">Let’s add an attribute called <span class="literal">odometer_reading</span> that always starts with a value of 0. We’ll also add a method <span class="literal">read_odometer()</span> that helps us read each car’s odometer:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, make, model, year):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize attributes to describe a car."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.make = make</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.model = model</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.year = year</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.odometer_reading = 0<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def get_descriptive_name(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-263" class="calibre"></span><span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def read_odometer(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Print a statement showing the car's mileage."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"This car has {self.odometer_reading} miles on it.")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_new_car = Car('audi', 'a4', 2019)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_new_car.get_descriptive_name())</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_new_car.read_odometer()</p>
<p class="indent">This time when Python calls the <span class="literal">__init__()</span> method to create a new instance, it stores the make, model, and year values as attributes like it did in the previous example. Then Python creates a new attribute called <span class="literal">odometer_reading</span> and sets its initial value to 0 <span class="ent">➊</span>. We also have a new method called <span class="literal">read_odometer()</span> at <span class="ent">➋</span> that makes it easy to read a car’s mileage.</p>
<p class="indent">Our car starts with a mileage of 0:</p>
<p class="programs">2019 Audi A4<br class="calibre4" />
This car has 0 miles on it.</p>
<p class="indent">Not many cars are sold with exactly 0 miles on the odometer, so we need a way to change the value of this attribute.</p>
<h4 class="h3" id="calibre_link-826"><strong class="calibre2"><em class="calibre3">Modifying Attribute Values</em></strong></h4>
<p class="noindent">You can change an attribute’s value in three ways: you can change the value directly through an instance, set the value through a method, or increment the value (add a certain amount to it) through a method. Let’s look at each of these approaches.</p>
<h5 class="h4" id="calibre_link-1341"><strong class="calibre2">Modifying an Attribute’s Value Directly</strong></h5>
<p class="noindent">The simplest way to modify the value of an attribute is to access the attribute directly through an instance. Here we set the odometer reading to 23 directly:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_new_car = Car('audi', 'a4', 2019)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_new_car.get_descriptive_name())</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> my_new_car.odometer_reading = 23<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_new_car.read_odometer()</p>
<p class="indent">At <span class="ent">➊</span> we use dot notation to access the car’s <span class="literal">odometer_reading</span> attribute and set its value directly. This line tells Python to take the instance <span class="literal">my_new_car</span>, find the attribute <span class="literal">odometer_reading</span> associated with it, and set the value of that attribute to 23:</p>
<p class="programs">2019 Audi A4<br class="calibre4" />
This car has 23 miles on it.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1342" class="calibre"></span>Sometimes you’ll want to access attributes directly like this, but other times you’ll want to write a method that updates the value for you.</p>
<h5 class="h4" id="calibre_link-1343"><strong class="calibre2">Modifying an Attribute’s Value Through a Method</strong></h5>
<p class="noindent">It can be helpful to have methods that update certain attributes for you. Instead of accessing the attribute directly, you pass the new value to a method that handles the updating internally.</p>
<p class="indent">Here’s an example showing a method called <span class="literal">update_odometer()</span>:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def update_odometer(self, mileage):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Set the odometer reading to the given value."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.odometer_reading = mileage<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_new_car = Car('audi', 'a4', 2019)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_new_car.get_descriptive_name())</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> my_new_car.update_odometer(23)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_new_car.read_odometer()</p>
<p class="indent">The only modification to <span class="literal">Car</span> is the addition of <span class="literal">update_odometer()</span> at <span class="ent">➊</span>. This method takes in a mileage value and assigns it to <span class="literal">self.odometer_reading</span>. At <span class="ent">➋</span> we call <span class="literal">update_odometer()</span> and give it <span class="literal">23</span> as an argument (corresponding to the <span class="literal">mileage</span> parameter in the method definition). It sets the odometer reading to 23, and <span class="literal">read_odometer()</span> prints the reading:</p>
<p class="programs">2019 Audi A4<br class="calibre4" />
This car has 23 miles on it.</p>
<p class="indent">We can extend the method <span class="literal">update_odometer()</span> to do additional work every time the odometer reading is modified. Let’s add a little logic to make sure no one tries to roll back the odometer reading:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update_odometer(self, mileage):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the odometer reading to the given value.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reject the change if it attempts to roll the odometer back.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if mileage &gt;= self.odometer_reading:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.odometer_reading = mileage</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("You can't roll back an odometer!")</p>
<p class="indent">Now <span class="literal">update_odometer()</span> checks that the new reading makes sense before modifying the attribute. If the new mileage, <span class="literal">mileage</span>, is greater than or equal <span type="pagebreak" id="calibre_link-264" class="calibre"></span>to the existing mileage, <span class="literal">self.odometer_reading</span>, you can update the odometer reading to the new mileage <span class="ent">➊</span>. If the new mileage is less than the existing mileage, you’ll get a warning that you can’t roll back an odometer <span class="ent">➋</span>.</p>
<h5 class="h4" id="calibre_link-1344"><strong class="calibre2">Incrementing an Attribute’s Value Through a Method</strong></h5>
<p class="noindent">Sometimes you’ll want to increment an attribute’s value by a certain amount rather than set an entirely new value. Say we buy a used car and put 100 miles on it between the time we buy it and the time we register it. Here’s a method that allows us to pass this incremental amount and add that value to the odometer reading:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update_odometer(self, mileage):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def increment_odometer(self, miles):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Add the given amount to the odometer reading."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.odometer_reading += miles<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> my_used_car = Car('subaru', 'outback', 2015)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_used_car.get_descriptive_name())<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> my_used_car.update_odometer(23_500)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_used_car.read_odometer()<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> my_used_car.increment_odometer(100)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_used_car.read_odometer()</p>
<p class="indent">The new method <span class="literal">increment_odometer()</span> at <span class="ent">➊</span> takes in a number of miles, and adds this value to <span class="literal">self.odometer_reading</span>. At <span class="ent">➋</span> we create a used car, <span class="literal">my_used_car</span>. We set its odometer to 23,500 by calling <span class="literal">update_odometer()</span> and passing it <span class="literal">23_500</span> at <span class="ent">➌</span>. At <span class="ent">➍</span> we call <span class="literal">increment_odometer()</span> and pass it <span class="literal">100</span> to add the 100 miles that we drove between buying the car and registering it:</p>
<p class="programs">2015 Subaru Outback<br class="calibre4" />
This car has 23500 miles on it.<br class="calibre4" />
This car has 23600 miles on it.</p>
<p class="indent">You can easily modify this method to reject negative increments so no one uses this function to roll back an odometer.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You can use methods like this to control how users of your program update values such as an odometer reading, but anyone with access to the program can set the odometer reading to any value by accessing the attribute directly. Effective security takes extreme attention to detail in addition to basic checks like those shown here.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-269" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-827"><strong class="calibre2">9-4. Number Served:</strong> Start with your program from <a href="#calibre_link-820" class="calibre6">Exercise 9-1</a> (<a href="#calibre_link-256" class="calibre6">page 162</a>). Add an attribute called <span class="literal1">number_served</span> with a default value of 0. Create an instance called <span class="literal1">restaurant</span> from this class. Print the number of customers the restaurant has served, and then change this value and print it again.</p>
<p class="sparai">Add a method called <span class="literal1">set_number_served()</span> that lets you set the number of customers that have been served. Call this method with a new number and print the value again.</p>
<p class="sparai">Add a method called <span class="literal1">increment_number_served()</span> that lets you increment the number of customers who’ve been served. Call this method with any number you like that could represent how many customers were served in, say, a day of business.</p>
<p class="sparal" id="calibre_link-828"><strong class="calibre2">9-5. Login Attempts:</strong> Add an attribute called <span class="literal1">login_attempts</span> to your <span class="literal1">User</span> class from <a href="#calibre_link-822" class="calibre6">Exercise 9-3</a> (<a href="#calibre_link-256" class="calibre6">page 162</a>). Write a method called <span class="literal1">increment_login_attempts()</span> that increments the value of <span class="literal1">login_attempts</span> by 1. Write another method called <span class="literal1">reset_login_attempts()</span> that resets the value of <span class="literal1">login_attempts</span> to 0.</p>
<p class="sparai">Make an instance of the <span class="literal1">User</span> class and call <span class="literal1">increment_login_attempts()</span> several times. Print the value of <span class="literal1">login_attempts</span> to make sure it was incremented properly, and then call <span class="literal1">reset_login_attempts()</span>. Print <span class="literal1">login_attempts</span> again to make sure it was reset to 0.</p>
</div>
<h3 class="h2" id="calibre_link-829"><strong class="calibre2">Inheritance</strong></h3>
<p class="noindent">You don’t always have to start from scratch when writing a class. If the class you’re writing is a specialized version of another class you wrote, you can use <em class="calibre3">inheritance</em>. When one class <em class="calibre3">inherits</em> from another, it takes on the attributes and methods of the first class. The original class is called the <em class="calibre3">parent class</em>, and the new class is the <em class="calibre3">child class</em>. The child class can inherit any or all of the attributes and methods of its parent class, but it’s also free to define new attributes and methods of its own.</p>
<h4 class="h3" id="calibre_link-830"><strong class="calibre2"><em class="calibre3">The __init__() Method for a Child Class</em></strong></h4>
<p class="noindent">When you’re writing a new class based on an existing class, you’ll often want to call the <span class="literal">__init__()</span> method from the parent class. This will initialize any attributes that were defined in the parent <span class="literal">__init__()</span> method and make them available in the child class.</p>
<p class="indent">As an example, let’s model an electric car. An electric car is just a specific kind of car, so we can base our new <span class="literal">ElectricCar</span> class on the <span class="literal">Car</span> class we wrote earlier. Then we’ll only have to write code for the attributes and behavior specific to electric cars.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-274" class="calibre"></span>Let’s start by making a simple version of the <span class="literal">ElectricCar</span> class, which does everything the <span class="literal">Car</span> class does:</p>
<p class="margin"><em class="calibre3">electric_car.py</em></p>
<p class="programs"><span class="ent">➊</span> <span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A simple attempt to represent a car."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, make, model, year):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.make = make</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.model = model</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.year = year</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.odometer_reading = 0</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def get_descriptive_name(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">long_name = f"{self.year} {self.manufacturer} {self.model}"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return long_name.title()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def read_odometer(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"This car has {self.odometer_reading} miles on it.")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update_odometer(self, mileage):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if mileage &gt;= self.odometer_reading:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.odometer_reading = mileage</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("You can't roll back an odometer!")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def increment_odometer(self, miles):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.odometer_reading += miles</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> class ElectricCar(Car):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Represent aspects of a car, specific to electric vehicles."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, make, model, year):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize attributes of the parent class."""<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super().__init__(make, model, year)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➎</span> my_tesla = ElectricCar('tesla', 'model s', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_tesla.get_descriptive_name())</p>
<p class="indent">At <span class="ent">➊</span> we start with <span class="literal">Car</span>. When you create a child class, the parent class must be part of the current file and must appear before the child class in the file. At <span class="ent">➋</span> we define the child class, <span class="literal">ElectricCar</span>. The name of the parent class must be included in parentheses in the definition of a child class. The <span class="literal">__init__()</span> method at <span class="ent">➌</span> takes in the information required to make a <span class="literal">Car</span> instance.</p>
<p class="indent">The <span class="literal">super()</span> function at <span class="ent">➍</span> is a special function that allows you to call a method from the parent class. This line tells Python to call the <span class="literal">__init__()</span> method from <span class="literal">Car</span>, which gives an <span class="literal">ElectricCar</span> instance all the attributes defined in that method. The name <em class="calibre3">super</em> comes from a convention of calling the parent class a <em class="calibre3">superclass</em> and the child class a <em class="calibre3">subclass</em>.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-271" class="calibre"></span>We test whether inheritance is working properly by trying to create an electric car with the same kind of information we’d provide when making a regular car. At <span class="ent">➎</span> we make an instance of the <span class="literal">ElectricCar</span> class and assign it to <span class="literal">my_tesla</span>. This line calls the <span class="literal">__init__()</span> method defined in <span class="literal">ElectricCar</span>, which in turn tells Python to call the <span class="literal">__init__()</span> method defined in the parent class <span class="literal">Car</span>. We provide the arguments <span class="literal">'tesla'</span>, <span class="literal">'model s'</span>, and <span class="literal">2019</span>.</p>
<p class="indent">Aside from <span class="literal">__init__()</span>, there are no attributes or methods yet that are particular to an electric car. At this point we’re just making sure the electric car has the appropriate <span class="literal">Car</span> behaviors:</p>
<p class="programs">2019 Tesla Model S</p>
<p class="indent">The <span class="literal">ElectricCar</span> instance works just like an instance of <span class="literal">Car</span>, so now we can begin defining attributes and methods specific to electric cars.</p>
<h4 class="h3" id="calibre_link-831"><strong class="calibre2"><em class="calibre3">Defining Attributes and Methods for the Child Class</em></strong></h4>
<p class="noindent">Once you have a child class that inherits from a parent class, you can add any new attributes and methods necessary to differentiate the child class from the parent class.</p>
<p class="indent">Let’s add an attribute that’s specific to electric cars (a battery, for example) and a method to report on this attribute. We’ll store the battery size and write a method that prints a description of the battery:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class ElectricCar(Car):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Represent aspects of a car, specific to electric vehicles."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, make, model, year):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initialize attributes of the parent class.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Then initialize attributes specific to an electric car.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">super().__init__(make, model, year)</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.battery_size = 75<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def describe_battery(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Print a statement describing the battery size."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"This car has a {self.battery_size}-kWh battery.")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_tesla = ElectricCar('tesla', 'model s', 2019)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_tesla.get_descriptive_name())</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_tesla.describe_battery()</p>
<p class="indent">At <span class="ent">➊</span> we add a new attribute <span class="literal">self.battery_size</span> and set its initial value to, say, <span class="literal">75</span>. This attribute will be associated with all instances created from the <span class="literal">ElectricCar</span> class but won’t be associated with any instances of <span class="literal">Car</span>. We also <span type="pagebreak" id="calibre_link-272" class="calibre"></span>add a method called <span class="literal">describe_battery()</span> that prints information about the battery at <span class="ent">➋</span>. When we call this method, we get a description that is clearly specific to an electric car:</p>
<p class="programs">2019 Tesla Model S<br class="calibre4" />
This car has a 75-kWh battery.</p>
<p class="indent">There’s no limit to how much you can specialize the <span class="literal">ElectricCar</span> class. You can add as many attributes and methods as you need to model an electric car to whatever degree of accuracy you need. An attribute or method that could belong to any car, rather than one that’s specific to an electric car, should be added to the <span class="literal">Car</span> class instead of the <span class="literal">ElectricCar</span> class. Then anyone who uses the <span class="literal">Car</span> class will have that functionality available as well, and the <span class="literal">ElectricCar</span> class will only contain code for the information and behavior specific to electric vehicles.</p>
<h4 class="h3" id="calibre_link-832"><strong class="calibre2"><em class="calibre3">Overriding Methods from the Parent Class</em></strong></h4>
<p class="noindent">You can override any method from the parent class that doesn’t fit what you’re trying to model with the child class. To do this, you define a method in the child class with the same name as the method you want to override in the parent class. Python will disregard the parent class method and only pay attention to the method you define in the child class.</p>
<p class="indent">Say the class <span class="literal">Car</span> had a method called <span class="literal">fill_gas_tank()</span>. This method is meaningless for an all-electric vehicle, so you might want to override this method. Here’s one way to do that:</p>
<p class="programs">class ElectricCar(Car):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def fill_gas_tank(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Electric cars don't have gas tanks."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("This car doesn't need a gas tank!")</p>
<p class="indent">Now if someone tries to call <span class="literal">fill_gas_tank()</span> with an electric car, Python will ignore the method <span class="literal">fill_gas_tank()</span> in <span class="literal">Car</span> and run this code instead. When you use inheritance, you can make your child classes retain what you need and override anything you don’t need from the parent class.</p>
<h4 class="h3" id="calibre_link-833"><strong class="calibre2"><em class="calibre3">Instances as Attributes</em></strong></h4>
<p class="noindent">When modeling something from the real world in code, you may find that you’re adding more and more detail to a class. You’ll find that you have a growing list of attributes and methods and that your files are becoming lengthy. In these situations, you might recognize that part of one class can be written as a separate class. You can break your large class into smaller classes that work together.</p>
<p class="indent">For example, if we continue adding detail to the <span class="literal">ElectricCar</span> class, we might notice that we’re adding many attributes and methods specific to <span type="pagebreak" id="calibre_link-1345" class="calibre"></span>the car’s battery. When we see this happening, we can stop and move those attributes and methods to a separate class called <span class="literal">Battery</span>. Then we can use a <span class="literal">Battery</span> instance as an attribute in the <span class="literal">ElectricCar</span> class:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> class Battery:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A simple attempt to model a battery for an electric car."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, battery_size=75):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize the battery's attributes."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.battery_size = battery_size<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def describe_battery(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Print a statement describing the battery size."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"This car has a {self.battery_size}-kWh battery.")<br class="calibre4" />
<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class ElectricCar(Car):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Represent aspects of a car, specific to electric vehicles."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, make, model, year):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Initialize attributes of the parent class.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Then initialize attributes specific to an electric car.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">super().__init__(make, model, year)</span><br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.battery = Battery()<br class="calibre4" />
<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_tesla = ElectricCar('tesla', 'model s', 2019)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_tesla.get_descriptive_name())</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_tesla.battery.describe_battery()</p>
<p class="indent">At <span class="ent">➊</span> we define a new class called <span class="literal">Battery</span> that doesn’t inherit from any other class. The <span class="literal">__init__()</span> method at <span class="ent">➋</span> has one parameter, <span class="literal">battery_size</span>, in addition to <span class="literal">self</span>. This is an optional parameter that sets the battery’s size to 75 if no value is provided. The method <span class="literal">describe_battery()</span> has been moved to this class as well <span class="ent">➌</span>.</p>
<p class="indent">In the <span class="literal">ElectricCar</span> class, we now add an attribute called <span class="literal">self.battery</span> <span class="ent">➍</span>. This line tells Python to create a new instance of <span class="literal">Battery</span> (with a default size of 75, because we’re not specifying a value) and assign that instance to the attribute <span class="literal">self.battery</span>. This will happen every time the <span class="literal">__init__()</span> method is called; any <span class="literal">ElectricCar</span> instance will now have a <span class="literal">Battery</span> instance created automatically.</p>
<p class="indent">We create an electric car and assign it to the variable <span class="literal">my_tesla</span>. When we want to describe the battery, we need to work through the car’s <span class="literal">battery</span> attribute:</p>
<p class="programs">my_tesla.battery.describe_battery()</p>
<p class="indent"><span type="pagebreak" id="calibre_link-273" class="calibre"></span>This line tells Python to look at the instance <span class="literal">my_tesla</span>, find its <span class="literal">battery</span> attribute, and call the method <span class="literal">describe_battery()</span> that’s associated with the <span class="literal">Battery</span> instance stored in the attribute.</p>
<p class="indent">The output is identical to what we saw previously:</p>
<p class="programs">2019 Tesla Model S<br class="calibre4" />
This car has a 75-kWh battery.</p>
<p class="indent">This looks like a lot of extra work, but now we can describe the battery in as much detail as we want without cluttering the <span class="literal">ElectricCar</span> class. Let’s add another method to <span class="literal">Battery</span> that reports the range of the car based on the battery size:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class Battery:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def get_range(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Print a statement about the range this battery provides."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.battery_size == 75:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range = 260<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif self.battery_size == 100:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range = 315<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"This car can go about {range} miles on a full charge.")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class ElectricCar(Car):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_tesla = ElectricCar('tesla', 'model s', 2019)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_tesla.get_descriptive_name())</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_tesla.battery.describe_battery()</span><br class="calibre4" />
<span class="ent">➋</span> my_tesla.battery.get_range()</p>
<p class="indent">The new method <span class="literal">get_range()</span> at <span class="ent">➊</span> performs some simple analysis. If the battery’s capacity is 75 kWh, <span class="literal">get_range()</span> sets the range to 260 miles, and if the capacity is 100 kWh, it sets the range to 315 miles. It then reports this value. When we want to use this method, we again have to call it through the car’s <span class="literal">battery</span> attribute at <span class="ent">➋</span>.</p>
<p class="indent">The output tells us the range of the car based on its battery size:</p>
<p class="programs">2019 Tesla Model S<br class="calibre4" />
This car has a 75-kWh battery.<br class="calibre4" />
This car can go about 260 miles on a full charge.</p>
<h4 class="h3" id="calibre_link-834"><span type="pagebreak" id="calibre_link-270" class="calibre"></span><strong class="calibre2"><em class="calibre3">Modeling Real-World Objects</em></strong></h4>
<p class="noindent">As you begin to model more complicated things like electric cars, you’ll wrestle with interesting questions. Is the range of an electric car a property of the battery or of the car? If we’re only describing one car, it’s probably fine to maintain the association of the method <span class="literal">get_range()</span> with the <span class="literal">Battery</span> class. But if we’re describing a manufacturer’s entire line of cars, we probably want to move <span class="literal">get_range()</span> to the <span class="literal">ElectricCar</span> class. The <span class="literal">get_range()</span> method would still check the battery size before determining the range, but it would report a range specific to the kind of car it’s associated with. Alternatively, we could maintain the association of the <span class="literal">get_range()</span> method with the battery but pass it a parameter such as <span class="literal">car_model</span>. The <span class="literal">get_range()</span> method would then report a range based on the battery size and car model.</p>
<p class="indent">This brings you to an interesting point in your growth as a programmer. When you wrestle with questions like these, you’re thinking at a higher logical level rather than a syntax-focused level. You’re thinking not about Python, but about how to represent the real world in code. When you reach this point, you’ll realize there are often no right or wrong approaches to modeling real-world situations. Some approaches are more efficient than others, but it takes practice to find the most efficient representations. If your code is working as you want it to, you’re doing well! Don’t be discouraged if you find you’re ripping apart your classes and rewriting them several times using different approaches. In the quest to write accurate, efficient code, everyone goes through this process.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-266" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-835"><strong class="calibre2">9-6. Ice Cream Stand:</strong> An ice cream stand is a specific kind of restaurant. Write a class called <span class="literal1">IceCreamStand</span> that inherits from the <span class="literal1">Restaurant</span> class you wrote in <a href="#calibre_link-820" class="calibre6">Exercise 9-1</a> (<a href="#calibre_link-256" class="calibre6">page 162</a>) or <a href="#calibre_link-827" class="calibre6">Exercise 9-4</a> (<a href="#calibre_link-269" class="calibre6">page 167</a>). Either version of the class will work; just pick the one you like better. Add an attribute called <span class="literal1">flavors</span> that stores a list of ice cream flavors. Write a method that displays these flavors. Create an instance of <span class="literal1">IceCreamStand</span>, and call this method.</p>
<p class="sparal" id="calibre_link-836"><strong class="calibre2">9-7. Admin:</strong> An administrator is a special kind of user. Write a class called <span class="literal1">Admin</span> that inherits from the <span class="literal1">User</span> class you wrote in <a href="#calibre_link-822" class="calibre6">Exercise 9-3</a> (<a href="#calibre_link-256" class="calibre6">page 162</a>) or <a href="#calibre_link-828" class="calibre6">Exercise 9-5</a> (<a href="#calibre_link-269" class="calibre6">page 167</a>). Add an attribute, <span class="literal1">privileges</span>, that stores a list of strings like <span class="literal1">"can add post"</span>, <span class="literal1">"can delete post"</span>, <span class="literal1">"can ban user"</span>, and so on. Write a method called <span class="literal1">show_privileges()</span> that lists the administrator’s set of privileges. Create an instance of <span class="literal1">Admin</span>, and call your method.</p>
<p class="sparal" id="calibre_link-837"><strong class="calibre2">9-8. Privileges:</strong> Write a separate <span class="literal1">Privileges</span> class. The class should have one attribute, <span class="literal1">privileges</span>, that stores a list of strings as described in <a href="#calibre_link-836" class="calibre6">Exercise 9-7</a>. Move the <span class="literal1">show_privileges()</span> method to this class. Make a <span class="literal1">Privileges</span> instance as an attribute in the <span class="literal1">Admin</span> class. Create a new instance of <span class="literal1">Admin</span> and use your method to show its privileges.</p>
<p class="sparal" id="calibre_link-838"><strong class="calibre2">9-9. Battery Upgrade:</strong> Use the final version of <em class="calibre3">electric_car.py</em> from this section. Add a method to the <span class="literal1">Battery</span> class called <span class="literal1">upgrade_battery()</span>. This method should check the battery size and set the capacity to 100 if it isn’t already. Make an electric car with a default battery size, call <span class="literal1">get_range()</span> once, and then call <span class="literal1">get_range()</span> a second time after upgrading the battery. You should see an increase in the car’s range.</p>
</div>
<h3 class="h2" id="calibre_link-839"><strong class="calibre2">Importing Classes</strong></h3>
<p class="noindent">As you add more functionality to your classes, your files can get long, even when you use inheritance properly. In keeping with the overall philosophy of Python, you’ll want to keep your files as uncluttered as possible. To help, Python lets you store classes in modules and then import the classes you need into your main program.</p>
<h4 class="h3" id="calibre_link-840"><strong class="calibre2"><em class="calibre3">Importing a Single Class</em></strong></h4>
<p class="noindent">Let’s create a module containing just the <span class="literal">Car</span> class. This brings up a subtle naming issue: we already have a file named <em class="calibre3">car.py</em> in this chapter, but this module should be named <em class="calibre3">car.py</em> because it contains code representing a car. We’ll resolve this naming issue by storing the <span class="literal">Car</span> class in a module named <em class="calibre3">car.py</em>, replacing the <em class="calibre3">car.py</em> file we were previously using. From now on, any program that uses this module will need a more specific filename, such as <em class="calibre3">my_car.py</em>. Here’s <em class="calibre3">car.py</em> with just the code from the class <span class="literal">Car</span>:</p>
<p class="margin"><em class="calibre3">car.py</em></p>
<p class="programs"><span class="ent">➊</span> """A class that can be used to represent a car."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A simple attempt to represent a car."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, make, model, year):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize attributes to describe a car."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.make = make</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.model = model</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.year = year</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.odometer_reading = 0</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def get_descriptive_name(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Return a neatly formatted descriptive name."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">long_name = f"{self.year} {self.manufacturer} {self.model}"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return long_name.title()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def read_odometer(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Print a statement showing the car's mileage."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"This car has {self.odometer_reading} miles on it.")</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-268" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update_odometer(self, mileage):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Set the odometer reading to the given value.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Reject the change if it attempts to roll the odometer back.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if mileage &gt;= self.odometer_reading:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.odometer_reading = mileage</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print("You can't roll back an odometer!")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def increment_odometer(self, miles):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Add the given amount to the odometer reading."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.odometer_reading += miles</span></p>
<p class="indent">At <span class="ent">➊</span> we include a module-level docstring that briefly describes the contents of this module. You should write a docstring for each module you create.</p>
<p class="indent">Now we make a separate file called <em class="calibre3">my_car.py</em>. This file will import the <span class="literal">Car</span> class and then create an instance from that class:</p>
<p class="margin"><em class="calibre3">my_car.py</em></p>
<p class="programs"><span class="ent">➊</span> from car import Car<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_new_car = Car('audi', 'a4', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_new_car.get_descriptive_name())<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_new_car.odometer_reading = 23<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_new_car.read_odometer()</p>
<p class="indent">The <span class="literal">import</span> statement at <span class="ent">➊</span> tells Python to open the <span class="literal">car</span> module and import the class <span class="literal">Car</span>. Now we can use the <span class="literal">Car</span> class as if it were defined in this file. The output is the same as we saw earlier:</p>
<p class="programs">2019 Audi A4<br class="calibre4" />
This car has 23 miles on it.</p>
<p class="indent">Importing classes is an effective way to program. Picture how long this program file would be if the entire <span class="literal">Car</span> class were included. When you instead move the class to a module and import the module, you still get all the same functionality, but you keep your main program file clean and easy to read. You also store most of the logic in separate files; once your classes work as you want them to, you can leave those files alone and focus on the higher-level logic of your main program.</p>
<h4 class="h3" id="calibre_link-841"><strong class="calibre2"><em class="calibre3">Storing Multiple Classes in a Module</em></strong></h4>
<p class="noindent">You can store as many classes as you need in a single module, although each class in a module should be related somehow. The classes <span class="literal">Battery</span> and <span class="literal">ElectricCar</span> both help represent cars, so let’s add them to the module <em class="calibre3">car.py</em>.</p>
<p class="margin"><span type="pagebreak" id="calibre_link-503" class="calibre"></span><em class="calibre3">car.py</em></p>
<p class="programs">"""A set of classes used to represent gas and electric cars."""<br class="calibre4" />
<br class="calibre4" />
<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">class Battery:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A simple attempt to model a battery for an electric car."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, battery_size=70):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize the battery's attributes."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.battery_size = battery_size</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def describe_battery(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Print a statement describing the battery size."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"This car has a {self.battery_size}-kWh battery.")</span><br class="calibre4" />
<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def get_range(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Print a statement about the range this battery provides."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if self.battery_size == 75:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">range = 260</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif self.battery_size == 100:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">range = 315</span><br class="calibre4" />
<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"This car can go about {range} miles on a full charge.")</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">class ElectricCar(Car):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Models aspects of a car, specific to electric vehicles."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, make, model, year):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Initialize attributes of the parent class.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Then initialize attributes specific to an electric car.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">super().__init__(make, model, year)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.battery = Battery()</span></p>
<p class="indent">Now we can make a new file called <em class="calibre3">my_electric_car.py</em>, import the <span class="literal">ElectricCar</span> class, and make an electric car:</p>
<p class="margin"><em class="calibre3">my_electric_car.py</em></p>
<p class="programs">from car import ElectricCar<br class="calibre4" />
<br class="calibre4" />
my_tesla = ElectricCar('tesla', 'model s', 2019)<br class="calibre4" />
<br class="calibre4" />
print(my_tesla.get_descriptive_name())<br class="calibre4" />
my_tesla.battery.describe_battery()<br class="calibre4" />
my_tesla.battery.get_range()</p>
<p class="indent">This has the same output we saw earlier, even though most of the logic is hidden away in a module:</p>
<p class="programs">2019 Tesla Model S<br class="calibre4" />
This car has a 75-kWh battery.<br class="calibre4" />
This car can go about 260 miles on a full charge.</p>
<h4 class="h3" id="calibre_link-842"><span type="pagebreak" id="calibre_link-267" class="calibre"></span><strong class="calibre2"><em class="calibre3">Importing Multiple Classes from a Module</em></strong></h4>
<p class="noindent">You can import as many classes as you need into a program file. If we want to make a regular car and an electric car in the same file, we need to import both classes, <span class="literal">Car</span> and <span class="literal">ElectricCar</span>:</p>
<p class="margin"><em class="calibre3">my_cars.py</em></p>
<p class="programs"><span class="ent">➊</span> from car import Car, ElectricCar<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> my_beetle = Car('volkswagen', 'beetle', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_beetle.get_descriptive_name())<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> my_tesla = ElectricCar('tesla', 'roadster', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_tesla.get_descriptive_name())</p>
<p class="indent">You import multiple classes from a module by separating each class with a comma <span class="ent">➊</span>. Once you’ve imported the necessary classes, you’re free to make as many instances of each class as you need.</p>
<p class="indent">In this example we make a regular Volkswagen Beetle at <span class="ent">➋</span> and an electric Tesla Roadster at <span class="ent">➌</span>:</p>
<p class="programs">2019 Volkswagen Beetle<br class="calibre4" />
2019 Tesla Roadster</p>
<h4 class="h3" id="calibre_link-843"><strong class="calibre2"><em class="calibre3">Importing an Entire Module</em></strong></h4>
<p class="noindent">You can also import an entire module and then access the classes you need using dot notation. This approach is simple and results in code that is easy to read. Because every call that creates an instance of a class includes the module name, you won’t have naming conflicts with any names used in the current file.</p>
<p class="indent">Here’s what it looks like to import the entire <span class="literal">car</span> module and then create a regular car and an electric car:</p>
<p class="margin"><em class="calibre3">my_cars.py</em></p>
<p class="programs"><span class="ent">➊</span> import car<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> my_beetle = car.Car('volkswagen', 'beetle', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_beetle.get_descriptive_name())</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> my_tesla = car.ElectricCar('tesla', 'roadster', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(my_tesla.get_descriptive_name())</span></p>
<p class="indent">At <span class="ent">➊</span> we import the entire <span class="literal">car</span> module. We then access the classes we need through the <span class="codeitalic">module_name.ClassName</span> syntax. At <span class="ent">➋</span> we again create a Volkswagen Beetle, and at <span class="ent">➌</span> we create a Tesla Roadster.</p>
<h4 class="h3" id="calibre_link-844"><strong class="calibre2"><em class="calibre3">Importing All Classes from a Module</em></strong></h4>
<p class="noindent">You can import every class from a module using the following syntax:</p>
<p class="programs">from <span class="codeitalic1">module_name</span> import *</p>
<p class="indent"><span type="pagebreak" id="calibre_link-363" class="calibre"></span>This method is not recommended for two reasons. First, it’s helpful to be able to read the <span class="literal">import</span> statements at the top of a file and get a clear sense of which classes a program uses. With this approach it’s unclear which classes you’re using from the module. This approach can also lead to confusion with names in the file. If you accidentally import a class with the same name as something else in your program file, you can create errors that are hard to diagnose. I show this here because even though it’s not a recommended approach, you’re likely to see it in other people’s code at some point.</p>
<p class="indent">If you need to import many classes from a module, you’re better off importing the entire module and using the <span class="codeitalic">module_name.ClassName</span> syntax. You won’t see all the classes used at the top of the file, but you’ll see clearly where the module is used in the program. You’ll also avoid the potential naming conflicts that can arise when you import every class in a module.</p>
<h4 class="h3" id="calibre_link-845"><strong class="calibre2"><em class="calibre3">Importing a Module into a Module</em></strong></h4>
<p class="noindent">Sometimes you’ll want to spread out your classes over several modules to keep any one file from growing too large and avoid storing unrelated classes in the same module. When you store your classes in several modules, you may find that a class in one module depends on a class in another module. When this happens, you can import the required class into the first module.</p>
<p class="indent">For example, let’s store the <span class="literal">Car</span> class in one module and the <span class="literal">ElectricCar</span> and <span class="literal">Battery</span> classes in a separate module. We’ll make a new module called <em class="calibre3">electric_car.py</em>&mdash;replacing the <em class="calibre3">electric_car.py</em> file we created earlier&mdash;and copy just the <span class="literal">Battery</span> and <span class="literal">ElectricCar</span> classes into this file:</p>
<p class="margin"><em class="calibre3">electric_car.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;"""A set of classes that can be used to represent electric cars."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> from car import Car<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class Battery:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class ElectricCar(Car):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">The class <span class="literal">ElectricCar</span> needs access to its parent class <span class="literal">Car</span>, so we import <span class="literal">Car</span> directly into the module at <span class="ent">➊</span>. If we forget this line, Python will raise an error when we try to import the <span class="literal">electric_car</span> module. We also need to update the <span class="literal">Car</span> module so it contains only the <span class="literal">Car</span> class:</p>
<p class="margin"><em class="calibre3">car.py</em></p>
<p class="programs">"""A class that can be used to represent a car."""<br class="calibre4" />
<br class="calibre4" />
<span class="ash">class Car:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-257" class="calibre"></span>Now we can import from each module separately and create whatever kind of car we need:</p>
<p class="margin"><em class="calibre3">my_cars.py</em></p>
<p class="programs"><span class="ent">➊</span> from car import Car<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from electric_car import ElectricCar<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_beetle = Car('volkswagen', 'beetle', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_beetle.get_descriptive_name())<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_tesla = ElectricCar('tesla', 'roadster', 2019)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(my_tesla.get_descriptive_name())</p>
<p class="indent">At <span class="ent">➊</span> we import <span class="literal">Car</span> from its module, and <span class="literal">ElectricCar</span> from its module. We then create one regular car and one electric car. Both kinds of cars are created correctly:</p>
<p class="programs">2019 Volkswagen Beetle<br class="calibre4" />
2019 Tesla Roadster</p>
<h4 class="h3" id="calibre_link-846"><strong class="calibre2"><em class="calibre3">Using Aliases</em></strong></h4>
<p class="noindent">As you saw in <a href="#calibre_link-118" class="calibre6">Chapter 8</a>, aliases can be quite helpful when using modules to organize your projects’ code. You can use aliases when importing classes as well.</p>
<p class="indent">As an example, consider a program where you want to make a bunch of electric cars. It might get tedious to type (and read) <span class="literal">ElectricCar</span> over and over again. You can give <span class="literal">ElectricCar</span> an alias in the import statement:</p>
<p class="programs">from electric_car import ElectricCar as EC</p>
<p class="indent">Now you can use this alias whenever you want to make an electric car:</p>
<p class="programs">my_tesla = EC('tesla', 'roadster', 2019)</p>
<h4 class="h3" id="calibre_link-847"><strong class="calibre2"><em class="calibre3">Finding Your Own Workflow</em></strong></h4>
<p class="noindent">As you can see, Python gives you many options for how to structure code in a large project. It’s important to know all these possibilities so you can determine the best ways to organize your projects as well as understand other people’s projects.</p>
<p class="indent">When you’re starting out, keep your code structure simple. Try doing everything in one file and moving your classes to separate modules once everything is working. If you like how modules and files interact, try storing your classes in modules when you start a project. Find an approach that lets you write code that works, and go from there.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-535" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-848"><strong class="calibre2">9-10. Imported Restaurant:</strong> Using your latest <span class="literal1">Restaurant</span> class, store it in a module. Make a separate file that imports <span class="literal1">Restaurant</span>. Make a <span class="literal1">Restaurant</span> instance, and call one of <span class="literal1">Restaurant</span>’s methods to show that the <span class="literal1">import</span> statement is working properly.</p>
<p class="sparal" id="calibre_link-849"><strong class="calibre2">9-11. Imported Admin:</strong> Start with your work from <a href="#calibre_link-837" class="calibre6">Exercise 9-8</a> (<a href="#calibre_link-270" class="calibre6">page 173</a>). Store the classes <span class="literal1">User</span>, <span class="literal1">Privileges</span>, and <span class="literal1">Admin</span> in one module. Create a separate file, make an <span class="literal1">Admin</span> instance, and call <span class="literal1">show_privileges()</span> to show that everything is working correctly.</p>
<p class="sparal" id="calibre_link-850"><strong class="calibre2">9-12. Multiple Modules:</strong> Store the <span class="literal1">User</span> class in one module, and store the <span class="literal1">Privileges</span> and <span class="literal1">Admin</span> classes in a separate module. In a separate file, create an <span class="literal1">Admin</span> instance and call <span class="literal1">show_privileges()</span> to show that everything is still working correctly.</p>
</div>
<h3 class="h2" id="calibre_link-851"><strong class="calibre2">The Python Standard Library</strong></h3>
<p class="noindent">The <em class="calibre3">Python standard library</em> is a set of modules included with every Python installation. Now that you have a basic understanding of how functions and classes work, you can start to use modules like these that other programmers have written. You can use any function or class in the standard library by including a simple <span class="literal">import</span> statement at the top of your file. Let’s look at one module, <span class="literal">random</span>, which can be useful in modeling many real-world situations.</p>
<p class="indent">One interesting function from the random module is <span class="literal">randint()</span>. This function takes two integer arguments and returns a randomly selected integer between (and including) those numbers.</p>
<p class="indent">Here’s how to generate a random number between 1 and 6:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">from random import randint</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">randint(1, 6)</span><br class="calibre4" />
3</p>
<p class="indent">Another useful function is <span class="literal">choice()</span>. This function takes in a list or tuple and returns a randomly chosen element:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">from random import choice</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">players = ['charles', 'martina', 'michael', 'florence', 'eli']</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">first_up = choice(players)</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">first_up</span><br class="calibre4" />
'florence'</p>
<p class="indent"><span type="pagebreak" id="calibre_link-255" class="calibre"></span>The <span class="literal">random</span> module shouldn’t be used when building security-related applications, but it’s good enough for many fun and interesting projects.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You can also download modules from external sources. You’ll see a number of these examples in <a href="#calibre_link-10" class="calibre6">Part II</a>, where we’ll need external modules to complete each project.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-852"><strong class="calibre2">9-13. Dice:</strong> Make a class <span class="literal1">Die</span> with one attribute called <span class="literal1">sides</span>, which has a default value of 6. Write a method called <span class="literal1">roll_die()</span> that prints a random number between 1 and the number of sides the die has. Make a 6-sided die and roll it 10 times.</p>
<p class="sparai">Make a 10-sided die and a 20-sided die. Roll each die 10 times.</p>
<p class="sparal" id="calibre_link-853"><strong class="calibre2">9-14. Lottery:</strong> Make a list or tuple containing a series of 10 numbers and five letters. Randomly select four numbers or letters from the list and print a message saying that any ticket matching these four numbers or letters wins a prize.</p>
<p class="sparal" id="calibre_link-854"><strong class="calibre2">9-15. Lottery Analysis:</strong> You can use a loop to see how hard it might be to win the kind of lottery you just modeled. Make a list or tuple called <span class="literal1">my_ticket</span>. Write a loop that keeps pulling numbers until your ticket wins. Print a message reporting how many times the loop had to run to give you a winning ticket.</p>
<p class="sparal" id="calibre_link-855"><strong class="calibre2">9-16. Python Module of the Week:</strong> One excellent resource for exploring the Python standard library is a site called <em class="calibre3">Python Module of the Week</em>. Go to <em class="calibre3"><a href="https://pymotw.com/" class="calibre6">https://pymotw.com/</a></em> and look at the table of contents. Find a module that looks interesting to you and read about it, perhaps starting with the <span class="literal1">random</span> module.</p>
</div>
<h3 class="h2" id="calibre_link-856"><strong class="calibre2">Styling Classes</strong></h3>
<p class="noindent">A few styling issues related to classes are worth clarifying, especially as your programs become more complicated.</p>
<p class="indent">Class names should be written in <em class="calibre3">CamelCase</em>. To do this, capitalize the first letter of each word in the name, and don’t use underscores. Instance and module names should be written in lowercase with underscores between words.</p>
<p class="indent">Every class should have a docstring immediately following the class definition. The docstring should be a brief description of what the class does, and you should follow the same formatting conventions you used for writing docstrings in functions. Each module should also have a docstring describing what the classes in a module can be used for.</p>
<p class="indent">You can use blank lines to organize code, but don’t use them excessively. Within a class you can use one blank line between methods, and within a module you can use two blank lines to separate classes.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1346" class="calibre"></span>If you need to import a module from the standard library and a module that you wrote, place the import statement for the standard library module first. Then add a blank line and the import statement for the module you wrote. In programs with multiple import statements, this convention makes it easier to see where the different modules used in the program come from.</p>
<h3 class="h2" id="calibre_link-857"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned how to write your own classes. You learned how to store information in a class using attributes and how to write methods that give your classes the behavior they need. You learned to write <span class="literal">__init__()</span> methods that create instances from your classes with exactly the attributes you want. You saw how to modify the attributes of an instance directly and through methods. You learned that inheritance can simplify the creation of classes that are related to each other, and you learned to use instances of one class as attributes in another class to keep each class simple.</p>
<p class="indent">You saw how storing classes in modules and importing classes you need into the files where they’ll be used can keep your projects organized. You started learning about the Python standard library, and you saw an example based on the <span class="literal">random</span> module. Finally, you learned to style your classes using Python conventions.</p>
<p class="indent">In <a href="#calibre_link-119" class="calibre6">Chapter 10</a> you’ll learn to work with files so you can save the work you’ve done in a program and the work you’ve allowed users to do. You’ll also learn about <em class="calibre3">exceptions</em>, a special Python class designed to help you respond to errors when they arise.</p>
</div>


<div class="calibre1" id="calibre_link-563">
<h2 class="h" id="calibre_link-119"><span type="pagebreak" id="calibre_link-368" class="calibre"></span><strong class="calibre2"><span class="big">10</span><br class="calibre4" />FILES AND EXCEPTIONS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Now that you’ve mastered the basic skills you need to write organized programs that are easy to use, it’s time to think about making your programs even more relevant and usable. In this chapter you’ll learn to work with files so your programs can quickly analyze lots of data. You’ll learn to handle errors so your programs don’t crash when they encounter unexpected situations. You’ll learn about <em class="calibre3">exceptions</em>, which are special objects Python creates to manage errors that arise while a program is running. You’ll also learn about the <span class="literal">json</span> module, which allows you to save user data so it isn’t lost when your program stops running.</p>
<p class="indent">Learning to work with files and save data will make your programs easier for people to use. Users will be able to choose what data to enter and when to enter it. People can run your program, do some work, and then close the program and pick up where they left off later. Learning to handle exceptions will help you deal with situations in which files don’t exist and deal with other problems that can cause your programs to crash. This will make your programs more robust when they encounter bad data, whether <span type="pagebreak" id="calibre_link-374" class="calibre"></span>it comes from innocent mistakes or from malicious attempts to break your programs. With the skills you’ll learn in this chapter, you’ll make your programs more applicable, usable, and stable.</p>
<h3 class="h2" id="calibre_link-858"><strong class="calibre2">Reading from a File</strong></h3>
<p class="noindent">An incredible amount of data is available in text files. Text files can contain weather data, traffic data, socioeconomic data, literary works, and more. Reading from a file is particularly useful in data analysis applications, but it’s also applicable to any situation in which you want to analyze or modify information stored in a file. For example, you can write a program that reads in the contents of a text file and rewrites the file with formatting that allows a browser to display it.</p>
<p class="indent">When you want to work with the information in a text file, the first step is to read the file into memory. You can read the entire contents of a file, or you can work through the file one line at a time.</p>
<h4 class="h3" id="calibre_link-859"><strong class="calibre2"><em class="calibre3">Reading an Entire File</em></strong></h4>
<p class="noindent">To begin, we need a file with a few lines of text in it. Let’s start with a file that contains <em class="calibre3">pi</em> to 30 decimal places, with 10 decimal places per line:</p>
<p class="margin"><em class="calibre3">pi_digits.txt</em></p>
<p class="programs">3.1415926535<br class="calibre4" />
&nbsp;&nbsp;8979323846<br class="calibre4" />
&nbsp;&nbsp;2643383279</p>
<p class="indent">To try the following examples yourself, you can enter these lines in an editor and save the file as <em class="calibre3">pi_digits.txt</em>, or you can download the file from the book’s resources through <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em>. Save the file in the same directory where you’ll store this chapter’s programs.</p>
<p class="indent">Here’s a program that opens this file, reads it, and prints the contents of the file to the screen:</p>
<p class="margin"><em class="calibre3">file_reader.py</em></p>
<p class="programs">with open('pi_digits.txt') as file_object:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;contents = file_object.read()<br class="calibre4" />
print(contents)</p>
<p class="indent">The first line of this program has a lot going on. Let’s start by looking at the <span class="literal">open()</span> function. To do any work with a file, even just printing its contents, you first need to <em class="calibre3">open</em> the file to access it. The <span class="literal">open()</span> function needs one argument: the name of the file you want to open. Python looks for this file in the directory where the program that’s currently being executed is stored. In this example, <em class="calibre3">file_reader.py</em> is currently running, so Python looks for <em class="calibre3">pi_digits.txt</em> in the directory where <em class="calibre3">file_reader.py</em> is stored. The <span class="literal">open()</span> function returns an object representing the file. Here, <span class="literal">open('pi_digits.txt')</span> returns an object representing <em class="calibre3">pi_digits.txt</em>. Python assigns this object to <span class="literal">file_object</span>, which we’ll work with later in the program.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-376" class="calibre"></span>The keyword <span class="literal">with</span> closes the file once access to it is no longer needed. Notice how we call <span class="literal">open()</span> in this program but not <span class="literal">close()</span>. You could open and close the file by calling <span class="literal">open()</span> and <span class="literal">close()</span>, but if a bug in your program prevents the <span class="literal">close()</span> method from being executed, the file may never close. This may seem trivial, but improperly closed files can cause data to be lost or corrupted. And if you call <span class="literal">close()</span> too early in your program, you’ll find yourself trying to work with a <em class="calibre3">closed</em> file (a file you can’t access), which leads to more errors. It’s not always easy to know exactly when you should close a file, but with the structure shown here, Python will figure that out for you. All you have to do is open the file and work with it as desired, trusting that Python will close it automatically when the <span class="literal">with</span> block finishes execution.</p>
<p class="indent">Once we have a file object representing <em class="calibre3">pi_digits.txt</em>, we use the <span class="literal">read()</span> method in the second line of our program to read the entire contents of the file and store it as one long string in <span class="literal">contents</span>. When we print the value of <span class="literal">contents</span>, we get the entire text file back:</p>
<p class="programs">3.1415926535<br class="calibre4" />
&nbsp;&nbsp;8979323846<br class="calibre4" />
&nbsp;&nbsp;2643383279</p>
<p class="indent">The only difference between this output and the original file is the extra blank line at the end of the output. The blank line appears because <span class="literal">read()</span> returns an empty string when it reaches the end of the file; this empty string shows up as a blank line. If you want to remove the extra blank line, you can use <span class="literal">rstrip()</span> in the call to <span class="literal">print()</span>:</p>
<p class="programs"><span class="ash">with open('pi_digits.txt') as file_object:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">contents = file_object.read()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(contents.rstrip())</p>
<p class="indent">Recall that Python’s <span class="literal">rstrip()</span> method removes, or strips, any whitespace characters from the right side of a string. Now the output matches the contents of the original file exactly:</p>
<p class="programs">3.1415926535<br class="calibre4" />
&nbsp;&nbsp;8979323846<br class="calibre4" />
&nbsp;&nbsp;2643383279</p>
<h4 class="h3" id="calibre_link-860"><strong class="calibre2"><em class="calibre3">File Paths</em></strong></h4>
<p class="noindent">When you pass a simple filename like <em class="calibre3">pi_digits.txt</em> to the <span class="literal">open()</span> function, Python looks in the directory where the file that’s currently being executed (that is, your <em class="calibre3">.py</em> program file) is stored.</p>
<p class="indent">Sometimes, depending on how you organize your work, the file you want to open won’t be in the same directory as your program file. For example, you might store your program files in a folder called <span type="pagebreak" id="calibre_link-377" class="calibre"></span><em class="calibre3">python_work</em>; inside <em class="calibre3">python_work</em>, you might have another folder called <em class="calibre3">text_files</em> to distinguish your program files from the text files they’re manipulating. Even though <em class="calibre3">text_files</em> is in <em class="calibre3">python_work</em>, just passing <span class="literal">open()</span> the name of a file in <em class="calibre3">text_files</em> won’t work, because Python will only look in <em class="calibre3">python_work</em> and stop there; it won’t go on and look in <em class="calibre3">text_files.</em> To get Python to open files from a directory other than the one where your program file is stored, you need to provide a <em class="calibre3">file path</em>, which tells Python to look in a specific location on your system.</p>
<p class="indent">Because <em class="calibre3">text_files</em> is inside <em class="calibre3">python_work</em>, you could use a relative file path to open a file from <em class="calibre3">text_files.</em> A <em class="calibre3">relative file path</em> tells Python to look for a given location relative to the directory where the currently running program file is stored. For example, you’d write:</p>
<p class="programs">with open('text_files/<span class="codeitalic1">filename</span>.txt') as file_object:</p>
<p class="indent">This line tells Python to look for the desired <em class="calibre3">.txt</em> file in the folder <em class="calibre3">text_files</em> and assumes that <em class="calibre3">text_files</em> is located inside <em class="calibre3">python_work</em> (which it is).</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Windows systems use a backslash (\) instead of a forward slash (/) when displaying file paths, but you can still use forward slashes in your code.</em></p>
</div>
<p class="indent">You can also tell Python exactly where the file is on your computer regardless of where the program that’s being executed is stored. This is called an <em class="calibre3">absolute file path</em>. You use an absolute path if a relative path doesn’t work. For instance, if you’ve put <em class="calibre3">text_files</em> in some folder other than <em class="calibre3">python_work</em>&mdash;say, a folder called <em class="calibre3">other_files</em>&mdash;then just passing <span class="literal">open()</span> the path <span class="literal">'text_files/</span><span class="codeitalic">filename</span><span class="literal">.txt'</span> won’t work because Python will only look for that location inside <em class="calibre3">python_work</em>. You’ll need to write out a full path to clarify where you want Python to look.</p>
<p class="indent">Absolute paths are usually longer than relative paths, so it’s helpful to assign them to a variable and then pass that variable to <span class="literal">open()</span>:</p>
<p class="programs">file_path = '/home/ehmatthes/other_files/text_files/<span class="codeitalic1">filename</span>.txt'<br class="calibre4" />
with open(file_path) as file_object:</p>
<p class="indent">Using absolute paths, you can read files from any location on your system. For now it’s easiest to store files in the same directory as your program files or in a folder such as <em class="calibre3">text_files</em> within the directory that stores your program files.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you try to use backslashes in a file path, you’ll get an error because the backslash is used to escape characters in strings. For example, in the path <span class="codeitalic">"C:\path\to\file.txt"</span>, the sequence <span class="codeitalic">\t</span> is interpreted as a tab. If you need to use backslashes, you can escape each one in the path, like this: <span class="codeitalic">"C:\\path\\to\\file.txt"</span>.</em></p>
</div>
<h4 class="h3" id="calibre_link-861"><span type="pagebreak" id="calibre_link-380" class="calibre"></span><strong class="calibre2"><em class="calibre3">Reading Line by Line</em></strong></h4>
<p class="noindent">When you’re reading a file, you’ll often want to examine each line of the file. You might be looking for certain information in the file, or you might want to modify the text in the file in some way. For example, you might want to read through a file of weather data and work with any line that includes the word <em class="calibre3">sunny</em> in the description of that day’s weather. In a news report, you might look for any line with the tag <span class="literal">&lt;headline&gt;</span> and rewrite that line with a specific kind of formatting.</p>
<p class="indent">You can use a <span class="literal">for</span> loop on the file object to examine each line from a file one at a time:</p>
<p class="margin"><em class="calibre3">file_reader.py</em></p>
<p class="programs"><span class="ent">➊</span> filename = 'pi_digits.txt'<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> with open(filename) as file_object:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for line in file_object:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(line)</p>
<p class="indent">At <span class="ent">➊</span> we assign the name of the file we’re reading from to the variable <span class="literal">filename</span>. This is a common convention when working with files. Because the variable <span class="literal">filename</span> doesn’t represent the actual file&mdash;it’s just a string telling Python where to find the file&mdash;you can easily swap out <span class="literal">'pi_digits.txt'</span> for the name of another file you want to work with. After we call <span class="literal">open()</span>, an object representing the file and its contents is assigned to the variable <span class="literal">file_object</span> <span class="ent">➋</span>. We again use the <span class="literal">with</span> syntax to let Python open and close the file properly. To examine the file’s contents, we work through each line in the file by looping over the file object <span class="ent">➌</span>.</p>
<p class="indent">When we print each line, we find even more blank lines:</p>
<p class="programs">3.1415926535<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;8979323846<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;2643383279</p>
<p class="indent">These blank lines appear because an invisible newline character is at the end of each line in the text file. The <span class="literal">print</span> function adds its own newline each time we call it, so we end up with two newline characters at the end of each line: one from the file and one from <span class="literal">print()</span>. Using <span class="literal">rstrip()</span> on each line in the <span class="literal">print()</span> call eliminates these extra blank lines:</p>
<p class="programs"><span class="ash">filename = 'pi_digits.txt'</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">with open(filename) as file_object:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for line in file_object:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(line.rstrip())</p>
<p class="indent"><span type="pagebreak" id="calibre_link-375" class="calibre"></span>Now the output matches the contents of the file once again:</p>
<p class="programs">3.1415926535<br class="calibre4" />
&nbsp;&nbsp;8979323846<br class="calibre4" />
&nbsp;&nbsp;2643383279</p>
<h4 class="h3" id="calibre_link-862"><strong class="calibre2"><em class="calibre3">Making a List of Lines from a File</em></strong></h4>
<p class="noindent">When you use <span class="literal">with</span>, the file object returned by <span class="literal">open()</span> is only available inside the <span class="literal">with</span> block that contains it. If you want to retain access to a file’s contents outside the <span class="literal">with</span> block, you can store the file’s lines in a list inside the block and then work with that list. You can process parts of the file immediately and postpone some processing for later in the program.</p>
<p class="indent">The following example stores the lines of <em class="calibre3">pi_digits.txt</em> in a list inside the <span class="literal">with</span> block and then prints the lines outside the <span class="literal">with</span> block:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'pi_digits.txt'</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as file_object:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lines = file_object.readlines()<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> for line in lines:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(line.rstrip())</p>
<p class="indent">At <span class="ent">➊</span> the <span class="literal">readlines()</span> method takes each line from the file and stores it in a list. This list is then assigned to <span class="literal">lines</span>, which we can continue to work with after the <span class="literal">with</span> block ends. At <span class="ent">➋</span> we use a simple <span class="literal">for</span> loop to print each line from <span class="literal">lines</span>. Because each item in <span class="literal">lines</span> corresponds to each line in the file, the output matches the contents of the file exactly.</p>
<h4 class="h3" id="calibre_link-863"><strong class="calibre2"><em class="calibre3">Working with a File’s Contents</em></strong></h4>
<p class="noindent">After you’ve read a file into memory, you can do whatever you want with that data, so let’s briefly explore the digits of <em class="calibre3">pi</em>. First, we’ll attempt to build a single string containing all the digits in the file with no whitespace in it:</p>
<p class="margin"><em class="calibre3">pi_string.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'pi_digits.txt'</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as file_object:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">lines = file_object.readlines()</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> pi_string = ''<br class="calibre4" />
<span class="ent">➋</span> for line in lines:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pi_string += line.rstrip()<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> print(pi_string)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(len(pi_string))</p>
<p class="indent"><span type="pagebreak" id="calibre_link-381" class="calibre"></span>We start by opening the file and storing each line of digits in a list, just as we did in the previous example. At <span class="ent">➊</span> we create a variable, <span class="literal">pi_string</span>, to hold the digits of <em class="calibre3">pi</em>. We then create a loop that adds each line of digits to <span class="literal">pi_string</span> and removes the newline character from each line <span class="ent">➋</span>. At <span class="ent">➌</span> we print this string and also show how long the string is:</p>
<p class="programs">3.1415926535&nbsp;&nbsp;8979323846&nbsp;&nbsp;2643383279<br class="calibre4" />
36</p>
<p class="indent">The variable <span class="literal">pi_string</span> contains the whitespace that was on the left side of the digits in each line, but we can get rid of that by using <span class="literal">strip()</span> instead of <span class="literal">rstrip()</span>:</p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">for line in lines:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;pi_string += line.strip()<br class="calibre4" />
<br class="calibre4" />
<span class="ash">print(pi_string)</span><br class="calibre4" />
<span class="ash">print(len(pi_string))</span></p>
<p class="indent">Now we have a string containing <em class="calibre3">pi</em> to 30 decimal places. The string is 32 characters long because it also includes the leading 3 and a decimal point:</p>
<p class="programs">3.141592653589793238462643383279<br class="calibre4" />
32</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">When Python reads from a text file, it interprets all text in the file as a string. If you read in a number and want to work with that value in a numerical context, you’ll have to convert it to an integer using the <span class="codeitalic">int()</span> function or convert it to a float using the <span class="codeitalic">float()</span> function.</em></p>
</div>
<h4 class="h3" id="calibre_link-864"><strong class="calibre2"><em class="calibre3">Large Files: One Million Digits</em></strong></h4>
<p class="noindent">So far we’ve focused on analyzing a text file that contains only three lines, but the code in these examples would work just as well on much larger files. If we start with a text file that contains <em class="calibre3">pi</em> to 1,000,000 decimal places instead of just 30, we can create a single string containing all these digits. We don’t need to change our program at all except to pass it a different file. We’ll also print just the first 50 decimal places, so we don’t have to watch a million digits scroll by in the terminal:</p>
<p class="margin"><em class="calibre3">pi_string.py</em></p>
<p class="programs">filename = 'pi_million_digits.txt'<br class="calibre4" />
<br class="calibre4" />
<span class="ash">with open(filename) as file_object:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">lines = file_object.readlines()</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-379" class="calibre"></span><span class="ash">pi_string = ''</span><br class="calibre4" />
<span class="ash">for line in lines:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pi_string += line.strip()</span><br class="calibre4" />
<br class="calibre4" />
print(f"{pi_string[:52]}...")<br class="calibre4" />
<span class="ash">print(len(pi_string))</span></p>
<p class="indent">The output shows that we do indeed have a string containing <em class="calibre3">pi</em> to 1,000,000 decimal places:</p>
<p class="programs">3.14159265358979323846264338327950288419716939937510...<br class="calibre4" />
1000002</p>
<p class="indent">Python has no inherent limit to how much data you can work with; you can work with as much data as your system’s memory can handle.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">To run this program (and many of the examples that follow), you’ll need to download the resources available at</em> <a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a>.</p>
</div>
<h4 class="h3" id="calibre_link-865"><strong class="calibre2"><em class="calibre3">Is Your Birthday Contained in Pi?</em></strong></h4>
<p class="noindent">I’ve always been curious to know if my birthday appears anywhere in the digits of <em class="calibre3">pi</em>. Let’s use the program we just wrote to find out if someone’s birthday appears anywhere in the first million digits of <em class="calibre3">pi</em>. We can do this by expressing each birthday as a string of digits and seeing if that string appears anywhere in <span class="literal">pi_string</span>:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for line in lines:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pi_string += line.strip()</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> birthday = input("Enter your birthday, in the form mmddyy: ")<br class="calibre4" />
<span class="ent">➋</span> if birthday in pi_string:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Your birthday appears in the first million digits of pi!")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Your birthday does not appear in the first million digits of pi.")</p>
<p class="indent">At <span class="ent">➊</span> we prompt for the user’s birthday, and then at <span class="ent">➋</span> we check if that string is in <span class="literal">pi_string</span>. Let’s try it:</p>
<p class="programs">Enter your birthdate, in the form mmddyy: <span class="codestrong">120372</span><br class="calibre4" />
Your birthday appears in the first million digits of pi!</p>
<p class="indent">My birthday does appear in the digits of <em class="calibre3">pi</em>! Once you’ve read from a file, you can analyze its contents in just about any way you can imagine.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-383" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-866"><strong class="calibre2">10-1. Learning Python:</strong> Open a blank file in your text editor and write a few lines summarizing what you’ve learned about Python so far. Start each line with the phrase <em class="calibre3">In Python you can. . .</em>. Save the file as <em class="calibre3">learning_python.txt</em> in the same directory as your exercises from this chapter. Write a program that reads the file and prints what you wrote three times. Print the contents once by reading in the entire file, once by looping over the file object, and once by storing the lines in a list and then working with them outside the <span class="literal1">with</span> block.</p>
<p class="sparal" id="calibre_link-867"><strong class="calibre2">10-2. Learning C:</strong> You can use the <span class="literal1">replace()</span> method to replace any word in a string with a different word. Here’s a quick example showing how to replace <span class="literal1">'dog'</span> with <span class="literal1">'cat'</span> in a sentence:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">message = "I really like dogs."</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">message.replace('dog', 'cat')</span><br class="calibre4" />
'I really like cats.'</p>
<p class="sparai">Read in each line from the file you just created, <em class="calibre3">learning_python.txt</em>, and replace the word <em class="calibre3">Python</em> with the name of another language, such as <em class="calibre3">C</em>. Print each modified line to the screen.</p>
</div>
<h3 class="h2" id="calibre_link-868"><strong class="calibre2">Writing to a File</strong></h3>
<p class="noindent">One of the simplest ways to save data is to write it to a file. When you write text to a file, the output will still be available after you close the terminal containing your program’s output. You can examine output after a program finishes running, and you can share the output files with others as well. You can also write programs that read the text back into memory and work with it again later.</p>
<h4 class="h3" id="calibre_link-869"><strong class="calibre2"><em class="calibre3">Writing to an Empty File</em></strong></h4>
<p class="noindent">To write text to a file, you need to call <span class="literal">open()</span> with a second argument telling Python that you want to write to the file. To see how this works, let’s write a simple message and store it in a file instead of printing it to the screen:</p>
<p class="margin"><em class="calibre3">write_message.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;filename = 'programming.txt'<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> with open(filename, 'w') as file_object:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_object.write("I love programming.")</p>
<p class="indent">The call to <span class="literal">open()</span> in this example has two arguments <span class="ent">➊</span>. The first argument is still the name of the file we want to open. The second argument, <span class="literal">'w'</span>, tells Python that we want to open the file in <em class="calibre3">write mode</em>. You can open a file <span type="pagebreak" id="calibre_link-378" class="calibre"></span>in <em class="calibre3">read mode</em> (<span class="literal">'r'</span>), <em class="calibre3">write mode</em> (<span class="literal">'w'</span>), <em class="calibre3">append mode</em> (<span class="literal">'a'</span>), or a mode that allows you to read and write to the file (<span class="literal">'r+'</span>). If you omit the mode argument, Python opens the file in read-only mode by default.</p>
<p class="indent">The <span class="literal">open()</span> function automatically creates the file you’re writing to if it doesn’t already exist. However, be careful opening a file in write mode (<span class="literal">'w'</span>) because if the file does exist, Python will erase the contents of the file before returning the file object.</p>
<p class="indent">At <span class="ent">➋</span> we use the <span class="literal">write()</span> method on the file object to write a string to the file. This program has no terminal output, but if you open the file <em class="calibre3">programming.txt</em>, you’ll see one line:</p>
<p class="margin"><em class="calibre3">programming.txt</em></p>
<p class="programs">I love programming.</p>
<p class="indent">This file behaves like any other file on your computer. You can open it, write new text in it, copy from it, paste to it, and so forth.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Python can only write strings to a text file. If you want to store numerical data in a text file, you’ll have to convert the data to string format first using the <span class="codeitalic">str()</span> function.</em></p>
</div>
<h4 class="h3" id="calibre_link-870"><strong class="calibre2"><em class="calibre3">Writing Multiple Lines</em></strong></h4>
<p class="noindent">The <span class="literal">write()</span> function doesn’t add any newlines to the text you write. So if you write more than one line without including newline characters, your file may not look the way you want it to:</p>
<p class="programs"><span class="ash">filename = 'programming.txt'</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">with open(filename, 'w') as file_object:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">file_object.write("I love programming.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;file_object.write("I love creating new games.")</p>
<p class="indent">If you open <em class="calibre3">programming.txt</em>, you’ll see the two lines squished together:</p>
<p class="programs">I love programming.I love creating new games.</p>
<p class="indent">Including newlines in your calls to <span class="literal">write()</span> makes each string appear on its own line:</p>
<p class="programs"><span class="ash">filename = 'programming.txt'</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">with open(filename, 'w') as file_object:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;file_object.write("I love programming.\n")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;file_object.write("I love creating new games.\n")</p>
<p class="indent">The output now appears on separate lines:</p>
<p class="programs">I love programming.<br class="calibre4" />
I love creating new games.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-382" class="calibre"></span>You can also use spaces, tab characters, and blank lines to format your output, just as you’ve been doing with terminal-based output.</p>
<h4 class="h3" id="calibre_link-871"><strong class="calibre2"><em class="calibre3">Appending to a File</em></strong></h4>
<p class="noindent">If you want to add content to a file instead of writing over existing content, you can open the file in <em class="calibre3">append mode</em>. When you open a file in append mode, Python doesn’t erase the contents of the file before returning the file object. Any lines you write to the file will be added at the end of the file. If the file doesn’t exist yet, Python will create an empty file for you.</p>
<p class="indent">Let’s modify <em class="calibre3">write_message.py</em> by adding some new reasons we love programming to the existing file <em class="calibre3">programming.txt</em>:</p>
<p class="margin"><em class="calibre3">write_message.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'programming.txt'</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> with open(filename, 'a') as file_object:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_object.write("I also love finding meaning in large datasets.\n")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_object.write("I love creating apps that can run in a browser.\n")</p>
<p class="indent">At <span class="ent">➊</span> we use the <span class="literal">'a'</span> argument to open the file for appending rather than writing over the existing file. At <span class="ent">➋</span> we write two new lines, which are added to <em class="calibre3">programming.txt</em>:</p>
<p class="margin"><em class="calibre3">programming.txt</em></p>
<p class="programs"><span class="ash">I love programming.</span><br class="calibre4" />
<span class="ash">I love creating new games.</span><br class="calibre4" />
I also love finding meaning in large datasets.<br class="calibre4" />
I love creating apps that can run in a browser.</p>
<p class="indent">We end up with the original contents of the file, followed by the new content we just added.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-872"><strong class="calibre2">10-3. Guest:</strong> Write a program that prompts the user for their name. When they respond, write their name to a file called <em class="calibre3">guest.txt</em>.</p>
<p class="sparal" id="calibre_link-873"><strong class="calibre2">10-4. Guest Book:</strong> Write a <span class="literal1">while</span> loop that prompts users for their name. When they enter their name, print a greeting to the screen and add a line recording their visit in a file called <em class="calibre3">guest_book.txt</em>. Make sure each entry appears on a new line in the file.</p>
<p class="sparal" id="calibre_link-874"><strong class="calibre2">10-5. Programming Poll:</strong> Write a <span class="literal1">while</span> loop that asks people why they like programming. Each time someone enters a reason, add their reason to a file that stores all the responses.</p>
</div>
<h3 class="h2" id="calibre_link-875"><span type="pagebreak" id="calibre_link-311" class="calibre"></span><strong class="calibre2">Exceptions</strong></h3>
<p class="noindent">Python uses special objects called <em class="calibre3">exceptions</em> to manage errors that arise during a program’s execution. Whenever an error occurs that makes Python unsure what to do next, it creates an exception object. If you write code that handles the exception, the program will continue running. If you don’t handle the exception, the program will halt and show a <em class="calibre3">traceback</em>, which includes a report of the exception that was raised.</p>
<p class="indent">Exceptions are handled with <span class="literal">try</span>-<span class="literal">except</span> blocks. A <span class="literal">try</span>-<span class="literal">except</span> block asks Python to do something, but it also tells Python what to do if an exception is raised. When you use <span class="literal">try</span>-<span class="literal">except</span> blocks, your programs will continue running even if things start to go wrong. Instead of tracebacks, which can be confusing for users to read, users will see friendly error messages that you write.</p>
<h4 class="h3" id="calibre_link-876"><strong class="calibre2"><em class="calibre3">Handling the ZeroDivisionError Exception</em></strong></h4>
<p class="noindent">Let’s look at a simple error that causes Python to raise an exception. You probably know that it’s impossible to divide a number by zero, but let’s ask Python to do it anyway:</p>
<p class="margin"><em class="calibre3">division_calculator.py</em></p>
<p class="programs">print(5/0)</p>
<p class="indent">Of course Python can’t do this, so we get a traceback:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File "division_calculator.py", line 1, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(5/0)<br class="calibre4" />
<span class="ent">➊</span> ZeroDivisionError: division by zero</p>
<p class="indent">The error reported at <span class="ent">➊</span> in the traceback, <span class="literal">ZeroDivisionError</span>, is an exception object. Python creates this kind of object in response to a situation where it can’t do what we ask it to. When this happens, Python stops the program and tells us the kind of exception that was raised. We can use this information to modify our program. We’ll tell Python what to do when this kind of exception occurs; that way, if it happens again, we’re prepared.</p>
<h4 class="h3" id="calibre_link-877"><strong class="calibre2"><em class="calibre3">Using try-except Blocks</em></strong></h4>
<p class="noindent">When you think an error may occur, you can write a <span class="literal">try</span>-<span class="literal">except</span> block to handle the exception that might be raised. You tell Python to try running some code, and you tell it what to do if the code results in a particular kind of exception.</p>
<p class="indent">Here’s what a <span class="literal">try</span>-<span class="literal">except</span> block for handling the <span class="literal">ZeroDivisionError</span> exception looks like:</p>
<p class="programs">try:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(5/0)</span><br class="calibre4" />
except ZeroDivisionError:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print("You can't divide by zero!")</p>
<p class="indent"><span type="pagebreak" id="calibre_link-373" class="calibre"></span>We put <span class="literal">print(5/0)</span>, the line that caused the error, inside a <span class="literal">try</span> block. If the code in a <span class="literal">try</span> block works, Python skips over the <span class="literal">except</span> block. If the code in the <span class="literal">try</span> block causes an error, Python looks for an <span class="literal">except</span> block whose error matches the one that was raised and runs the code in that block.</p>
<p class="indent">In this example, the code in the <span class="literal">try</span> block produces a <span class="literal">ZeroDivisionError</span>, so Python looks for an <span class="literal">except</span> block telling it how to respond. Python then runs the code in that block, and the user sees a friendly error message instead of a traceback:</p>
<p class="programs">You can't divide by zero!</p>
<p class="indent">If more code followed the <span class="literal">try</span>-<span class="literal">except</span> block, the program would continue running because we told Python how to handle the error. Let’s look at an example where catching an error can allow a program to continue running.</p>
<h4 class="h3" id="calibre_link-878"><strong class="calibre2"><em class="calibre3">Using Exceptions to Prevent Crashes</em></strong></h4>
<p class="noindent">Handling errors correctly is especially important when the program has more work to do after the error occurs. This happens often in programs that prompt users for input. If the program responds to invalid input appropriately, it can prompt for more valid input instead of crashing.</p>
<p class="indent">Let’s create a simple calculator that does only division:</p>
<p class="margin"><em class="calibre3">division_calculator.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;print("Give me two numbers, and I'll divide them.")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("Enter 'q' to quit.")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;while True:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_number = input("\nFirst number: ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if first_number == 'q':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second_number = input("Second number: ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if second_number == 'q':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer = int(first_number) / int(second_number)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(answer)</p>
<p class="indent">This program prompts the user to input a <span class="literal">first_number</span> <span class="ent">➊</span> and, if the user does not enter <em class="calibre3">q</em> to quit, a <span class="literal">second_number</span> <span class="ent">➋</span>. We then divide these two numbers to get an <span class="literal">answer</span> <span class="ent">➌</span>. This program does nothing to handle errors, so asking it to divide by zero causes it to crash:</p>
<p class="programs">Give me two numbers, and I'll divide them.<br class="calibre4" />
Enter 'q' to quit.<br class="calibre4" />
<br class="calibre4" />
First number: <span class="codestrong">5</span><br class="calibre4" />
Second number: <span class="codestrong">0</span><br class="calibre4" />
Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;File "division_calculator.py", line 9, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;answer = int(first_number) / int(second_number)<br class="calibre4" />
ZeroDivisionError: division by zero</p>
<p class="indent"><span type="pagebreak" id="calibre_link-371" class="calibre"></span>It’s bad that the program crashed, but it’s also not a good idea to let users see tracebacks. Nontechnical users will be confused by them, and in a malicious setting, attackers will learn more than you want them to know from a traceback. For example, they’ll know the name of your program file, and they’ll see a part of your code that isn’t working properly. A skilled attacker can sometimes use this information to determine which kind of attacks to use against your code.</p>
<h4 class="h3" id="calibre_link-879"><strong class="calibre2"><em class="calibre3">The else Block</em></strong></h4>
<p class="noindent">We can make this program more error resistant by wrapping the line that might produce errors in a <span class="literal">try</span>-<span class="literal">except</span> block. The error occurs on the line that performs the division, so that’s where we’ll put the <span class="literal">try</span>-<span class="literal">except</span> block. This example also includes an <span class="literal">else</span> block. Any code that depends on the <span class="literal">try</span> block executing successfully goes in the <span class="literal">else</span> block:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if second_number == 'q':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">break</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">answer = int(first_number) / int(second_number)</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except ZeroDivisionError:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("You can't divide by 0!")<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(answer)</span></p>
<p class="indent">We ask Python to try to complete the division operation in a <span class="literal">try</span> block <span class="ent">➊</span>, which includes only the code that might cause an error. Any code that depends on the <span class="literal">try</span> block succeeding is added to the <span class="literal">else</span> block. In this case if the division operation is successful, we use the <span class="literal">else</span> block to print the result <span class="ent">➌</span>.</p>
<p class="indent">The <span class="literal">except</span> block tells Python how to respond when a <span class="literal">ZeroDivisionError</span> arises <span class="ent">➋</span>. If the <span class="literal">try</span> block doesn’t succeed because of a division by zero error, we print a friendly message telling the user how to avoid this kind of error. The program continues to run, and the user never sees a traceback:</p>
<p class="programs">Give me two numbers, and I'll divide them.<br class="calibre4" />
Enter 'q' to quit.<br class="calibre4" />
<br class="calibre4" />
First number: <span class="codestrong">5</span><br class="calibre4" />
Second number: <span class="codestrong">0</span><br class="calibre4" />
You can't divide by 0!<br class="calibre4" />
<span type="pagebreak" id="calibre_link-185" class="calibre"></span>First number: <span class="codestrong">5</span><br class="calibre4" />
Second number: <span class="codestrong">2</span><br class="calibre4" />
2.5<br class="calibre4" />
<br class="calibre4" />
First number: <span class="codestrong">q</span></p>
<p class="indent">The <span class="literal">try</span>-<span class="literal">except</span>-<span class="literal">else</span> block works like this: Python attempts to run the code in the <span class="literal">try</span> block. The only code that should go in a <span class="literal">try</span> block is code that might cause an exception to be raised. Sometimes you’ll have additional code that should run only if the <span class="literal">try</span> block was successful; this code goes in the <span class="literal">else</span> block. The <span class="literal">except</span> block tells Python what to do in case a certain exception arises when it tries to run the code in the <span class="literal">try</span> block.</p>
<p class="indent">By anticipating likely sources of errors, you can write robust programs that continue to run even when they encounter invalid data and missing resources. Your code will be resistant to innocent user mistakes and malicious attacks.</p>
<h4 class="h3" id="calibre_link-880"><strong class="calibre2"><em class="calibre3">Handling the FileNotFoundError Exception</em></strong></h4>
<p class="noindent">One common issue when working with files is handling missing files. The file you’re looking for might be in a different location, the filename may be misspelled, or the file may not exist at all. You can handle all of these situations in a straightforward way with a <span class="literal">try</span>-<span class="literal">except</span> block.</p>
<p class="indent">Let’s try to read a file that doesn’t exist. The following program tries to read in the contents of <em class="calibre3">Alice in Wonderland</em>, but I haven’t saved the file <em class="calibre3">alice.txt</em> in the same directory as <em class="calibre3">alice.py</em>:</p>
<p class="margin"><em class="calibre3">alice.py</em></p>
<p class="programs">filename = 'alice.txt'<br class="calibre4" />
<br class="calibre4" />
with open(filename, encoding='utf-8') as f:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;contents = f.read()</p>
<p class="indent">There are two changes here. One is the use of the variable <span class="literal">f</span> to represent the file object, which is a common convention. The second is the use of the <span class="literal">encoding</span> argument. This argument is needed when your system’s default encoding doesn’t match the encoding of the file that’s being read.</p>
<p class="indent">Python can’t read from a missing file, so it raises an exception:</p>
<p class="programs">Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;File "alice.py", line 3, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;with open(filename, encoding='utf-8') as f:<br class="calibre4" />
FileNotFoundError: [Errno 2] No such file or directory: 'alice.txt'</p>
<p class="indent">The last line of the traceback reports a <span class="literal">FileNotFoundError</span>: this is the exception Python creates when it can’t find the file it’s trying to open. <span type="pagebreak" id="calibre_link-522" class="calibre"></span>In this example, the <span class="literal">open()</span> function produces the error, so to handle it, the <span class="literal">try</span> block will begin with the line that contains <span class="literal">open()</span>:</p>
<p class="programs"><span class="ash">filename = 'alice.txt'</span><br class="calibre4" />
<br class="calibre4" />
try:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename, encoding='utf-8') as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">contents = f.read()</span><br class="calibre4" />
except FileNotFoundError:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"Sorry, the file {filename} does not exist.")</p>
<p class="indent">In this example, the code in the <span class="literal">try</span> block produces a <span class="literal">FileNotFoundError</span>, so Python looks for an <span class="literal">except</span> block that matches that error. Python then runs the code in that block, and the result is a friendly error message instead of a traceback:</p>
<p class="programs">Sorry, the file alice.txt does not exist.</p>
<p class="indent">The program has nothing more to do if the file doesn’t exist, so the error-handling code doesn’t add much to this program. Let’s build on this example and see how exception handling can help when you’re working with more than one file.</p>
<h4 class="h3" id="calibre_link-881"><strong class="calibre2"><em class="calibre3">Analyzing Text</em></strong></h4>
<p class="noindent">You can analyze text files containing entire books. Many classic works of literature are available as simple text files because they are in the public domain. The texts used in this section come from Project Gutenberg (<em class="calibre3"><a href="http://gutenberg.org/" class="calibre6">http://gutenberg.org/</a></em>). Project Gutenberg maintains a collection of literary works that are available in the public domain, and it’s a great resource if you’re interested in working with literary texts in your programming projects.</p>
<p class="indent">Let’s pull in the text of <em class="calibre3">Alice in Wonderland</em> and try to count the number of words in the text. We’ll use the string method <span class="literal">split()</span>, which can build a list of words from a string. Here’s what <span class="literal">split()</span> does with a string containing just the title <span class="literal">"Alice in Wonderland"</span>:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">title = "Alice in Wonderland"</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">title.split()</span><br class="calibre4" />
['Alice', 'in', 'Wonderland']</p>
<p class="indent">The <span class="literal">split()</span> method separates a string into parts wherever it finds a space and stores all the parts of the string in a list. The result is a list of words from the string, although some punctuation may also appear with some of the words. To count the number of words in <em class="calibre3">Alice in Wonderland</em>, we’ll use <span class="literal">split()</span> on the entire text. Then we’ll count the items in the list to get a rough idea of the number of words in the text:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'alice.txt'</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">try:</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-186" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename, encoding='utf-8') as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">contents = f.read()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">except FileNotFoundError:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Sorry, the file {filename} does not exist.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Count the approximate number of words in the file.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;words = contents.split()<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_words = len(words)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"The file {filename} has about {num_words} words.")</p>
<p class="indent">I moved the file <em class="calibre3">alice.txt</em> to the correct directory, so the <span class="literal">try</span> block will work this time. At <span class="ent">➊</span> we take the string <span class="literal">contents</span>, which now contains the entire text of <em class="calibre3">Alice in Wonderland</em> as one long string, and use the <span class="literal">split()</span> method to produce a list of all the words in the book. When we use <span class="literal">len()</span> on this list to examine its length, we get a good approximation of the number of words in the original string <span class="ent">➋</span>. At <span class="ent">➌</span> we print a statement that reports how many words were found in the file. This code is placed in the <span class="literal">else</span> block because it will work only if the code in the <span class="literal">try</span> block was executed successfully. The output tells us how many words are in <em class="calibre3">alice.txt</em>:</p>
<p class="programs">The file alice.txt has about 29465 words.</p>
<p class="indent">The count is a little high because extra information is provided by the publisher in the text file used here, but it’s a good approximation of the length of <em class="calibre3">Alice in Wonderland</em>.</p>
<h4 class="h3" id="calibre_link-882"><strong class="calibre2"><em class="calibre3">Working with Multiple Files</em></strong></h4>
<p class="noindent">Let’s add more books to analyze. But before we do, let’s move the bulk of this program to a function called <span class="literal">count_words()</span>. By doing so, it will be easier to run the analysis for multiple books:</p>
<p class="margin"><em class="calibre3">word_count.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;def count_words(filename):<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Count the approximate number of words in a file."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">try:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename, encoding='utf-8') as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">contents = f.read()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">except FileNotFoundError:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Sorry, the file {filename} does not exist.")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">words = contents.split()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">num_words = len(words)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"The file {filename} has about {num_words} words.")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;filename = 'alice.txt'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;count_words(filename)</p>
<p class="indent">Most of this code is unchanged. We simply indented it and moved it into the body of <span class="literal">count_words()</span>. It’s a good habit to keep comments up to date when you’re modifying a program, so we changed the comment to a docstring and reworded it slightly <span class="ent">➊</span>.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-372" class="calibre"></span>Now we can write a simple loop to count the words in any text we want to analyze. We do this by storing the names of the files we want to analyze in a list, and then we call <span class="literal">count_words()</span> for each file in the list. We’ll try to count the words for <em class="calibre3">Alice in Wonderland</em>, <em class="calibre3">Siddhartha</em>, <em class="calibre3">Moby Dick</em>, and <em class="calibre3">Little Women</em>, which are all available in the public domain. I’ve intentionally left <em class="calibre3">siddhartha.txt</em> out of the directory containing <em class="calibre3">word_count.py</em>, so we can see how well our program handles a missing file:</p>
<p class="programs"><span class="ash">def count_words(filename):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
filenames = ['alice.txt', 'siddhartha.txt', 'moby_dick.txt', 'little_women.txt']<br class="calibre4" />
for filename in filenames:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;count_words(filename)</p>
<p class="indent">The missing <em class="calibre3">siddhartha.txt</em> file has no effect on the rest of the program’s execution:</p>
<p class="programs">The file alice.txt has about 29465 words.<br class="calibre4" />
Sorry, the file siddhartha.txt does not exist.<br class="calibre4" />
The file moby_dick.txt has about 215830 words.<br class="calibre4" />
The file little_women.txt has about 189079 words.</p>
<p class="indent">Using the <span class="literal">try</span>-<span class="literal">except</span> block in this example provides two significant advantages. We prevent our users from seeing a traceback, and we let the program continue analyzing the texts it’s able to find. If we don’t catch the <span class="literal">FileNotFoundError</span> that <em class="calibre3">siddhartha.txt</em> raised, the user would see a full traceback, and the program would stop running after trying to analyze <em class="calibre3">Siddhartha</em>. It would never analyze <em class="calibre3">Moby Dick</em> or <em class="calibre3">Little Women</em>.</p>
<h4 class="h3" id="calibre_link-883"><strong class="calibre2"><em class="calibre3">Failing Silently</em></strong></h4>
<p class="noindent">In the previous example, we informed our users that one of the files was unavailable. But you don’t need to report every exception you catch. Sometimes you’ll want the program to fail silently when an exception occurs and continue on as if nothing happened. To make a program fail silently, you write a <span class="literal">try</span> block as usual, but you explicitly tell Python to do nothing in the <span class="literal">except</span> block. Python has a <span class="literal">pass</span> statement that tells it to do nothing in a block:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">def count_words(filename):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Count the approximate number of words in a file."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">try:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">except FileNotFoundError:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">filenames = ['alice.txt', 'siddhartha.txt', 'moby_dick.txt', 'little_women.txt']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for filename in filenames:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">count_words(filename)</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-370" class="calibre"></span>The only difference between this listing and the previous one is the <span class="literal">pass</span> statement at <span class="ent">➊</span>. Now when a <span class="literal">FileNotFoundError</span> is raised, the code in the <span class="literal">except</span> block runs, but nothing happens. No traceback is produced, and there’s no output in response to the error that was raised. Users see the word counts for each file that exists, but they don’t see any indication that a file wasn’t found:</p>
<p class="programs">The file alice.txt has about 29465 words.<br class="calibre4" />
The file moby_dick.txt has about 215830 words.<br class="calibre4" />
The file little_women.txt has about 189079 words.</p>
<p class="indent">The <span class="literal">pass</span> statement also acts as a placeholder. It’s a reminder that you’re choosing to do nothing at a specific point in your program’s execution and that you might want to do something there later. For example, in this program we might decide to write any missing filenames to a file called <em class="calibre3">missing_files.txt</em>. Our users wouldn’t see this file, but we’d be able to read the file and deal with any missing texts.</p>
<h4 class="h3" id="calibre_link-884"><strong class="calibre2"><em class="calibre3">Deciding Which Errors to Report</em></strong></h4>
<p class="noindent">How do you know when to report an error to your users and when to fail silently? If users know which texts are supposed to be analyzed, they might appreciate a message informing them why some texts were not analyzed. If users expect to see some results but don’t know which books are supposed to be analyzed, they might not need to know that some texts were unavailable. Giving users information they aren’t looking for can decrease the usability of your program. Python’s error-handling structures give you fine-grained control over how much to share with users when things go wrong; it’s up to you to decide how much information to share.</p>
<p class="indent">Well-written, properly tested code is not very prone to internal errors, such as syntax or logical errors. But every time your program depends on something external, such as user input, the existence of a file, or the availability of a network connection, there is a possibility of an exception being raised. A little experience will help you know where to include exception handling blocks in your program and how much to report to users about errors that arise.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-564"><strong class="calibre2">10-6. Addition:</strong> One common problem when prompting for numerical input occurs when people provide text instead of numbers. When you try to convert the input to an <span class="literal1">int</span>, you’ll get a <span class="literal1">ValueError</span>. Write a program that prompts for two numbers. Add them together and print the result. Catch the <span class="literal1">ValueError</span> if either input value is not a number, and print a friendly error message. Test your program by entering two numbers and then by entering some text instead of a number.</p>
<p class="sparal" id="calibre_link-885"><span type="pagebreak" id="calibre_link-369" class="calibre"></span><strong class="calibre2">10-7. Addition Calculator:</strong> Wrap your code from <a href="#calibre_link-564" class="calibre6">Exercise 10-6</a> in a <span class="literal1">while</span> loop so the user can continue entering numbers even if they make a mistake and enter text instead of a number.</p>
<p class="sparal" id="calibre_link-565"><strong class="calibre2">10-8. Cats and Dogs:</strong> Make two files, <em class="calibre3">cats.txt</em> and <em class="calibre3">dogs.txt</em>. Store at least three names of cats in the first file and three names of dogs in the second file. Write a program that tries to read these files and print the contents of the file to the screen. Wrap your code in a <span class="literal1">try-except</span> block to catch the <span class="literal1">FileNotFound</span> error, and print a friendly message if a file is missing. Move one of the files to a different location on your system, and make sure the code in the <span class="literal1">except</span> block executes properly.</p>
<p class="sparal" id="calibre_link-886"><strong class="calibre2">10-9. Silent Cats and Dogs:</strong> Modify your <span class="literal1">except</span> block in <a href="#calibre_link-565" class="calibre6">Exercise 10-8</a> to fail silently if either file is missing.</p>
<p class="sparal" id="calibre_link-887"><strong class="calibre2">10-10. Common Words:</strong> Visit Project Gutenberg (<em class="calibre3"><a href="https://gutenberg.org/" class="calibre6">https://gutenberg.org/</a></em>) and find a few texts you’d like to analyze. Download the text files for these works, or copy the raw text from your browser into a text file on your computer.</p>
<p class="sparai">You can use the <span class="literal1">count()</span> method to find out how many times a word or phrase appears in a string. For example, the following code counts the number of times <span class="literal1">'row'</span> appears in a string:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">line = "Row, row, row your boat"</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">line.count('row')</span><br class="calibre4" />
2<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">line.lower().count('row')</span><br class="calibre4" />
3</p>
<p class="sparai">Notice that converting the string to lowercase using <span class="literal1">lower()</span> catches all appearances of the word you’re looking for, regardless of how it’s formatted.</p>
<p class="sparai">Write a program that reads the files you found at Project Gutenberg and determines how many times the word <span class="literal1">'the'</span> appears in each text. This will be an approximation because it will also count words such as <span class="literal1">'then'</span> and <span class="literal1">'there'</span>. Try counting <span class="literal1">'the '</span>, with a space in the string, and see how much lower your count is.</p>
</div>
<h3 class="h2" id="calibre_link-888"><strong class="calibre2">Storing Data</strong></h3>
<p class="noindent">Many of your programs will ask users to input certain kinds of information. You might allow users to store preferences in a game or provide data for a visualization. Whatever the focus of your program is, you’ll store the information users provide in data structures such as lists and dictionaries. When users close a program, you’ll almost always want to save the information they entered. A simple way to do this involves storing your data using the <span class="literal">json</span> module.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-512" class="calibre"></span>The <span class="literal">json</span> module allows you to dump simple Python data structures into a file and load the data from that file the next time the program runs. You can also use <span class="literal">json</span> to share data between different Python programs. Even better, the JSON data format is not specific to Python, so you can share data you store in the JSON format with people who work in many other programming languages. It’s a useful and portable format, and it’s easy to learn.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The JSON (JavaScript Object Notation) format was originally developed for JavaScript. However, it has since become a common format used by many languages, including Python.</em></p>
</div>
<h4 class="h3" id="calibre_link-889"><strong class="calibre2"><em class="calibre3">Using json.dump() and json.load()</em></strong></h4>
<p class="noindent">Let’s write a short program that stores a set of numbers and another program that reads these numbers back into memory. The first program will use <span class="literal">json.dump()</span> to store the set of numbers, and the second program will use <span class="literal">json.load()</span>.</p>
<p class="indent">The <span class="literal">json.dump()</span> function takes two arguments: a piece of data to store and a file object it can use to store the data. Here’s how you can use <span class="literal">json.dump()</span> to store a list of numbers:</p>
<p class="margin"><em class="calibre3">number_writer.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import json<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;numbers = [2, 3, 5, 7, 11, 13]<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> filename = 'numbers.json'<br class="calibre4" />
<span class="ent">➋</span> with open(filename, 'w') as f:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(numbers, f)</p>
<p class="indent">We first import the <span class="literal">json</span> module and then create a list of numbers to work with. At <span class="ent">➊</span> we choose a filename in which to store the list of numbers. It’s customary to use the file extension <em class="calibre3">.json</em> to indicate that the data in the file is stored in the JSON format. Then we open the file in write mode, which allows <span class="literal">json</span> to write the data to the file <span class="ent">➋</span>. At <span class="ent">➌</span> we use the <span class="literal">json.dump()</span> function to store the list <span class="literal">numbers</span> in the file <em class="calibre3">numbers.json</em>.</p>
<p class="indent">This program has no output, but let’s open the file <em class="calibre3">numbers.json</em> and look at it. The data is stored in a format that looks just like Python:</p>
<p class="programs">[2, 3, 5, 7, 11, 13]</p>
<p class="indent">Now we’ll write a program that uses <span class="literal">json.load()</span> to read the list back into memory:</p>
<p class="margin"><em class="calibre3">number_reader.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import json<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> filename = 'numbers.json'<br class="calibre4" />
<span class="ent">➋</span> with open(filename) as f:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numbers = json.load(f)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(numbers)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-455" class="calibre"></span>At <span class="ent">➊</span> we make sure to read from the same file we wrote to. This time when we open the file, we open it in read mode because Python only needs to read from the file <span class="ent">➋</span>. At <span class="ent">➌</span> we use the <span class="literal">json.load()</span> function to load the information stored in <em class="calibre3">numbers.json</em>, and we assign it to the variable <span class="literal">numbers</span>. Finally we print the recovered list of numbers and see that it’s the same list created in <em class="calibre3">number_writer.py</em>:</p>
<p class="programs">[2, 3, 5, 7, 11, 13]</p>
<p class="indent">This is a simple way to share data between two programs.</p>
<h4 class="h3" id="calibre_link-890"><strong class="calibre2"><em class="calibre3">Saving and Reading User-Generated Data</em></strong></h4>
<p class="noindent">Saving data with <span class="literal">json</span> is useful when you’re working with user-generated data, because if you don’t store your user’s information somehow, you’ll lose it when the program stops running. Let’s look at an example where we prompt the user for their name the first time they run a program and then remember their name when they run the program again.</p>
<p class="indent">Let’s start by storing the user’s name:</p>
<p class="margin"><em class="calibre3">remember_me.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import json<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> username = input("What is your name? ")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;filename = 'username.json'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;with open(filename, 'w') as f:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(username, f)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"We'll remember you when you come back, {username}!")</p>
<p class="indent">At <span class="ent">➊</span> we prompt for a username to store. Next, we use <span class="literal">json.dump()</span>, passing it a username and a file object, to store the username in a file <span class="ent">➋</span>. Then we print a message informing the user that we’ve stored their information <span class="ent">➌</span>:</p>
<p class="programs">What is your name? <span class="codestrong">Eric</span><br class="calibre4" />
We'll remember you when you come back, Eric!</p>
<p class="indent">Now let’s write a new program that greets a user whose name has already been stored:</p>
<p class="margin"><em class="calibre3">greet_user.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import json<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;filename = 'username.json'<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;with open(filename) as f:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username = json.load(f)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Welcome back, {username}!")</p>
<p class="indent"><span type="pagebreak" id="calibre_link-548" class="calibre"></span>At <span class="ent">➊</span> we use <span class="literal">json.load()</span> to read the information stored in <em class="calibre3">username.json</em> and assign it to the variable <span class="literal">username</span>. Now that we’ve recovered the username, we can welcome them back <span class="ent">➋</span>:</p>
<p class="programs">Welcome back, Eric!</p>
<p class="indent">We need to combine these two programs into one file. When someone runs <em class="calibre3">remember_me.py</em>, we want to retrieve their username from memory if possible; therefore, we’ll start with a <span class="literal">try</span> block that attempts to recover the username. If the file <em class="calibre3">username.json</em> doesn’t exist, we’ll have the <span class="literal">except</span> block prompt for a username and store it in <em class="calibre3">username.json</em> for next time:</p>
<p class="margin"><em class="calibre3">remember_me.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import json<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Load the username, if it has been stored previously.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;Otherwise, prompt for the username and store it.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;filename = 'username.json'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;try:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with open(filename) as f:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username = json.load(f)<br class="calibre4" />
<span class="ent">➌</span> except FileNotFoundError:<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username = input("What is your name? ")<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with open(filename, 'w') as f:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(username, f)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"We'll remember you when you come back, {username}!")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Welcome back, {username}!")</p>
<p class="indent">There’s no new code here; blocks of code from the last two examples are just combined into one file. At <span class="ent">➊</span> we try to open the file <em class="calibre3">username.json</em>. If this file exists, we read the username back into memory <span class="ent">➋</span> and print a message welcoming back the user in the <span class="literal">else</span> block. If this is the first time the user runs the program, <em class="calibre3">username.json</em> won’t exist and a <span class="literal">FileNotFoundError</span> will occur <span class="ent">➌</span>. Python will move on to the <span class="literal">except</span> block where we prompt the user to enter their username <span class="ent">➍</span>. We then use <span class="literal">json.dump()</span> to store the username and print a greeting <span class="ent">➎</span>.</p>
<p class="indent">Whichever block executes, the result is a username and an appropriate greeting. If this is the first time the program runs, this is the output:</p>
<p class="programs">What is your name? <span class="codestrong">Eric</span><br class="calibre4" />
We'll remember you when you come back, Eric!</p>
<p class="indent">Otherwise:</p>
<p class="programs">Welcome back, Eric!</p>
<p class="indent">This is the output you see if the program was already run at least once.</p>
<h4 class="h3" id="calibre_link-891"><span type="pagebreak" id="calibre_link-542" class="calibre"></span><strong class="calibre2"><em class="calibre3">Refactoring</em></strong></h4>
<p class="noindent">Often, you’ll come to a point where your code will work, but you’ll recognize that you could improve the code by breaking it up into a series of functions that have specific jobs. This process is called <em class="calibre3">refactoring</em>. Refactoring makes your code cleaner, easier to understand, and easier to extend.</p>
<p class="indent">We can refactor <em class="calibre3">remember_me.py</em> by moving the bulk of its logic into one or more functions. The focus of <em class="calibre3">remember_me.py</em> is on greeting the user, so let’s move all of our existing code into a function called <span class="literal">greet_user()</span>:</p>
<p class="margin"><em class="calibre3">remember_me.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import json</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;def greet_user():<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Greet the user by name."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'username.json'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">try:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">username = json.load(f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">except FileNotFoundError:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">username = input("What is your name? ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename, 'w') as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">json.dump(username, f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"We'll remember you when you come back, {username}!")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Welcome back, {username}!")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;greet_user()</p>
<p class="indent">Because we’re using a function now, we update the comments with a docstring that reflects how the program currently works <span class="ent">➊</span>. This file is a little cleaner, but the function <span class="literal">greet_user()</span> is doing more than just greeting the user&mdash;it’s also retrieving a stored username if one exists and prompting for a new username if one doesn’t exist.</p>
<p class="indent">Let’s refactor <span class="literal">greet_user()</span> so it’s not doing so many different tasks. We’ll start by moving the code for retrieving a stored username to a separate function:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import json</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;def get_stored_username():<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Get stored username if available."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'username.json'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">try:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">username = json.load(f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">except FileNotFoundError:</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return None<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return username<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1347" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash">def greet_user():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Greet the user by name."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username = get_stored_username()<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if username:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Welcome back, {username}!")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">username = input("What is your name? ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'username.json'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename, 'w') as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">json.dump(username, f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"We'll remember you when you come back, {username}!")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">greet_user()</span></p>
<p class="indent">The new function <span class="literal">get_stored_username()</span> has a clear purpose, as stated in the docstring at <span class="ent">➊</span>. This function retrieves a stored username and returns the username if it finds one. If the file <em class="calibre3">username.json</em> doesn’t exist, the function returns <span class="literal">None</span> <span class="ent">➋</span>. This is good practice: a function should either return the value you’re expecting, or it should return <span class="literal">None</span>. This allows us to perform a simple test with the return value of the function. At <span class="ent">➌</span> we print a welcome back message to the user if the attempt to retrieve a username was successful, and if it doesn’t, we prompt for a new username.</p>
<p class="indent">We should factor one more block of code out of <span class="literal">greet_user()</span>. If the username doesn’t exist, we should move the code that prompts for a new username to a function dedicated to that purpose:</p>
<p class="programs"><span class="ash">import json</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">def get_stored_username():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Get stored username if available."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
def get_new_username():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""Prompt for a new username."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">username = input("What is your name? ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'username.json'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename, 'w') as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">json.dump(username, f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;return username<br class="calibre4" />
<br class="calibre4" />
<span class="ash">def greet_user():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Greet the user by name."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">username = get_stored_username()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if username:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Welcome back, {username}!")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username = get_new_username()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"We'll remember you when you come back, {username}!")</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">greet_user()</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-543" class="calibre"></span>Each function in this final version of <em class="calibre3">remember_me.py</em> has a single, clear purpose. We call <span class="literal">greet_user()</span>, and that function prints an appropriate message: it either welcomes back an existing user or greets a new user. It does this by calling <span class="literal">get_stored_username()</span>, which is responsible only for retrieving a stored username if one exists. Finally, <span class="literal">greet_user()</span> calls <span class="literal">get_new_username()</span> if necessary, which is responsible only for getting a new username and storing it. This compartmentalization of work is an essential part of writing clear code that will be easy to maintain and extend.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-566"><strong class="calibre2">10-11. Favorite Number:</strong> Write a program that prompts for the user’s favorite number. Use <span class="literal1">json.dump()</span> to store this number in a file. Write a separate program that reads in this value and prints the message, “I know your favorite number! It’s _____.”</p>
<p class="sparal" id="calibre_link-892"><strong class="calibre2">10-12. Favorite Number Remembered:</strong> Combine the two programs from <a href="#calibre_link-566" class="calibre6">Exercise 10-11</a> into one file. If the number is already stored, report the favorite number to the user. If not, prompt for the user’s favorite number and store it in a file. Run the program twice to see that it works.</p>
<p class="sparal" id="calibre_link-893"><strong class="calibre2">10-13. Verify User:</strong> The final listing for <em class="calibre3">remember_me.py</em> assumes either that the user has already entered their username or that the program is running for the first time. We should modify it in case the current user is not the person who last used the program.</p>
<p class="sparai">Before printing a welcome back message in <span class="literal1">greet_user()</span>, ask the user if this is the correct username. If it’s not, call <span class="literal1">get_new_username()</span> to get the correct username.</p>
</div>
<h3 class="h2" id="calibre_link-894"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned how to work with files. You learned to read an entire file at once and read through a file’s contents one line at a time. You learned to write to a file and append text onto the end of a file. You read about exceptions and how to handle the exceptions you’re likely to see in your programs. Finally, you learned how to store Python data structures so you can save information your users provide, preventing them from having to start over each time they run a program.</p>
<p class="indent">In <a href="#calibre_link-120" class="calibre6">Chapter 11</a> you’ll learn efficient ways to test your code. This will help you trust that the code you develop is correct, and it will help you identify bugs that are introduced as you continue to build on the programs you’ve written.</p>
</div>


<div class="calibre1" id="calibre_link-567">
<h2 class="h" id="calibre_link-120"><span type="pagebreak" id="calibre_link-552" class="calibre"></span><strong class="calibre2"><span class="big">11</span><br class="calibre4" />TESTING YOUR CODE</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">When you write a function or a class, you can also write tests for that code. Testing proves that your code works as it’s supposed to in response to all the input types it’s designed to receive. When you write tests, you can be confident that your code will work correctly as more people begin to use your programs. You’ll also be able to test new code as you add it to make sure your changes don’t break your program’s existing behavior. Every programmer makes mistakes, so every programmer must test their code often, catching problems before users encounter them.</p>
<p class="indent">In this chapter you’ll learn to test your code using tools in Python’s <span class="literal">unittest</span> module. You’ll learn to build a test case and check that a set of inputs results in the output you want. You’ll see what a passing test looks like and what a failing test looks like, and you’ll learn how a failing test can help you improve your code. You’ll learn to test functions and classes, and you’ll start to understand how many tests to write for a project.</p>
<h3 class="h2" id="calibre_link-895"><span type="pagebreak" id="calibre_link-505" class="calibre"></span><strong class="calibre2">Testing a Function</strong></h3>
<p class="noindent">To learn about testing, we need code to test. Here’s a simple function that takes in a first and last name, and returns a neatly formatted full name:</p>
<p class="margin"><em class="calibre3">name_function.py</em></p>
<p class="programs">def get_formatted_name(first, last):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""Generate a neatly formatted full name."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first} {last}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;return full_name.title()</p>
<p class="indent">The function <span class="literal">get_formatted_name()</span> combines the first and last name with a space in between to complete a full name, and then capitalizes and returns the full name. To check that <span class="literal">get_formatted_name()</span> works, let’s make a program that uses this function. The program <em class="calibre3">names.py</em> lets users enter a first and last name, and see a neatly formatted full name:</p>
<p class="margin"><em class="calibre3">names.py</em></p>
<p class="programs">from name_function import get_formatted_name<br class="calibre4" />
<br class="calibre4" />
print("Enter 'q' at any time to quit.")<br class="calibre4" />
while True:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;first = input("\nPlease give me a first name: ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if first == 'q':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;last = input("Please give me a last name: ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if last == 'q':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;formatted_name = get_formatted_name(first, last)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(f"\tNeatly formatted name: {formatted_name}.")</p>
<p class="indent">This program imports <span class="literal">get_formatted_name()</span> from <em class="calibre3">name_function.py</em>. The user can enter a series of first and last names, and see the formatted full names that are generated:</p>
<p class="programs">Enter 'q' at any time to quit.<br class="calibre4" />
<br class="calibre4" />
Please give me a first name: <span class="codestrong">janis</span><br class="calibre4" />
Please give me a last name: <span class="codestrong">joplin</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neatly formatted name: Janis Joplin.<br class="calibre4" />
<br class="calibre4" />
Please give me a first name: <span class="codestrong">bob</span><br class="calibre4" />
Please give me a last name: <span class="codestrong">dylan</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neatly formatted name: Bob Dylan.<br class="calibre4" />
<br class="calibre4" />
Please give me a first name: <span class="codestrong">q</span></p>
<p class="indent">We can see that the names generated here are correct. But let’s say we want to modify <span class="literal">get_formatted_name()</span> so it can also handle middle names. As we do so, we want to make sure we don’t break the way the function handles names that have only a first and last name. We could test our code by running <em class="calibre3">names.py</em> and entering a name like <span class="literal">Janis Joplin</span> every time we modify <span class="literal">get_formatted_name()</span>, but that would become tedious. Fortunately, <span type="pagebreak" id="calibre_link-555" class="calibre"></span>Python provides an efficient way to automate the testing of a function’s output. If we automate the testing of <span class="literal">get_formatted_name()</span>, we can always be confident that the function will work when given the kinds of names we’ve written tests for.</p>
<h4 class="h3" id="calibre_link-896"><strong class="calibre2"><em class="calibre3">Unit Tests and Test Cases</em></strong></h4>
<p class="noindent">The module <span class="literal">unittest</span> from the Python standard library provides tools for testing your code. A <em class="calibre3">unit test</em> verifies that one specific aspect of a function’s behavior is correct. A <em class="calibre3">test case</em> is a collection of unit tests that together prove that a function behaves as it’s supposed to, within the full range of situations you expect it to handle. A good test case considers all the possible kinds of input a function could receive and includes tests to represent each of these situations. A test case with <em class="calibre3">full coverage</em> includes a full range of unit tests covering all the possible ways you can use a function. Achieving full coverage on a large project can be daunting. It’s often good enough to write tests for your code’s critical behaviors and then aim for full coverage only if the project starts to see widespread use.</p>
<h4 class="h3" id="calibre_link-897"><strong class="calibre2"><em class="calibre3">A Passing Test</em></strong></h4>
<p class="noindent">The syntax for setting up a test case takes some getting used to, but once you’ve set up the test case it’s straightforward to add more unit tests for your functions. To write a test case for a function, import the <span class="literal">unittest</span> module and the function you want to test. Then create a class that inherits from <span class="literal">unittest.TestCase</span>, and write a series of methods to test different aspects of your function’s behavior.</p>
<p class="indent">Here’s a test case with one method that verifies that the function <span class="literal">get_formatted_name()</span> works correctly when given a first and last name:</p>
<p class="margin"><em class="calibre3">test_name_function.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import unittest<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from name_function import get_formatted_name<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> class NamesTestCase(unittest.TestCase):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Tests for 'name_function.py'."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def test_first_last_name(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Do names like 'Janis Joplin' work?"""<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted_name = get_formatted_name('janis', 'joplin')<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.assertEqual(formatted_name, 'Janis Joplin')<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> if __name__ == '__main__':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unittest.main()</p>
<p class="indent">First, we import <span class="literal">unittest</span> and the function we want to test, <span class="literal">get_formatted_name()</span>. At <span class="ent">➊</span> we create a class called <span class="literal">NamesTestCase</span>, which will contain a series of unit tests for <span class="literal">get_formatted_name()</span>. You can name the class anything you want, but it’s best to call it something related to the function you’re about to test and to use the word <em class="calibre3">Test</em> in the class name. This class must inherit from the class <span class="literal">unittest.TestCase</span> so Python knows how to run the tests you write.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-245" class="calibre"></span><span class="literal">NamesTestCase</span> contains a single method that tests one aspect of <span class="literal">get_formatted_name()</span>. We call this method <span class="literal">test_first_last_name()</span> because we’re verifying that names with only a first and last name are formatted correctly. Any method that starts with <span class="literal">test_</span> will be run automatically when we run <em class="calibre3">test_name_function.py</em>. Within this test method, we call the function we want to test. In this example we call <span class="literal">get_formatted_name()</span> with the arguments <span class="literal">'janis'</span> and <span class="literal">'joplin'</span>, and assign the result to <span class="literal">formatted_name</span> <span class="ent">➋</span>.</p>
<p class="indent">At <span class="ent">➌</span> we use one of <span class="literal">unittest</span>’s most useful features: an <em class="calibre3">assert</em> method. Assert methods verify that a result you received matches the result you expected to receive. In this case, because we know <span class="literal">get_formatted_name()</span> is supposed to return a capitalized, properly spaced full name, we expect the value of <span class="literal">formatted_name</span> to be <span class="literal">Janis Joplin</span>. To check if this is true, we use <span class="literal">unittest</span>’s <span class="literal">assertEqual()</span> method and pass it <span class="literal">formatted_name</span> and <span class="literal">'Janis Joplin'</span>. The line</p>
<p class="programs">self.assertEqual(formatted_name, 'Janis Joplin')</p>
<p class="noindent">says, “Compare the value in <span class="literal">formatted_name</span> to the string <span class="literal">'Janis Joplin'</span>. If they are equal as expected, fine. But if they don’t match, let me know!”</p>
<p class="indent">We’re going to run this file directly, but it’s important to note that many testing frameworks import your test files before running them. When a file is imported, the interpreter executes the file as it’s being imported. The <span class="literal">if</span> block at <span class="ent">➍</span> looks at a special variable, <span class="literal">__name__</span>, which is set when the program is executed. If this file is being run as the main program, the value of <span class="literal">__name__</span> is set to <span class="literal">'__main__'</span>. In this case, we call <span class="literal">unittest.main()</span>, which runs the test case. When a testing framework imports this file, the value of <span class="literal">__name__</span> won’t be <span class="literal">'__main__'</span> and this block will not be executed.</p>
<p class="indent">When we run <em class="calibre3">test_name_function.py</em>, we get the following output:</p>
<p class="programs">.<br class="calibre4" />
----------------------------------------------------------------------<br class="calibre4" />
Ran 1 test in 0.000s<br class="calibre4" />
<br class="calibre4" />
OK</p>
<p class="indent">The dot on the first line of output tells us that a single test passed. The next line tells us that Python ran one test, and it took less than 0.001 seconds to run. The final <span class="literal">OK</span> tells us that all unit tests in the test case passed.</p>
<p class="indent">This output indicates that the function <span class="literal">get_formatted_name()</span> will always work for names that have a first and last name unless we modify the function. When we modify <span class="literal">get_formatted_name()</span>, we can run this test again. If the test case passes, we know the function will still work for names like Janis Joplin.</p>
<h4 class="h3" id="calibre_link-898"><strong class="calibre2"><em class="calibre3">A Failing Test</em></strong></h4>
<p class="noindent">What does a failing test look like? Let’s modify <span class="literal">get_formatted_name()</span> so it can handle middle names, but we’ll do so in a way that breaks the function for names with just a first and last name, like Janis Joplin.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1348" class="calibre"></span>Here’s a new version of <span class="literal">get_formatted_name()</span> that requires a middle name argument:</p>
<p class="margin"><em class="calibre3">name_function.py</em></p>
<p class="programs">def get_formatted_name(first, middle, last):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Generate a neatly formatted full name."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first} {middle} {last}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return full_name.title()</span></p>
<p class="indent">This version should work for people with middle names, but when we test it, we see that we’ve broken the function for people with just a first and last name. This time, running the file <em class="calibre3">test_name_function.py</em> gives this output:</p>
<p class="programs"><span class="ent">➊</span> E<br class="calibre4" />
&nbsp;&nbsp;&nbsp;======================================================================<br class="calibre4" />
<span class="ent">➋</span> ERROR: test_first_last_name (__main__.NamesTestCase)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------<br class="calibre4" />
<span class="ent">➌</span> Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File "test_name_function.py", line 8, in test_first_last_name<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted_name = get_formatted_name('janis', 'joplin')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;TypeError: get_formatted_name() missing 1 required positional argument: 'last'<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------<br class="calibre4" />
<span class="ent">➍</span> Ran 1 test in 0.000s<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➎</span> FAILED (errors=1)</p>
<p class="indent">There’s a lot of information here because there’s a lot you might need to know when a test fails. The first item in the output is a single <span class="literal">E</span> <span class="ent">➊</span>, which tells us one unit test in the test case resulted in an error. Next, we see that <span class="literal">test_first_last_name()</span> in <span class="literal">NamesTestCase</span> caused an error <span class="ent">➋</span>. Knowing which test failed is critical when your test case contains many unit tests. At <span class="ent">➌</span> we see a standard traceback, which reports that the function call <span class="literal">get_formatted_name('janis', 'joplin')</span> no longer works because it’s missing a required positional argument.</p>
<p class="indent">We also see that one unit test was run <span class="ent">➍</span>. Finally, we see an additional message that the overall test case failed and that one error occurred when running the test case <span class="ent">➎</span>. This information appears at the end of the output so you see it right away; you don’t need to scroll up through a long output listing to find out how many tests failed.</p>
<h4 class="h3" id="calibre_link-899"><strong class="calibre2"><em class="calibre3">Responding to a Failed Test</em></strong></h4>
<p class="noindent">What do you do when a test fails? Assuming you’re checking the right conditions, a passing test means the function is behaving correctly and a failing test means there’s an error in the new code you wrote. So when a test fails, don’t change the test. Instead, fix the code that caused the test to fail. Examine the changes you just made to the function, and figure out how those changes broke the desired behavior.</p>
<p class="indent">In this case <span class="literal">get_formatted_name()</span> used to require only two parameters: a first name and a last name. Now it requires a first name, middle name, and <span type="pagebreak" id="calibre_link-554" class="calibre"></span>last name. The addition of that mandatory middle name parameter broke the desired behavior of <span class="literal">get_formatted_name()</span>. The best option here is to make the middle name optional. Once we do, our test for names like <span class="literal">Janis Joplin</span> should pass again, and we should be able to accept middle names as well. Let’s modify <span class="literal">get_formatted_name()</span> so middle names are optional and then run the test case again. If it passes, we’ll move on to making sure the function handles middle names properly.</p>
<p class="indent">To make middle names optional, we move the parameter <span class="literal">middle</span> to the end of the parameter list in the function definition and give it an empty default value. We also add an <span class="literal">if</span> test that builds the full name properly, depending on whether or not a middle name is provided:</p>
<p class="margin"><em class="calibre3">name_function.py</em></p>
<p class="programs">def get_formatted_name(first, last, middle=''):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Generate a neatly formatted full name."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if middle:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first} {middle} {last}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name = f"{first} {last}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return full_name.title()</span></p>
<p class="indent">In this new version of <span class="literal">get_formatted_name()</span>, the middle name is optional. If a middle name is passed to the function, the full name will contain a first, middle, and last name. Otherwise, the full name will consist of just a first and last name. Now the function should work for both kinds of names. To find out if the function still works for names like <span class="literal">Janis Joplin</span>, let’s run <em class="calibre3">test_name_function.py</em> again:</p>
<p class="programs">.<br class="calibre4" />
----------------------------------------------------------------------<br class="calibre4" />
Ran 1 test in 0.000s<br class="calibre4" />
<br class="calibre4" />
OK</p>
<p class="indent">The test case passes now. This is ideal; it means the function works for names like <span class="literal">Janis Joplin</span> again without us having to test the function manually. Fixing our function was easy because the failed test helped us identify the new code that broke existing behavior.</p>
<h4 class="h3" id="calibre_link-900"><strong class="calibre2"><em class="calibre3">Adding New Tests</em></strong></h4>
<p class="noindent">Now that we know <span class="literal">get_formatted_name()</span> works for simple names again, let’s write a second test for people who include a middle name. We do this by adding another method to the class <span class="literal">NamesTestCase</span>:</p>
<p class="margin"><em class="calibre3">test_name_function.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class NamesTestCase(unittest.TestCase):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Tests for 'name_function.py'."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def test_first_last_name(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-506" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def test_first_last_middle_name(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Do names like 'Wolfgang Amadeus Mozart' work?"""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted_name = get_formatted_name(<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'wolfgang', 'mozart', 'amadeus')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.assertEqual(formatted_name, 'Wolfgang Amadeus Mozart')<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">if __name__ == '__main__':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">unittest.main()</span></p>
<p class="indent">We name this new method <span class="literal">test_first_last_middle_name()</span>. The method name must start with <em class="calibre3">test_</em> so the method runs automatically when we run <em class="calibre3">test_name_function.py</em>. We name the method to make it clear which behavior of <span class="literal">get_formatted_name()</span> we’re testing. As a result, if the test fails, we know right away what kinds of names are affected. It’s fine to have long method names in your <span class="literal">TestCase</span> classes. They need to be descriptive so you can make sense of the output when your tests fail, and because Python calls them automatically, you’ll never have to write code that calls these methods.</p>
<p class="indent">To test the function, we call <span class="literal">get_formatted_name()</span> with a first, last, and middle name <span class="ent">➊</span>, and then we use <span class="literal">assertEqual()</span> to check that the returned full name matches the full name (first, middle, and last) that we expect. When we run <em class="calibre3">test_name_function.py</em> again, both tests pass:</p>
<p class="programs">..<br class="calibre4" />
----------------------------------------------------------------------<br class="calibre4" />
Ran 2 tests in 0.000s<br class="calibre4" />
<br class="calibre4" />
OK</p>
<p class="indent">Great! We now know that the function still works for names like <span class="literal">Janis Joplin</span>, and we can be confident that it will work for names like <span class="literal">Wolfgang Amadeus Mozart</span> as well.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-901"><strong class="calibre2">11-1. City, Country:</strong> Write a function that accepts two parameters: a city name and a country name. The function should return a single string of the form <span class="codeitalic2">City, Country</span>, such as <span class="literal1">Santiago, Chile</span>. Store the function in a module called <em class="calibre3">city_functions.py</em>.</p>
<p class="sparai">Create a file called <em class="calibre3">test_cities.py</em> that tests the function you just wrote (remember that you need to import <span class="literal1">unittest</span> and the function you want to test). Write a method called <span class="literal1">test_city_country()</span> to verify that calling your function with values such as <span class="literal1">'santiago'</span> and <span class="literal1">'chile'</span> results in the correct string. Run <em class="calibre3">test_cities.py</em>, and make sure <span class="literal1">test_city_country()</span> passes.</p>
<p class="sparal" id="calibre_link-902"><span type="pagebreak" id="calibre_link-246" class="calibre"></span><strong class="calibre2">11-2. Population:</strong> Modify your function so it requires a third parameter, <span class="literal1">population</span>. It should now return a single string of the form <span class="codeitalic2">City, Country &ndash; population xxx</span>, such as <span class="literal1">Santiago, Chile &ndash; population 5000000</span>. Run <em class="calibre3">test_cities.py</em> again. Make sure <span class="literal1">test_city_country()</span> fails this time.</p>
<p class="sparai">Modify the function so the <span class="literal1">population</span> parameter is optional. Run <em class="calibre3">test_cities.py</em> again, and make sure <span class="literal1">test_city_country()</span> passes again.</p>
<p class="sparai">Write a second test called <span class="literal1">test_city_country_population()</span> that verifies you can call your function with the values <span class="literal1">'santiago'</span>, <span class="literal1">'chile'</span>, and <span class="literal1">'population=5000000'</span>. Run <em class="calibre3">test_cities.py</em> again, and make sure this new test passes.</p>
</div>
<h3 class="h2" id="calibre_link-903"><strong class="calibre2">Testing a Class</strong></h3>
<p class="noindent">In the first part of this chapter, you wrote tests for a single function. Now you’ll write tests for a class. You’ll use classes in many of your own programs, so it’s helpful to be able to prove that your classes work correctly. If you have passing tests for a class you’re working on, you can be confident that improvements you make to the class won’t accidentally break its current behavior.</p>
<h4 class="h3" id="calibre_link-904"><strong class="calibre2"><em class="calibre3">A Variety of Assert Methods</em></strong></h4>
<p class="noindent">Python provides a number of assert methods in the <span class="literal">unittest.TestCase</span> class. As mentioned earlier, assert methods test whether a condition you believe is true at a specific point in your code is indeed true. If the condition is true as expected, your assumption about how that part of your program behaves is confirmed; you can be confident that no errors exist. If the condition you assume is true is actually not true, Python raises an exception.</p>
<p class="indent"><a href="#calibre_link-568" class="calibre6">Table 11-1</a> describes six commonly used assert methods. With these methods you can verify that returned values equal or don’t equal expected values, that values are <span class="literal">True</span> or <span class="literal">False</span>, and that values are <span class="literal">in</span> or <span class="literal">not in</span> a given list. You can use these methods only in a class that inherits from <span class="literal">unittest.TestCase</span>, so let’s look at how we can use one of these methods in the context of testing an actual class.</p>
<p class="tabcap" id="calibre_link-568"><strong class="calibre2">Table 11-1:</strong> Assert Methods Available from the <span class="literal1">unittest</span> Module</p>
<table class="topbot-d">
<colgroup class="calibre10">
<col class="calibre11"></col>
<col class="calibre11"></col>
</colgroup>
<tbody class="calibre12">
<tr class="calibre13">
<td class="table-h"><p class="tab_th"><strong class="calibre2">Method</strong></p></td>
<td class="table-h"><p class="tab_th"><strong class="calibre2">Use</strong></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">assertEqual(a, b)</span></p></td>
<td class="table-b"><p class="taba">Verify that <span class="literal">a == b</span></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">assertNotEqual(a, b)</span></p></td>
<td class="table-b"><p class="taba">Verify that <span class="literal">a != b</span></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">assertTrue(x)</span></p></td>
<td class="table-b"><p class="taba">Verify that <span class="literal">x</span> is <span class="literal">True</span></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">assertFalse(x)</span></p></td>
<td class="table-b"><p class="taba">Verify that <span class="literal">x</span> is <span class="literal">False</span></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">assertIn(</span><span class="codeitalic">item, list</span><span class="literal">)</span></p></td>
<td class="table-b"><p class="taba">Verify that <span class="codeitalic">item</span> is in <span class="codeitalic">list</span></p></td>
</tr>
<tr class="calibre13">
<td class="table-ba"><p class="taba"><span class="literal">assertNotIn(</span><span class="codeitalic">item, list</span><span class="literal">)</span></p></td>
<td class="table-ba"><p class="taba">Verify that <span class="codeitalic">item</span> is not in <span class="codeitalic">list</span></p></td>
</tr>
</tbody>
</table>
<h4 class="h3" id="calibre_link-905"><span type="pagebreak" id="calibre_link-456" class="calibre"></span><strong class="calibre2"><em class="calibre3">A Class to Test</em></strong></h4>
<p class="noindent">Testing a class is similar to testing a function&mdash;much of your work involves testing the behavior of the methods in the class. But there are a few differences, so let’s write a class to test. Consider a class that helps administer anonymous surveys:</p>
<p class="margin"><em class="calibre3">survey.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;class AnonymousSurvey:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Collect anonymous answers to a survey question."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, question):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Store a question, and prepare to store responses."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.question = question<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.responses = []<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def show_question(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Show the survey question."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(self.question)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def store_response(self, new_response):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Store a single response to the survey."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.responses.append(new_response)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def show_results(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Show all the responses that have been given."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Survey results:")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for response in self.responses:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"- {response}")</p>
<p class="indent">This class starts with a survey question that you provide <span class="ent">➊</span> and includes an empty list to store responses. The class has methods to print the survey question <span class="ent">➋</span>, add a new response to the response list <span class="ent">➌</span>, and print all the responses stored in the list <span class="ent">➍</span>. To create an instance from this class, all you have to provide is a question. Once you have an instance representing a particular survey, you display the survey question with <span class="literal">show_question()</span>, store a response using <span class="literal">store_response()</span>, and show results with <span class="literal">show_results()</span>.</p>
<p class="indent">To show that the <span class="literal">AnonymousSurvey</span> class works, let’s write a program that uses the class:</p>
<p class="margin"><em class="calibre3">language_survey.py</em></p>
<p class="programs">from survey import AnonymousSurvey<br class="calibre4" />
<br class="calibre4" />
# Define a question, and make a survey.<br class="calibre4" />
question = "What language did you first learn to speak?"<br class="calibre4" />
my_survey = AnonymousSurvey(question)<br class="calibre4" />
<br class="calibre4" />
# Show the question, and store responses to the question.<br class="calibre4" />
my_survey.show_question()<br class="calibre4" />
print("Enter 'q' at any time to quit.\n")<br class="calibre4" />
while True:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;response = input("Language: ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if response == 'q':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;my_survey.store_response(response)<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-558" class="calibre"></span># Show the survey results.<br class="calibre4" />
print("\nThank you to everyone who participated in the survey!")<br class="calibre4" />
my_survey.show_results()</p>
<p class="indent">This program defines a question (<span class="literal">"What language did you first learn to speak?"</span>) and creates an <span class="literal">AnonymousSurvey</span> object with that question. The program calls <span class="literal">show_question()</span> to display the question and then prompts for responses. Each response is stored as it is received. When all responses have been entered (the user inputs <span class="literal">q</span> to quit), <span class="literal">show_results()</span> prints the survey results:</p>
<p class="programs">What language did you first learn to speak?<br class="calibre4" />
Enter 'q' at any time to quit.<br class="calibre4" />
<br class="calibre4" />
Language: <span class="codestrong">English</span><br class="calibre4" />
Language: <span class="codestrong">Spanish</span><br class="calibre4" />
Language: <span class="codestrong">English</span><br class="calibre4" />
Language: <span class="codestrong">Mandarin</span><br class="calibre4" />
Language: <span class="codestrong">q</span><br class="calibre4" />
<br class="calibre4" />
Thank you to everyone who participated in the survey!<br class="calibre4" />
Survey results:<br class="calibre4" />
- English<br class="calibre4" />
- Spanish<br class="calibre4" />
- English<br class="calibre4" />
- Mandarin</p>
<p class="indent">This class works for a simple anonymous survey. But let’s say we want to improve <span class="literal">AnonymousSurvey</span> and the module it’s in, <span class="literal">survey</span>. We could allow each user to enter more than one response. We could write a method to list only unique responses and to report how many times each response was given. We could write another class to manage nonanonymous surveys.</p>
<p class="indent">Implementing such changes would risk affecting the current behavior of the class <span class="literal">AnonymousSurvey</span>. For example, it’s possible that while trying to allow each user to enter multiple responses, we could accidentally change how single responses are handled. To ensure we don’t break existing behavior as we develop this module, we can write tests for the class.</p>
<h4 class="h3" id="calibre_link-906"><strong class="calibre2"><em class="calibre3">Testing the AnonymousSurvey Class</em></strong></h4>
<p class="noindent">Let’s write a test that verifies one aspect of the way <span class="literal">AnonymousSurvey</span> behaves. We’ll write a test to verify that a single response to the survey question is stored properly. We’ll use the <span class="literal">assertIn()</span> method to verify that the response is in the list of responses after it’s been stored:</p>
<p class="margin"><em class="calibre3">test_survey.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import unittest<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from survey import AnonymousSurvey<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> class TestAnonymousSurvey(unittest.TestCase):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Tests for the class AnonymousSurvey"""<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1349" class="calibre"></span><span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def test_store_single_response(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Test that a single response is stored properly."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;question = "What language did you first learn to speak?"<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_survey = AnonymousSurvey(question)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_survey.store_response('English')<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.assertIn('English', my_survey.responses)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;if __name__ == '__main__':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unittest.main()</p>
<p class="indent">We start by importing the <span class="literal">unittest</span> module and the class we want to test, <span class="literal">AnonymousSurvey</span>. We call our test case <span class="literal">TestAnonymousSurvey</span>, which again inherits from <span class="literal">unittest.TestCase</span> <span class="ent">➊</span>. The first test method will verify that when we store a response to the survey question, the response ends up in the survey’s list of responses. A good descriptive name for this method is <span class="literal">test_store_single_response()</span> <span class="ent">➋</span>. If this test fails, we’ll know from the method name shown in the output of the failing test that there was a problem storing a single response to the survey.</p>
<p class="indent">To test the behavior of a class, we need to make an instance of the class. At <span class="ent">➌</span> we create an instance called <span class="literal">my_survey</span> with the question <span class="literal">"What language did you first learn to speak?"</span> We store a single response, <span class="literal">English</span>, using the <span class="literal">store_response()</span> method. Then we verify that the response was stored correctly by asserting that <span class="literal">English</span> is in the list <span class="literal">my_survey.responses</span> <span class="ent">➍</span>.</p>
<p class="indent">When we run <em class="calibre3">test_survey.py</em>, the test passes:</p>
<p class="programs">.<br class="calibre4" />
----------------------------------------------------------------------<br class="calibre4" />
Ran 1 test in 0.001s<br class="calibre4" />
<br class="calibre4" />
OK</p>
<p class="indent">This is good, but a survey is useful only if it generates more than one response. Let’s verify that three responses can be stored correctly. To do this, we add another method to <span class="literal">TestAnonymousSurvey</span>:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import unittest</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from survey import AnonymousSurvey</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class TestAnonymousSurvey(unittest.TestCase):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Tests for the class AnonymousSurvey"""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def test_store_single_response(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def test_store_three_responses(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Test that three individual responses are stored properly."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;question = "What language did you first learn to speak?"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_survey = AnonymousSurvey(question)<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responses = ['English', 'Spanish', 'Mandarin']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for response in responses:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_survey.store_response(response)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for response in responses:<br class="calibre4" />
<span type="pagebreak" id="calibre_link-556" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.assertIn(response, my_survey.responses)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">if __name__ == '__main__':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">unittest.main()</span></p>
<p class="indent">We call the new method <span class="literal">test_store_three_responses()</span>. We create a survey object just like we did in <span class="literal">test_store_single_response()</span>. We define a list containing three different responses <span class="ent">➊</span>, and then we call <span class="literal">store_response()</span> for each of these responses. Once the responses have been stored, we write another loop and assert that each response is now in <span class="literal">my_survey.responses</span> <span class="ent">➋</span>.</p>
<p class="indent">When we run <em class="calibre3">test_survey.py</em> again, both tests (for a single response and for three responses) pass:</p>
<p class="programs">..<br class="calibre4" />
----------------------------------------------------------------------<br class="calibre4" />
Ran 2 tests in 0.000s<br class="calibre4" />
<br class="calibre4" />
OK</p>
<p class="indent">This works perfectly. However, these tests are a bit repetitive, so we’ll use another feature of <span class="literal">unittest</span> to make them more efficient.</p>
<h4 class="h3" id="calibre_link-907"><strong class="calibre2"><em class="calibre3">The setUp() Method</em></strong></h4>
<p class="noindent">In <em class="calibre3">test_survey.py</em> we created a new instance of <span class="literal">AnonymousSurvey</span> in each test method, and we created new responses in each method. The <span class="literal">unittest.TestCase</span> class has a <span class="literal">setUp()</span> method that allows you to create these objects once and then use them in each of your test methods. When you include a <span class="literal">setUp()</span> method in a <span class="literal">TestCase</span> class, Python runs the <span class="literal">setUp()</span> method before running each method starting with <em class="calibre3">test_</em>. Any objects created in the <span class="literal">setUp()</span> method are then available in each test method you write.</p>
<p class="indent">Let’s use <span class="literal">setUp()</span> to create a survey instance and a set of responses that can be used in <span class="literal">test_store_single_response()</span> and <span class="literal">test_store_three_responses()</span>:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import unittest</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from survey import AnonymousSurvey</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class TestAnonymousSurvey(unittest.TestCase):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Tests for the class AnonymousSurvey."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def setUp(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a survey and a set of responses for use in all test methods.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;question = "What language did you first learn to speak?"<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.my_survey = AnonymousSurvey(question)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.responses = ['English', 'Spanish', 'Mandarin']<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def test_store_single_response(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Test that a single response is stored properly."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.my_survey.store_response(self.responses[0])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.assertIn(self.responses[0], self.my_survey.responses)<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-557" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def test_store_three_responses(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Test that three individual responses are stored properly."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for response in self.responses:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.my_survey.store_response(response)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for response in self.responses:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.assertIn(response, self.my_survey.responses)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">if __name__ == '__main__':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">unittest.main()</span></p>
<p class="indent">The method <span class="literal">setUp()</span> does two things: it creates a survey instance <span class="ent">➊</span>, and it creates a list of responses <span class="ent">➋</span>. Each of these is prefixed by <span class="literal">self</span>, so they can be used anywhere in the class. This makes the two test methods simpler, because neither one has to make a survey instance or a response. The method <span class="literal">test_store_single_response()</span> verifies that the first response in <span class="literal">self.responses</span>&mdash;<span class="literal">self.responses[0]</span>&mdash;can be stored correctly, and <span class="literal">test_store_three_responses()</span> verifies that all three responses in <span class="literal">self.responses</span> can be stored correctly.</p>
<p class="indent">When we run <em class="calibre3">test_survey.py</em> again, both tests still pass. These tests would be particularly useful when trying to expand <span class="literal">AnonymousSurvey</span> to handle multiple responses for each person. After modifying the code to accept multiple responses, you could run these tests and make sure you haven’t affected the ability to store a single response or a series of individual responses.</p>
<p class="indent">When you’re testing your own classes, the <span class="literal">setUp()</span> method can make your test methods easier to write. You make one set of instances and attributes in <span class="literal">setUp()</span> and then use these instances in all your test methods. This is much easier than making a new set of instances and attributes in each test method.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">When a test case is running, Python prints one character for each unit test as it is completed. A passing test prints a dot, a test that results in an error prints an <span class="codeitalic">E</span>, and a test that results in a failed assertion prints an <span class="codeitalic">F</span>. This is why you’ll see a different number of dots and characters on the first line of output when you run your test cases. If a test case takes a long time to run because it contains many unit tests, you can watch these results to get a sense of how many tests are passing.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-908"><strong class="calibre2">11-3. Employee:</strong> Write a class called <span class="literal1">Employee</span>. The <span class="literal1">__init__()</span> method should take in a first name, a last name, and an annual salary, and store each of these as attributes. Write a method called <span class="literal1">give_raise()</span> that adds $5,000 to the annual salary by default but also accepts a different raise amount.</p>
<p class="sparai">Write a test case for <span class="literal1">Employee</span>. Write two test methods, <span class="literal1">test_give_default_raise()</span> and <span class="literal1">test_give_custom_raise()</span>. Use the <span class="literal1">setUp()</span> method so you don’t have to create a new employee instance in each test method. Run your test case, and make sure both tests pass.</p>
</div>
<h3 class="h2" id="calibre_link-909"><span type="pagebreak" id="calibre_link-553" class="calibre"></span><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter you learned to write tests for functions and classes using tools in the <span class="literal">unittest</span> module. You learned to write a class that inherits from <span class="literal">unittest.TestCase</span>, and you learned to write test methods that verify specific behaviors your functions and classes should exhibit. You learned to use the <span class="literal">setUp()</span> method to efficiently create instances and attributes from your classes that can be used in all the test methods for a class.</p>
<p class="indent">Testing is an important topic that many beginners don’t learn. You don’t have to write tests for all the simple projects you try as a beginner. But as soon as you start to work on projects that involve significant development effort, you should test the critical behaviors of your functions and classes. You’ll be more confident that new work on your project won’t break the parts that work, and this will give you the freedom to make improvements to your code. If you accidentally break existing functionality, you’ll know right away, so you can still fix the problem easily. Responding to a failed test that you ran is much easier than responding to a bug report from an unhappy user.</p>
<p class="indent">Other programmers respect your projects more if you include some initial tests. They’ll feel more comfortable experimenting with your code and be more willing to work with you on projects. If you want to contribute to a project that other programmers are working on, you’ll be expected to show that your code passes existing tests and you’ll usually be expected to write tests for new behavior you introduce to the project.</p>
<p class="indent">Play around with tests to become familiar with the process of testing your code. Write tests for the most critical behaviors of your functions and classes, but don’t aim for full coverage in early projects unless you have a specific reason to do so.</p>
</div>


<div class="calibre1" id="calibre_link-8">
<h1 class="h1" id="calibre_link-10"><span type="pagebreak" id="calibre_link-1350" class="calibre"></span><strong class="calibre2">PART II<br class="calibre4" /><span class="f">PROJECTS</span></strong></h1>
<p class="noindenta">Congratulations! You now know enough about Python to start building interactive and meaningful projects. Creating your own projects will teach you new skills and solidify your understanding of the concepts introduced in <a href="#calibre_link-9" class="calibre6">Part I</a>.</p>
<p class="indent"><a href="#calibre_link-10" class="calibre6">Part II</a> contains three types of projects, and you can choose to do any or all of these projects in whichever order you like. Here’s a brief description of each project to help you decide which to dig into first.</p>
<h5 class="h4"><strong class="calibre2">Alien Invasion: Making a Game with Python</strong></h5>
<p class="noindent">In the <em class="calibre3">Alien Invasion</em> project (<a href="#calibre_link-11" class="calibre6">Chapters 12</a>, <a href="#calibre_link-12" class="calibre6">13</a>, and <a href="#calibre_link-13" class="calibre6">14</a>), you’ll use the Pygame package to develop a 2D game in which the aim is to shoot down a fleet of aliens as they drop down the screen in levels that increase in speed and difficulty. At the end of the project, you’ll have learned skills that will enable you to develop your own 2D games in Pygame.</p>
<h5 class="h4"><strong class="calibre2">Data Visualization</strong></h5>
<p class="noindent">The Data Visualization project starts in <a href="#calibre_link-14" class="calibre6">Chapter 15</a>, in which you’ll learn to generate data and create a series of functional and beautiful visualizations of that data using Matplotlib and Plotly. <a href="#calibre_link-15" class="calibre6">Chapter 16</a> teaches you to access data from online sources and feed it into a visualization package to create plots of weather data and a map of global earthquake activity. Finally, <a href="#calibre_link-16" class="calibre6">Chapter 17</a> shows you how to write a program to automatically download <span type="pagebreak" id="calibre_link-1351" class="calibre"></span>and visualize data. Learning to make visualizations allows you to explore the field of data mining, which is a highly sought-after skill in the world today.</p>
<h5 class="h4"><strong class="calibre2">Web Applications</strong></h5>
<p class="noindent">In the Web Applications project (<a href="#calibre_link-17" class="calibre6">Chapters 18</a>, <a href="#calibre_link-18" class="calibre6">19</a>, and <a href="#calibre_link-19" class="calibre6">20</a>), you’ll use the Django package to create a simple web application that allows users to keep a journal about any number of topics they’ve been learning about. Users will create an account with a username and password, enter a topic, and then make entries about what they’re learning. You’ll also learn how to deploy your app so anyone in the world can access it.</p>
<p class="indent">After completing this project, you’ll be able to start building your own simple web applications, and you’ll be ready to delve into more thorough resources on building applications with Django.</p>
</div>


<div class="calibre1" id="calibre_link-1242">
<h1 class="h1" id="calibre_link-155"><span type="pagebreak" id="calibre_link-1352" class="calibre"></span><strong class="calibre2">PROJECT 1<br class="calibre4" /><span class="f">ALIEN INVASION</span></strong><span type="pagebreak" id="calibre_link-1353" class="calibre"></span></h1>
</div>


<div class="calibre1" id="calibre_link-96">
<h2 class="h" id="calibre_link-11"><span type="pagebreak" id="calibre_link-1354" class="calibre"></span><strong class="calibre2"><span class="big">12</span><br class="calibre4" />A SHIP THAT FIRES BULLETS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Let’s build a game called <em class="calibre3">Alien Invasion</em>! We’ll use Pygame, a collection of fun, powerful Python modules that manage graphics, animation, and even sound, making it easier for you to build sophisticated games. With Pygame handling tasks like drawing images to the screen, you can focus on the higher-level logic of game dynamics.</p>
<p class="indent">In this chapter, you’ll set up Pygame, and then create a rocket ship that moves right and left and fires bullets in response to player input. In the next two chapters, you’ll create a fleet of aliens to destroy, and then continue to refine the game by setting limits on the number of ships you can use and adding a scoreboard.</p>
<p class="indent">While building this game, you’ll also learn how to manage large projects that span multiple files. We’ll refactor a lot of code and manage file contents to organize the project and make the code efficient.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-219" class="calibre"></span>Making games is an ideal way to have fun while learning a language. It’s deeply satisfying to play a game you wrote, and writing a simple game will help you comprehend how professionals develop games. As you work through this chapter, enter and run the code to identify how each code block contributes to overall gameplay. Experiment with different values and settings to better understand how to refine interactions in your games.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep">Alien Invasion <em class="calibre3">spans a number of different files, so make a new</em> alien_invasion <em class="calibre3">folder on your system. Be sure to save all files for the project to this folder so your <span class="codeitalic">import</span> statements will work correctly.</em></p>
<p class="notepi"><em class="calibre3">Also, if you feel comfortable using version control, you might want to use it for this project. If you haven’t used version control before, see <a href="#calibre_link-67" class="calibre6">Appendix D</a> for an overview.</em></p>
</div>
<h3 class="h2" id="calibre_link-910"><strong class="calibre2">Planning Your Project</strong></h3>
<p class="noindent">When you’re building a large project, it’s important to prepare a plan before you begin to write code. Your plan will keep you focused and make it more likely that you’ll complete the project.</p>
<p class="indent">Let’s write a description of the general gameplay. Although the following description doesn’t cover every detail of <em class="calibre3">Alien Invasion</em>, it provides a clear idea of how to start building the game:</p>
<p class="quote">In <em class="calibre3">Alien Invasion</em>, the player controls a rocket ship that appears at the bottom center of the screen. The player can move the ship right and left using the arrow keys and shoot bullets using the spacebar. When the game begins, a fleet of aliens fills the sky and moves across and down the screen. The player shoots and destroys the aliens. If the player shoots all the aliens, a new fleet appears that moves faster than the previous fleet. If any alien hits the player’s ship or reaches the bottom of the screen, the player loses a ship. If the player loses three ships, the game ends.</p>
<p class="indent">For the first development phase, we’ll make a ship that can move right and left and fires bullets when the player presses the spacebar. After setting up this behavior, we can create the aliens and refine the gameplay.</p>
<h3 class="h2" id="calibre_link-911"><strong class="calibre2">Installing Pygame</strong></h3>
<p class="noindent">Before you begin coding, install Pygame. The <span class="literal">pip</span> module helps you download and install Python packages. To install Pygame, enter the following command at a terminal prompt:</p>
<p class="programs">$ <span class="codestrong">python -m pip install --user pygame</span></p>
<p class="indent">This command tells Python to run the <span class="literal">pip</span> module and install the <span class="literal">pygame</span> package to the current user’s Python installation. If you use a command <span type="pagebreak" id="calibre_link-216" class="calibre"></span>other than <span class="literal">python</span> to run programs or start a terminal session, such as <span class="literal">python3</span>, your command will look like this:</p>
<p class="programs">$ <span class="codestrong">python3 -m pip install --user pygame</span></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If this command doesn’t work on macOS, try running the command again without the <span class="codeitalic">--user</span> flag.</em></p>
</div>
<h3 class="h2" id="calibre_link-912"><strong class="calibre2">Starting the Game Project</strong></h3>
<p class="noindent">We’ll begin building the game by creating an empty Pygame window. Later, we’ll draw the game elements, such as the ship and the aliens, on this window. We’ll also make our game respond to user input, set the background color, and load a ship image.</p>
<h4 class="h3" id="calibre_link-913"><strong class="calibre2"><em class="calibre3">Creating a Pygame Window and Responding to User Input</em></strong></h4>
<p class="noindent">We’ll make an empty Pygame window by creating a class to represent the game. In your text editor, create a new file and save it as <em class="calibre3">alien_invasion.py</em>; then enter the following:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import sys<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;import pygame<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class AlienInvasion:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Overall class to manage game assets and behavior."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize the game, and create game resources."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pygame.init()<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = pygame.display.set_mode((1200, 800))<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pygame.display.set_caption("Alien Invasion")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def run_game(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Start the main loop for the game."""<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while True:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Watch for keyboard and mouse events.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for event in pygame.event.get():<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if event.type == pygame.QUIT:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make the most recently drawn screen visible.<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pygame.display.flip()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;if __name__ == '__main__':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make a game instance, and run the game.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ai = AlienInvasion()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ai.run_game()</p>
<p class="indent"><span type="pagebreak" id="calibre_link-524" class="calibre"></span>First, we import the <span class="literal">sys</span> and <span class="literal">pygame</span> modules. The <span class="literal">pygame</span> module contains the functionality we need to make a game. We’ll use tools in the <span class="literal">sys</span> module to exit the game when the player quits.</p>
<p class="indent"><em class="calibre3">Alien Invasion</em> starts as a class called <span class="literal">AlienInvasion</span>. In the <span class="literal">__init__()</span> method, the <span class="literal">pygame.init()</span> function initializes the background settings that Pygame needs to work properly <span class="ent">➊</span>. At <span class="ent">➋</span>, we call <span class="literal">pygame.display.set_mode()</span> to create a display window, on which we’ll draw all the game’s graphical elements. The argument <span class="literal">(1200, 800)</span> is a tuple that defines the dimensions of the game window, which will be 1200 pixels wide by 800 pixels high. (You can adjust these values depending on your display size.) We assign this display window to the attribute <span class="literal">self.screen</span>, so it will be available in all methods in the class.</p>
<p class="indent">The object we assigned to <span class="literal">self.screen</span> is called a <em class="calibre3">surface</em>. A surface in Pygame is a part of the screen where a game element can be displayed. Each element in the game, like an alien or a ship, is its own surface. The surface returned by <span class="literal">display.set_mode()</span> represents the entire game window. When we activate the game’s animation loop, this surface will be redrawn on every pass through the loop, so it can be updated with any changes triggered by user input.</p>
<p class="indent">The game is controlled by the <span class="literal">run_game()</span> method. This method contains a <span class="literal">while</span> loop <span class="ent">➌</span> that runs continually. The <span class="literal">while</span> loop contains an event loop and code that manages screen updates. An <em class="calibre3">event</em> is an action that the user performs while playing the game, such as pressing a key or moving the mouse. To make our program respond to events, we write this <em class="calibre3">event loop</em> to <em class="calibre3">listen</em> for events and perform appropriate tasks depending on the kinds of events that occur. The <span class="literal">for</span> loop at <span class="ent">➍</span> is an event loop.</p>
<p class="indent">To access the events that Pygame detects, we’ll use the <span class="literal">pygame.event.get()</span> function. This function returns a list of events that have taken place since the last time this function was called. Any keyboard or mouse event will cause this <span class="literal">for</span> loop to run. Inside the loop, we’ll write a series of <span class="literal">if</span> statements to detect and respond to specific events. For example, when the player clicks the game window’s close button, a <span class="literal">pygame.QUIT</span> event is detected and we call <span class="literal">sys.exit()</span> to exit the game <span class="ent">➎</span>.</p>
<p class="indent">The call to <span class="literal">pygame.display.flip()</span> at <span class="ent">➏</span> tells Pygame to make the most recently drawn screen visible. In this case, it simply draws an empty screen on each pass through the <span class="literal">while</span> loop, erasing the old screen so only the new screen is visible. When we move the game elements around, <span class="literal">pygame.display.flip()</span> continually updates the display to show the new positions of game elements and hides the old ones, creating the illusion of smooth movement.</p>
<p class="indent">At the end of the file, we create an instance of the game, and then call <span class="literal">run_game()</span>. We place <span class="literal">run_game()</span> in an <span class="literal">if</span> block that only runs if the file is called directly. When you run this <em class="calibre3">alien_invasion.py</em> file, you should see an empty Pygame window.</p>
<h4 class="h3" id="calibre_link-914"><strong class="calibre2"><em class="calibre3">Setting the Background Color</em></strong></h4>
<p class="noindent">Pygame creates a black screen by default, but that’s boring. Let’s set a different background color. We’ll do this at the end of the <span class="literal">__init__()</span> method.</p>
<p class="margin"><span type="pagebreak" id="calibre_link-213" class="calibre"></span><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.set_caption("Alien Invasion")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set the background color.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bg_color = (230, 230, 230)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for event in pygame.event.get():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.type == pygame.QUIT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">sys.exit()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Redraw the screen during each pass through the loop.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.fill(self.bg_color)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make the most recently drawn screen visible.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.flip()</span></p>
<p class="indent">Colors in Pygame are specified as RGB colors: a mix of red, green, and blue. Each color value can range from 0 to 255. The color value (255, 0, 0) is red, (0, 255, 0) is green, and (0, 0, 255) is blue. You can mix different RGB values to create up to 16 million colors. The color value (230, 230, 230) mixes equal amounts of red, blue, and green, which produces a light gray background color. We assign this color to <span class="literal">self.bg_color</span> <span class="ent">➊</span>.</p>
<p class="indent">At <span class="ent">➋</span>, we fill the screen with the background color using the <span class="literal">fill()</span> method, which acts on a surface and takes only one argument: a color.</p>
<h4 class="h3" id="calibre_link-915"><strong class="calibre2"><em class="calibre3">Creating a Settings Class</em></strong></h4>
<p class="noindent">Each time we introduce new functionality into the game, we’ll typically create some new settings as well. Instead of adding settings throughout the code, let’s write a module called <span class="literal">settings</span> that contains a class called <span class="literal">Settings</span> to store all these values in one place. This approach allows us to work with just one settings object any time we need to access an individual setting. This also makes it easier to modify the game’s appearance and behavior as our project grows: to modify the game, we’ll simply change some values in <em class="calibre3">settings.py</em>, which we’ll create next, instead of searching for different settings throughout the project.</p>
<p class="indent">Create a new file named <em class="calibre3">settings.py</em> inside your <em class="calibre3">alien_invasion</em> folder, and add this initial <span class="literal">Settings</span> class:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">class Settings:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""A class to store all settings for Alien Invasion."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize the game's settings."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Screen settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen_width = 1200<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen_height = 800<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bg_color = (230, 230, 230)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-230" class="calibre"></span>To make an instance of <span class="literal">Settings</span> in the project and use it to access our settings, we need to modify <em class="calibre3">alien_invasion.py</em> as follows:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">import pygame</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from settings import Settings<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class AlienInvasion:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Overall class to manage game assets and behavior."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize the game, and create game resources."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.init()</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings = Settings()<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = pygame.display.set_mode(<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(self.settings.screen_width, self.settings.screen_height))<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.set_caption("Alien Invasion")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Redraw the screen during each pass through the loop.</span><br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.fill(self.settings.bg_color)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make the most recently drawn screen visible.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.flip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We import <span class="literal">Settings</span> into the main program file. Then we create an instance of <span class="literal">Settings</span> and assign it to <span class="literal">self.settings</span> <span class="ent">➊</span>, after making the call to <span class="literal">pygame.init()</span>. When we create a screen <span class="ent">➋</span>, we use the <span class="literal">screen_width</span> and <span class="literal">screen_height</span> attributes of <span class="literal">self.settings</span>, and then we use <span class="literal">self.settings</span> to access the background color when filling the screen at <span class="ent">➌</span> as well.</p>
<p class="indent">When you run <em class="calibre3">alien_invasion.py</em> now you won’t yet see any changes, because all we’ve done is move the settings we were already using elsewhere. Now we’re ready to start adding new elements to the screen.</p>
<h3 class="h2" id="calibre_link-916"><strong class="calibre2">Adding the Ship Image</strong></h3>
<p class="noindent">Let’s add the ship to our game. To draw the player’s ship on the screen, we’ll load an image and then use the Pygame <span class="literal">blit()</span> method to draw the image.</p>
<p class="indent">When you’re choosing artwork for your games, be sure to pay attention to licensing. The safest and cheapest way to start is to use freely licensed graphics that you can use and modify, from a website like <em class="calibre3"><a href="https://pixabay.com/" class="calibre6">https://pixabay.com/</a></em>.</p>
<p class="indent">You can use almost any type of image file in your game, but it’s easiest when you use a bitmap (<em class="calibre3">.bmp</em>) file because Pygame loads bitmaps by default. Although you can configure Pygame to use other file types, some file types <span type="pagebreak" id="calibre_link-214" class="calibre"></span>depend on certain image libraries that must be installed on your computer. Most images you’ll find are in <em class="calibre3">.jpg</em> or <em class="calibre3">.png</em> formats, but you can convert them to bitmaps using tools like Photoshop, GIMP, and Paint.</p>
<p class="indent">Pay particular attention to the background color in your chosen image. Try to find a file with a transparent or solid background that you can replace with any background color using an image editor. Your games will look best if the image’s background color matches your game’s background color. Alternatively, you can match your game’s background to the image’s background.</p>
<p class="indent">For <em class="calibre3">Alien Invasion</em>, you can use the file <em class="calibre3">ship.bmp</em> (<a href="#calibre_link-97" class="calibre6">Figure 12-1</a>), which is available in the book’s resources at <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em>. The file’s background color matches the settings we’re using in this project. Make a folder called <em class="calibre3">images</em> inside your main <em class="calibre3">alien_invasion</em> project folder. Save the file <em class="calibre3">ship.bmp</em> in the <em class="calibre3">images</em> folder.</p>
<div class="image1"><a id="calibre_link-97" class="calibre6"></a><img src="images/000023.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 12-1: The ship for</em> Alien Invasion</p>
<h4 class="h3" id="calibre_link-917"><strong class="calibre2"><em class="calibre3">Creating the Ship Class</em></strong></h4>
<p class="noindent">After choosing an image for the ship, we need to display it on the screen. To use our ship, we’ll create a new <span class="literal">ship</span> module that will contain the class <span class="literal">Ship</span>. This class will manage most of the behavior of the player’s ship:</p>
<p class="margin"><em class="calibre3">ship.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import pygame<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class Ship:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A class to manage the ship."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, ai_game):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize the ship and set its starting position."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = ai_game.screen<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen_rect = ai_game.screen.get_rect()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Load the ship image and get its rect.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.image = pygame.image.load('images/ship.bmp')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect = self.image.get_rect()<br class="calibre4" />
<span type="pagebreak" id="calibre_link-527" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Start each new ship at the bottom center of the screen.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.midbottom = self.screen_rect.midbottom<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def blitme(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Draw the ship at its current location."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.blit(self.image, self.rect)</p>
<p class="indent">Pygame is efficient because it lets you treat all game elements like rectangles (<em class="calibre3">rects</em>), even if they’re not exactly shaped like rectangles. Treating an element as a rectangle is efficient because rectangles are simple geometric shapes. When Pygame needs to figure out whether two game elements have collided, for example, it can do this more quickly if it treats each object as a rectangle. This approach usually works well enough that no one playing the game will notice that we’re not working with the exact shape of each game element. We’ll treat the ship and the screen as rectangles in this class.</p>
<p class="indent">We import the <span class="literal">pygame</span> module before defining the class. The <span class="literal">__init__()</span> method of <span class="literal">Ship</span> takes two parameters: the <span class="literal">self</span> reference and a reference to the current instance of the <span class="literal">AlienInvasion</span> class. This will give <span class="literal">Ship</span> access to all the game resources defined in <span class="literal">AlienInvasion</span>. At <span class="ent">➊</span> we assign the screen to an attribute of <span class="literal">Ship</span>, so we can access it easily in all the methods in this class. At <span class="ent">➋</span> we access the screen’s <span class="literal">rect</span> attribute using the <span class="literal">get_rect()</span> method and assign it to <span class="literal">self.screen_rect</span>. Doing so allows us to place the ship in the correct location on the screen.</p>
<p class="indent">To load the image, we call <span class="literal">pygame.image.load()</span> <span class="ent">➌</span> and give it the location of our ship image. This function returns a surface representing the ship, which we assign to <span class="literal">self.image</span>. When the image is loaded, we call <span class="literal">get_rect()</span> to access the ship surface’s <span class="literal">rect</span> attribute so we can later use it to place the ship.</p>
<p class="indent">When you’re working with a <span class="literal">rect</span> object, you can use the x- and y-coordinates of the top, bottom, left, and right edges of the rectangle, as well as the center, to place the object. You can set any of these values to establish the current position of the rect. When you’re centering a game element, work with the <span class="literal">center</span>, <span class="literal">centerx</span>, or <span class="literal">centery</span> attributes of a rect. When you’re working at an edge of the screen, work with the <span class="literal">top</span>, <span class="literal">bottom</span>, <span class="literal">left</span>, or <span class="literal">right</span> attributes. There are also attributes that combine these properties, such as <span class="literal">midbottom</span>, <span class="literal">midtop</span>, <span class="literal">midleft</span>, and <span class="literal">midright</span>. When you’re adjusting the horizontal or vertical placement of the rect, you can just use the <span class="literal">x</span> and <span class="literal">y</span> attributes, which are the x- and y-coordinates of its top-left corner. These attributes spare you from having to do calculations that game developers formerly had to do manually, and you’ll use them often.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">In Pygame, the origin (0, 0) is at the top-left corner of the screen, and coordinates increase as you go down and to the right. On a 1200 by 800 screen, the origin is at the top-left corner, and the bottom-right corner has the coordinates (1200, 800). These coordinates refer to the game window, not the physical screen.</em></p>
</div>
<p class="indent"><span type="pagebreak" id="calibre_link-215" class="calibre"></span>We’ll position the ship at the bottom center of the screen. To do so, make the value of <span class="literal">self.rect.midbottom</span> match the <span class="literal">midbottom</span> attribute of the screen’s rect <span class="ent">➍</span>. Pygame uses these <span class="literal">rect</span> attributes to position the ship image so it’s centered horizontally and aligned with the bottom of the screen.</p>
<p class="indent">At <span class="ent">➎</span>, we define the <span class="literal">blitme()</span> method, which draws the image to the screen at the position specified by <span class="literal">self.rect</span>.</p>
<h4 class="h3" id="calibre_link-918"><strong class="calibre2"><em class="calibre3">Drawing the Ship to the Screen</em></strong></h4>
<p class="noindent">Now let’s update <em class="calibre3">alien_invasion.py</em> so it creates a ship and calls the ship’s <span class="literal">blitme()</span> method:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from settings import Settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;from ship import Ship<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class AlienInvasion:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Overall class to manage game assets and behavior."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.set_caption("Alien Invasion")</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship = Ship(self)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Redraw the screen during each pass through the loop.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.fill(self.settings.bg_color)</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.blitme()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make the most recently drawn screen visible.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.flip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We import <span class="literal">Ship</span> and then make an instance of <span class="literal">Ship</span> after the screen has been created <span class="ent">➊</span>. The call to <span class="literal">Ship()</span> requires one argument, an instance of <span class="literal">AlienInvasion</span>. The <span class="literal">self</span> argument here refers to the current instance of <span class="literal">AlienInvasion</span>. This is the parameter that gives <span class="literal">Ship</span> access to the game’s resources, such as the <span class="literal">screen</span> object. We assign this <span class="literal">Ship</span> instance to <span class="literal">self.ship</span>.</p>
<p class="indent">After filling the background, we draw the ship on the screen by calling <span class="literal">ship.blitme()</span>, so the ship appears on top of the background <span class="ent">➋</span>.</p>
<p class="indent">When you run <em class="calibre3">alien_invasion.py</em> now, you should see an empty game screen with the rocket ship sitting at the bottom center, as shown in <a href="#calibre_link-98" class="calibre6">Figure 12-2</a>.</p>
<div class="image1"><span type="pagebreak" id="calibre_link-500" class="calibre"></span><a id="calibre_link-98" class="calibre6"></a><img src="images/000030.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 12-2:</em> Alien Invasion <em class="calibre3">with the ship at the bottom center of the screen</em></p>
<h3 class="h2" id="calibre_link-919"><strong class="calibre2">Refactoring: The _check_events() and _update_screen() Methods</strong></h3>
<p class="noindent">In large projects, you’ll often refactor code you’ve written before adding more code. Refactoring simplifies the structure of the code you’ve already written, making it easier to build on. In this section, we’ll break the <span class="literal">run_game()</span> method, which is getting lengthy, into two helper methods. A <em class="calibre3">helper method</em> does work inside a class but isn’t meant to be called through an instance. In Python, a single leading underscore indicates a helper method.</p>
<h4 class="h3" id="calibre_link-920"><strong class="calibre2"><em class="calibre3">The _check_events() Method</em></strong></h4>
<p class="noindent">We’ll move the code that manages events to a separate method called <span class="literal">_check_events()</span>. This will simplify <span class="literal">run_game()</span> and isolate the event management loop. Isolating the event loop allows you to manage events separately from other aspects of the game, such as updating the screen.</p>
<p class="indent">Here’s the <span class="literal">AlienInvasion</span> class with the new <span class="literal">_check_events()</span> method, which only affects the code in <span class="literal">run_game()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start the main loop for the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._check_events()<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-501" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Redraw the screen during each pass through the loop.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _check_events(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Respond to keypresses and mouse events."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for event in pygame.event.get():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.type == pygame.QUIT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">sys.exit()</span></p>
<p class="indent">We make a new <span class="literal">_check_events()</span> method <span class="ent">➋</span> and move the lines that check whether the player has clicked to close the window into this new method.</p>
<p class="indent">To call a method from within a class, use dot notation with the variable <span class="literal">self</span> and the name of the method <span class="ent">➊</span>. We call the method from inside the <span class="literal">while</span> loop in <span class="literal">run_game()</span>.</p>
<h4 class="h3" id="calibre_link-921"><strong class="calibre2"><em class="calibre3">The _update_screen() Method</em></strong></h4>
<p class="noindent">To further simplify <span class="literal">run_game()</span>, we’ll move the code for updating the screen to a separate method called <span class="literal">_update_screen()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start the main loop for the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._check_events()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._update_screen()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_events(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def _update_screen(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Update images on the screen, and flip to the new screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.fill(self.settings.bg_color)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.blitme()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.flip()</span></p>
<p class="indent">We moved the code that draws the background and the ship and flips the screen to <span class="literal">_update_screen()</span>. Now the body of the main loop in <span class="literal">run_game()</span> is much simpler. It’s easy to see that we’re looking for new events and updating the screen on each pass through the loop.</p>
<p class="indent">If you’ve already built a number of games, you’ll probably start out by breaking your code into methods like these. But if you’ve never tackled a project like this, you probably won’t know how to structure your code. This approach of writing code that works and then restructuring it as it grows more complex gives you an idea of a realistic development process: you start out writing your code as simply as possible, and then refactor it as your project becomes more complex.</p>
<p class="indent">Now that we’ve restructured the code to make it easier to add to, we can work on the dynamic aspects of the game!</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-530" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-922"><strong class="calibre2">12-1. Blue Sky:</strong> Make a Pygame window with a blue background.</p>
<p class="sparal" id="calibre_link-923"><strong class="calibre2">12-2. Game Character:</strong> Find a bitmap image of a game character you like or convert an image to a bitmap. Make a class that draws the character at the center of the screen and match the background color of the image to the background color of the screen, or vice versa.</p>
</div>
<h3 class="h2" id="calibre_link-924"><strong class="calibre2">Piloting the Ship</strong></h3>
<p class="noindent">Next, we’ll give the player the ability to move the ship right and left. We’ll write code that responds when the player presses the right or left arrow key. We’ll focus on movement to the right first, and then we’ll apply the same principles to control movement to the left. As we add this code, you’ll learn how to control the movement of images on the screen and respond to user input.</p>
<h4 class="h3" id="calibre_link-925"><strong class="calibre2"><em class="calibre3">Responding to a Keypress</em></strong></h4>
<p class="noindent">Whenever the player presses a key, that keypress is registered in Pygame as an event. Each event is picked up by the <span class="literal">pygame.event.get()</span> method. We need to specify in our <span class="literal">_check_events()</span> method what kind of events we want the game to check for. Each keypress is registered as a <span class="literal">KEYDOWN</span> event.</p>
<p class="indent">When Pygame detects a <span class="literal">KEYDOWN</span> event, we need to check whether the key that was pressed is one that triggers a certain action. For example, if the player presses the right arrow key, we want to increase the ship’s <span class="literal">rect.x</span> value to move the ship to the right:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_events(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to keypresses and mouse events."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for event in pygame.event.get():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.type == pygame.QUIT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">sys.exit()</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif event.type == pygame.KEYDOWN:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if event.key == pygame.K_RIGHT:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Move the ship to the right.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.rect.x += 1</p>
<p class="indent">Inside <span class="literal">_check_events()</span> we add an <span class="literal">elif</span> block to the event loop to respond when Pygame detects a <span class="literal">KEYDOWN</span> event <span class="ent">➊</span>. We check whether the key pressed, <span class="literal">event.key</span>, is the right arrow key <span class="ent">➋</span>. The right arrow key is represented by <span class="literal">pygame.K_RIGHT</span>. If the right arrow key was pressed, we move the ship to the right by increasing the value of <span class="literal">self.ship.rect.x</span> by 1 <span class="ent">➌</span>.</p>
<p class="indent">When you run <em class="calibre3">alien_invasion.py</em> now, the ship should move to the right one pixel every time you press the right arrow key. That’s a start, but it’s not an efficient way to control the ship. Let’s improve this control by allowing continuous movement.</p>
<h4 class="h3" id="calibre_link-926"><span type="pagebreak" id="calibre_link-229" class="calibre"></span><strong class="calibre2"><em class="calibre3">Allowing Continuous Movement</em></strong></h4>
<p class="noindent">When the player holds down the right arrow key, we want the ship to continue moving right until the player releases the key. We’ll have the game detect a <span class="literal">pygame.KEYUP</span> event so we’ll know when the right arrow key is released; then we’ll use the <span class="literal">KEYDOWN</span> and <span class="literal">KEYUP</span> events together with a flag called <span class="literal">moving_right</span> to implement continuous motion.</p>
<p class="indent">When the <span class="literal">moving_right</span> flag is <span class="literal">False</span>, the ship will be motionless. When the player presses the right arrow key, we’ll set the flag to <span class="literal">True</span>, and when the player releases the key, we’ll set the flag to <span class="literal">False</span> again.</p>
<p class="indent">The <span class="literal">Ship</span> class controls all attributes of the ship, so we’ll give it an attribute called <span class="literal">moving_right</span> and an <span class="literal">update()</span> method to check the status of the <span class="literal">moving_right</span> flag. The <span class="literal">update()</span> method will change the position of the ship if the flag is set to <span class="literal">True</span>. We’ll call this method once on each pass through the <span class="literal">while</span> loop to update the position of the ship.</p>
<p class="indent">Here are the changes to <span class="literal">Ship</span>:</p>
<p class="margin"><em class="calibre3">ship.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Ship:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A class to manage the ship."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Start each new ship at the bottom center of the screen.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.rect.midbottom = self.screen_rect.midbottom</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Movement flag<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.moving_right = False<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def update(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Update the ship's position based on the movement flag."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.moving_right:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.x += 1<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def blitme(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We add a <span class="literal">self.moving_right</span> attribute in the <span class="literal">__init__()</span> method and set it to <span class="literal">False</span> initially <span class="ent">➊</span>. Then we add <span class="literal">update()</span>, which moves the ship right if the flag is <span class="literal">True</span> <span class="ent">➋</span>. The <span class="literal">update()</span> method will be called through an instance of <span class="literal">Ship</span>, so it’s not considered a helper method.</p>
<p class="indent">Now we need to modify <span class="literal">_check_events()</span> so that <span class="literal">moving_right</span> is set to <span class="literal">True</span> when the right arrow key is pressed and <span class="literal">False</span> when the key is released:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_events(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to keypresses and mouse events."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for event in pygame.event.get():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.type == pygame.KEYDOWN:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.key == pygame.K_RIGHT:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.moving_right = True<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif event.type == pygame.KEYUP:<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1355" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if event.key == pygame.K_RIGHT:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.moving_right = False</p>
<p class="indent">At <span class="ent">➊</span>, we modify how the game responds when the player presses the right arrow key: instead of changing the ship’s position directly, we merely set <span class="literal">moving_right</span> to <span class="literal">True</span>. At <span class="ent">➋</span>, we add a new <span class="literal">elif</span> block, which responds to <span class="literal">KEYUP</span> events. When the player releases the right arrow key (<span class="literal">K_RIGHT</span>), we set <span class="literal">moving_right</span> to <span class="literal">False</span>.</p>
<p class="indent">Next, we modify the <span class="literal">while</span> loop in <span class="literal">run_game()</span> so it calls the ship’s <span class="literal">update()</span> method on each pass through the loop:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start the main loop for the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._check_events()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.update()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_screen()</span></p>
<p class="indent">The ship’s position will be updated after we’ve checked for keyboard events and before we update the screen. This allows the ship’s position to be updated in response to player input and ensures the updated position will be used when drawing the ship to the screen.</p>
<p class="indent">When you run <em class="calibre3">alien_invasion.py</em> and hold down the right arrow key, the ship should move continuously to the right until you release the key.</p>
<h4 class="h3" id="calibre_link-927"><strong class="calibre2"><em class="calibre3">Moving Both Left and Right</em></strong></h4>
<p class="noindent">Now that the ship can move continuously to the right, adding movement to the left is straightforward. Again, we’ll modify the <span class="literal">Ship</span> class and the <span class="literal">_check_events()</span> method. Here are the relevant changes to <span class="literal">__init__()</span> and <span class="literal">update()</span> in <span class="literal">Ship</span>:</p>
<p class="margin"><em class="calibre3">ship.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Movement flags<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.moving_right = False</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.moving_left = False<br class="calibre4" />
<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Update the ship's position based on movement flags."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if self.moving_right:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.rect.x += 1</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.moving_left:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.x -= 1</p>
<p class="indent">In <span class="literal">__init__()</span>, we add a <span class="literal">self.moving_left</span> flag. In <span class="literal">update()</span>, we use two separate <span class="literal">if</span> blocks rather than an <span class="literal">elif</span> to allow the ship’s <span class="literal">rect.x</span> value to be increased and then decreased when both arrow keys are held down. This results in the ship standing still. If we used <span class="literal">elif</span> for motion to the left, the <span type="pagebreak" id="calibre_link-227" class="calibre"></span>right arrow key would always have priority. Doing it this way makes the movements more accurate when switching from right to left when the player might momentarily hold down both keys.</p>
<p class="indent">We have to make two adjustments to <span class="literal">_check_events()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_events(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to keypresses and mouse events."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for event in pygame.event.get():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.type == pygame.KEYDOWN:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.key == pygame.K_RIGHT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.moving_right = True</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif event.key == pygame.K_LEFT:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.moving_left = True<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.type == pygame.KEYUP:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.key == pygame.K_RIGHT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.moving_right = False</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif event.key == pygame.K_LEFT:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.moving_left = False</p>
<p class="indent">If a <span class="literal">KEYDOWN</span> event occurs for the <span class="literal">K_LEFT</span> key, we set <span class="literal">moving_left</span> to <span class="literal">True</span>. If a <span class="literal">KEYUP</span> event occurs for the <span class="literal">K_LEFT</span> key, we set <span class="literal">moving_left</span> to <span class="literal">False</span>. We can use <span class="literal">elif</span> blocks here because each event is connected to only one key. If the player presses both keys at once, two separate events will be detected.</p>
<p class="indent">When you run <em class="calibre3">alien_invasion.py</em> now, you should be able to move the ship continuously to the right and left. If you hold down both keys, the ship should stop moving.</p>
<p class="indent">Next, we’ll further refine the ship’s movement. Let’s adjust the ship’s speed and limit how far the ship can move so it can’t disappear off the sides of the screen.</p>
<h4 class="h3" id="calibre_link-928"><strong class="calibre2"><em class="calibre3">Adjusting the Ship’s Speed</em></strong></h4>
<p class="noindent">Currently, the ship moves one pixel per cycle through the <span class="literal">while</span> loop, but we can take finer control of the ship’s speed by adding a <span class="literal">ship_speed</span> attribute to the <span class="literal">Settings</span> class. We’ll use this attribute to determine how far to move the ship on each pass through the loop. Here’s the new attribute in <em class="calibre3">settings.py</em>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">class Settings:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A class to store all settings for Alien Invasion."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ship settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship_speed = 1.5</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1356" class="calibre"></span>We set the initial value of <span class="literal">ship_speed</span> to <span class="literal">1.5</span>. When the ship moves now, its position is adjusted by 1.5 pixels rather than 1 pixel on each pass through the loop.</p>
<p class="indent">We’re using decimal values for the speed setting to give us finer control of the ship’s speed when we increase the tempo of the game later on. However, rect attributes such as <span class="literal">x</span> store only integer values, so we need to make some modifications to <span class="literal">Ship</span>:</p>
<p class="margin"><em class="calibre3">ship.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Ship:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A class to manage the ship."""</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize the ship and set its starting position."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen = ai_game.screen</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings = ai_game.settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Start each new ship at the bottom center of the screen.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store a decimal value for the ship's horizontal position.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x = float(self.rect.x)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Movement flags</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.moving_right = False</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.moving_left = False</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Update the ship's position based on movement flags."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update the ship's x value, not the rect.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if self.moving_right:</span><br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x += self.settings.ship_speed<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if self.moving_left:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x -= self.settings.ship_speed<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update rect object from self.x.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.x = self.x<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def blitme(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We create a <span class="literal">settings</span> attribute for <span class="literal">Ship</span>, so we can use it in <span class="literal">update()</span> <span class="ent">➊</span>. Because we’re adjusting the position of the ship by fractions of a pixel, we need to assign the position to a variable that can store a decimal value. You can use a decimal value to set an attribute of <span class="literal">rect</span>, but the <span class="literal">rect</span> will only keep the integer portion of that value. To keep track of the ship’s position accurately, we define a new <span class="literal">self.x</span> attribute that can hold decimal values <span class="ent">➋</span>. We use the <span class="literal">float()</span> function to convert the value of <span class="literal">self.rect.x</span> to a decimal and assign this value to <span class="literal">self.x</span>.</p>
<p class="indent">Now when we change the ship’s position in <span class="literal">update()</span>, the value of <span class="literal">self.x</span> is adjusted by the amount stored in <span class="literal">settings.ship_speed</span> <span class="ent">➌</span>. After <span class="literal">self.x</span> has been updated, we use the new value to update <span class="literal">self.rect.x</span>, which controls <span type="pagebreak" id="calibre_link-228" class="calibre"></span>the position of the ship <span class="ent">➍</span>. Only the integer portion of <span class="literal">self.x</span> will be stored in <span class="literal">self.rect.x</span>, but that’s fine for displaying the ship.</p>
<p class="indent">Now we can change the value of <span class="literal">ship_speed</span>, and any value greater than one will make the ship move faster. This will help make the ship respond quickly enough to shoot down aliens, and it will let us change the tempo of the game as the player progresses in gameplay.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you’re using macOS, you might notice that the ship moves very slowly, even with a high speed setting. You can remedy this problem by running the game in fullscreen mode, which we’ll implement shortly.</em></p>
</div>
<h4 class="h3" id="calibre_link-929"><strong class="calibre2"><em class="calibre3">Limiting the Ship’s Range</em></strong></h4>
<p class="noindent">At this point, the ship will disappear off either edge of the screen if you hold down an arrow key long enough. Let’s correct this so the ship stops moving when it reaches the screen’s edge. We do this by modifying the <span class="literal">update()</span> method in <span class="literal">Ship</span>:</p>
<p class="margin"><em class="calibre3">ship.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Update the ship's position based on movement flags."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Update the ship's x value, not the rect.</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.moving_right and self.rect.right &lt; self.screen_rect.right:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.x += self.settings.ship_speed</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.moving_left and self.rect.left &gt; 0:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.x -= self.settings.ship_speed</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Update rect object from self.x.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.rect.x = self.x</span></p>
<p class="indent">This code checks the position of the ship before changing the value of <span class="literal">self.x</span>. The code <span class="literal">self.rect.right</span> returns the x-coordinate of the right edge of the ship’s <span class="literal">rect</span>. If this value is less than the value returned by <span class="literal">self.screen_rect.right</span>, the ship hasn’t reached the right edge of the screen <span class="ent">➊</span>. The same goes for the left edge: if the value of the left side of the <span class="literal">rect</span> is greater than zero, the ship hasn’t reached the left edge of the screen <span class="ent">➋</span>. This ensures the ship is within these bounds before adjusting the value of <span class="literal">self.x</span>.</p>
<p class="indent">When you run <em class="calibre3">alien_invasion.py</em> now, the ship should stop moving at either edge of the screen. This is pretty cool; all we’ve done is add a conditional test in an <span class="literal">if</span> statement, but it feels like the ship hits a wall or a force field at either edge of the screen!</p>
<h4 class="h3" id="calibre_link-930"><strong class="calibre2"><em class="calibre3">Refactoring _check_events()</em></strong></h4>
<p class="noindent">The <span class="literal">_check_events()</span> method will increase in length as we continue to develop the game, so let’s break <span class="literal">_check_events()</span> into two more methods: one that handles <span class="literal">KEYDOWN</span> events and another that handles <span class="literal">KEYUP</span> events:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_events(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to keypresses and mouse events."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for event in pygame.event.get():</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-525" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.type == pygame.QUIT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">sys.exit()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.type == pygame.KEYDOWN:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._check_keydown_events(event)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.type == pygame.KEYUP:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._check_keyup_events(event)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def _check_keydown_events(self, event):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Respond to keypresses."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.key == pygame.K_RIGHT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.moving_right = True</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.key == pygame.K_LEFT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.moving_left = True</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def _check_keyup_events(self, event):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Respond to key releases."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.key == pygame.K_RIGHT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.moving_right = False</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.key == pygame.K_LEFT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.moving_left = False</span></p>
<p class="indent">We make two new helper methods: <span class="literal">_check_keydown_events()</span> and <span class="literal">_check_keyup_events()</span>. Each needs a <span class="literal">self</span> parameter and an <span class="literal">event</span> parameter. The bodies of these two methods are copied from <span class="literal">_check_events()</span>, and we’ve replaced the old code with calls to the new methods. The <span class="literal">_check_events()</span> method is simpler now with this cleaner code structure, which will make it easier to develop further responses to player input.</p>
<h4 class="h3" id="calibre_link-931"><strong class="calibre2"><em class="calibre3">Pressing Q to Quit</em></strong></h4>
<p class="noindent">Now that we’re responding to keypresses efficiently, we can add another way to quit the game. It gets tedious to click the X at the top of the game window to end the game every time you test a new feature, so we’ll add a keyboard shortcut to end the game when the player presses Q:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_keydown_events(self, event):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.key == pygame.K_LEFT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.moving_left = True</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif event.key == pygame.K_q:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()</p>
<p class="indent">In <span class="literal">_check_keydown_events()</span>, we add a new block that ends the game when the player presses Q. Now, when testing, you can press Q to close the game rather than using your cursor to close the window.</p>
<h4 class="h3" id="calibre_link-932"><strong class="calibre2"><em class="calibre3">Running the Game in Fullscreen Mode</em></strong></h4>
<p class="noindent">Pygame has a fullscreen mode that you might like better than running the game in a regular window. Some games look better in fullscreen mode, and macOS users might see better performance in fullscreen mode.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1357" class="calibre"></span>To run the game in fullscreen mode, make the following changes in <span class="literal">__init__()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize the game, and create game resources."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.init()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.settings = Settings()</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = pygame.display.set_mode((0, 0), pygame.FULLSCREEN)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings.screen_width = self.screen.get_rect().width<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings.screen_height = self.screen.get_rect().height<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.set_caption("Alien Invasion")</span></p>
<p class="indent">When creating the screen surface, we pass a size of <span class="literal">(0, 0)</span> and the parameter <span class="literal">pygame.FULLSCREEN</span> <span class="ent">➊</span>. This tells Pygame to figure out a window size that will fill the screen. Because we don’t know the width and height of the screen ahead of time, we update these settings after the screen is created <span class="ent">➋</span>. We use the <span class="literal">width</span> and <span class="literal">height</span> attributes of the screen’s rect to update the <span class="literal">settings</span> object.</p>
<p class="indent">If you like how the game looks or behaves in fullscreen mode, keep these settings. If you liked the game better in its own window, you can revert back to the original approach where we set a specific screen size for the game.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Make sure you can quit by pressing Q before running the game in fullscreen mode; Pygame offers no default way to quit a game while in fullscreen mode.</em></p>
</div>
<h3 class="h2" id="calibre_link-933"><strong class="calibre2">A Quick Recap</strong></h3>
<p class="noindent">In the next section, we’ll add the ability to shoot bullets, which involves adding a new file called <em class="calibre3">bullet.py</em> and making some modifications to some of the files we’re already using. Right now, we have three files containing a number of classes and methods. To be clear about how the project is organized, let’s review each of these files before adding more functionality.</p>
<h4 class="h3" id="calibre_link-934"><strong class="calibre2"><em class="calibre3">alien_invasion.py</em></strong></h4>
<p class="noindent">The main file, <em class="calibre3">alien_invasion.py</em>, contains the <span class="literal">AlienInvasion</span> class. This class creates a number of important attributes used throughout the game: the settings are assigned to <span class="literal">settings</span>, the main display surface is assigned to <span class="literal">screen</span>, and a <span class="literal">ship</span> instance is created in this file as well. The main loop of the game, a <span class="literal">while</span> loop, is also stored in this module. The <span class="literal">while</span> loop calls <span class="literal">_check_events()</span>, <span class="literal">ship.update()</span>, and <span class="literal">_update_screen()</span>.</p>
<p class="indent">The <span class="literal">_check_events()</span> method detects relevant events, such as keypresses and releases, and processes each of these types of events through the methods <span class="literal">_check_keydown_events()</span> and <span class="literal">_check_keyup_events()</span>. For now, <span type="pagebreak" id="calibre_link-200" class="calibre"></span>these methods manage the ship’s movement. The <span class="literal">AlienInvasion</span> class also contains <span class="literal">_update_screen()</span>, which redraws the screen on each pass through the main loop.</p>
<p class="indent">The <em class="calibre3">alien_invasion.py</em> file is the only file you need to run when you want to play <em class="calibre3">Alien Invasion</em>. The other files&mdash;<em class="calibre3">settings.py</em> and <em class="calibre3">ship.py</em>&mdash;contain code that is imported into this file.</p>
<h4 class="h3" id="calibre_link-935"><strong class="calibre2"><em class="calibre3">settings.py</em></strong></h4>
<p class="noindent">The <em class="calibre3">settings.py</em> file contains the <span class="literal">Settings</span> class. This class only has an <span class="literal">__init__()</span> method, which initializes attributes controlling the game’s appearance and the ship’s speed.</p>
<h4 class="h3" id="calibre_link-936"><strong class="calibre2"><em class="calibre3">ship.py</em></strong></h4>
<p class="noindent">The <em class="calibre3">ship.py</em> file contains the <span class="literal">Ship</span> class. The <span class="literal">Ship</span> class has an <span class="literal">__init__()</span> method, an <span class="literal">update()</span> method to manage the ship’s position, and a <span class="literal">blitme()</span> method to draw the ship to the screen. The image of the ship is stored in <em class="calibre3">ship.bmp</em>, which is in the <em class="calibre3">images</em> folder.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-937"><strong class="calibre2">12-3. Pygame Documentation:</strong> We’re far enough into the game now that you might want to look at some of the Pygame documentation. The Pygame home page is at <em class="calibre3"><a href="https://www.pygame.org/" class="calibre6">https://www.pygame.org/</a></em>, and the home page for the documentation is at <em class="calibre3"><a href="https://www.pygame.org/docs/" class="calibre6">https://www.pygame.org/docs/</a></em>. Just skim the documentation for now. You won’t need it to complete this project, but it will help if you want to modify <em class="calibre3">Alien Invasion</em> or make your own game afterward.</p>
<p class="sparal" id="calibre_link-938"><strong class="calibre2">12-4. Rocket:</strong> Make a game that begins with a rocket in the center of the screen. Allow the player to move the rocket up, down, left, or right using the four arrow keys. Make sure the rocket never moves beyond any edge of the screen.</p>
<p class="sparal" id="calibre_link-939"><strong class="calibre2">12-5. Keys:</strong> Make a Pygame file that creates an empty screen. In the event loop, print the <span class="literal1">event.key</span> attribute whenever a <span class="literal1">pygame.KEYDOWN</span> event is detected. Run the program and press various keys to see how Pygame responds.</p>
</div>
<h3 class="h2" id="calibre_link-940"><strong class="calibre2">Shooting Bullets</strong></h3>
<p class="noindent">Now let’s add the ability to shoot bullets. We’ll write code that fires a bullet, which is represented by a small rectangle, when the player presses the spacebar. Bullets will then travel straight up the screen until they disappear off the top of the screen.</p>
<h4 class="h3" id="calibre_link-941"><span type="pagebreak" id="calibre_link-205" class="calibre"></span><strong class="calibre2"><em class="calibre3">Adding the Bullet Settings</em></strong></h4>
<p class="noindent">At the end of the <span class="literal">__init__()</span> method, we’ll update <em class="calibre3">settings.py</em> to include the values we’ll need for a new <span class="literal">Bullet</span> class:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Bullet settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullet_speed = 1.0<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullet_width = 3<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullet_height = 15<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullet_color = (60, 60, 60)</p>
<p class="indent">These settings create dark gray bullets with a width of 3 pixels and a height of 15 pixels. The bullets will travel slightly slower than the ship.</p>
<h4 class="h3" id="calibre_link-942"><strong class="calibre2"><em class="calibre3">Creating the Bullet Class</em></strong></h4>
<p class="noindent">Now create a <em class="calibre3">bullet.py</em> file to store our <span class="literal">Bullet</span> class. Here’s the first part of <em class="calibre3">bullet.py</em>:</p>
<p class="margin"><em class="calibre3">bullet.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import pygame<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from pygame.sprite import Sprite<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class Bullet(Sprite):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A class to manage bullets fired from the ship"""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, ai_game):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Create a bullet object at the ship's current position."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super().__init__()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = ai_game.screen<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings = ai_game.settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.color = self.settings.bullet_color<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a bullet rect at (0, 0) and then set correct position.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect = pygame.Rect(0, 0, self.settings.bullet_width,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings.bullet_height)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.midtop = ai_game.ship.rect.midtop<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store the bullet's position as a decimal value.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.y = float(self.rect.y)</p>
<p class="indent">The <span class="literal">Bullet</span> class inherits from <span class="literal">Sprite</span>, which we import from the <span class="literal">pygame.sprite</span> module. When you use sprites, you can group related elements in your game and act on all the grouped elements at once. To create a bullet instance, <span class="literal">__init__()</span> needs the current instance of <span class="literal">AlienInvasion</span>, and we call <span class="literal">super()</span> to inherit properly from <span class="literal">Sprite</span>. We also set attributes for the screen and settings objects, and for the bullet’s color.</p>
<p class="indent">At <span class="ent">➊</span>, we create the bullet’s <span class="literal">rect</span> attribute. The bullet isn’t based on an image, so we have to build a rect from scratch using the <span class="literal">pygame.Rect()</span> class. This class requires the x- and y-coordinates of the top-left corner of the <span type="pagebreak" id="calibre_link-207" class="calibre"></span><span class="literal">rect</span>, and the width and height of the <span class="literal">rect</span>. We initialize the <span class="literal">rect</span> at (0, 0), but we’ll move it to the correct location in the next line, because the bullet’s position depends on the ship’s position. We get the width and height of the bullet from the values stored in <span class="literal">self.settings</span>.</p>
<p class="indent">At <span class="ent">➋</span>, we set the bullet’s <span class="literal">midtop</span> attribute to match the ship’s <span class="literal">midtop</span> attribute. This will make the bullet emerge from the top of the ship, making it look like the bullet is fired from the ship. We store a decimal value for the bullet’s y-coordinate so we can make fine adjustments to the bullet’s speed <span class="ent">➌</span>.</p>
<p class="indent">Here’s the second part of <em class="calibre3">bullet.py</em>, <span class="literal">update()</span> and <span class="literal">draw_bullet()</span>:</p>
<p class="margin"><em class="calibre3">bullet.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def update(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Move the bullet up the screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update the decimal position of the bullet.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.y -= self.settings.bullet_speed<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update the rect position.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.y = self.y<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def draw_bullet(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Draw the bullet to the screen."""<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pygame.draw.rect(self.screen, self.color, self.rect)</p>
<p class="indent">The <span class="literal">update()</span> method manages the bullet’s position. When a bullet is fired, it moves up the screen, which corresponds to a decreasing y-coordinate value. To update the position, we subtract the amount stored in <span class="literal">settings.bullet_speed</span> from <span class="literal">self.y</span> <span class="ent">➊</span>. We then use the value of <span class="literal">self.y</span> to set the value of <span class="literal">self.rect.y</span> <span class="ent">➋</span>.</p>
<p class="indent">The <span class="literal">bullet_speed</span> setting allows us to increase the speed of the bullets as the game progresses or as needed to refine the game’s behavior. Once a bullet is fired, we never change the value of its x-coordinate, so it will travel vertically in a straight line even if the ship moves.</p>
<p class="indent">When we want to draw a bullet, we call <span class="literal">draw_bullet()</span>. The <span class="literal">draw.rect()</span> function fills the part of the screen defined by the bullet’s <span class="literal">rect</span> with the color stored in <span class="literal">self.color</span> <span class="ent">➌</span>.</p>
<h4 class="h3" id="calibre_link-943"><strong class="calibre2"><em class="calibre3">Storing Bullets in a Group</em></strong></h4>
<p class="noindent">Now that we have a <span class="literal">Bullet</span> class and the necessary settings defined, we can write code to fire a bullet each time the player presses the spacebar. We’ll create a group in <span class="literal">AlienInvasion</span> to store all the live bullets so we can manage the bullets that have already been fired. This group will be an instance of the <span class="literal">pygame.sprite.Group</span> class, which behaves like a list with some extra functionality that’s helpful when building games. We’ll use this group to draw bullets to the screen on each pass through the main loop and to update each bullet’s position.</p>
<p class="indent">We’ll create the group in <span class="literal">__init__()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship = Ship(self)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets = pygame.sprite.Group()</p>
<p class="indent"><span type="pagebreak" id="calibre_link-203" class="calibre"></span>Then we need to update the position of the bullets on each pass through the <span class="literal">while</span> loop:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start the main loop for the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._check_events()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.update()</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets.update()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_screen()</span></p>
<p class="indent">When you call <span class="literal">update()</span> on a group <span class="ent">➊</span>, the group automatically calls <span class="literal">update()</span> for each sprite in the group. The line <span class="literal">self.bullets.update()</span> calls <span class="literal">bullet.update()</span> for each bullet we place in the group <span class="literal">bullets</span>.</p>
<h4 class="h3" id="calibre_link-944"><strong class="calibre2"><em class="calibre3">Firing Bullets</em></strong></h4>
<p class="noindent">In <span class="literal">AlienInvasion</span>, we need to modify <span class="literal">_check_keydown_events()</span> to fire a bullet when the player presses the spacebar. We don’t need to change <span class="literal">_check_keyup_events()</span> because nothing happens when the spacebar is released. We also need to modify <span class="literal">_update_screen()</span> to make sure each bullet is drawn to the screen before we call <span class="literal">flip()</span>.</p>
<p class="indent">We know there will be a bit of work to do when we fire a bullet, so let’s write a new method, <span class="literal">_fire_bullet()</span>, to handle this work:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from ship import Ship</span><br class="calibre4" />
<span class="ent">➊</span> from bullet import Bullet<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class AlienInvasion:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_keydown_events(self, event):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">elif event.key == pygame.K_q:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">sys.exit()</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif event.key == pygame.K_SPACE:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._fire_bullet()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_keyup_events(self, event):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _fire_bullet(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Create a new bullet and add it to the bullets group."""<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_bullet = Bullet(self)<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets.add(new_bullet)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_screen(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Update images on the screen, and flip to the new screen."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.fill(self.settings.bg_color)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.blitme()</span><br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for bullet in self.bullets.sprites():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bullet.draw_bullet()<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-202" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.flip()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">First, we import <span class="literal">Bullet</span> <span class="ent">➊</span>. Then we call <span class="literal">_fire_bullet()</span> when the spacebar is pressed <span class="ent">➋</span>. In <span class="literal">_fire_bullet()</span>, we make an instance of <span class="literal">Bullet</span> and call it <span class="literal">new_bullet</span> <span class="ent">➌</span>. We then add it to the group <span class="literal">bullets</span> using the <span class="literal">add()</span> method <span class="ent">➍</span>. The <span class="literal">add()</span> method is similar to <span class="literal">append()</span>, but it’s a method that’s written specifically for Pygame groups.</p>
<p class="indent">The <span class="literal">bullets.sprites()</span> method returns a list of all sprites in the group <span class="literal">bullets</span>. To draw all fired bullets to the screen, we loop through the sprites in <span class="literal">bullets</span> and call <span class="literal">draw_bullet()</span> on each one <span class="ent">➎</span>.</p>
<p class="indent">When you run <em class="calibre3">alien_invasion.py</em> now, you should be able to move the ship right and left, and fire as many bullets as you want. The bullets travel up the screen and disappear when they reach the top, as shown in <a href="#calibre_link-99" class="calibre6">Figure 12-3</a>. You can alter the size, color, and speed of the bullets in <em class="calibre3">settings.py</em>.</p>
<div class="image1"><a id="calibre_link-99" class="calibre6"></a><img src="images/000038.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 12-3: The ship after firing a series of bullets</em></p>
<h4 class="h3" id="calibre_link-945"><strong class="calibre2"><em class="calibre3">Deleting Old Bullets</em></strong></h4>
<p class="noindent">At the moment, the bullets disappear when they reach the top, but only because Pygame can’t draw them above the top of the screen. The bullets actually continue to exist; their y-coordinate values just grow increasingly negative. This is a problem, because they continue to consume memory and processing power.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-204" class="calibre"></span>We need to get rid of these old bullets, or the game will slow down from doing so much unnecessary work. To do this, we need to detect when the <span class="literal">bottom</span> value of a bullet’s <span class="literal">rect</span> has a value of 0, which indicates the bullet has passed off the top of the screen:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start the main loop for the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._check_events()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.update()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.update()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get rid of bullets that have disappeared.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for bullet in self.bullets.copy():<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if bullet.rect.bottom &lt;= 0:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets.remove(bullet)<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(len(self.bullets))<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_screen()</span></p>
<p class="indent">When you use a <span class="literal">for</span> loop with a list (or a group in Pygame), Python expects that the list will stay the same length as long as the loop is running. Because we can’t remove items from a list or group within a <span class="literal">for</span> loop, we have to loop over a copy of the group. We use the <span class="literal">copy()</span> method to set up the <span class="literal">for</span> loop <span class="ent">➊</span>, which enables us to modify <span class="literal">bullets</span> inside the loop. We check each bullet to see whether it has disappeared off the top of the screen at <span class="ent">➋</span>. If it has, we remove it from <span class="literal">bullets</span> <span class="ent">➌</span>. At <span class="ent">➍</span> we insert a <span class="literal">print()</span> call to show how many bullets currently exist in the game and verify that they’re being deleted when they reach the top of the screen.</p>
<p class="indent">If this code works correctly, we can watch the terminal output while firing bullets and see that the number of bullets decreases to zero after each series of bullets has cleared the top of the screen. After you run the game and verify that bullets are being deleted properly, remove the <span class="literal">print()</span> call. If you leave it in, the game will slow down significantly because it takes more time to write output to the terminal than it does to draw graphics to the game window.</p>
<h4 class="h3" id="calibre_link-946"><strong class="calibre2"><em class="calibre3">Limiting the Number of Bullets</em></strong></h4>
<p class="noindent">Many shooting games limit the number of bullets a player can have on the screen at one time; doing so encourages players to shoot accurately. We’ll do the same in <em class="calibre3">Alien Invasion</em>.</p>
<p class="indent">First, store the number of bullets allowed in <em class="calibre3">settings.py</em>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Bullet settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullet_color = (60, 60, 60)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets_allowed = 3</p>
<p class="indent"><span type="pagebreak" id="calibre_link-201" class="calibre"></span>This limits the player to three bullets at a time. We’ll use this setting in <span class="literal">AlienInvasion</span> to check how many bullets exist before creating a new bullet in <span class="literal">_fire_bullet()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _fire_bullet(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Create a new bullet and add it to the bullets group."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if len(self.bullets) &lt; self.settings.bullets_allowed:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">new_bullet = Bullet(self)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.add(new_bullet)</span></p>
<p class="indent">When the player presses the spacebar, we check the length of <span class="literal">bullets</span>. If <span class="literal">len(self.bullets)</span> is less than three, we create a new bullet. But if three bullets are already active, nothing happens when the spacebar is pressed. When you run the game now, you should be able to fire bullets only in groups of three.</p>
<h4 class="h3" id="calibre_link-947"><strong class="calibre2"><em class="calibre3">Creating the _update_bullets() Method</em></strong></h4>
<p class="noindent">We want to keep the <span class="literal">AlienInvasion</span> class reasonably well organized, so now that we’ve written and checked the bullet management code, we can move it to a separate method. We’ll create a new method called <span class="literal">_update_bullets()</span> and add it just before <span class="literal">_update_screen()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def _update_bullets(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Update position of bullets and get rid of old bullets."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update bullet positions.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.update()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Get rid of bullets that have disappeared.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for bullet in self.bullets.copy():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if bullet.rect.bottom &lt;= 0:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.remove(bullet)</span></p>
<p class="indent">The code for <span class="literal">_update_bullets()</span> is cut and pasted from <span class="literal">run_game()</span>; all we’ve done here is clarify the comments.</p>
<p class="indent">The <span class="literal">while</span> loop in <span class="literal">run_game()</span> looks simple again:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._check_events()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.update()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._update_bullets()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_screen()</span></p>
<p class="indent">Now our main loop contains only minimal code, so we can quickly read the method names and understand what’s happening in the game. The main loop checks for player input, and then updates the position of the ship and any bullets that have been fired. We then use the updated positions to draw a new screen.</p>
<p class="indent">Run <em class="calibre3">alien_invasion.py</em> one more time, and make sure you can still fire bullets without errors.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-1358" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-145"><strong class="calibre2">12-6. Sideways Shooter:</strong> Write a game that places a ship on the left side of the screen and allows the player to move the ship up and down. Make the ship fire a bullet that travels right across the screen when the player presses the spacebar. Make sure bullets are deleted once they disappear off the screen.</p>
</div>
<h3 class="h2" id="calibre_link-948"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned to make a plan for a game and learned the basic structure of a game written in Pygame. You learned to set a background color and store settings in a separate class where you can adjust them more easily. You saw how to draw an image to the screen and give the player control over the movement of game elements. You created elements that move on their own, like bullets flying up a screen, and deleted objects that are no longer needed. You also learned to refactor code in a project on a regular basis to facilitate ongoing development.</p>
<p class="indent">In <a href="#calibre_link-12" class="calibre6">Chapter 13</a>, we’ll add aliens to <em class="calibre3">Alien Invasion</em>. By the end of the chapter, you’ll be able to shoot down aliens, hopefully before they reach your ship!<span type="pagebreak" id="calibre_link-1359" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-136">
<h2 class="h" id="calibre_link-12"><span type="pagebreak" id="calibre_link-1360" class="calibre"></span><strong class="calibre2"><span class="big">13</span><br class="calibre4" />ALIENS!</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter, we’ll add aliens to <em class="calibre3">Alien Invasion</em>. We’ll add one alien near the top of the screen and then generate a whole fleet of aliens. We’ll make the fleet advance sideways and down, and we’ll get rid of any aliens hit by a bullet. Finally, we’ll limit the number of ships a player has and end the game when the player runs out of ships.</p>
<p class="indent">As you work through this chapter, you’ll learn more about Pygame and about managing a large project. You’ll also learn to detect collisions between game objects, like bullets and aliens. Detecting collisions helps you define interactions between elements in your games: for example, you can <span type="pagebreak" id="calibre_link-194" class="calibre"></span>confine a character inside the walls of a maze or pass a ball between two characters. We’ll continue to work from a plan that we revisit occasionally to maintain the focus of our code-writing sessions.</p>
<p class="indent">Before we start writing new code to add a fleet of aliens to the screen, let’s look at the project and update our plan.</p>
<h3 class="h2" id="calibre_link-949"><strong class="calibre2">Reviewing the Project</strong></h3>
<p class="noindent">When you’re beginning a new phase of development on a large project, it’s always a good idea to revisit your plan and clarify what you want to accomplish with the code you’re about to write. In this chapter, we’ll:</p>
<ul class="calibre8">
<li class="noindent1">Examine our code and determine if we need to refactor before implementing new features.</li>
<li class="noindent1">Add a single alien to the top-left corner of the screen with appropriate spacing around it.</li>
<li class="noindent1">Use the spacing around the first alien and the overall screen size to determine how many aliens can fit on the screen. We’ll write a loop to create aliens to fill the upper portion of the screen.</li>
<li class="noindent1">Make the fleet move sideways and down until the entire fleet is shot down, an alien hits the ship, or an alien reaches the ground. If the entire fleet is shot down, we’ll create a new fleet. If an alien hits the ship or the ground, we’ll destroy the ship and create a new fleet.</li>
<li class="noindent1">Limit the number of ships the player can use, and end the game when the player has used up the allotted number of ships.</li>
</ul>
<p class="indent">We’ll refine this plan as we implement features, but this is sufficient to start with.</p>
<p class="indent">You should also review your existing code when you begin working on a new series of features in a project. Because each new phase typically makes a project more complex, it’s best to clean up any cluttered or inefficient code. We’ve been refactoring as we go, so there isn’t any code that we need to refactor at this point.</p>
<h3 class="h2" id="calibre_link-950"><strong class="calibre2">Creating the First Alien</strong></h3>
<p class="noindent">Placing one alien on the screen is like placing a ship on the screen. Each alien’s behavior is controlled by a class called <span class="literal">Alien</span>, which we’ll structure like the <span class="literal">Ship</span> class. We’ll continue using bitmap images for simplicity. You can find your own image for an alien or use the one shown in <a href="#calibre_link-137" class="calibre6">Figure 13-1</a>, which is available in the book’s resources at <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em>. This image has a gray background, which matches the screen’s background color. Make sure you save the image file you choose in the <em class="calibre3">images</em> folder.</p>
<div class="image1"><span type="pagebreak" id="calibre_link-528" class="calibre"></span><a id="calibre_link-137" class="calibre6"></a><img src="images/000045.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 13-1: The alien we’ll use to build the fleet</em></p>
<h4 class="h3" id="calibre_link-951"><strong class="calibre2"><em class="calibre3">Creating the Alien Class</em></strong></h4>
<p class="noindent">Now we’ll write the <span class="literal">Alien</span> class and save it as <em class="calibre3">alien.py</em>:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import pygame<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from pygame.sprite import Sprite<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class Alien(Sprite):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A class to represent a single alien in the fleet."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, ai_game):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize the alien and set its starting position."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super().__init__()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = ai_game.screen<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Load the alien image and set its rect attribute.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.image = pygame.image.load('images/alien.bmp')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect = self.image.get_rect()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Start each new alien near the top left of the screen.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.x = self.rect.width<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.y = self.rect.height<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store the alien's exact horizontal position.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x = float(self.rect.x)</p>
<p class="indent">Most of this class is like the <span class="literal">Ship</span> class except for the aliens’ placement on the screen. We initially place each alien near the top-left corner of the screen; we add a space to the left of it that’s equal to the alien’s width and a space above it equal to its height <span class="ent">➊</span> so it’s easy to see. We’re mainly <span type="pagebreak" id="calibre_link-195" class="calibre"></span>concerned with the aliens’ horizontal speed, so we’ll track the horizontal position of each alien precisely <span class="ent">➋</span>.</p>
<p class="indent">This <span class="literal">Alien</span> class doesn’t need a method for drawing it to the screen; instead, we’ll use a Pygame group method that automatically draws all the elements of a group to the screen.</p>
<h4 class="h3" id="calibre_link-952"><strong class="calibre2"><em class="calibre3">Creating an Instance of the Alien</em></strong></h4>
<p class="noindent">We want to create an instance of <span class="literal">Alien</span> so we can see the first alien on the screen. Because it’s part of our setup work, we’ll add the code for this instance at the end of the <span class="literal">__init__()</span> method in <span class="literal">AlienInvasion</span>. Eventually, we’ll create an entire fleet of aliens, which will be quite a bit of work, so we’ll make a new helper method called <span class="literal">_create_fleet()</span>.</p>
<p class="indent">The order of methods in a class doesn’t matter, as long as there’s some consistency to how they’re placed. I’ll place <span class="literal">_create_fleet()</span> just before the <span class="literal">_update_screen()</span> method, but anywhere in <span class="literal">AlienInvasion</span> will work. First, we’ll import the <span class="literal">Alien</span> class.</p>
<p class="indent">Here are the updated <span class="literal">import</span> statements for <em class="calibre3">alien_invasion.py</em>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">from bullet import Bullet</span><br class="calibre4" />
from alien import Alien</p>
<p class="indent">And here’s the updated <span class="literal">__init__()</span> method:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship = Ship(self)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets = pygame.sprite.Group()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.aliens = pygame.sprite.Group()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._create_fleet()</p>
<p class="indent">We create a group to hold the fleet of aliens, and we call <span class="literal">_create_fleet()</span>, which we’re about to write.</p>
<p class="indent">Here’s the new <span class="literal">_create_fleet()</span> method:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def _create_fleet(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Create the fleet of aliens."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make an alien.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien = Alien(self)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.aliens.add(alien)</p>
<p class="indent">In this method, we’re creating one instance of <span class="literal">Alien</span>, and then adding it to the group that will hold the fleet. The alien will be placed in the default upper-left area of the screen, which is perfect for the first alien.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-526" class="calibre"></span>To make the alien appear, we need to call the group’s <span class="literal">draw()</span> method in <span class="literal">_update_screen()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_screen(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for bullet in self.bullets.sprites():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">bullet.draw_bullet()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.aliens.draw(self.screen)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.flip()</span></p>
<p class="indent">When you call <span class="literal">draw()</span> on a group, Pygame draws each element in the group at the position defined by its <span class="literal">rect</span> attribute. The <span class="literal">draw()</span> method requires one argument: a surface on which to draw the elements from the group. <a href="#calibre_link-138" class="calibre6">Figure 13-2</a> shows the first alien on the screen.</p>
<div class="image1"><a id="calibre_link-138" class="calibre6"></a><img src="images/000051.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 13-2: The first alien appears.</em></p>
<p class="indent">Now that the first alien appears correctly, we’ll write the code to draw an entire fleet.</p>
<h3 class="h2" id="calibre_link-953"><strong class="calibre2">Building the Alien Fleet</strong></h3>
<p class="noindent">To draw a fleet, we need to figure out how many aliens can fit across the screen and how many rows of aliens can fit down the screen. We’ll first figure out the horizontal spacing between aliens and create a row; then we’ll determine the vertical spacing and create an entire fleet.</p>
<h4 class="h3" id="calibre_link-954"><span type="pagebreak" id="calibre_link-174" class="calibre"></span><strong class="calibre2"><em class="calibre3">Determining How Many Aliens Fit in a Row</em></strong></h4>
<p class="noindent">To figure out how many aliens fit in a row, let’s look at how much horizontal space we have. The screen width is stored in <span class="literal">settings.screen_width</span>, but we need an empty margin on either side of the screen. We’ll make this margin the width of one alien. Because we have two margins, the available space for aliens is the screen width minus two alien widths:</p>
<p class="programs">available_space_x = settings.screen_width &ndash; (2 * alien_width)</p>
<p class="indent">We also need to set the spacing between aliens; we’ll make it one alien width. The space needed to display one alien is twice its width: one width for the alien and one width for the empty space to its right. To find the number of aliens that fit across the screen, we divide the available space by two times the width of an alien. We use <em class="calibre3">floor division</em> (<span class="literal">//</span>), which divides two numbers and drops any remainder, so we’ll get an integer number of aliens:</p>
<p class="programs">number_aliens_x = available_space_x // (2 * alien_width)</p>
<p class="indent">We’ll use these calculations when we create the fleet.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">One great aspect of calculations in programming is that you don’t have to be sure your formulas are correct when you first write them. You can try them out and see if they work. At worst, you’ll have a screen that’s overcrowded with aliens or has too few aliens. You can then revise your calculations based on what you see on the screen.</em></p>
</div>
<h4 class="h3" id="calibre_link-955"><strong class="calibre2"><em class="calibre3">Creating a Row of Aliens</em></strong></h4>
<p class="noindent">We’re ready to generate a full row of aliens. Because our code for making a single alien works, we’ll rewrite <span class="literal">_create_fleet()</span> to make a whole row of aliens:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _create_fleet(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Create the fleet of aliens."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create an alien and find the number of aliens in a row.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Spacing between each alien is equal to one alien width.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien = Alien(self)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien_width = alien.rect.width<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;available_space_x = self.settings.screen_width - (2 * alien_width)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number_aliens_x = available_space_x // (2 * alien_width)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create the first row of aliens.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for alien_number in range(number_aliens_x):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create an alien and place it in the row.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien = Alien(self)<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien.x = alien_width + 2 * alien_width * alien_number<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien.rect.x = alien.x<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.aliens.add(alien)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-529" class="calibre"></span>We’ve already thought through most of this code. We need to know the alien’s width and height to place aliens, so we create an alien at <span class="ent">➊</span> before we perform calculations. This alien won’t be part of the fleet, so don’t add it to the group <span class="literal">aliens</span>. At <span class="ent">➋</span> we get the alien’s width from its <span class="literal">rect</span> attribute and store this value in <span class="literal">alien_width</span> so we don’t have to keep working through the <span class="literal">rect</span> attribute. At <span class="ent">➌</span> we calculate the horizontal space available for aliens and the number of aliens that can fit into that space.</p>
<p class="indent">Next, we set up a loop that counts from 0 to the number of aliens we need to make <span class="ent">➍</span>. In the main body of the loop, we create a new alien and then set its x-coordinate value to place it in the row <span class="ent">➎</span>. Each alien is pushed to the right one alien width from the left margin. Next, we multiply the alien width by 2 to account for the space each alien takes up, including the empty space to its right, and we multiply this amount by the alien’s position in the row. We use the alien’s <span class="literal">x</span> attribute to set the position of its rect. Then we add each new alien to the group <span class="literal">aliens</span>.</p>
<p class="indent">When you run <em class="calibre3">Alien Invasion</em> now, you should see the first row of aliens appear, as in <a href="#calibre_link-139" class="calibre6">Figure 13-3</a>.</p>
<div class="image1"><a id="calibre_link-139" class="calibre6"></a><img src="images/000057.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 13-3: The first row of aliens</em></p>
<p class="indent">The first row is offset to the left, which is actually good for gameplay. The reason is that we want the fleet to move right until it hits the edge of the screen, then drop down a bit, then move left, and so forth. Like the classic game <em class="calibre3">Space Invaders</em>, this movement is more interesting than having the fleet drop straight down. We’ll continue this motion until all aliens are shot down or until an alien hits the ship or the bottom of the screen.</p>
<div class="note">
<p class="notet"><span type="pagebreak" id="calibre_link-1361" class="calibre"></span><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Depending on the screen width you’ve chosen, the alignment of the first row of aliens might look slightly different on your system.</em></p>
</div>
<h4 class="h3" id="calibre_link-956"><strong class="calibre2"><em class="calibre3">Refactoring _create_fleet()</em></strong></h4>
<p class="noindent">If the code we’ve written so far was all we need to create a fleet, we’d probably leave <span class="literal">_create_fleet()</span> as is. But we have more work to do, so let’s clean up the method a bit. We’ll add a new helper method, <span class="literal">_create_alien()</span>, and call it from <span class="literal">_create_fleet()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _create_fleet(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Create the first row of aliens.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for alien_number in range(number_aliens_x):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._create_alien(alien_number)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def _create_alien(self, alien_number):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Create an alien and place it in the row."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien = Alien(self)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien_width = alien.rect.width<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien.x = alien_width + 2 * alien_width * alien_number</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien.rect.x = alien.x</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.aliens.add(alien)</span></p>
<p class="indent">The method <span class="literal">_create_alien()</span> requires one parameter in addition to <span class="literal">self</span>: it needs the alien number that’s currently being created. We use the same body we made for <span class="literal">_create_fleet()</span> except that we get the width of an alien inside the method instead of passing it as an argument. This refactoring will make it easier to add new rows and create an entire fleet.</p>
<h4 class="h3" id="calibre_link-957"><strong class="calibre2"><em class="calibre3">Adding Rows</em></strong></h4>
<p class="noindent">To finish the fleet, we’ll determine the number of rows that fit on the screen and then repeat the loop for creating the aliens in one row until we have the correct number of rows. To determine the number of rows, we find the available vertical space by subtracting the alien height from the top, the ship height from the bottom, and two alien heights from the bottom of the screen:</p>
<p class="programs">available_space_y = settings.screen_height &ndash; (3 * alien_height) &ndash; ship_height</p>
<p class="indent">The result will create some empty space above the ship, so the player has some time to start shooting aliens at the beginning of each level.</p>
<p class="indent">Each row needs some empty space below it, which we’ll make equal to the height of one alien. To find the number of rows, we divide the available space by two times the height of an alien. We use floor division because we can only make an integer number of rows. (Again, if these calculations are off, we’ll see it right away and adjust our approach until we have reasonable spacing.)</p>
<p class="programs">number_rows = available_height_y // (2 * alien_height)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-472" class="calibre"></span>Now that we know how many rows fit in a fleet, we can repeat the code for creating a row:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _create_fleet(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien = Alien(self)</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien_width, alien_height = alien.rect.size<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">available_space_x = self.settings.screen_width - (2 * alien_width)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">number_aliens_x = available_space_x // (2 * alien_width)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Determine the number of rows of aliens that fit on the screen.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ship_height = self.ship.rect.height<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;available_space_y = (self.settings.screen_height -<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3 * alien_height) - ship_height)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number_rows = available_space_y // (2 * alien_height)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create the full fleet of aliens.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for row_number in range(number_rows):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for alien_number in range(number_aliens_x):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._create_alien(alien_number, row_number)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _create_alien(self, alien_number, row_number):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Create an alien and place it in the row."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien = Alien(self)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien_width, alien_height = alien.rect.size<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien.x = alien_width + 2 * alien_width * alien_number</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">alien.rect.x = alien.x</span><br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien.rect.y = alien.rect.height + 2 * alien.rect.height * row_number<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.aliens.add(alien)</span></p>
<p class="indent">We need the width and height of an alien, so at <span class="ent">➊</span> we use the attribute <span class="literal">size</span>, which contains a tuple with the width and height of a <span class="literal">rect</span> object. To calculate the number of rows we can fit on the screen, we write our <span class="literal">available_space_y</span> calculation right after the calculation for <span class="literal">available_space_x</span> <span class="ent">➋</span>. The calculation is wrapped in parentheses so the outcome can be split over two lines, which results in lines of 79 characters or less, as is recommended.</p>
<p class="indent">To create multiple rows, we use two nested loops: one outer and one inner loop <span class="ent">➌</span>. The inner loop creates the aliens in one row. The outer loop counts from 0 to the number of rows we want; Python uses the code for making a single row and repeats it <span class="literal">number_rows</span> times.</p>
<p class="indent">To nest the loops, write the new <span class="literal">for</span> loop and indent the code you want to repeat. (Most text editors make it easy to indent and unindent blocks of code, but for help see <a href="#calibre_link-2" class="calibre6">Appendix B</a>.) Now when we call <span class="literal">_create_alien()</span>, we include an argument for the row number so each row can be placed farther down the screen.</p>
<p class="indent">The definition of <span class="literal">_create_alien()</span> needs a parameter to hold the row number. Within <span class="literal">_create_alien()</span>, we change an alien’s y-coordinate value when it’s not in the first row <span class="ent">➍</span> by starting with one alien’s height to create empty space at the top of the screen. Each row starts two alien heights below <span type="pagebreak" id="calibre_link-196" class="calibre"></span>the previous row, so we multiply the alien height by two and then by the row number. The first row number is 0, so the vertical placement of the first row is unchanged. All subsequent rows are placed farther down the screen.</p>
<p class="indent">When you run the game now, you should see a full fleet of aliens, as shown in <a href="#calibre_link-140" class="calibre6">Figure 13-4</a>.</p>
<div class="image1"><a id="calibre_link-140" class="calibre6"></a><img src="images/000063.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 13-4: The full fleet appears.</em></p>
<p class="indent">In the next section, we’ll make the fleet move!</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-141"><strong class="calibre2">13-1. Stars:</strong> Find an image of a star. Make a grid of stars appear on the screen.</p>
<p class="sparal" id="calibre_link-958"><strong class="calibre2">13-2. Better Stars:</strong> You can make a more realistic star pattern by introducing randomness when you place each star. Recall that you can get a random number like this:</p>
<p class="programs">from random import randint<br class="calibre4" />
random_number = randint(-10, 10)</p>
<p class="sparai">This code returns a random integer between &ndash;10 and 10. Using your code in <a href="#calibre_link-141" class="calibre6">Exercise 13-1</a>, adjust each star’s position by a random amount.</p>
</div>
<h3 class="h2" id="calibre_link-959"><span type="pagebreak" id="calibre_link-1362" class="calibre"></span><strong class="calibre2">Making the Fleet Move</strong></h3>
<p class="noindent">Now let’s make the fleet of aliens move to the right across the screen until it hits the edge, and then make it drop a set amount and move in the other direction. We’ll continue this movement until all aliens have been shot down, one collides with the ship, or one reaches the bottom of the screen. Let’s begin by making the fleet move to the right.</p>
<h4 class="h3" id="calibre_link-960"><strong class="calibre2"><em class="calibre3">Moving the Aliens Right</em></strong></h4>
<p class="noindent">To move the aliens, we’ll use an <span class="literal">update()</span> method in <em class="calibre3">alien.py</em>, which we’ll call for each alien in the group of aliens. First, add a setting to control the speed of each alien:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Alien settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.alien_speed = 1.0</p>
<p class="indent">Then use this setting to implement <span class="literal">update()</span>:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize the alien and set its starting position."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">super().__init__()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen = ai_game.screen</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings = ai_game.settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def update(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Move the alien to the right."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x += self.settings.alien_speed<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.x = self.x</p>
<p class="indent">We create a settings parameter in <span class="literal">__init__()</span> so we can access the alien’s speed in <span class="literal">update()</span>. Each time we update an alien’s position, we move it to the right by the amount stored in <span class="literal">alien_speed</span>. We track the alien’s exact position with the <span class="literal">self.x</span> attribute, which can hold decimal values <span class="ent">➊</span>. We then use the value of <span class="literal">self.x</span> to update the position of the alien’s <span class="literal">rect</span> <span class="ent">➋</span>.</p>
<p class="indent">In the main <span class="literal">while</span> loop, we already have calls to update the ship and bullet positions. Now we’ll add a call to update the position of each alien as well:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._check_events()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.update()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_bullets()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._update_aliens()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_screen()</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-187" class="calibre"></span>We’re about to write some code to manage the movement of the fleet, so we create a new method called <span class="literal">_update_aliens()</span>. We set the aliens’ positions to update after the bullets have been updated, because we’ll soon be checking to see whether any bullets hit any aliens.</p>
<p class="indent">Where you place this method in the module is not critical. But to keep the code organized, I’ll place it just after <span class="literal">_update_bullets()</span> to match the order of method calls in the <span class="literal">while</span> loop. Here’s the first version of <span class="literal">_update_aliens()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def _update_aliens(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Update the positions of all aliens in the fleet."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.aliens.update()</p>
<p class="indent">We use the <span class="literal">update()</span> method on the <span class="literal">aliens</span> group, which calls each alien’s <span class="literal">update()</span> method. When you run <em class="calibre3">Alien Invasion</em> now, you should see the fleet move right and disappear off the side of the screen.</p>
<h4 class="h3" id="calibre_link-961"><strong class="calibre2"><em class="calibre3">Creating Settings for Fleet Direction</em></strong></h4>
<p class="noindent">Now we’ll create the settings that will make the fleet move down the screen and to the left when it hits the right edge of the screen. Here’s how to implement this behavior:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Alien settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.alien_speed = 1.0</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.fleet_drop_speed = 10<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# fleet_direction of 1 represents right; -1 represents left.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.fleet_direction = 1</p>
<p class="indent">The setting <span class="literal">fleet_drop_speed</span> controls how quickly the fleet drops down the screen each time an alien reaches either edge. It’s helpful to separate this speed from the aliens’ horizontal speed so you can adjust the two speeds independently.</p>
<p class="indent">To implement the setting <span class="literal">fleet_direction</span>, we could use a text value, such as <span class="literal">'left'</span> or <span class="literal">'right'</span>, but we’d end up with <span class="literal">if</span>-<span class="literal">elif</span> statements testing for the fleet direction. Instead, because we have only two directions to deal with, let’s use the values 1 and &ndash;1, and switch between them each time the fleet changes direction. (Using numbers also makes sense because moving right involves adding to each alien’s x-coordinate value, and moving left involves subtracting from each alien’s x-coordinate value.)</p>
<h4 class="h3" id="calibre_link-962"><strong class="calibre2"><em class="calibre3">Checking Whether an Alien Has Hit the Edge</em></strong></h4>
<p class="noindent">We need a method to check whether an alien is at either edge, and we need to modify <span class="literal">update()</span> to allow each alien to move in the appropriate direction. This code is part of the <span class="literal">Alien</span> class:</p>
<p class="margin"><em class="calibre3">alien.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def check_edges(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Return True if alien is at edge of screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen_rect = self.screen.get_rect()<br class="calibre4" />
<span type="pagebreak" id="calibre_link-197" class="calibre"></span><span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.rect.right &gt;= screen_rect.right or self.rect.left &lt;= 0:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return True<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def update(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Move the alien right or left."""<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x += (self.settings.alien_speed *<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings.fleet_direction)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.rect.x = self.x</span></p>
<p class="indent">We can call the new method <span class="literal">check_edges()</span> on any alien to see whether it’s at the left or right edge. The alien is at the right edge if the <span class="literal">right</span> attribute of its <span class="literal">rect</span> is greater than or equal to the <span class="literal">right</span> attribute of the screen’s <span class="literal">rect</span>. It’s at the left edge if its <span class="literal">left</span> value is less than or equal to 0 <span class="ent">➊</span>.</p>
<p class="indent">We modify the method <span class="literal">update()</span> to allow motion to the left or right by multiplying the alien’s speed by the value of <span class="literal">fleet_direction</span> <span class="ent">➋</span>. If <span class="literal">fleet_direction</span> is 1, the value of <span class="literal">alien_speed</span> will be added to the alien’s current position, moving the alien to the right; if <span class="literal">fleet_direction</span> is &ndash;1, the value will be subtracted from the alien’s position, moving the alien to the left.</p>
<h4 class="h3" id="calibre_link-963"><strong class="calibre2"><em class="calibre3">Dropping the Fleet and Changing Direction</em></strong></h4>
<p class="noindent">When an alien reaches the edge, the entire fleet needs to drop down and change direction. Therefore, we need to add some code to <span class="literal">AlienInvasion</span> because that’s where we’ll check whether any aliens are at the left or right edge. We’ll make this happen by writing the methods <span class="literal">_check_fleet_edges()</span> and <span class="literal">_change_fleet_direction()</span>, and then modifying <span class="literal">_update_aliens()</span>. I’ll put these new methods after <span class="literal">_create_alien()</span>, but again the placement of these methods in the class isn’t critical.</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _check_fleet_edges(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Respond appropriately if any aliens have reached an edge."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for alien in self.aliens.sprites():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if alien.check_edges():<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._change_fleet_direction()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _change_fleet_direction(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Drop the entire fleet and change the fleet's direction."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for alien in self.aliens.sprites():<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alien.rect.y += self.settings.fleet_drop_speed<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings.fleet_direction *= -1</p>
<p class="indent">In <span class="literal">_check_fleet_edges()</span>, we loop through the fleet and call <span class="literal">check_edges()</span> on each alien <span class="ent">➊</span>. If <span class="literal">check_edges()</span> returns <span class="literal">True</span>, we know an alien is at an edge and the whole fleet needs to change direction; so we call <span class="literal">_change_fleet_direction()</span> and break out of the loop <span class="ent">➋</span>. In <span class="literal">_change_fleet_direction()</span>, we loop through all the aliens and drop each one using the setting <span class="literal">fleet_drop_speed</span> <span class="ent">➌</span>; then we change the value of <span class="literal">fleet_direction</span> by multiplying its current value by &ndash;1. The line that changes the fleet’s direction isn’t part of the <span class="literal">for</span> loop. We want to change each alien’s vertical position, but we only want to change the direction of the fleet once.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-188" class="calibre"></span>Here are the changes to <span class="literal">_update_aliens()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_aliens(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check if the fleet is at an edge,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then update the positions of all aliens in the fleet.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._check_fleet_edges()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.aliens.update()</span></p>
<p class="indent">We’ve modified the method by calling <span class="literal">_check_fleet_edges()</span> before updating each alien’s position.</p>
<p class="indent">When you run the game now, the fleet should move back and forth between the edges of the screen and drop down every time it hits an edge. Now we can start shooting down aliens and watch for any aliens that hit the ship or reach the bottom of the screen.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-142"><strong class="calibre2">13-3. Raindrops:</strong> Find an image of a raindrop and create a grid of raindrops. Make the raindrops fall toward the bottom of the screen until they disappear.</p>
<p class="sparal" id="calibre_link-964"><strong class="calibre2">13-4. Steady Rain:</strong> Modify your code in <a href="#calibre_link-142" class="calibre6">Exercise 13-3</a> so when a row of raindrops disappears off the bottom of the screen, a new row appears at the top of the screen and begins to fall.</p>
</div>
<h3 class="h2" id="calibre_link-965"><strong class="calibre2">Shooting Aliens</strong></h3>
<p class="noindent">We’ve built our ship and a fleet of aliens, but when the bullets reach the aliens, they simply pass through because we aren’t checking for collisions. In game programming, <em class="calibre3">collisions</em> happen when game elements overlap. To make the bullets shoot down aliens, we’ll use the method <span class="literal">sprite.groupcollide()</span> to look for collisions between members of two groups.</p>
<h4 class="h3" id="calibre_link-966"><strong class="calibre2"><em class="calibre3">Detecting Bullet Collisions</em></strong></h4>
<p class="noindent">We want to know right away when a bullet hits an alien so we can make an alien disappear as soon as it’s hit. To do this, we’ll look for collisions immediately after updating the position of all the bullets.</p>
<p class="indent">The <span class="literal">sprite.groupcollide()</span> function compares the rects of each element in one group with the rects of each element in another group. In this case, it compares each bullet’s <span class="literal">rect</span> with each alien’s <span class="literal">rect</span> and returns a dictionary containing the bullets and aliens that have collided. Each key in the <span type="pagebreak" id="calibre_link-189" class="calibre"></span>dictionary will be a bullet, and the corresponding value will be the alien that was hit. (We’ll also use this dictionary when we implement a scoring system in <a href="#calibre_link-13" class="calibre6">Chapter 14</a>.)</p>
<p class="indent">Add the following code to the end of <span class="literal">_update_bullets()</span> to check for collisions between bullets and aliens:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_bullets(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Update position of bullets and get rid of old bullets."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for any bullets that have hit aliens.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;If so, get rid of the bullet and the alien.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;collisions = pygame.sprite.groupcollide(<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets, self.aliens, True, True)</p>
<p class="indent">The new code we added compares the positions of all the bullets in <span class="literal">self.bullets</span> and all the aliens in <span class="literal">self.aliens</span>, and identifies any that overlap. Whenever the rects of a bullet and alien overlap, <span class="literal">groupcollide()</span> adds a key-value pair to the dictionary it returns. The two <span class="literal">True</span> arguments tell Pygame to delete the bullets and aliens that have collided. (To make a high-powered bullet that can travel to the top of the screen, destroying every alien in its path, you could set the first Boolean argument to <span class="literal">False</span> and keep the second Boolean argument set to <span class="literal">True</span>. The aliens hit would disappear, but all bullets would stay active until they disappeared off the top of the screen.)</p>
<p class="indent">When you run <em class="calibre3">Alien Invasion</em> now, aliens you hit should disappear. <a href="#calibre_link-143" class="calibre6">Figure 13-5</a> shows a fleet that has been partially shot down.</p>
<div class="image1"><a id="calibre_link-143" class="calibre6"></a><img src="images/000048.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 13-5: We can shoot aliens!</em></p>
<h4 class="h3" id="calibre_link-967"><span type="pagebreak" id="calibre_link-199" class="calibre"></span><strong class="calibre2"><em class="calibre3">Making Larger Bullets for Testing</em></strong></h4>
<p class="noindent">You can test many features of the game simply by running the game. But some features are tedious to test in the normal version of the game. For example, it’s a lot of work to shoot down every alien on the screen multiple times to test whether your code responds to an empty fleet correctly.</p>
<p class="indent">To test particular features, you can change certain game settings to focus on a particular area. For example, you might shrink the screen so there are fewer aliens to shoot down or increase the bullet speed and give yourself lots of bullets at once.</p>
<p class="indent">My favorite change for testing <em class="calibre3">Alien Invasion</em> is to use really wide bullets that remain active even after they’ve hit an alien (see <a href="#calibre_link-144" class="calibre6">Figure 13-6</a>). Try setting <span class="literal">bullet_width</span> to 300, or even 3000, to see how quickly you can shoot down the fleet!</p>
<div class="image1"><a id="calibre_link-144" class="calibre6"></a><img src="images/000033.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 13-6: Extra-powerful bullets make some aspects of the game easier to test.</em></p>
<p class="indent">Changes like these will help you test the game more efficiently and possibly spark ideas for giving players bonus powers. Just remember to restore the settings to normal when you’re finished testing a feature.</p>
<h4 class="h3" id="calibre_link-968"><strong class="calibre2"><em class="calibre3">Repopulating the Fleet</em></strong></h4>
<p class="noindent">One key feature of <em class="calibre3">Alien Invasion</em> is that the aliens are relentless: every time the fleet is destroyed, a new fleet should appear.</p>
<p class="indent">To make a new fleet of aliens appear after a fleet has been destroyed, we first check whether the <span class="literal">aliens</span> group is empty. If it is, we make a call to <span class="literal">_create_fleet()</span>. We’ll perform this check at the end of <span class="literal">_update_bullets()</span>, because that’s where individual aliens are destroyed.</p>
<p class="margin"><span type="pagebreak" id="calibre_link-206" class="calibre"></span><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_bullets(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if not self.aliens:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Destroy existing bullets and create new fleet.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets.empty()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._create_fleet()</p>
<p class="indent">At <span class="ent">➊</span>, we check whether the <span class="literal">aliens</span> group is empty. An empty group evaluates to <span class="literal">False</span>, so this is a simple way to check whether the group is empty. If it is, we get rid of any existing bullets by using the <span class="literal">empty()</span> method, which removes all the remaining sprites from a group <span class="ent">➋</span>. We also call <span class="literal">_create_fleet()</span>, which fills the screen with aliens again.</p>
<p class="indent">Now a new fleet appears as soon as you destroy the current fleet.</p>
<h4 class="h3" id="calibre_link-969"><strong class="calibre2"><em class="calibre3">Speeding Up the Bullets</em></strong></h4>
<p class="noindent">If you’ve tried firing at the aliens in the game’s current state, you might find that the bullets aren’t traveling at the best speed for gameplay. They might be a little slow on your system or way too fast. At this point, you can modify the settings to make the gameplay interesting and enjoyable on your system.</p>
<p class="indent">We modify the speed of the bullets by adjusting the value of <span class="literal">bullet_speed</span> in <em class="calibre3">settings.py</em>. On my system, I’ll adjust the value of <span class="literal">bullet_speed</span> to 1.5, so the bullets travel a little faster:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Bullet settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullet_speed = 1.5<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullet_width = 3</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">The best value for this setting depends on your system’s speed, so find a value that works for you. You can adjust other settings as well.</p>
<h4 class="h3" id="calibre_link-970"><strong class="calibre2"><em class="calibre3">Refactoring _update_bullets()</em></strong></h4>
<p class="noindent">Let’s refactor <span class="literal">_update_bullets()</span> so it’s not doing so many different tasks. We’ll move the code for dealing with bullet and alien collisions to a separate method:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_bullets(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Get rid of bullets that have disappeared.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for bullet in self.bullets.copy():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if bullet.rect.bottom &lt;= 0:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.remove(bullet)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._check_bullet_alien_collisions()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def _check_bullet_alien_collisions(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Respond to bullet-alien collisions."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove any bullets and aliens that have collided.<br class="calibre4" />
<span type="pagebreak" id="calibre_link-192" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">collisions = pygame.sprite.groupcollide(</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets, self.aliens, True, True)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if not self.aliens:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Destroy existing bullets and create new fleet.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.empty()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._create_fleet()</span></p>
<p class="indent">We’ve created a new method, <span class="literal">_check_bullet_alien_collisions()</span>, to look for collisions between bullets and aliens, and to respond appropriately if the entire fleet has been destroyed. Doing so keeps <span class="literal">_update_bullets()</span> from growing too long and simplifies further development.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-971"><strong class="calibre2">13-5. Sideways Shooter Part 2:</strong> We’ve come a long way since <a href="#calibre_link-145" class="calibre6">Exercise 12-6</a>, Sideways Shooter. For this exercise, try to develop Sideways Shooter to the same point we’ve brought <em class="calibre3">Alien Invasion</em> to. Add a fleet of aliens, and make them move sideways toward the ship. Or, write code that places aliens at random positions along the right side of the screen and then sends them toward the ship. Also, write code that makes the aliens disappear when they’re hit.</p>
</div>
<h3 class="h2" id="calibre_link-972"><strong class="calibre2">Ending the Game</strong></h3>
<p class="noindent">What’s the fun and challenge in a game if you can’t lose? If the player doesn’t shoot down the fleet quickly enough, we’ll have the aliens destroy the ship when they make contact. At the same time, we’ll limit the number of ships a player can use, and we’ll destroy the ship when an alien reaches the bottom of the screen. The game will end when the player has used up all their ships.</p>
<h4 class="h3" id="calibre_link-973"><strong class="calibre2"><em class="calibre3">Detecting Alien and Ship Collisions</em></strong></h4>
<p class="noindent">We’ll start by checking for collisions between aliens and the ship so we can respond appropriately when an alien hits it. We’ll check for alien and ship collisions immediately after updating the position of each alien in <span class="literal">AlienInvasion</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_aliens(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.aliens.update()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Look for alien-ship collisions.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if pygame.sprite.spritecollideany(self.ship, self.aliens):<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Ship hit!!!")</p>
<p class="indent"><span type="pagebreak" id="calibre_link-210" class="calibre"></span>The <span class="literal">spritecollideany()</span> function takes two arguments: a sprite and a group. The function looks for any member of the group that has collided with the sprite and stops looping through the group as soon as it finds one member that has collided with the sprite. Here, it loops through the group <span class="literal">aliens</span> and returns the first alien it finds that has collided with <span class="literal">ship</span>.</p>
<p class="indent">If no collisions occur, <span class="literal">spritecollideany()</span> returns <span class="literal">None</span> and the <span class="literal">if</span> block at <span class="ent">➊</span> won’t execute. If it finds an alien that has collided with the ship, it returns that alien and the <span class="literal">if</span> block executes: it prints <em class="calibre3">Ship hit!!!</em> <span class="ent">➋</span>. When an alien hits the ship, we’ll need to do a number of tasks: we’ll need to delete all remaining aliens and bullets, recenter the ship, and create a new fleet. Before we write code to do all this, we need to know that our approach for detecting alien and ship collisions works correctly. Writing a <span class="literal">print()</span> call is a simple way to ensure we’re detecting these collisions properly.</p>
<p class="indent">Now when you run <em class="calibre3">Alien Invasion,</em> the message <em class="calibre3">Ship hit!!!</em> should appear in the terminal whenever an alien runs into the ship. When you’re testing this feature, set <span class="literal">alien_drop_speed</span> to a higher value, such as 50 or 100, so the aliens reach your ship faster.</p>
<h4 class="h3" id="calibre_link-974"><strong class="calibre2"><em class="calibre3">Responding to Alien and Ship Collisions</em></strong></h4>
<p class="noindent">Now we need to figure out exactly what will happen when an alien collides with the ship. Instead of destroying the <span class="literal">ship</span> instance and creating a new one, we’ll count how many times the ship has been hit by tracking statistics for the game. Tracking statistics will also be useful for scoring.</p>
<p class="indent">Let’s write a new class, <span class="literal">GameStats</span>, to track game statistics, and save it as <em class="calibre3">game_stats.py</em>:</p>
<p class="margin"><em class="calibre3">game_stats.py</em></p>
<p class="programs">class GameStats:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""Track statistics for Alien Invasion."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, ai_game):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize statistics."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings = ai_game.settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.reset_stats()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;def reset_stats(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize statistics that can change during the game."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ships_left = self.settings.ship_limit</p>
<p class="indent">We’ll make one <span class="literal">GameStats</span> instance for the entire time <em class="calibre3">Alien Invasion</em> is running. But we’ll need to reset some statistics each time the player starts a new game. To do this, we’ll initialize most of the statistics in the <span class="literal">reset_stats()</span> method instead of directly in <span class="literal">__init__()</span>. We’ll call this method from <span class="literal">__init__()</span> so the statistics are set properly when the <span class="literal">GameStats</span> instance is first created <span class="ent">➊</span>. But we’ll also be able to call <span class="literal">reset_stats()</span> any time the player starts a new game.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-547" class="calibre"></span>Right now we have only one statistic, <span class="literal">ships_left</span>, the value of which will change throughout the game. The number of ships the player starts with should be stored in <em class="calibre3">settings.py</em> as <span class="literal">ship_limit</span>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Ship settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship_speed = 1.5</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship_limit = 3</p>
<p class="indent">We also need to make a few changes in <em class="calibre3">alien_invasion.py</em> to create an instance of <span class="literal">GameStats</span>. First, we’ll update the <span class="literal">import</span> statements at the top of the file:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs"><span class="ash">import sys</span><br class="calibre4" />
from time import sleep<br class="calibre4" />
<br class="calibre4" />
<span class="ash">import pygame</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">from settings import Settings</span><br class="calibre4" />
from game_stats import GameStats<br class="calibre4" />
<span class="ash">from ship import Ship</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We import the <span class="literal">sleep()</span> function from the <span class="literal">time</span> module in the Python standard library so we can pause the game for a moment when the ship is hit. We also import <span class="literal">GameStats</span>.</p>
<p class="indent">We’ll create an instance of <span class="literal">GameStats</span> in <span class="literal">__init__()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen = pygame.display.set_mode(</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">(self.settings.screen_width, self.settings.screen_height))</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.set_caption("Alien Invasion")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create an instance to store game statistics.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats = GameStats(self)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship = Ship(self)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We make the instance after creating the game window but before defining other game elements, such as the ship.</p>
<p class="indent">When an alien hits the ship, we’ll subtract one from the number of ships left, destroy all existing aliens and bullets, create a new fleet, and reposition the ship in the middle of the screen. We’ll also pause the game for a moment so the player can notice the collision and regroup before a new fleet appears.</p>
<p class="indent">Let’s put most of this code in a new method called <span class="literal">_ship_hit()</span>. We’ll call this method from <span class="literal">_update_aliens()</span> when an alien hits the ship:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _ship_hit(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Respond to the ship being hit by an alien."""<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-193" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Decrement ships_left.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.ships_left -= 1<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get rid of any remaining aliens and bullets.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.aliens.empty()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets.empty()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a new fleet and center the ship.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._create_fleet()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.center_ship()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Pause.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(0.5)</p>
<p class="indent">The new method <span class="literal">_ship_hit()</span> coordinates the response when an alien hits a ship. Inside <span class="literal">_ship_hit()</span>, the number of ships left is reduced by 1 at <span class="ent">➊</span>, after which we empty the groups <span class="literal">aliens</span> and <span class="literal">bullets</span> <span class="ent">➋</span>.</p>
<p class="indent">Next, we create a new fleet and center the ship <span class="ent">➌</span>. (We’ll add the method <span class="literal">center_ship()</span> to <span class="literal">Ship</span> in a moment.) Then we add a pause after the updates have been made to all the game elements but before any changes have been drawn to the screen, so the player can see that their ship has been hit <span class="ent">➍</span>. The <span class="literal">sleep()</span> call pauses program execution for half a second, long enough for the player to see that the alien has hit the ship. When the <span class="literal">sleep()</span> function ends, code execution moves on to the <span class="literal">_update_screen()</span> method, which draws the new fleet to the screen.</p>
<p class="indent">In <span class="literal">_update_aliens()</span>, we replace the <span class="literal">print()</span> call with a call to <span class="literal">_ship_hit()</span> when an alien hits the ship:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_aliens(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if pygame.sprite.spritecollideany(self.ship, self.aliens):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._ship_hit()</p>
<p class="indent">Here’s the new method <span class="literal">center_ship()</span>; add it to the end of <em class="calibre3">ship.py</em>:</p>
<p class="margin"><em class="calibre3">ship.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def center_ship(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Center the ship on the screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.midbottom = self.screen_rect.midbottom<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x = float(self.rect.x)</p>
<p class="indent">We center the ship the same way we did in <span class="literal">__init__()</span>. After centering it, we reset the <span class="literal">self.x</span> attribute, which allows us to track the ship’s exact position.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Notice that we never make more than one ship; we make only one ship instance for the whole game and recenter it whenever the ship has been hit. The statistic <span class="codeitalic">ships_left</span> will tell us when the player has run out of ships.</em></p>
</div>
<p class="indent">Run the game, shoot a few aliens, and let an alien hit the ship. The game should pause, and a new fleet should appear with the ship centered at the bottom of the screen again.</p>
<h4 class="h3" id="calibre_link-975"><span type="pagebreak" id="calibre_link-198" class="calibre"></span><strong class="calibre2"><em class="calibre3">Aliens that Reach the Bottom of the Screen</em></strong></h4>
<p class="noindent">If an alien reaches the bottom of the screen, we’ll have the game respond the same way it does when an alien hits the ship. To check when this happens, add a new method in <em class="calibre3">alien_invasion.py</em>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _check_aliens_bottom(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Check if any aliens have reached the bottom of the screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen_rect = self.screen.get_rect()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for alien in self.aliens.sprites():<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if alien.rect.bottom &gt;= screen_rect.bottom:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Treat this the same as if the ship got hit.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._ship_hit()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</p>
<p class="indent">The method <span class="literal">_check_aliens_bottom()</span> checks whether any aliens have reached the bottom of the screen. An alien reaches the bottom when its <span class="literal">rect.bottom</span> value is greater than or equal to the screen’s <span class="literal">rect.bottom</span> attribute <span class="ent">➊</span>. If an alien reaches the bottom, we call <span class="literal">_ship_hit()</span>. If one alien hits the bottom, there’s no need to check the rest, so we break out of the loop after calling <span class="literal">_ship_hit()</span>.</p>
<p class="indent">We’ll call this method from <span class="literal">_update_aliens()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_aliens(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Look for alien-ship collisions.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if pygame.sprite.spritecollideany(self.ship, self.aliens):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._ship_hit()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Look for aliens hitting the bottom of the screen.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._check_aliens_bottom()</p>
<p class="indent">We call <span class="literal">_check_aliens_bottom()</span> after updating the positions of all the aliens and after looking for alien and ship collisions <span class="ent">➋</span>. Now a new fleet will appear every time the ship is hit by an alien or an alien reaches the bottom of the screen.</p>
<h4 class="h3" id="calibre_link-976"><strong class="calibre2"><em class="calibre3">Game Over!</em></strong></h4>
<p class="noindent"><em class="calibre3">Alien Invasion</em> feels more complete now, but the game never ends. The value of <span class="literal">ships_left</span> just grows increasingly negative. Let’s add a <span class="literal">game_active</span> flag as an attribute to <span class="literal">GameStats</span> to end the game when the player runs out of ships. We’ll set this flag at the end of the <span class="literal">__init__()</span> method in <span class="literal">GameStats</span>:</p>
<p class="margin"><em class="calibre3">game_stats.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Start Alien Invasion in an active state.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.game_active = True</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1363" class="calibre"></span>Now we add code to <span class="literal">_ship_hit()</span> that sets <span class="literal">game_active</span> to <span class="literal">False</span> when the player has used up all their ships:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _ship_hit(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to ship being hit by alien."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.stats.ships_left &gt; 0:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Decrement ships_left.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.ships_left -= 1</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Pause.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">sleep(0.5)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.game_active = False</p>
<p class="indent">Most of <span class="literal">_ship_hit()</span> is unchanged. We’ve moved all the existing code into an <span class="literal">if</span> block, which tests to make sure the player has at least one ship remaining. If so, we create a new fleet, pause, and move on. If the player has no ships left, we set <span class="literal">game_active</span> to <span class="literal">False</span>.</p>
<h4 class="h3" id="calibre_link-977"><strong class="calibre2"><em class="calibre3">Identifying When Parts of the Game Should Run</em></strong></h4>
<p class="noindent">We need to identify the parts of the game that should always run and the parts that should run only when the game is active:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def run_game(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start the main loop for the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._check_events()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.stats.game_active:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship.update()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_bullets()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_aliens()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._update_screen()</span></p>
<p class="indent">In the main loop, we always need to call <span class="literal">_check_events()</span>, even if the game is inactive. For example, we still need to know if the user presses Q to quit the game or clicks the button to close the window. We also continue updating the screen so we can make changes to the screen while waiting to see whether the player chooses to start a new game. The rest of the function calls only need to happen when the game is active, because when the game is inactive, we don’t need to update the positions of game elements.</p>
<p class="indent">Now when you play <em class="calibre3">Alien Invasion</em>, the game should freeze when you’ve used up all your ships.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-1364" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-978"><strong class="calibre2">13-6. Game Over:</strong> In Sideways Shooter, keep track of the number of times the ship is hit and the number of times an alien is hit by the ship. Decide on an appropriate condition for ending the game, and stop the game when this situation occurs.</p>
</div>
<h3 class="h2" id="calibre_link-979"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned how to add a large number of identical elements to a game by creating a fleet of aliens. You used nested loops to create a grid of elements, and you made a large set of game elements move by calling each element’s <span class="literal">update()</span> method. You learned to control the direction of objects on the screen and to respond to specific situations, such as when the fleet reaches the edge of the screen. You detected and responded to collisions when bullets hit aliens and aliens hit the ship. You also learned how to track statistics in a game and use a <span class="literal">game_active</span> flag to determine when the game is over.</p>
<p class="indent">In the next and final chapter of this project, we’ll add a Play button so the player can choose when to start their first game and whether to play again when the game ends. We’ll speed up the game each time the player shoots down the entire fleet, and we’ll add a scoring system. The final result will be a fully playable game!</p>
</div>


<div class="calibre1" id="calibre_link-105">
<h2 class="h" id="calibre_link-13"><span type="pagebreak" id="calibre_link-1365" class="calibre"></span><strong class="calibre2"><span class="big">14</span><br class="calibre4" />SCORING</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter, we’ll finish the <em class="calibre3">Alien Invasion</em> game. We’ll add a Play button to start a game on demand or to restart a game once it ends. We’ll also change the game so it speeds up when the player moves up a level, and implement a scoring system. By the end of the chapter, you’ll know enough to start writing games that increase in difficulty as a player progresses and show scores.</p>
<h3 class="h2" id="calibre_link-980"><span type="pagebreak" id="calibre_link-208" class="calibre"></span><strong class="calibre2">Adding the Play Button</strong></h3>
<p class="noindent">In this section, we’ll add a Play button that appears before a game begins and reappears when the game ends so the player can play again.</p>
<p class="indent">Right now the game begins as soon as you run <em class="calibre3">alien_invasion.py</em>. Let’s start the game in an inactive state and then prompt the player to click a Play button to begin. To do this, modify the <span class="literal">__init__()</span> method of <span class="literal">GameStats</span>:</p>
<p class="margin"><em class="calibre3">game_stats.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize statistics."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.settings = ai_game.settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.reset_stats()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Start game in an inactive state.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.game_active = False</p>
<p class="indent">Now the game should start in an inactive state with no way for the player to start it until we make a Play button.</p>
<h4 class="h3" id="calibre_link-981"><strong class="calibre2"><em class="calibre3">Creating a Button Class</em></strong></h4>
<p class="noindent">Because Pygame doesn’t have a built-in method for making buttons, we’ll write a <span class="literal">Button</span> class to create a filled rectangle with a label. You can use this code to make any button in a game. Here’s the first part of the <span class="literal">Button</span> class; save it as <em class="calibre3">button.py</em>:</p>
<p class="margin"><em class="calibre3">button.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import pygame.font<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class Button:<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, ai_game, msg):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize button attributes."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = ai_game.screen<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen_rect = self.screen.get_rect()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set the dimensions and properties of the button.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.width, self.height = 200, 50<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.button_color = (0, 255, 0)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.text_color = (255, 255, 255)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.font = pygame.font.SysFont(None, 48)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Build the button's rect object and center it.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect = pygame.Rect(0, 0, self.width, self.height)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.rect.center = self.screen_rect.center<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The button message needs to be prepped only once.<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._prep_msg(msg)</p>
<p class="indent">First, we import the <span class="literal">pygame.font</span> module, which lets Pygame render text to the screen. The <span class="literal">__init__()</span> method takes the parameters <span class="literal">self</span>, the <span class="literal">ai_game</span> <span type="pagebreak" id="calibre_link-209" class="calibre"></span>object, and <span class="literal">msg</span>, which contains the button’s text <span class="ent">➊</span>. We set the button dimensions at <span class="ent">➋</span>, and then set <span class="literal">button_color</span> to color the button’s <span class="literal">rect</span> object bright green and set <span class="literal">text_color</span> to render the text in white.</p>
<p class="indent">At <span class="ent">➌</span>, we prepare a <span class="literal">font</span> attribute for rendering text. The <span class="literal">None</span> argument tells Pygame to use the default font, and <span class="literal">48</span> specifies the size of the text. To center the button on the screen, we create a <span class="literal">rect</span> for the button <span class="ent">➍</span> and set its <span class="literal">center</span> attribute to match that of the screen.</p>
<p class="indent">Pygame works with text by rendering the string you want to display as an image. At <span class="ent">➎</span>, we call <span class="literal">_prep_msg()</span> to handle this rendering.</p>
<p class="indent">Here’s the code for <span class="literal">_prep_msg()</span>:</p>
<p class="margin"><em class="calibre3">button.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _prep_msg(self, msg):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Turn msg into a rendered image and center text on the button."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.msg_image = self.font.render(msg, True, self.text_color,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.button_color)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.msg_image_rect = self.msg_image.get_rect()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.msg_image_rect.center = self.rect.center</p>
<p class="indent">The <span class="literal">_prep_msg()</span> method needs a <span class="literal">self</span> parameter and the text to be rendered as an image (<span class="literal">msg</span>). The call to <span class="literal">font.render()</span> turns the text stored in <span class="literal">msg</span> into an image, which we then store in <span class="literal">self.msg_image</span> <span class="ent">➊</span>. The <span class="literal">font.render()</span> method also takes a Boolean value to turn antialiasing on or off (antialiasing makes the edges of the text smoother). The remaining arguments are the specified font color and background color. We set antialiasing to <span class="literal">True</span> and set the text background to the same color as the button. (If you don’t include a background color, Pygame will try to render the font with a transparent background.)</p>
<p class="indent">At <span class="ent">➋</span>, we center the text image on the button by creating a <span class="literal">rect</span> from the image and setting its <span class="literal">center</span> attribute to match that of the button.</p>
<p class="indent">Finally, we create a <span class="literal">draw_button()</span> method that we can call to display the button onscreen:</p>
<p class="margin"><em class="calibre3">button.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def draw_button(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Draw blank button and then draw message.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.fill(self.button_color, self.rect)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.blit(self.msg_image, self.msg_image_rect)</p>
<p class="indent">We call <span class="literal">screen.fill()</span> to draw the rectangular portion of the button. Then we call <span class="literal">screen.blit()</span> to draw the text image to the screen, passing it an image and the <span class="literal">rect</span> object associated with the image. This completes the <span class="literal">Button</span> class.</p>
<h4 class="h3" id="calibre_link-982"><strong class="calibre2"><em class="calibre3">Drawing the Button to the Screen</em></strong></h4>
<p class="noindent">We’ll use the <span class="literal">Button</span> class to create a Play button in <span class="literal">AlienInvasion</span>. First, we’ll update the <span class="literal">import</span> statements:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">from game_stats import GameStats</span><br class="calibre4" />
from button import Button</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1366" class="calibre"></span>Because we need only one Play button, we’ll create the button in the <span class="literal">__init__()</span> method of <span class="literal">AlienInvasion</span>. We can place this code at the very end of <span class="literal">__init__()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._create_fleet()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make the Play button.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.play_button = Button(self, "Play")</p>
<p class="indent">This code creates an instance of <span class="literal">Button</span> with the label <em class="calibre3">Play</em>, but it doesn’t draw the button to the screen. We’ll call the button’s <span class="literal">draw_button()</span> method in <span class="literal">_update_screen()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_screen(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.aliens.draw(self.screen)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Draw the play button if the game is inactive.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if not self.stats.game_active:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.play_button.draw_button()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.flip()</span></p>
<p class="indent">To make the Play button visible above all other elements on the screen, we draw it after all the other elements have been drawn but before flipping to a new screen. We include it in an <span class="literal">if</span> block, so the button only appears when the game is inactive.</p>
<p class="indent">Now when you run <em class="calibre3">Alien Invasion</em>, you should see a Play button in the center of the screen, as shown in <a href="#calibre_link-106" class="calibre6">Figure 14-1</a>.</p>
<div class="image1"><a id="calibre_link-106" class="calibre6"></a><img src="images/000019.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 14-1: A Play button appears when the game is inactive.</em></p>
<h4 class="h3" id="calibre_link-983"><span type="pagebreak" id="calibre_link-221" class="calibre"></span><strong class="calibre2"><em class="calibre3">Starting the Game</em></strong></h4>
<p class="noindent">To start a new game when the player clicks Play, add the following <span class="literal">elif</span> block to the end of <span class="literal">_check_events()</span> to monitor mouse events over the button:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_events(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to keypresses and mouse events."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for event in pygame.event.get():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if event.type == pygame.QUIT:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif event.type == pygame.MOUSEBUTTONDOWN:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mouse_pos = pygame.mouse.get_pos()<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._check_play_button(mouse_pos)</p>
<p class="indent">Pygame detects a <span class="literal">MOUSEBUTTONDOWN</span> event when the player clicks anywhere on the screen <span class="ent">➊</span>, but we want to restrict our game to respond to mouse clicks only on the Play button. To accomplish this, we use <span class="literal">pygame.mouse.get_pos()</span>, which returns a tuple containing the mouse cursor’s x- and y-coordinates when the mouse button is clicked <span class="ent">➋</span>. We send these values to the new method <span class="literal">_check_play_button()</span> <span class="ent">➌</span>.</p>
<p class="indent">Here’s <span class="literal">_check_play_button()</span>, which I chose to place after <span class="literal">_check_events()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _check_play_button(self, mouse_pos):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Start a new game when the player clicks Play."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.play_button.rect.collidepoint(mouse_pos):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.game_active = True</p>
<p class="indent">We use the <span class="literal">rect</span> method <span class="literal">collidepoint()</span> to check whether the point of the mouse click overlaps the region defined by the Play button’s <span class="literal">rect</span> <span class="ent">➊</span>. If so, we set <span class="literal">game_active</span> to <span class="literal">True</span>, and the game begins!</p>
<p class="indent">At this point, you should be able to start and play a full game. When the game ends, the value of <span class="literal">game_active</span> should become <span class="literal">False</span> and the Play button should reappear.</p>
<h4 class="h3" id="calibre_link-984"><strong class="calibre2"><em class="calibre3">Resetting the Game</em></strong></h4>
<p class="noindent">The Play button code we just wrote works the first time the player clicks Play. But it doesn’t work after the first game ends, because the conditions that caused the game to end haven’t been reset.</p>
<p class="indent">To reset the game each time the player clicks Play, we need to reset the game statistics, clear out the old aliens and bullets, build a new fleet, and center the ship, as shown here:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_play_button(self, mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start a new game when the player clicks Play."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if self.play_button.rect.collidepoint(mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reset the game statistics.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.reset_stats()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.game_active = True</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get rid of any remaining aliens and bullets.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.aliens.empty()<br class="calibre4" />
<span type="pagebreak" id="calibre_link-220" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullets.empty()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a new fleet and center the ship.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._create_fleet()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship.center_ship()</p>
<p class="indent">At <span class="ent">➊</span>, we reset the game statistics, which gives the player three new ships. Then we set <span class="literal">game_active</span> to <span class="literal">True</span> so the game will begin as soon as the code in this function finishes running. We empty the <span class="literal">aliens</span> and <span class="literal">bullets</span> groups <span class="ent">➋</span>, and then create a new fleet and center the ship <span class="ent">➌</span>.</p>
<p class="indent">Now the game will reset properly each time you click Play, allowing you to play it as many times as you want!</p>
<h4 class="h3" id="calibre_link-985"><strong class="calibre2"><em class="calibre3">Deactivating the Play Button</em></strong></h4>
<p class="noindent">One issue with our Play button is that the button region on the screen will continue to respond to clicks even when the Play button isn’t visible. If you click the Play button area by accident after a game begins, the game will restart!</p>
<p class="indent">To fix this, set the game to start only when <span class="literal">game_active</span> is <span class="literal">False</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_play_button(self, mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start a new game when the player clicks Play."""</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button_clicked = self.play_button.rect.collidepoint(mouse_pos)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if button_clicked and not self.stats.game_active:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Reset the game statistics.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.reset_stats()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">The flag <span class="literal">button_clicked</span> stores a <span class="literal">True</span> or <span class="literal">False</span> value <span class="ent">➊</span>, and the game will restart only if Play is clicked <em class="calibre3">and</em> the game is not currently active <span class="ent">➋</span>. To test this behavior, start a new game and repeatedly click where the Play button should be. If everything works as expected, clicking the Play button area should have no effect on the gameplay.</p>
<h4 class="h3" id="calibre_link-986"><strong class="calibre2"><em class="calibre3">Hiding the Mouse Cursor</em></strong></h4>
<p class="noindent">We want the mouse cursor to be visible to begin play, but once play begins, it just gets in the way. To fix this, we’ll make it invisible when the game becomes active. We can do this at the end of the <span class="literal">if</span> block in <span class="literal">_check_play_button()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_play_button(self, mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start a new game when the player clicks Play."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">button_clicked = self.play_button.rect.collidepoint(mouse_pos)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if button_clicked and not self.stats.game_active:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Hide the mouse cursor.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pygame.mouse.set_visible(False)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-108" class="calibre"></span>Passing <span class="literal">False</span> to <span class="literal">set_visible()</span> tells Pygame to hide the cursor when the mouse is over the game window.</p>
<p class="indent">We’ll make the cursor reappear once the game ends so the player can click Play again to begin a new game. Here’s the code to do that:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _ship_hit(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to ship being hit by alien."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if self.stats.ships_left &gt; 0:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.game_active = False</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pygame.mouse.set_visible(True)</p>
<p class="indent">We make the cursor visible again as soon as the game becomes inactive, which happens in <span class="literal">_ship_hit()</span>. Attention to details like this makes your game more professional looking and allows the player to focus on playing rather than figuring out the user interface.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-987"><strong class="calibre2">14-1. Press P to Play:</strong> Because <em class="calibre3">Alien Invasion</em> uses keyboard input to control the ship, it would be useful to start the game with a keypress. Add code that lets the player press P to start. It might help to move some code from <span class="literal1">_check_play_button()</span> to a <span class="literal1">_start_game()</span> method that can be called from <span class="literal1">_check_play_button()</span> <em class="calibre3">and</em> <span class="literal1">_check_keydown_events()</span>.</p>
<p class="sparal" id="calibre_link-107"><strong class="calibre2">14-2. Target Practice:</strong> Create a rectangle at the right edge of the screen that moves up and down at a steady rate. Then have a ship appear on the left side of the screen that the player can move up and down while firing bullets at the moving, rectangular target. Add a Play button that starts the game, and when the player misses the target three times, end the game and make the Play button reappear. Let the player restart the game with this Play button.</p>
</div>
<h3 class="h2" id="calibre_link-988"><strong class="calibre2">Leveling Up</strong></h3>
<p class="noindent">In our current game, once a player shoots down the entire alien fleet, the player reaches a new level, but the game difficulty doesn’t change. Let’s liven things up a bit and make the game more challenging by increasing the game’s speed each time a player clears the screen.</p>
<h4 class="h3" id="calibre_link-989"><strong class="calibre2"><em class="calibre3">Modifying the Speed Settings</em></strong></h4>
<p class="noindent">We’ll first reorganize the <span class="literal">Settings</span> class to group the game settings into static and changing ones. We’ll also make sure that settings that change <span type="pagebreak" id="calibre_link-217" class="calibre"></span>during the game reset when we start a new game. Here’s the <span class="literal">__init__()</span> method for <em class="calibre3">settings.py</em>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize the game's static settings."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Screen settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen_width = 1200</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen_height = 800</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bg_color = (230, 230, 230)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Ship settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship_limit = 3</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Bullet settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullet_width = 3</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullet_height = 15</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullet_color = 60, 60, 60</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets_allowed = 3</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Alien settings</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.fleet_drop_speed = 10</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# How quickly the game speeds up<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.speedup_scale = 1.1<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initialize_dynamic_settings()</p>
<p class="indent">We continue to initialize those settings that stay constant in the <span class="literal">__init__()</span> method. At <span class="ent">➊</span>, we add a <span class="literal">speedup_scale</span> setting to control how quickly the game speeds up: a value of 2 will double the game speed every time the player reaches a new level; a value of 1 will keep the speed constant. A value like 1.1 should increase the speed enough to make the game challenging but not impossible. Finally, we call the <span class="literal">initialize_dynamic_settings()</span> method to initialize the values for attributes that need to change throughout the game <span class="ent">➋</span>.</p>
<p class="indent">Here’s the code for <span class="literal">initialize_dynamic_settings()</span>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def initialize_dynamic_settings(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize settings that change throughout the game."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship_speed = 1.5<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullet_speed = 3.0<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.alien_speed = 1.0<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# fleet_direction of 1 represents right; -1 represents left.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.fleet_direction = 1</p>
<p class="indent">This method sets the initial values for the ship, bullet, and alien speeds. We’ll increase these speeds as the player progresses in the game and reset them each time the player starts a new game. We include <span class="literal">fleet_direction</span> in this method so the aliens always move right at the beginning of a new game. We don’t need to increase the value of <span class="literal">fleet_drop_speed</span>, because when the aliens move faster across the screen, they’ll also come down the screen faster.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-218" class="calibre"></span>To increase the speeds of the ship, bullets, and aliens each time the player reaches a new level, we’ll write a new method called <span class="literal">increase_speed()</span>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def increase_speed(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Increase speed settings."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ship_speed *= self.speedup_scale<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.bullet_speed *= self.speedup_scale<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.alien_speed *= self.speedup_scale</p>
<p class="indent">To increase the speed of these game elements, we multiply each speed setting by the value of <span class="literal">speedup_scale</span>.</p>
<p class="indent">We increase the game’s tempo by calling <span class="literal">increase_speed()</span> in <span class="literal">_check_bullet_alien_collisions()</span> when the last alien in a fleet has been shot down:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_bullet_alien_collisions(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if not self.aliens:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Destroy existing bullets and create new fleet.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.empty()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._create_fleet()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings.increase_speed()</p>
<p class="indent">Changing the values of the speed settings <span class="literal">ship_speed</span>, <span class="literal">alien_speed</span>, and <span class="literal">bullet_speed</span> is enough to speed up the entire game!</p>
<h4 class="h3" id="calibre_link-990"><strong class="calibre2"><em class="calibre3">Resetting the Speed</em></strong></h4>
<p class="noindent">Now we need to return any changed settings to their initial values each time the player starts a new game; otherwise, each new game would start with the increased speed settings of the previous game:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_play_button(self, mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Start a new game when the player clicks Play."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">button_clicked = self.play_button.rect.collidepoint(mouse_pos)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if button_clicked and not self.stats.game_active:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reset the game settings.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings.initialize_dynamic_settings()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Playing <em class="calibre3">Alien Invasion</em> should be more fun and challenging now. Each time you clear the screen, the game should speed up and become slightly more difficult. If the game becomes too difficult too quickly, decrease the value of <span class="literal">settings.speedup_scale</span>. Or if the game isn’t challenging enough, increase the value slightly. Find a sweet spot by ramping up the difficulty in a reasonable amount of time. The first couple of screens should be easy, the next few challenging but doable, and subsequent screens almost impossibly difficult.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-211" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-991"><strong class="calibre2">14-3. Challenging Target Practice:</strong> Start with your work from <a href="#calibre_link-107" class="calibre6">Exercise 14-2</a> (<a href="#calibre_link-108" class="calibre6">page 285</a>). Make the target move faster as the game progresses, and restart the target at the original speed when the player clicks Play.</p>
<p class="sparal" id="calibre_link-992"><strong class="calibre2">14-4. Difficulty Levels:</strong> Make a set of buttons for <em class="calibre3">Alien Invasion</em> that allows the player to select an appropriate starting difficulty level for the game. Each button should assign the appropriate values for the attributes in <span class="literal1">Settings</span> needed to create different difficulty levels.</p>
</div>
<h3 class="h2" id="calibre_link-993"><strong class="calibre2">Scoring</strong></h3>
<p class="noindent">Let’s implement a scoring system to track the game’s score in real time and display the high score, level, and number of ships remaining.</p>
<p class="indent">The score is a game statistic, so we’ll add a <span class="literal">score</span> attribute to <span class="literal">GameStats</span>:</p>
<p class="margin"><em class="calibre3">game_stats.py</em></p>
<p class="programs"><span class="ash">class GameStats:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def reset_stats(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize statistics that can change during the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ships_left = self.ai_settings.ship_limit</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score = 0</p>
<p class="indent">To reset the score each time a new game starts, we initialize <span class="literal">score</span> in <span class="literal">reset_stats()</span> rather than <span class="literal">__init__()</span>.</p>
<h4 class="h3" id="calibre_link-994"><strong class="calibre2"><em class="calibre3">Displaying the Score</em></strong></h4>
<p class="noindent">To display the score on the screen, we first create a new class, <span class="literal">Scoreboard</span>. For now, this class will just display the current score, but eventually we’ll use it to report the high score, level, and number of ships remaining as well. Here’s the first part of the class; save it as <em class="calibre3">scoreboard.py</em>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">import pygame.font<br class="calibre4" />
<br class="calibre4" />
class Scoreboard:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A class to report scoring information."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, ai_game):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize scorekeeping attributes."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen = ai_game.screen<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen_rect = self.screen.get_rect()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.settings = ai_game.settings<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats = ai_game.stats<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Font settings for scoring information.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.text_color = (30, 30, 30)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.font = pygame.font.SysFont(None, 48)<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-212" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prepare the initial score image.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.prep_score()</p>
<p class="indent">Because <span class="literal">Scoreboard</span> writes text to the screen, we begin by importing the <span class="literal">pygame.font</span> module. Next, we give <span class="literal">__init__()</span> the <span class="literal">ai_game</span> parameter so it can access the <span class="literal">settings</span>, <span class="literal">screen</span>, and <span class="literal">stats</span> objects, which it will need to report the values we’re tracking <span class="ent">➊</span>. Then we set a text color <span class="ent">➋</span> and instantiate a font object <span class="ent">➌</span>.</p>
<p class="indent">To turn the text to be displayed into an image, we call <span class="literal">prep_score()</span> <span class="ent">➍</span>, which we define here:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def prep_score(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Turn the score into a rendered image."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score_str = str(self.stats.score)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_image = self.font.render(score_str, True,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.text_color, self.settings.bg_color)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Display the score at the top right of the screen.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_rect = self.score_image.get_rect()<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_rect.right = self.screen_rect.right - 20<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_rect.top = 20</p>
<p class="indent">In <span class="literal">prep_score()</span>, we turn the numerical value <span class="literal">stats.score</span> into a string <span class="ent">➊</span>, and then pass this string to <span class="literal">render()</span>, which creates the image <span class="ent">➋</span>. To display the score clearly onscreen, we pass the screen’s background color and the text color to <span class="literal">render()</span>.</p>
<p class="indent">We’ll position the score in the upper-right corner of the screen and have it expand to the left as the score increases and the width of the number grows. To make sure the score always lines up with the right side of the screen, we create a <span class="literal">rect</span> called <span class="literal">score_rect</span> <span class="ent">➌</span> and set its right edge 20 pixels from the right edge of the screen <span class="ent">➍</span>. We then place the top edge 20 pixels down from the top of the screen <span class="ent">➎</span>.</p>
<p class="indent">Then we create a <span class="literal">show_score()</span> method to display the rendered score image:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def show_score(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Draw score to the screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.blit(self.score_image, self.score_rect)</p>
<p class="indent">This method draws the score image onscreen at the location <span class="literal">score_rect</span> specifies.</p>
<h4 class="h3" id="calibre_link-995"><strong class="calibre2"><em class="calibre3">Making a Scoreboard</em></strong></h4>
<p class="noindent">To display the score, we’ll create a <span class="literal">Scoreboard</span> instance in <span class="literal">AlienInvasion</span>. First, let’s update the <span class="literal">import</span> statements:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">from game_stats import GameStats</span><br class="calibre4" />
from scoreboard import Scoreboard<br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-1367" class="calibre"></span>Next, we make an instance of <span class="literal">Scoreboard</span> in <span class="literal">__init__()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">pygame.display.set_caption("Alien Invasion")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create an instance to store game statistics,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;and create a scoreboard.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats = GameStats(self)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb = Scoreboard(self)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Then we draw the scoreboard onscreen in <span class="literal">_update_screen()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _update_screen(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.aliens.draw(self.screen)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Draw the score information.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.show_score()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Draw the play button if the game is inactive.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We call <span class="literal">show_score()</span> just before we draw the Play button.</p>
<p class="indent">When you run <em class="calibre3">Alien Invasion</em> now, a 0 should appear at the top right of the screen. (At this point, we just want to make sure the score appears in the right place before developing the scoring system further.) <a href="#calibre_link-109" class="calibre6">Figure 14-2</a> shows the score as it appears before the game starts.</p>
<div class="image1"><a id="calibre_link-109" class="calibre6"></a><img src="images/000013.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 14-2: The score appears at the top-right corner of the screen.</em></p>
<p class="indent"><span type="pagebreak" id="calibre_link-190" class="calibre"></span>Next, we’ll assign point values to each alien!</p>
<h4 class="h3" id="calibre_link-996"><strong class="calibre2"><em class="calibre3">Updating the Score as Aliens Are Shot Down</em></strong></h4>
<p class="noindent">To write a live score onscreen, we update the value of <span class="literal">stats.score</span> whenever an alien is hit, and then call <span class="literal">prep_score()</span> to update the score image. But first, let’s determine how many points a player gets each time they shoot down an alien:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def initialize_dynamic_settings(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Scoring<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.alien_points = 50</p>
<p class="indent">We’ll increase each alien’s point value as the game progresses. To make sure this point value is reset each time a new game starts, we set the value in <span class="literal">initialize_dynamic_settings()</span>.</p>
<p class="indent">Let’s update the score each time an alien is shot down in <span class="literal">_check_bullet_alien_collisions()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_bullet_alien_collisions(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to bullet-alien collisions."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Remove any bullets and aliens that have collided.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">collisions = pygame.sprite.groupcollide(</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets, self.aliens, True, True)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if collisions:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.score += self.settings.alien_points<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.prep_score()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">When a bullet hits an alien, Pygame returns a <span class="literal">collisions</span> dictionary. We check whether the dictionary exists, and if it does, the alien’s value is added to the score. We then call <span class="literal">prep_score()</span> to create a new image for the updated score.</p>
<p class="indent">Now when you play <em class="calibre3">Alien Invasion</em>, you should be able to rack up points!</p>
<h4 class="h3" id="calibre_link-997"><strong class="calibre2"><em class="calibre3">Resetting the Score</em></strong></h4>
<p class="noindent">Right now, we’re only prepping a new score <em class="calibre3">after</em> an alien has been hit, which works for most of the game. But we still see the old score when a new game starts until the first alien is hit in the new game.</p>
<p class="indent">We can fix this by prepping the score when starting a new game:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_play_button(self, mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if button_clicked and not self.stats.game_active:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Reset the game statistics.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.reset_stats()</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-191" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.game_active = True</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.prep_score()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We call <span class="literal">prep_score()</span> after resetting the game stats when starting a new game. This preps the scoreboard with a 0 score.</p>
<h4 class="h3" id="calibre_link-998"><strong class="calibre2"><em class="calibre3">Making Sure to Score All Hits</em></strong></h4>
<p class="noindent">As currently written, our code could miss scoring for some aliens. For example, if two bullets collide with aliens during the same pass through the loop or if we make an extra-wide bullet to hit multiple aliens, the player will only receive points for hitting one of the aliens. To fix this, let’s refine the way that bullet and alien collisions are detected.</p>
<p class="indent">In <span class="literal">_check_bullet_alien_collisions()</span>, any bullet that collides with an alien becomes a key in the <span class="literal">collisions</span> dictionary. The value associated with each bullet is a list of aliens it has collided with. We loop through the values in the <span class="literal">collisions</span> dictionary to make sure we award points for each alien hit:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">def _check_bullet_alien_collisions(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if collisions:</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for aliens in collisions.values():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.score += self.settings.alien_points * len(aliens)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.sb.prep_score()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">If the <span class="literal">collisions</span> dictionary has been defined, we loop through all values in the dictionary. Remember that each value is a list of aliens hit by a single bullet. We multiply the value of each alien by the number of aliens in each list and add this amount to the current score. To test this, change the width of a bullet to 300 pixels and verify that you receive points for each alien you hit with your extra-wide bullets; then return the bullet width to its normal value.</p>
<h4 class="h3" id="calibre_link-999"><strong class="calibre2"><em class="calibre3">Increasing Point Values</em></strong></h4>
<p class="noindent">Because the game gets more difficult each time a player reaches a new level, aliens in later levels should be worth more points. To implement this functionality, we’ll add code to increase the point value when the game’s speed increases:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">class Settings:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A class to store all settings for Alien Invasion."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># How quickly the game speeds up</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.speedup_scale = 1.1</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-226" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# How quickly the alien point values increase<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_scale = 1.5<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.initialize_dynamic_settings()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def initialize_dynamic_settings(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def increase_speed(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Increase speed settings and alien point values."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ship_speed *= self.speedup_scale</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullet_speed *= self.speedup_scale</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.alien_speed *= self.speedup_scale</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.alien_points = int(self.alien_points * self.score_scale)</p>
<p class="indent">We define a rate at which points increase, which we call <span class="literal">score_scale</span> <span class="ent">➊</span>. A small increase in speed (1.1) makes the game more challenging quickly. But to see a more notable difference in scoring, we need to change the alien point value by a larger amount (1.5). Now when we increase the game’s speed, we also increase the point value of each hit <span class="ent">➋</span>. We use the <span class="literal">int()</span> function to increase the point value by whole integers.</p>
<p class="indent">To see the value of each alien, add a <span class="literal">print()</span> call to the <span class="literal">increase_speed()</span> method in <span class="literal">Settings</span>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def increase_speed(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.alien_points = int(self.alien_points * self.score_scale)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(self.alien_points)</p>
<p class="indent">The new point value should appear in the terminal every time you reach a new level.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Be sure to remove the <span class="codeitalic">print()</span> call after verifying that the point value is increasing, or it might affect your game’s performance and distract the player.</em></p>
</div>
<h4 class="h3" id="calibre_link-1000"><strong class="calibre2"><em class="calibre3">Rounding the Score</em></strong></h4>
<p class="noindent">Most arcade-style shooting games report scores as multiples of 10, so let’s follow that lead with our scores. Also, let’s format the score to include comma separators in large numbers. We’ll make this change in <span class="literal">Scoreboard</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def prep_score(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Turn the score into a rendered image."""</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rounded_score = round(self.stats.score, -1)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score_str = "{:,}".format(rounded_score)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.score_image = self.font.render(score_str, True,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.text_color, self.settings.bg_color)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-223" class="calibre"></span>The <span class="literal">round()</span> function normally rounds a decimal number to a set number of decimal places given as the second argument. However, when you pass a negative number as the second argument, <span class="literal">round()</span> will round the value to the nearest 10, 100, 1000, and so on. The code at <span class="ent">➊</span> tells Python to round the value of <span class="literal">stats.score</span> to the nearest 10 and store it in <span class="literal">rounded_score</span>.</p>
<p class="indent">At <span class="ent">➋</span>, a string formatting directive tells Python to insert commas into numbers when converting a numerical value to a string: for example, to output <span class="literal">1,000,000</span> instead of <span class="literal">1000000</span>. Now when you run the game, you should see a neatly formatted, rounded score even when you rack up lots of points, as shown in <a href="#calibre_link-110" class="calibre6">Figure 14-3</a>.</p>
<div class="image1"><a id="calibre_link-110" class="calibre6"></a><img src="images/000026.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 14-3: A rounded score with comma separators</em></p>
<h4 class="h3" id="calibre_link-1001"><strong class="calibre2"><em class="calibre3">High Scores</em></strong></h4>
<p class="noindent">Every player wants to beat a game’s high score, so let’s track and report high scores to give players something to work toward. We’ll store high scores in <span class="literal">GameStats</span>:</p>
<p class="margin"><em class="calibre3">game_stats.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# High score should never be reset.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.high_score = 0</p>
<p class="indent">Because the high score should never be reset, we initialize <span class="literal">high_score</span> in <span class="literal">__init__()</span> rather than in <span class="literal">reset_stats()</span>.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1368" class="calibre"></span>Next, we’ll modify <span class="literal">Scoreboard</span> to display the high score. Let’s start with the <span class="literal">__init__()</span> method:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prepare the initial score images.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.prep_score()</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.prep_high_score()</p>
<p class="indent">The high score will be displayed separately from the score, so we need a new method, <span class="literal">prep_high_score()</span>, to prepare the high score image <span class="ent">➊</span>.</p>
<p class="indent">Here’s the <span class="literal">prep_high_score()</span> method:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def prep_high_score(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Turn the high score into a rendered image."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high_score = round(self.stats.high_score, -1)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high_score_str = "{:,}".format(high_score)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.high_score_image = self.font.render(high_score_str, True,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.text_color, self.settings.bg_color)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Center the high score at the top of the screen.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.high_score_rect = self.high_score_image.get_rect()<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.high_score_rect.centerx = self.screen_rect.centerx<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.high_score_rect.top = self.score_rect.top</p>
<p class="indent">We round the high score to the nearest 10 and format it with commas <span class="ent">➊</span>. We then generate an image from the high score <span class="ent">➋</span>, center the high score <span class="literal">rect</span> horizontally <span class="ent">➌</span>, and set its <span class="literal">top</span> attribute to match the top of the score image <span class="ent">➍</span>.</p>
<p class="indent">The <span class="literal">show_score()</span> method now draws the current score at the top right and the high score at the top center of the screen:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def show_score(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Draw score to the screen."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.blit(self.score_image, self.score_rect)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.blit(self.high_score_image, self.high_score_rect)</p>
<p class="indent">To check for high scores, we’ll write a new method, <span class="literal">check_high_score()</span>, in <span class="literal">Scoreboard</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;def check_high_score(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Check to see if there's a new high score."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.stats.score &gt; self.stats.high_score:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.high_score = self.stats.score<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.prep_high_score()</p>
<p class="indent">The method <span class="literal">check_high_score()</span> checks the current score against the high score. If the current score is greater, we update the value of <span class="literal">high_score</span> and call <span class="literal">prep_high_score()</span> to update the high score’s image.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-224" class="calibre"></span>We need to call <span class="literal">check_high_score()</span> each time an alien is hit after updating the score in <span class="literal">_check_bullet_alien_collisions()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_bullet_alien_collisions(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if collisions:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for aliens in collisions.values():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.score += self.settings.alien_points * len(aliens)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.sb.prep_score()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.check_high_score()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We call <span class="literal">check_high_score()</span> when the <span class="literal">collisions</span> dictionary is present, and we do so after updating the score for all the aliens that have been hit.</p>
<p class="indent">The first time you play <em class="calibre3">Alien Invasion</em>, your score will be the high score, so it will be displayed as the current score and the high score. But when you start a second game, your high score should appear in the middle and your current score at the right, as shown in <a href="#calibre_link-111" class="calibre6">Figure 14-4</a>.</p>
<div class="image1"><a id="calibre_link-111" class="calibre6"></a><img src="images/000034.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 14-4: The high score is shown at the top center of the screen.</em></p>
<h4 class="h3" id="calibre_link-1002"><strong class="calibre2"><em class="calibre3">Displaying the Level</em></strong></h4>
<p class="noindent">To display the player’s level in the game, we first need an attribute in <span class="literal">GameStats</span> representing the current level. To reset the level at the start of each new game, initialize it in <span class="literal">reset_stats()</span>:</p>
<p class="margin"><em class="calibre3">game_stats.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def reset_stats(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize statistics that can change during the game."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.ships_left = self.settings.ship_limit</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-1369" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.score = 0</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.level = 1</p>
<p class="indent">To have <span class="literal">Scoreboard</span> display the current level, we call a new method, <span class="literal">prep_level()</span>, from <span class="literal">__init__()</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.prep_high_score()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.prep_level()</p>
<p class="indent">Here’s <span class="literal">prep_level()</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def prep_level(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Turn the level into a rendered image."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;level_str = str(self.stats.level)<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.level_image = self.font.render(level_str, True,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.text_color, self.settings.bg_color)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Position the level below the score.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.level_rect = self.level_image.get_rect()<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.level_rect.right = self.score_rect.right<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.level_rect.top = self.score_rect.bottom + 10</p>
<p class="indent">The <span class="literal">prep_level()</span> method creates an image from the value stored in <span class="literal">stats.level</span> <span class="ent">➊</span> and sets the image’s <span class="literal">right</span> attribute to match the score’s <span class="literal">right</span> attribute <span class="ent">➋</span>. It then sets the <span class="literal">top</span> attribute 10 pixels beneath the bottom of the score image to leave space between the score and the level <span class="ent">➌</span>.</p>
<p class="indent">We also need to update <span class="literal">show_score()</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def show_score(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Draw scores and level to the screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.blit(self.score_image, self.score_rect)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.blit(self.high_score_image, self.high_score_rect)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.screen.blit(self.level_image, self.level_rect)</p>
<p class="indent">This new line draws the level image to the screen.</p>
<p class="indent">We’ll increment <span class="literal">stats.level</span> and update the level image in <span class="literal">_check_bullet_alien_collisions()</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_bullet_alien_collisions(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if not self.aliens:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Destroy existing bullets and create new fleet.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.bullets.empty()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self._create_fleet()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.settings.increase_speed()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Increase level.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stats.level += 1<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.prep_level()</p>
<p class="indent"><span type="pagebreak" id="calibre_link-225" class="calibre"></span>If a fleet is destroyed, we increment the value of <span class="literal">stats.level</span> and call <span class="literal">prep_level()</span> to make sure the new level displays correctly.</p>
<p class="indent">To ensure the level image updates properly at the start of a new game, we also call <span class="literal">prep_level()</span> when the player clicks the Play button:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_play_button(self, mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if button_clicked and not self.stats.game_active:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.sb.prep_score()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.prep_level()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We call <span class="literal">prep_level()</span> right after calling <span class="literal">prep_score()</span>.</p>
<p class="indent">Now you’ll see how many levels you’ve completed, as shown in <a href="#calibre_link-112" class="calibre6">Figure 14-5</a>.</p>
<div class="image1"><a id="calibre_link-112" class="calibre6"></a><img src="images/000041.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 14-5: The current level appears just below the current score.</em></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">In some classic games, the scores have labels, such as Score, High Score, and Level. We’ve omitted these labels because the meaning of each number becomes clear once you’ve played the game. To include these labels, add them to the score strings just before the calls to <span class="codeitalic">font.render()</span> in <span class="codeitalic">Scoreboard</span>.</em></p>
</div>
<h4 class="h3" id="calibre_link-1003"><strong class="calibre2"><em class="calibre3">Displaying the Number of Ships</em></strong></h4>
<p class="noindent">Finally, let’s display the number of ships the player has left, but this time, let’s use a graphic. To do so, we’ll draw ships in the upper-left corner of <span type="pagebreak" id="calibre_link-1370" class="calibre"></span>the screen to represent how many ships are left, just as many classic arcade games do.</p>
<p class="indent">First, we need to make <span class="literal">Ship</span> inherit from <span class="literal">Sprite</span> so we can create a group of ships:</p>
<p class="margin"><em class="calibre3">ship.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import pygame</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;from pygame.sprite import Sprite<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> class Ship(Sprite):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""A class to manage the ship."""</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize the ship and set its starting position."""</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super().__init__()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Here we import <span class="literal">Sprite</span>, make sure <span class="literal">Ship</span> inherits from <span class="literal">Sprite</span> <span class="ent">➊</span>, and call <span class="literal">super()</span> at the beginning of <span class="literal">__init__()</span> <span class="ent">➋</span>.</p>
<p class="indent">Next, we need to modify <span class="literal">Scoreboard</span> to create a group of ships we can display. Here are the <span class="literal">import</span> statements for <span class="literal">Scoreboard</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs"><span class="ash">import pygame.font</span><br class="calibre4" />
from pygame.sprite import Group<br class="calibre4" />
<br class="calibre4" />
from ship import Ship</p>
<p class="indent">Because we’re making a group of ships, we import the <span class="literal">Group</span> and <span class="literal">Ship</span> classes.</p>
<p class="indent">Here’s <span class="literal">__init__()</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __init__(self, ai_game):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Initialize scorekeeping attributes."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ai_game = ai_game<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen = ai_game.screen</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.prep_level()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.prep_ships()</p>
<p class="indent">We assign the game instance to an attribute, because we’ll need it to create some ships. We call <span class="literal">prep_ships()</span> after the call to <span class="literal">prep_level()</span>.</p>
<p class="indent">Here’s <span class="literal">prep_ships()</span>:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def prep_ships(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Show how many ships are left."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ships = Group()<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for ship_number in range(self.stats.ships_left):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ship = Ship(self.ai_game)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ship.rect.x = 10 + ship_number * ship.rect.width<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ship.rect.y = 10<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ships.add(ship)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-222" class="calibre"></span>The <span class="literal">prep_ships()</span> method creates an empty group, <span class="literal">self.ships</span>, to hold the ship instances <span class="ent">➊</span>. To fill this group, a loop runs once for every ship the player has left <span class="ent">➋</span>. Inside the loop, we create a new ship and set each ship’s x-coordinate value so the ships appear next to each other with a 10-pixel margin on the left side of the group of ships <span class="ent">➌</span>. We set the y-coordinate value 10 pixels down from the top of the screen so the ships appear in the upper-left corner of the screen <span class="ent">➍</span>. Then we add each new ship to the group <span class="literal">ships</span> <span class="ent">➎</span>.</p>
<p class="indent">Now we need to draw the ships to the screen:</p>
<p class="margin"><em class="calibre3">scoreboard.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def show_score(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Draw scores, level, and ships to the screen."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.blit(self.score_image, self.score_rect)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.blit(self.high_score_image, self.high_score_rect)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.screen.blit(self.level_image, self.level_rect)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ships.draw(self.screen)</p>
<p class="indent">To display the ships on the screen, we call <span class="literal">draw()</span> on the group, and Pygame draws each ship.</p>
<p class="indent">To show the player how many ships they have to start with, we call <span class="literal">prep_ships()</span> when a new game starts. We do this in <span class="literal">_check_play_button()</span> in <span class="literal">AlienInvasion</span>:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _check_play_button(self, mouse_pos):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if button_clicked and not self.stats.game_active:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.sb.prep_score()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.sb.prep_level()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.prep_ships()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We also call <span class="literal">prep_ships()</span> when a ship is hit to update the display of ship images when the player loses a ship:</p>
<p class="margin"><em class="calibre3">alien_invasion.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def _ship_hit(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Respond to ship being hit by alien."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if self.stats.ships_left &gt; 0:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Decrement ships_left, and update scoreboard.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">self.stats.ships_left -= 1</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sb.prep_ships()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We call <span class="literal">prep_ships()</span> after decreasing the value of <span class="literal">ships_left</span>, so the correct number of ships displays each time a ship is destroyed.</p>
<p class="indent"><a href="#calibre_link-113" class="calibre6">Figure 14-6</a> shows the complete scoring system with the remaining ships displayed at the top left of the screen.</p>
<div class="image1"><span type="pagebreak" id="calibre_link-1371" class="calibre"></span><a id="calibre_link-113" class="calibre6"></a><img src="images/000049.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 14-6: The complete scoring system for</em> Alien Invasion</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1004"><strong class="calibre2">14-5. All-Time High Score:</strong> The high score is reset every time a player closes and restarts <em class="calibre3">Alien Invasion</em>. Fix this by writing the high score to a file before calling <span class="literal1">sys.exit()</span> and reading in the high score when initializing its value in <span class="literal1">GameStats</span>.</p>
<p class="sparal" id="calibre_link-1005"><strong class="calibre2">14-6. Refactoring:</strong> Look for methods that are doing more than one task, and refactor them to organize your code and make it efficient. For example, move some of the code in <span class="literal1">_check_bullet_alien_collisions()</span>, which starts a new level when the fleet of aliens has been destroyed, to a function called <span class="literal1">start_new_level()</span>. Also, move the four separate method calls in the <span class="literal1">__init__()</span> method in <span class="literal1">Scoreboard</span> to a method called <span class="literal1">prep_images()</span> to shorten <span class="literal1">__init__()</span>. The <span class="literal1">prep_images()</span> method could also help simplify <span class="literal1">_check_play_button()</span> or <span class="literal1">start_game()</span> if you’ve already refactored <span class="literal1">_check_play_button()</span>.</p>
<div class="notea">
<p class="notet"><strong class="calibre2">NOTE</strong></p>
<p class="notep"><em class="calibre3">Before attempting to refactor the project, see <a href="#calibre_link-67" class="calibre6">Appendix D</a> to learn how to restore the project to a working state if you introduce bugs while refactoring.</em></p>
</div>
<p class="sparal" id="calibre_link-1006"><span type="pagebreak" id="calibre_link-1372" class="calibre"></span><strong class="calibre2">14-7. Expanding the Game:</strong> Think of a way to expand <em class="calibre3">Alien Invasion</em>. For example, you could program the aliens to shoot bullets down at the ship or add shields for your ship to hide behind, which can be destroyed by bullets from either side. Or use something like the <span class="literal1">pygame.mixer</span> module to add sound effects, such as explosions and shooting sounds.</p>
<p class="sparal" id="calibre_link-1007"><strong class="calibre2">14-8. Sideways Shooter, Final Version:</strong> Continue developing Sideways Shooter, using everything we’ve done in this project. Add a Play button, make the game speed up at appropriate points, and develop a scoring system. Be sure to refactor your code as you work, and look for opportunities to customize the game beyond what was shown in this chapter.</p>
</div>
<h3 class="h2" id="calibre_link-1008"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned how to implement a Play button to start a new game, detect mouse events, and hide the cursor in active games. You can use what you’ve learned to create other buttons in your games, like a Help button to display instructions on how to play. You also learned how to modify the speed of a game as it progresses, implement a progressive scoring system, and display information in textual and nontextual ways.</p>
</div>


<div class="calibre1" id="calibre_link-34">
<h1 class="h1" id="calibre_link-156"><span type="pagebreak" id="calibre_link-1373" class="calibre"></span><strong class="calibre2">PROJECT 2<br class="calibre4" /><span class="f">DATA VISUALIZATION</span></strong><span type="pagebreak" id="calibre_link-1374" class="calibre"></span></h1>
</div>


<div class="calibre1" id="calibre_link-80">
<h2 class="h" id="calibre_link-14"><span type="pagebreak" id="calibre_link-287" class="calibre"></span><strong class="calibre2"><span class="big">15</span><br class="calibre4" />GENERATING DATA</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent"><em class="calibre3">Data visualization</em> involves exploring data through visual representations. It’s closely associated with <em class="calibre3">data analysis</em>, which uses code to explore the patterns and connections in a data set. A data set can be made up of a small list of numbers that fits in one line of code or it can be many gigabytes of data.</p>
<p class="indent">Making beautiful data representations is about more than pretty pictures. When a representation of a data set is simple and visually appealing, its meaning becomes clear to viewers. People will see patterns and significance in your data sets that they never knew existed.</p>
<p class="indent">Fortunately, you don’t need a supercomputer to visualize complex data. With Python’s efficiency, you can quickly explore data sets made of millions of individual data points on just a laptop. Also, the data points don’t have to be numbers. With the basics you learned in the first part of this book, you can analyze nonnumerical data as well.</p>
<p class="indent">People use Python for data-intensive work in genetics, climate research, political and economic analysis, and much more. Data scientists have written <span type="pagebreak" id="calibre_link-487" class="calibre"></span>an impressive array of visualization and analysis tools in Python, many of which are available to you as well. One of the most popular tools is Matplotlib, a mathematical plotting library. We’ll use Matplotlib to make simple plots, such as line graphs and scatter plots. Then we’ll create a more interesting data set based on the concept of a random walk&mdash;a visualization generated from a series of random decisions.</p>
<p class="indent">We’ll also use a package called Plotly, which creates visualizations that work well on digital devices. Plotly generates visualizations that automatically resize to fit a variety of display devices. These visualizations can also include a number of interactive features, such as emphasizing particular aspects of the data set when users hover over different parts of the visualization. We’ll use Plotly to analyze the results of rolling dice.</p>
<h3 class="h2" id="calibre_link-1009"><strong class="calibre2">Installing Matplotlib</strong></h3>
<p class="noindent">To use Matplotlib for your initial set of visualizations, you’ll need to install it using <span class="literal">pip</span>, a module that downloads and installs Python packages. Enter the following command at a terminal prompt:</p>
<p class="programs">$ <span class="codestrong">python -m pip install --user matplotlib</span></p>
<p class="indent">This command tells Python to run the <span class="literal">pip</span> module and install the <span class="literal">matplotlib</span> package to the current user’s Python installation. If you use a command other than <span class="literal">python</span> on your system to run programs or start a terminal session, such as <span class="literal">python3</span>, your command will look like this:</p>
<p class="programs">$ <span class="codestrong">python3 -m pip install --user matplotlib</span></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If this command doesn’t work on macOS, try running the command again without the <span class="codeitalic">--user</span> flag.</em></p>
</div>
<p class="indent">To see the kinds of visualizations you can make with Matplotlib, visit the sample gallery at <em class="calibre3"><a href="https://matplotlib.org/gallery/" class="calibre6">https://matplotlib.org/gallery/</a></em>. When you click a visualization in the gallery, you’ll see the code used to generate the plot.</p>
<h3 class="h2" id="calibre_link-1010"><strong class="calibre2">Plotting a Simple Line Graph</strong></h3>
<p class="noindent">Let’s plot a simple line graph using Matplotlib, and then customize it to create a more informative data visualization. We’ll use the square number sequence 1, 4, 9, 16, 25 as the data for the graph.</p>
<p class="indent">Just provide Matplotlib with the numbers, as shown here, and Matplotlib should do the rest:</p>
<p class="margin"><em class="calibre3">mpl_squares.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import matplotlib.pyplot as plt<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;squares = [1, 4, 9, 16, 25]<br class="calibre4" />
<span type="pagebreak" id="calibre_link-490" class="calibre"></span><span class="ent">➊</span> fig, ax = plt.subplots()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ax.plot(squares)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.show()</p>
<p class="indent">We first import the <span class="literal">pyplot</span> module using the alias <span class="literal">plt</span> so we don’t have to type <span class="literal">pyplot</span> repeatedly. (You’ll see this convention often in online examples, so we’ll do the same here.) The <span class="literal">pyplot</span> module contains a number of functions that generate charts and plots.</p>
<p class="indent">We create a list called <span class="literal">squares</span> to hold the data that we’ll plot. Then we follow another common Matplotlib convention by calling the <span class="literal">subplots()</span> function <span class="ent">➊</span>. This function can generate one or more plots in the same figure. The variable <span class="literal">fig</span> represents the entire figure or collection of plots that are generated. The variable <span class="literal">ax</span> represents a single plot in the figure and is the variable we’ll use most of the time.</p>
<p class="indent">We then use the <span class="literal">plot()</span> method, which will try to plot the data it’s given in a meaningful way. The function <span class="literal">plt.show()</span> opens Matplotlib’s viewer and displays the plot, as shown in <a href="#calibre_link-81" class="calibre6">Figure 15-1</a>. The viewer allows you to zoom and navigate the plot, and when you click the disk icon, you can save any plot images you like.</p>
<div class="image1"><a id="calibre_link-81" class="calibre6"></a><img src="images/000055.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-1: One of the simplest plots you can make in Matplotlib</em></p>
<h4 class="h3" id="calibre_link-1011"><strong class="calibre2"><em class="calibre3">Changing the Label Type and Line Thickness</em></strong></h4>
<p class="noindent">Although the plot in <a href="#calibre_link-81" class="calibre6">Figure 15-1</a> shows that the numbers are increasing, the label type is too small and the line is a little thin to read easily. Fortunately, Matplotlib allows you to adjust every feature of a visualization.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-495" class="calibre"></span>We’ll use a few of the available customizations to improve this plot’s readability, as shown here:</p>
<p class="margin"><em class="calibre3">mpl_squares.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">squares = [1, 4, 9, 16, 25]</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
<span class="ent">➊</span> ax.plot(squares, linewidth=3)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Set chart title and label axes.<br class="calibre4" />
<span class="ent">➋</span> ax.set_title("Square Numbers", fontsize=24)<br class="calibre4" />
<span class="ent">➌</span> ax.set_xlabel("Value", fontsize=14)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ax.set_ylabel("Square of Value", fontsize=14)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Set size of tick labels.<br class="calibre4" />
<span class="ent">➍</span> ax.tick_params(axis='both', labelsize=14)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span></p>
<p class="indent">The <span class="literal">linewidth</span> parameter at <span class="ent">➊</span> controls the thickness of the line that <span class="literal">plot()</span> generates. The <span class="literal">set_title()</span> method at <span class="ent">➋</span> sets a title for the chart. The <span class="literal">fontsize</span> parameters, which appear repeatedly throughout the code, control the size of the text in various elements on the chart.</p>
<p class="indent">The <span class="literal">set_xlabel()</span> and <span class="literal">set_ylabel()</span> methods allow you to set a title for each of the axes <span class="ent">➌</span>, and the method <span class="literal">tick_params()</span> styles the tick marks <span class="ent">➍</span>. The arguments shown here affect the tick marks on both the x- and y-axes (<span class="literal">axis='both'</span>) and set the font size of the tick mark labels to 14 (<span class="literal">labelsize=14</span>).</p>
<p class="indent">As you can see in <a href="#calibre_link-82" class="calibre6">Figure 15-2</a>, the resulting chart is much easier to read. The label type is bigger, and the line graph is thicker. It’s often worth experimenting with these values to get an idea of what will look best in the resulting graph.</p>
<div class="image1"><a id="calibre_link-82" class="calibre6"></a><img src="images/000061.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-2: The chart is much easier to read now.</em></p>
<h4 class="h3" id="calibre_link-1012"><span type="pagebreak" id="calibre_link-497" class="calibre"></span><strong class="calibre2"><em class="calibre3">Correcting the Plot</em></strong></h4>
<p class="noindent">But now that we can read the chart better, we see that the data is not plotted correctly. Notice at the end of the graph that the square of 4.0 is shown as 25! Let’s fix that.</p>
<p class="indent">When you give <span class="literal">plot()</span> a sequence of numbers, it assumes the first data point corresponds to an x-coordinate value of 0, but our first point corresponds to an x-value of 1. We can override the default behavior by giving <span class="literal">plot()</span> the input and output values used to calculate the squares:</p>
<p class="margin"><em class="calibre3">mpl_squares.py</em></p>
<p class="programs"><span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
input_values = [1, 2, 3, 4, 5]<br class="calibre4" />
<span class="ash">squares = [1, 4, 9, 16, 25]</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
ax.plot(input_values, squares, linewidth=3)<br class="calibre4" />
<br class="calibre4" />
<span class="ash"># Set chart title and label axes.</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Now <span class="literal">plot()</span> will graph the data correctly because we’ve provided the input and output values, so it doesn’t have to assume how the output numbers were generated. The resulting plot, shown in <a href="#calibre_link-83" class="calibre6">Figure 15-3</a>, is correct.</p>
<div class="image1"><a id="calibre_link-83" class="calibre6"></a><img src="images/000067.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-3: The data is now plotted correctly.</em></p>
<p class="indent">You can specify numerous arguments when using <span class="literal">plot()</span> and use a number of functions to customize your plots. We’ll continue to explore these customization functions as we work with more interesting data sets throughout this chapter.</p>
<h4 class="h3" id="calibre_link-1013"><span type="pagebreak" id="calibre_link-493" class="calibre"></span><strong class="calibre2"><em class="calibre3">Using Built-in Styles</em></strong></h4>
<p class="noindent">Matplotlib has a number of predefined styles available, with good starting settings for background colors, gridlines, line widths, fonts, font sizes, and more that will make your visualizations appealing without requiring much customization. To see the styles available on your system, run the following lines in a terminal session:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">import matplotlib.pyplot as plt</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">plt.style.available</span><br class="calibre4" />
['seaborn-dark', 'seaborn-darkgrid', 'seaborn-ticks', 'fivethirtyeight',<br class="calibre4" />
--<span class="codeitalic1">snip</span>--</p>
<p class="indent">To use any of these styles, add one line of code before starting to generate the plot:</p>
<p class="margin"><em class="calibre3">mpl_squares.py</em></p>
<p class="programs"><span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">input_values = [1, 2, 3, 4, 5]</span><br class="calibre4" />
<span class="ash">squares = [1, 4, 9, 16, 25]</span><br class="calibre4" />
<br class="calibre4" />
plt.style.use('seaborn')<br class="calibre4" />
<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">This code generates the plot shown in <a href="#calibre_link-84" class="calibre6">Figure 15-4</a>. A wide variety of styles is available; play around with these styles to find some that you like.</p>
<div class="image1"><a id="calibre_link-84" class="calibre6"></a><img src="images/000004.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-4: The built-in seaborn style</em></p>
<h4 class="h3" id="calibre_link-1014"><strong class="calibre2"><em class="calibre3">Plotting and Styling Individual Points with scatter()</em></strong></h4>
<p class="noindent">Sometimes, it’s useful to plot and style individual points based on certain characteristics. For example, you might plot small values in one color and larger values in a different color. You could also plot a large data set with <span type="pagebreak" id="calibre_link-545" class="calibre"></span>one set of styling options and then emphasize individual points by replotting them with different options.</p>
<p class="indent">To plot a single point, use the <span class="literal">scatter()</span> method. Pass the single (<em class="calibre3">x</em>, <em class="calibre3">y</em>) values of the point of interest to <span class="literal">scatter()</span> to plot those values:</p>
<p class="margin"><em class="calibre3">scatter_squares.py</em></p>
<p class="programs">import matplotlib.pyplot as plt<br class="calibre4" />
<br class="calibre4" />
plt.style.use('seaborn')<br class="calibre4" />
fig, ax = plt.subplots()<br class="calibre4" />
ax.scatter(2, 4)<br class="calibre4" />
<br class="calibre4" />
plt.show()</p>
<p class="indent">Let’s style the output to make it more interesting. We’ll add a title, label the axes, and make sure all the text is large enough to read:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('seaborn')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
<span class="ent">➊</span> ax.scatter(2, 4, s=200)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Set chart title and label axes.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ax.set_title("Square Numbers", fontsize=24)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ax.set_xlabel("Value", fontsize=14)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ax.set_ylabel("Square of Value", fontsize=14)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Set size of tick labels.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ax.tick_params(axis='both', which='major', labelsize=14)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span></p>
<p class="indent">At <span class="ent">➊</span> we call <span class="literal">scatter()</span> and use the <span class="literal">s</span> argument to set the size of the dots used to draw the graph. When you run <em class="calibre3">scatter_squares.py</em> now, you should see a single point in the middle of the chart, as shown in <a href="#calibre_link-85" class="calibre6">Figure 15-5</a>.</p>
<div class="image1"><a id="calibre_link-85" class="calibre6"></a><img src="images/000009.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-5: Plotting a single point</em></p>
<h4 class="h3" id="calibre_link-1015"><span type="pagebreak" id="calibre_link-1375" class="calibre"></span><strong class="calibre2"><em class="calibre3">Plotting a Series of Points with scatter()</em></strong></h4>
<p class="noindent">To plot a series of points, we can pass <span class="literal">scatter()</span> separate lists of x- and y-values, like this:</p>
<p class="margin"><em class="calibre3">scatter_squares.py</em></p>
<p class="programs"><span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
x_values = [1, 2, 3, 4, 5]<br class="calibre4" />
y_values = [1, 4, 9, 16, 25]<br class="calibre4" />
<br class="calibre4" />
<span class="ash">plt.style.use('seaborn')</span><br class="calibre4" />
<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
ax.scatter(x_values, y_values, s=100)<br class="calibre4" />
<br class="calibre4" />
<span class="ash"># Set chart title and label axes.</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">The <span class="literal">x_values</span> list contains the numbers to be squared, and <span class="literal">y_values</span> contains the square of each number. When these lists are passed to <span class="literal">scatter()</span>, Matplotlib reads one value from each list as it plots each point. The points to be plotted are (1, 1), (2, 4), (3, 9), (4, 16), and (5, 25); <a href="#calibre_link-86" class="calibre6">Figure 15-6</a> shows the result.</p>
<div class="image1"><a id="calibre_link-86" class="calibre6"></a><img src="images/000015.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-6: A scatter plot with multiple points</em></p>
<h4 class="h3" id="calibre_link-1016"><strong class="calibre2"><em class="calibre3">Calculating Data Automatically</em></strong></h4>
<p class="noindent">Writing lists by hand can be inefficient, especially when we have many points. Rather than passing our points in a list, let’s use a loop in Python to do the calculations for us.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-489" class="calibre"></span>Here’s how this would look with 1000 points:</p>
<p class="margin"><em class="calibre3">scatter_squares.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> x_values = range(1, 1001)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;y_values = [x**2 for x in x_values]<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('seaborn')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
<span class="ent">➋</span> ax.scatter(x_values, y_values, s=10)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Set chart title and label axes.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Set the range for each axis.<br class="calibre4" />
<span class="ent">➌</span> ax.axis([0, 1100, 0, 1100000])<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span></p>
<p class="indent">We start with a range of x-values containing the numbers 1 through 1000 <span class="ent">➊</span>. Next, a list comprehension generates the y-values by looping through the x-values (<span class="literal">for x in x_values</span>), squaring each number (<span class="literal">x**2</span>) and storing the results in <span class="literal">y_values</span>. We then pass the input and output lists to <span class="literal">scatter()</span> <span class="ent">➋</span>. Because this is a large data set, we use a smaller point size.</p>
<p class="indent">At <span class="ent">➌</span> we use the <span class="literal">axis()</span> method to specify the range of each axis. The <span class="literal">axis()</span> method requires four values: the minimum and maximum values for the x-axis and the y-axis. Here, we run the x-axis from 0 to 1100 and the y-axis from 0 to 1,100,000. <a href="#calibre_link-87" class="calibre6">Figure 15-7</a> shows the result.</p>
<div class="image1"><a id="calibre_link-87" class="calibre6"></a><img src="images/000021.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-7: Python can plot 1000 points as easily as it plots 5 points.</em></p>
<h4 class="h3" id="calibre_link-1017"><span type="pagebreak" id="calibre_link-494" class="calibre"></span><strong class="calibre2"><em class="calibre3">Defining Custom Colors</em></strong></h4>
<p class="noindent">To change the color of the points, pass <span class="literal">c</span> to <span class="literal">scatter()</span> with the name of a color to use in quotation marks, as shown here:</p>
<p class="programs">ax.scatter(x_values, y_values, c='red', s=10)</p>
<p class="indent">You can also define custom colors using the RGB color model. To define a color, pass the <span class="literal">c</span> argument a tuple with three decimal values (one each for red, green, and blue in that order), using values between 0 and 1. For example, the following line creates a plot with light-green dots:</p>
<p class="programs">ax.scatter(x_values, y_values, c=(0, 0.8, 0), s=10)</p>
<p class="indent">Values closer to 0 produce dark colors, and values closer to 1 produce lighter colors.</p>
<h4 class="h3" id="calibre_link-1018"><strong class="calibre2"><em class="calibre3">Using a Colormap</em></strong></h4>
<p class="noindent">A <em class="calibre3">colormap</em> is a series of colors in a gradient that moves from a starting to an ending color. You use colormaps in visualizations to emphasize a pattern in the data. For example, you might make low values a light color and high values a darker color.</p>
<p class="indent">The <span class="literal">pyplot</span> module includes a set of built-in colormaps. To use one of these colormaps, you need to specify how <span class="literal">pyplot</span> should assign a color to each point in the data set. Here’s how to assign each point a color based on its y-value:</p>
<p class="margin"><em class="calibre3">scatter_squares.py</em></p>
<p class="programs"><span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">x_values = range(1, 1001)</span><br class="calibre4" />
<span class="ash">y_values = [x**2 for x in x_values]</span><br class="calibre4" />
<br class="calibre4" />
ax.scatter(x_values, y_values, c=y_values, cmap=plt.cm.Blues, s=10)<br class="calibre4" />
<br class="calibre4" />
<span class="ash"># Set chart title and label axes.</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We pass the list of y-values to <span class="literal">c</span>, and then tell <span class="literal">pyplot</span> which colormap to use using the <span class="literal">cmap</span> argument. This code colors the points with lower y-values light blue and colors the points with higher y-values dark blue. <a href="#calibre_link-88" class="calibre6">Figure 15-8</a> shows the resulting plot.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You can see all the colormaps available in <span class="codeitalic">pyplot</span> at</em> <a href="https://matplotlib.org/" class="calibre6">https://matplotlib.org/</a>; <em class="calibre3">go to <strong class="calibre2"><em class="calibre3">Examples</em></strong>, scroll down to <strong class="calibre2"><em class="calibre3">Color</em></strong>, and click <strong class="calibre2"><em class="calibre3">Colormap reference</em></strong>.</em></p>
</div>
<div class="image1"><span type="pagebreak" id="calibre_link-498" class="calibre"></span><a id="calibre_link-88" class="calibre6"></a><img src="images/000028.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-8: A plot using the <span class="codeitalic2">Blues</span> colormap</em></p>
<h4 class="h3" id="calibre_link-1019"><strong class="calibre2"><em class="calibre3">Saving Your Plots Automatically</em></strong></h4>
<p class="noindent">If you want your program to automatically save the plot to a file, you can replace the call to <span class="literal">plt.show()</span> with a call to <span class="literal">plt.savefig()</span>:</p>
<p class="programs">plt.savefig('squares_plot.png', bbox_inches='tight')</p>
<p class="indent">The first argument is a filename for the plot image, which will be saved in the same directory as <em class="calibre3">scatter_squares.py</em>. The second argument trims extra whitespace from the plot. If you want the extra whitespace around the plot, just omit this argument.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1020"><strong class="calibre2">15-1. Cubes:</strong> A number raised to the third power is a <em class="calibre3">cube</em>. Plot the first five cubic numbers, and then plot the first 5000 cubic numbers.</p>
<p class="sparal" id="calibre_link-1021"><strong class="calibre2">15-2. Colored Cubes:</strong> Apply a colormap to your cubes plot.</p>
</div>
<h3 class="h2" id="calibre_link-1022"><strong class="calibre2">Random Walks</strong></h3>
<p class="noindent">In this section, we’ll use Python to generate data for a random walk, and then use Matplotlib to create a visually appealing representation of that data. A <em class="calibre3">random walk</em> is a path that has no clear direction but is determined by a series of random decisions, each of which is left entirely to chance. You might imagine a random walk as the path a confused ant would take if it took every step in a random direction.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-537" class="calibre"></span>Random walks have practical applications in nature, physics, biology, chemistry, and economics. For example, a pollen grain floating on a drop of water moves across the surface of the water because it’s constantly pushed around by water molecules. Molecular motion in a water drop is random, so the path a pollen grain traces on the surface is a random walk. The code we’ll write next models many real-world situations.</p>
<h4 class="h3" id="calibre_link-1023"><strong class="calibre2"><em class="calibre3">Creating the RandomWalk() Class</em></strong></h4>
<p class="noindent">To create a random walk, we’ll create a <span class="literal">RandomWalk</span> class, which will make random decisions about which direction the walk should take. The class needs three attributes: one variable to store the number of points in the walk and two lists to store the x- and y-coordinate values of each point in the walk.</p>
<p class="indent">We’ll only need two methods for the <span class="literal">RandomWalk</span> class: the <span class="literal">__init__()</span> method and <span class="literal">fill_walk()</span>, which will calculate the points in the walk. Let’s start with <span class="literal">__init__()</span> as shown here:</p>
<p class="margin"><em class="calibre3">random_walk.py</em></p>
<p class="programs"><span class="ent">➊</span> from random import choice<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class RandomWalk:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A class to generate random walks."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, num_points=5000):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Initialize attributes of a walk."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.num_points = num_points<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# All walks start at (0, 0).<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x_values = [0]<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.y_values = [0]</p>
<p class="indent">To make random decisions, we’ll store possible moves in a list and use the <span class="literal">choice()</span> function, from the <span class="literal">random</span> module, to decide which move to make each time a step is taken <span class="ent">➊</span>. We then set the default number of points in a walk to 5000, which is large enough to generate some interesting patterns but small enough to generate walks quickly <span class="ent">➋</span>. Then at <span class="ent">➌</span> we make two lists to hold the x- and y-values, and we start each walk at the point (0, 0).</p>
<h4 class="h3" id="calibre_link-1024"><strong class="calibre2"><em class="calibre3">Choosing Directions</em></strong></h4>
<p class="noindent">We’ll use the <span class="literal">fill_walk()</span> method, as shown here, to fill our walk with points and determine the direction of each step. Add this method to <em class="calibre3">random_walk.py</em>:</p>
<p class="margin"><em class="calibre3">random_walk.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def fill_walk(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Calculate all the points in the walk."""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Keep taking steps until the walk reaches the desired length.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while len(self.x_values) &lt; self.num_points:<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Decide which direction to go and how far to go in that direction.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_direction = choice([1, -1])<br class="calibre4" />
<span type="pagebreak" id="calibre_link-538" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_distance = choice([0, 1, 2, 3, 4])<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_step = x_direction * x_distance<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_direction = choice([1, -1])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_distance = choice([0, 1, 2, 3, 4])<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_step = y_direction * y_distance<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reject moves that go nowhere.<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if x_step == 0 and y_step == 0:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Calculate the new position.<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = self.x_values[-1] + x_step<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = self.y_values[-1] + y_step<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x_values.append(x)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.y_values.append(y)</p>
<p class="indent">At <span class="ent">➊</span> we set up a loop that runs until the walk is filled with the correct number of points. The main part of the <span class="literal">fill_walk()</span> method tells Python how to simulate four random decisions: will the walk go right or left? How far will it go in that direction? Will it go up or down? How far will it go in that direction?</p>
<p class="indent">We use <span class="literal">choice([1, -1])</span> to choose a value for <span class="literal">x_direction</span>, which returns either 1 for right movement or &ndash;1 for left <span class="ent">➋</span>. Next, <span class="literal">choice([0, 1, 2, 3, 4])</span> tells Python how far to move in that direction (<span class="literal">x_distance</span>) by randomly selecting an integer between 0 and 4. (The inclusion of a 0 allows us to take steps along the y-axis as well as steps that have movement along both axes.)</p>
<p class="indent">At <span class="ent">➌</span> and <span class="ent">➍</span> we determine the length of each step in the <em class="calibre3">x</em> and <em class="calibre3">y</em> directions by multiplying the direction of movement by the distance chosen. A positive result for <span class="literal">x_step</span> means move right, a negative result means move left, and 0 means move vertically. A positive result for <span class="literal">y_step</span> means move up, negative means move down, and 0 means move horizontally. If the value of both <span class="literal">x_step</span> and <span class="literal">y_step</span> are 0, the walk doesn’t go anywhere, so we continue the loop to ignore this move <span class="ent">➎</span>.</p>
<p class="indent">To get the next x-value for the walk, we add the value in <span class="literal">x_step</span> to the last value stored in <span class="literal">x_values</span> <span class="ent">➏</span> and do the same for the y-values. When we have these values, we append them to <span class="literal">x_values</span> and <span class="literal">y_values</span>.</p>
<h4 class="h3" id="calibre_link-1025"><strong class="calibre2"><em class="calibre3">Plotting the Random Walk</em></strong></h4>
<p class="noindent">Here’s the code to plot all the points in the walk:</p>
<p class="margin"><em class="calibre3">rw_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import matplotlib.pyplot as plt<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from random_walk import RandomWalk<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Make a random walk.<br class="calibre4" />
<span class="ent">➊</span> rw = RandomWalk()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;rw.fill_walk()<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-540" class="calibre"></span>&nbsp;&nbsp;&nbsp;# Plot the points in the walk.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.style.use('classic')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;fig, ax = plt.subplots()<br class="calibre4" />
<span class="ent">➋</span> ax.scatter(rw.x_values, rw.y_values, s=15)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.show()</p>
<p class="indent">We begin by importing <span class="literal">pyplot</span> and <span class="literal">RandomWalk</span>. We then create a random walk and store it in <span class="literal">rw</span> <span class="ent">➊</span>, making sure to call <span class="literal">fill_walk()</span>. At <span class="ent">➋</span> we feed the walk’s x- and y-values to <span class="literal">scatter()</span> and choose an appropriate dot size. <a href="#calibre_link-89" class="calibre6">Figure 15-9</a> shows the resulting plot with 5000 points. (The images in this section omit Matplotlib’s viewer, but you’ll continue to see it when you run <em class="calibre3">rw_visual.py</em>.)</p>
<div class="image1"><a id="calibre_link-89" class="calibre6"></a><img src="images/000036.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-9: A random walk with 5000 points</em></p>
<h4 class="h3" id="calibre_link-1026"><strong class="calibre2"><em class="calibre3">Generating Multiple Random Walks</em></strong></h4>
<p class="noindent">Every random walk is different, and it’s fun to explore the various patterns that can be generated. One way to use the preceding code to make multiple walks without having to run the program several times is to wrap it in a <span class="literal">while</span> loop, like this:</p>
<p class="margin"><em class="calibre3">rw_visual.py</em></p>
<p class="programs"><span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">from random_walk import RandomWalk</span><br class="calibre4" />
<br class="calibre4" />
# Keep making new walks, as long as the program is active.<br class="calibre4" />
while True:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make a random walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">rw = RandomWalk()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">rw.fill_walk()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Plot the points in the walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('classic')</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-539" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">ax.scatter(rw.x_values, rw.y_values, s=15)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;keep_running = input("Make another walk? (y/n): ")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if keep_running == 'n':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</p>
<p class="indent">This code generates a random walk, displays it in Matplotlib’s viewer, and pauses with the viewer open. When you close the viewer, you’ll be asked whether you want to generate another walk. Press <span class="codestrong1">y</span> to generate walks that stay near the starting point, that wander off mostly in one direction, that have thin sections connecting larger groups of points, and so on. When you want to end the program, press <span class="codestrong1">n</span>.</p>
<h4 class="h3" id="calibre_link-1027"><strong class="calibre2"><em class="calibre3">Styling the Walk</em></strong></h4>
<p class="noindent">In this section, we’ll customize our plots to emphasize the important characteristics of each walk and deemphasize distracting elements. To do so, we identify the characteristics we want to emphasize, such as where the walk began, where it ended, and the path taken. Next, we identify the characteristics to deemphasize, such as tick marks and labels. The result should be a simple visual representation that clearly communicates the path taken in each random walk.</p>
<h5 class="h4" id="calibre_link-1376"><strong class="calibre2">Coloring the Points</strong></h5>
<p class="noindent">We’ll use a colormap to show the order of the points in the walk, and then remove the black outline from each dot so the color of the dots will be clearer. To color the points according to their position in the walk, we pass the <span class="literal">c</span> argument a list containing the position of each point. Because the points are plotted in order, the list just contains the numbers from 0 to 4999, as shown here:</p>
<p class="margin"><em class="calibre3">rw_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make a random walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">rw = RandomWalk()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">rw.fill_walk()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Plot the points in the walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('classic')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point_numbers = range(rw.num_points)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(rw.x_values, rw.y_values, c=point_numbers, cmap=plt.cm.Blues,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edgecolors='none', s=15)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">keep_running = input("Make another walk? (y/n): ")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-541" class="calibre"></span>At <span class="ent">➊</span> we use <span class="literal">range()</span> to generate a list of numbers equal to the number of points in the walk. Then we store them in the list <span class="literal">point_numbers</span>, which we’ll use to set the color of each point in the walk. We pass <span class="literal">point_numbers</span> to the <span class="literal">c</span> argument, use the <span class="literal">Blues</span> colormap, and then pass <span class="literal">edgecolors='none'</span> to get rid of the black outline around each point. The result is a plot of the walk that varies from light to dark blue along a gradient, as shown in <a href="#calibre_link-90" class="calibre6">Figure 15-10</a>.</p>
<div class="image1"><a id="calibre_link-90" class="calibre6"></a><img src="images/000043.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-10: A random walk colored with the <span class="codeitalic2">Blues</span> colormap</em></p>
<h5 class="h4" id="calibre_link-1377"><strong class="calibre2">Plotting the Starting and Ending Points</strong></h5>
<p class="noindent">In addition to coloring points to show their position along the walk, it would be useful to see where each walk begins and ends. To do so, we can plot the first and last points individually after the main series has been plotted. We’ll make the end points larger and color them differently to make them stand out, as shown here:</p>
<p class="margin"><em class="calibre3">rw_visual.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">ax.scatter(rw.x_values, rw.y_values, c=point_numbers, cmap=plt.cm.Blues,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">edgecolors='none', s=15)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# Emphasize the first and last points.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(0, 0, c='green', edgecolors='none', s=100)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(rw.x_values[-1], rw.y_values[-1], c='red', edgecolors='none',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=100)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-491" class="calibre"></span>To show the starting point, we plot point (0, 0) in green in a larger size (<span class="literal">s=100</span>) than the rest of the points. To mark the end point, we plot the last x- and y-value in the walk in red with a size of 100. Make sure you insert this code just before the call to <span class="literal">plt.show()</span> so the starting and ending points are drawn on top of all the other points.</p>
<p class="indent">When you run this code, you should be able to spot exactly where each walk begins and ends. (If these end points don’t stand out clearly, adjust their color and size until they do.)</p>
<h5 class="h4" id="calibre_link-1378"><strong class="calibre2">Cleaning Up the Axes</strong></h5>
<p class="noindent">Let’s remove the axes in this plot so they don’t distract from the path of each walk. To turn off the axes, use this code:</p>
<p class="margin"><em class="calibre3">rw_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">ax.scatter(rw.x_values[-1], rw.y_values[-1], c='red', edgecolors='none',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">s=100)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove the axes.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.get_xaxis().set_visible(False)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.get_yaxis().set_visible(False)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">To modify the axes, we use the <span class="literal">ax.get_xaxis()</span> and <span class="literal">ax.get_yaxis()</span> methods <span class="ent">➊</span> to set the visibility of each axis to <span class="literal">False</span>. As you continue to work with visualizations, you’ll frequently see this chaining of methods.</p>
<p class="indent">Run <em class="calibre3">rw_visual.py</em> now; you should see a series of plots with no axes.</p>
<h5 class="h4" id="calibre_link-1379"><strong class="calibre2">Adding Plot Points</strong></h5>
<p class="noindent">Let’s increase the number of points to give us more data to work with. To do so, we increase the value of <span class="literal">num_points</span> when we make a <span class="literal">RandomWalk</span> instance and adjust the size of each dot when drawing the plot, as shown here:</p>
<p class="margin"><em class="calibre3">rw_visual.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make a random walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;rw = RandomWalk(50_000)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">rw.fill_walk()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Plot the points in the walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('classic')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">point_numbers = range(rw.num_points)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(rw.x_values, rw.y_values, c=point_numbers, cmap=plt.cm.Blues,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edgecolor='none', s=1)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-496" class="calibre"></span>This example creates a random walk with 50,000 points (to mirror real-world data) and plots each point at size <span class="literal">s=1</span>. The resulting walk is wispy and cloud-like, as shown in <a href="#calibre_link-91" class="calibre6">Figure 15-11</a>. As you can see, we’ve created a piece of art from a simple scatter plot!</p>
<p class="indent">Experiment with this code to see how much you can increase the number of points in a walk before your system starts to slow down significantly or the plot loses its visual appeal.</p>
<div class="image1"><a id="calibre_link-91" class="calibre6"></a><img src="images/000052.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-11: A walk with 50,000 points</em></p>
<h5 class="h4" id="calibre_link-1380"><strong class="calibre2">Altering the Size to Fill the Screen</strong></h5>
<p class="noindent">A visualization is much more effective at communicating patterns in data if it fits nicely on the screen. To make the plotting window better fit your screen, adjust the size of Matplotlib’s output, like this:</p>
<p class="margin"><em class="calibre3">rw_visual.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">while True:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make a random walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">rw = RandomWalk(50_000)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">rw.fill_walk()</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Plot the points in the walk.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('classic')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;fig, ax = plt.subplots(figsize=(15, 9))<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">When creating the plot, you can pass a <span class="literal">figsize</span> argument to set the size of the figure. The <span class="literal">figsize</span> parameter takes a tuple, which tells Matplotlib the dimensions of the plotting window in inches.</p>
<p class="indent">Matplotlib assumes that your screen resolution is 100 pixels per inch; if this code doesn’t give you an accurate plot size, adjust the numbers as <span type="pagebreak" id="calibre_link-488" class="calibre"></span>necessary. Or, if you know your system’s resolution, pass <span class="literal">plt.subplots()</span> the resolution using the <span class="literal">dpi</span> parameter to set a plot size that makes effective use of the space available on your screen, as shown here:</p>
<p class="programs">fig, ax = plt.subplots(figsize=(10, 6), dpi=128)</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1028"><strong class="calibre2">15-3. Molecular Motion:</strong> Modify <em class="calibre3">rw_visual.py</em> by replacing <span class="literal1">plt.scatter()</span> with <span class="literal1">plt.plot()</span>. To simulate the path of a pollen grain on the surface of a drop of water, pass in the <span class="literal1">rw.x_values</span> and <span class="literal1">rw.y_values</span>, and include a <span class="literal1">linewidth</span> argument. Use 5000 instead of 50,000 points.</p>
<p class="sparal" id="calibre_link-1029"><strong class="calibre2">15-4. Modified Random Walks:</strong> In the <span class="literal1">RandomWalk</span> class, <span class="literal1">x_step</span> and <span class="literal1">y_step</span> are generated from the same set of conditions. The direction is chosen randomly from the list <span class="literal1">[1, -1]</span> and the distance from the list <span class="literal1">[0, 1, 2, 3, 4]</span>. Modify the values in these lists to see what happens to the overall shape of your walks. Try a longer list of choices for the distance, such as 0 through 8, or remove the &ndash;1 from the <em class="calibre3">x</em> or <em class="calibre3">y</em> direction list.</p>
<p class="sparal" id="calibre_link-1030"><strong class="calibre2">15-5. Refactoring:</strong> The <span class="literal1">fill_walk()</span> method is lengthy. Create a new method called <span class="literal1">get_step()</span> to determine the direction and distance for each step, and then calculate the step. You should end up with two calls to <span class="literal1">get_step()</span> in <span class="literal1">fill_walk()</span>:</p>
<p class="programs">x_step = self.get_step()<br class="calibre4" />
y_step = self.get_step()</p>
<p class="sparai">This refactoring should reduce the size of <span class="literal1">fill_walk()</span> and make the method easier to read and understand.</p>
</div>
<h3 class="h2" id="calibre_link-1031"><strong class="calibre2">Rolling Dice with Plotly</strong></h3>
<p class="noindent">In this section, we’ll use the Python package Plotly to produce interactive visualizations. Plotly is particularly useful when you’re creating visualizations that will be displayed in a browser, because the visualizations will scale automatically to fit the viewer’s screen. Visualizations that Plotly generates are also interactive; when the user hovers over certain elements on the screen, information about that element is highlighted.</p>
<p class="indent">In this project, we’ll analyze the results of rolling dice. When you roll one regular, six-sided die, you have an equal chance of rolling any of the numbers from 1 through 6. However, when you use two dice, you’re more likely to roll certain numbers rather than others. We’ll try to determine <span type="pagebreak" id="calibre_link-304" class="calibre"></span>which numbers are most likely to occur by generating a data set that represents rolling dice. Then we’ll plot the results of a large number of rolls to determine which results are more likely than others.</p>
<p class="indent">The study of rolling dice is often used in mathematics to explain various types of data analysis. But it also has real-world applications in casinos and other gambling scenarios, as well as in the way games like Monopoly and many role-playing games are played.</p>
<h4 class="h3" id="calibre_link-1032"><strong class="calibre2"><em class="calibre3">Installing Plotly</em></strong></h4>
<p class="noindent">Install Plotly using <span class="literal">pip</span>, just as you did for Matplotlib:</p>
<p class="programs">$ <span class="codestrong">python -m pip install --user plotly</span></p>
<p class="indent">If you used <span class="codestrong1">python3</span> or something else when installing Matplotlib, make sure you use the same command here.</p>
<p class="indent">To see what kind of visualizations are possible with Plotly, visit the gallery of chart types at <em class="calibre3"><a href="https://plot.ly/python/" class="calibre6">https://plot.ly/python/</a></em>. Each example includes source code, so you can see how Plotly generates the visualizations.</p>
<h4 class="h3" id="calibre_link-1033"><strong class="calibre2"><em class="calibre3">Creating the Die Class</em></strong></h4>
<p class="noindent">We’ll create the following <span class="literal">Die</span> class to simulate the roll of one die:</p>
<p class="margin"><em class="calibre3">die.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;from random import randint<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class Die:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A class representing a single die."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __init__(self, num_sides=6):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Assume a six-sided die."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.num_sides = num_sides<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def roll(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;""""Return a random value between 1 and number of sides."""<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return randint(1, self.num_sides)</p>
<p class="indent">The <span class="literal">__init__()</span> method takes one optional argument. With the <span class="literal">Die</span> class, when an instance of our die is created, the number of sides will always be six if no argument is included. If an argument <em class="calibre3">is</em> included, that value will set the number of sides on the die <span class="ent">➊</span>. (Dice are named for their number of sides: a six-sided die is a D6, an eight-sided die is a D8, and so on.)</p>
<p class="indent">The <span class="literal">roll()</span> method uses the <span class="literal">randint()</span> function to return a random number between 1 and the number of sides <span class="ent">➋</span>. This function can return the starting value (1), the ending value (<span class="literal">num_sides</span>), or any integer between the two.</p>
<h4 class="h3" id="calibre_link-1034"><span type="pagebreak" id="calibre_link-305" class="calibre"></span><strong class="calibre2"><em class="calibre3">Rolling the Die</em></strong></h4>
<p class="noindent">Before creating a visualization based on the <span class="literal">Die</span> class, let’s roll a D6, print the results, and check that the results look reasonable:</p>
<p class="margin"><em class="calibre3">die_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;from die import Die<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Create a D6.<br class="calibre4" />
<span class="ent">➊</span> die = Die()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Make some rolls, and store results in a list.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;results = []<br class="calibre4" />
<span class="ent">➋</span> for roll_num in range(100):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = die.roll()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results.append(result)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(results)</p>
<p class="indent">At <span class="ent">➊</span> we create an instance of <span class="literal">Die</span> with the default six sides. At <span class="ent">➋</span> we roll the die 100 times and store the results of each roll in the list <span class="literal">results</span>. Here’s a sample set of results:</p>
<p class="programs">[4, 6, 5, 6, 1, 5, 6, 3, 5, 3, 5, 3, 2, 2, 1, 3, 1, 5, 3, 6, 3, 6, 5, 4,<br class="calibre4" />
&nbsp;1, 1, 4, 2, 3, 6, 4, 2, 6, 4, 1, 3, 2, 5, 6, 3, 6, 2, 1, 1, 3, 4, 1, 4,<br class="calibre4" />
&nbsp;3, 5, 1, 4, 5, 5, 2, 3, 3, 1, 2, 3, 5, 6, 2, 5, 6, 1, 3, 2, 1, 1, 1, 6,<br class="calibre4" />
&nbsp;5, 5, 2, 2, 6, 4, 1, 4, 5, 1, 1, 1, 4, 5, 3, 3, 1, 3, 5, 4, 5, 6, 5, 4,<br class="calibre4" />
&nbsp;1, 5, 1, 2]</p>
<p class="indent">A quick scan of these results shows that the <span class="literal">Die</span> class seems to be working. We see the values 1 and 6, so we know the smallest and largest possible values are being returned, and because we don’t see 0 or 7, we know all the results are in the appropriate range. We also see each number from 1 through 6, which indicates that all possible outcomes are represented. Let’s determine exactly how many times each number appears.</p>
<h4 class="h3" id="calibre_link-1035"><strong class="calibre2"><em class="calibre3">Analyzing the Results</em></strong></h4>
<p class="noindent">We’ll analyze the results of rolling one D6 by counting how many times we roll each number:</p>
<p class="margin"><em class="calibre3">die_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Make some rolls, and store results in a list.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">results = []</span><br class="calibre4" />
<span class="ent">➊</span> for roll_num in range(1000):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">result = die.roll()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">results.append(result)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Analyze the results.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;frequencies = []<br class="calibre4" />
<span class="ent">➋</span> for value in range(1, die.num_sides+1):<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequency = results.count(value)<br class="calibre4" />
<span type="pagebreak" id="calibre_link-521" class="calibre"></span><span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequencies.append(frequency)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(frequencies)</p>
<p class="indent">Because we’re no longer printing the results, we can increase the number of simulated rolls to 1000 <span class="ent">➊</span>. To analyze the rolls, we create the empty list <span class="literal">frequencies</span> to store the number of times each value is rolled. We loop through the possible values (1 through 6 in this case) at <span class="ent">➋</span>, count how many times each number appears in <span class="literal">results</span> <span class="ent">➌</span>, and then append this value to the <span class="literal">frequencies</span> list <span class="ent">➍</span>. We then print this list before making a visualization:</p>
<p class="programs">[155, 167, 168, 170, 159, 181]</p>
<p class="indent">These results look reasonable: we see six frequencies, one for each possible number when you roll a D6, and we see that no frequency is significantly higher than any other. Now let’s visualize these results.</p>
<h4 class="h3" id="calibre_link-1036"><strong class="calibre2"><em class="calibre3">Making a Histogram</em></strong></h4>
<p class="noindent">With a list of frequencies, we can make a <em class="calibre3">histogram</em> of the results. A histogram is a bar chart showing how often certain results occur. Here’s the code to create the histogram:</p>
<p class="margin"><em class="calibre3">die_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;from plotly.graph_objs import Bar, Layout<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from plotly import offline<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from die import Die</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Analyze the results.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">frequencies = []</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for value in range(1, die.num_sides+1):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">frequency = results.count(value)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">frequencies.append(frequency)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Visualize the results.<br class="calibre4" />
<span class="ent">➊</span> x_values = list(range(1, die.num_sides+1))<br class="calibre4" />
<span class="ent">➋</span> data = [Bar(x=x_values, y=frequencies)]<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> x_axis_config = {'title': 'Result'}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;y_axis_config = {'title': 'Frequency of Result'}<br class="calibre4" />
<span class="ent">➍</span> my_layout = Layout(title='Results of rolling one D6 1000 times',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xaxis=x_axis_config, yaxis=y_axis_config)<br class="calibre4" />
<span class="ent">➎</span> offline.plot({'data': data, 'layout': my_layout}, filename='d6.html')</p>
<p class="indent">To make a histogram, we need a bar for each of the possible results. We store these in a list called <span class="literal">x_values</span>, which starts at 1 and ends at the number of sides on the die <span class="ent">➊</span>. Plotly doesn’t accept the results of the <span class="literal">range()</span> function directly, so we need to convert the range to a list explicitly using <span type="pagebreak" id="calibre_link-306" class="calibre"></span>the <span class="literal">list()</span> function. The Plotly class <span class="literal">Bar()</span> represents a data set that will be formatted as a bar chart <span class="ent">➋</span>. This class needs a list of x-values, and a list of y-values. The class must be wrapped in square brackets, because a data set can have multiple elements.</p>
<p class="indent">Each axis can be configured in a number of ways, and each configuration option is stored as an entry in a dictionary. At this point, we’re just setting the title of each axis <span class="ent">➌</span>. The <span class="literal">Layout()</span> class returns an object that specifies the layout and configuration of the graph as a whole <span class="ent">➍</span>. Here we set the title of the graph and pass the x- and y-axis configuration dictionaries as well.</p>
<p class="indent">To generate the plot, we call the <span class="literal">offline.plot()</span> function <span class="ent">➎</span>. This function needs a dictionary containing the data and layout objects, and it also accepts a name for the file where the graph will be saved. We store the output in a file called <em class="calibre3">d6.html</em>.</p>
<p class="indent">When you run the program <em class="calibre3">die_visual.py</em>, a browser will probably open showing the file <em class="calibre3">d6.html</em>. If this doesn’t happen automatically, open a new tab in any web browser, and then open the file <em class="calibre3">d6.html</em> (in the folder where you saved <em class="calibre3">die_visual.py</em>). You should see a chart that looks like the one in <a href="#calibre_link-92" class="calibre6">Figure 15-12</a>. (I’ve modified this chart slightly for printing; by default, Plotly generates charts with smaller text than what you see here.)</p>
<div class="image1"><a id="calibre_link-92" class="calibre6"></a><img src="images/000058.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-12: A simple bar chart created with Plotly</em></p>
<p class="indent">Notice that Plotly has made the chart interactive: hover your cursor over any bar in the chart, and you’ll see the associated data. This feature is particularly useful when you’re plotting multiple data sets on the same chart. Also notice the icons in the upper right, which allow you to pan and zoom the visualization, and save your visualization as an image.</p>
<h4 class="h3" id="calibre_link-1037"><span type="pagebreak" id="calibre_link-293" class="calibre"></span><strong class="calibre2"><em class="calibre3">Rolling Two Dice</em></strong></h4>
<p class="noindent">Rolling two dice results in larger numbers and a different distribution of results. Let’s modify our code to create two D6 dice to simulate the way we roll a pair of dice. Each time we roll the pair, we’ll add the two numbers (one from each die) and store the sum in <span class="literal">results</span>. Save a copy of <em class="calibre3">die_visual.py</em> as <em class="calibre3">dice_visual.py</em>, and make the following changes:</p>
<p class="margin"><em class="calibre3">dice_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from plotly.graph_objs import Bar, Layout</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from plotly import offline</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from die import Die</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Create two D6 dice.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;die_1 = Die()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;die_2 = Die()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Make some rolls, and store results in a list.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">results = []</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for roll_num in range(1000):</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = die_1.roll() + die_2.roll()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">results.append(result)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Analyze the results.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">frequencies = []</span><br class="calibre4" />
<span class="ent">➋</span> max_result = die_1.num_sides + die_2.num_sides<br class="calibre4" />
<span class="ent">➌</span> for value in range(2, max_result+1):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">frequency = results.count(value)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">frequencies.append(frequency)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Visualize the results.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;x_values = list(range(2, max_result+1))<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">data = [Bar(x=x_values, y=frequencies)]</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> x_axis_config = {'title': 'Result', 'dtick': 1}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">y_axis_config = {'title': 'Frequency of Result'}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;my_layout = Layout(title='Results of rolling two D6 dice 1000 times',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">xaxis=x_axis_config, yaxis=y_axis_config)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;offline.plot({'data': data, 'layout': my_layout}, filename='d6_d6.html')</p>
<p class="indent">After creating two instances of <span class="literal">Die</span>, we roll the dice and calculate the sum of the two dice for each roll <span class="ent">➊</span>. The largest possible result (12) is the sum of the largest number on both dice, which we store in <span class="literal">max_result</span> <span class="ent">➋</span>. The smallest possible result (2) is the sum of the smallest number on both dice. When we analyze the results, we count the number of results for each value between 2 and <span class="literal">max_result</span> <span class="ent">➌</span>. (We could have used <span class="literal">range(2, 13)</span>, but this would work only for two D6 dice. When modeling real-world situations, it’s best to write code that can easily model a variety of situations. This code allows us to simulate rolling a pair of dice with any number of sides.)</p>
<p class="indent">When creating the chart, we include the <span class="literal">dtick</span> key in the <span class="literal">x_axis_config</span> dictionary <span class="ent">➍</span>. This setting controls the spacing between tick marks on the x-axis. Now that we have more bars on the histogram, Plotly’s default <span type="pagebreak" id="calibre_link-544" class="calibre"></span>settings will only label some of the bars. The <span class="literal">'dtick': 1</span> setting tells Plotly to label every tick mark. We also update the title of the chart and change the output filename as well.</p>
<p class="indent">After running this code, you should see a chart that looks like the one in <a href="#calibre_link-93" class="calibre6">Figure 15-13</a>.</p>
<div class="image1"><a id="calibre_link-93" class="calibre6"></a><img src="images/000064.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-13: Simulated results of rolling two six-sided dice 1000 times</em></p>
<p class="indent">This graph shows the approximate results you’re likely to get when you roll a pair of D6 dice. As you can see, you’re least likely to roll a 2 or a 12 and most likely to roll a 7. This happens because there are six ways to roll a 7, namely: 1 and 6, 2 and 5, 3 and 4, 4 and 3, 5 and 2, or 6 and 1.</p>
<h4 class="h3" id="calibre_link-1038"><strong class="calibre2"><em class="calibre3">Rolling Dice of Different Sizes</em></strong></h4>
<p class="noindent">Let’s create a six-sided die and a ten-sided die, and see what happens when we roll them 50,000 times:</p>
<p class="margin"><em class="calibre3">dice_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from plotly.graph_objs import Bar, Layout</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from plotly import offline</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from die import Die</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Create a D6 and a D10.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">die_1 = Die()</span><br class="calibre4" />
<span class="ent">➊</span> die_2 = Die(10)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Make some rolls, and store results in a list.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">results = []</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;for roll_num in range(50_000):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">result = die_1.roll() + die_2.roll()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">results.append(result)</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-294" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash"># Analyze the results.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Visualize the results.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">x_values = list(range(2, max_result+1))</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">data = [Bar(x=x_values, y=frequencies)]</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">x_axis_config = {'title': 'Result', 'dtick': 1}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">y_axis_config = {'title': 'Frequency of Result'}</span><br class="calibre4" />
<span class="ent">➋</span> my_layout = Layout(title='Results of rolling a D6 and a D10 50000 times',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">xaxis=x_axis_config, yaxis=y_axis_config)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;offline.plot({'data': data, 'layout': my_layout}, filename='d6_d10.html')</p>
<p class="indent">To make a D10, we pass the argument <span class="literal">10</span> when creating the second <span class="literal">Die</span> instance <span class="ent">➊</span> and change the first loop to simulate 50,000 rolls instead of 1000. We change the title of the graph and update the output filename as well <span class="ent">➋</span>.</p>
<p class="indent"><a href="#calibre_link-94" class="calibre6">Figure 15-14</a> shows the resulting chart. Instead of one most likely result, there are five. This happens because there’s still only one way to roll the smallest value (1 and 1) and the largest value (6 and 10), but the smaller die limits the number of ways you can generate the middle numbers: there are six ways to roll a 7, 8, 9, 10, and 11. Therefore, these are the most common results, and you’re equally likely to roll any one of these numbers.</p>
<div class="image1"><a id="calibre_link-94" class="calibre6"></a><img src="images/000001.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 15-14: The results of rolling a six-sided die and a ten-sided die 50,000 times</em></p>
<p class="indent">Our ability to use Plotly to model the rolling of dice gives us considerable freedom in exploring this phenomenon. In just minutes you can simulate a tremendous number of rolls using a large variety of dice.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-1381" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1039"><strong class="calibre2">15-6. Two D8s:</strong> Create a simulation showing what happens when you roll two eight-sided dice 1000 times. Try to picture what you think the visualization will look like before you run the simulation; then see if your intuition was correct. Gradually increase the number of rolls until you start to see the limits of your system’s capabilities.</p>
<p class="sparal" id="calibre_link-1040"><strong class="calibre2">15-7. Three Dice:</strong> When you roll three D6 dice, the smallest number you can roll is 3 and the largest number is 18. Create a visualization that shows what happens when you roll three D6 dice.</p>
<p class="sparal" id="calibre_link-1041"><strong class="calibre2">15-8. Multiplication:</strong> When you roll two dice, you usually add the two numbers together to get the result. Create a visualization that shows what happens if you multiply these numbers instead.</p>
<p class="sparal" id="calibre_link-1042"><strong class="calibre2">15-9. Die Comprehensions:</strong> For clarity, the listings in this section use the long form of <span class="literal1">for</span> loops. If you’re comfortable using list comprehensions, try writing a comprehension for one or both of the loops in each of these programs.</p>
<p class="sparal" id="calibre_link-1043"><strong class="calibre2">15-10. Practicing with Both Libraries:</strong> Try using Matplotlib to make a die-rolling visualization, and use Plotly to make the visualization for a random walk. (You’ll need to consult the documentation for each library to complete this exercise.)</p>
</div>
<h3 class="h2" id="calibre_link-1044"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned to generate data sets and create visualizations of that data. You created simple plots with Matplotlib and used a scatter plot to explore random walks. You also created a histogram with Plotly and used a histogram to explore the results of rolling dice of different sizes.</p>
<p class="indent">Generating your own data sets with code is an interesting and powerful way to model and explore a wide variety of real-world situations. As you continue to work through the data visualization projects that follow, keep an eye out for situations you might be able to model with code. Look at the visualizations you see in news media, and see if you can identify those that were generated using methods similar to the ones you’re learning in these projects.</p>
<p class="indent">In <a href="#calibre_link-15" class="calibre6">Chapter 16</a>, you’ll download data from online sources and continue to use Matplotlib and Plotly to explore that data.<span type="pagebreak" id="calibre_link-1382" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-35">
<h2 class="h" id="calibre_link-15"><span type="pagebreak" id="calibre_link-1383" class="calibre"></span><strong class="calibre2"><span class="big">16</span><br class="calibre4" />DOWNLOADING DATA</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter, you’ll download data sets from online sources and create working visualizations of that data. You can find an incredible variety of data online, much of which hasn’t been examined thoroughly. The ability to analyze this data allows you to discover patterns and connections that no one else has found.</p>
<p class="indent">We’ll access and visualize data stored in two common data formats, CSV and JSON. We’ll use Python’s <span class="literal">csv</span> module to process weather data stored in the CSV (comma-separated values) format and analyze high and low temperatures over time in two different locations. We’ll then use Matplotlib to generate a chart based on our downloaded data to display variations in temperature in two dissimilar environments: Sitka, Alaska, and Death Valley, California. Later in the chapter, we’ll use the <span class="literal">json</span> module to access earthquake data stored in the JSON format and use Plotly to draw a world map showing the locations and magnitudes of recent earthquakes.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-281" class="calibre"></span>By the end of this chapter, you’ll be prepared to work with different types and data set formats, and you’ll have a deeper understanding of how to build complex visualizations. Being able to access and visualize online data of different types and formats is essential to working with a wide variety of real-world data sets.</p>
<h3 class="h2" id="calibre_link-1045"><strong class="calibre2">The CSV File Format</strong></h3>
<p class="noindent">One simple way to store data in a text file is to write the data as a series of values separated by commas, which is called <em class="calibre3">comma-separated values</em>. The resulting files are called <em class="calibre3">CSV</em> files. For example, here’s a chunk of weather data in CSV format:</p>
<p class="programs">"USW00025333","SITKA AIRPORT, AK US","2018-01-01","0.45",,"48","38"</p>
<p class="indent">This is an excerpt of some weather data from January 1, 2018 in Sitka, Alaska. It includes the day’s high and low temperatures, as well as a number of other measurements from that day. CSV files can be tricky for humans to read, but they’re easy for programs to process and extract values from, which speeds up the data analysis process.</p>
<p class="indent">We’ll begin with a small set of CSV-formatted weather data recorded in Sitka, which is available in the book’s resources at <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em>. Make a folder called <em class="calibre3">data</em> inside the folder where you’re saving this chapter’s programs. Copy the file <em class="calibre3">sitka_weather_07-2018_simple.csv</em> into this new folder. (After you download the book’s resources, you’ll have all the files you need for this project.)</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The weather data in this project was originally downloaded from</em> <a href="https://ncdc.noaa.gov/cdo-web/" class="calibre6">https://ncdc.noaa.gov/cdo-web/</a>.</p>
</div>
<h4 class="h3" id="calibre_link-1046"><strong class="calibre2"><em class="calibre3">Parsing the CSV File Headers</em></strong></h4>
<p class="noindent">Python’s <span class="literal">csv</span> module in the standard library parses the lines in a CSV file and allows us to quickly extract the values we’re interested in. Let’s start by examining the first line of the file, which contains a series of headers for the data. These headers tell us what kind of information the data holds:</p>
<p class="margin"><em class="calibre3">sitka_highs.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import csv<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;filename = 'data/sitka_weather_07-2018_simple.csv'<br class="calibre4" />
<span class="ent">➊</span> with open(filename) as f:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader = csv.reader(f)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header_row = next(reader)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(header_row)</p>
<p class="indent">After importing the <span class="literal">csv</span> module, we assign the name of the file we’re working with to <span class="literal">filename</span>. We then open the file and assign the resulting file <span type="pagebreak" id="calibre_link-285" class="calibre"></span>object to <span class="literal">f</span> <span class="ent">➊</span>. Next, we call <span class="literal">csv.reader()</span> and pass it the file object as an argument to create a reader object associated with that file <span class="ent">➋</span>. We assign the reader object to <span class="literal">reader</span>.</p>
<p class="indent">The <span class="literal">csv</span> module contains a <span class="literal">next()</span> function, which returns the next line in the file when passed the reader object. In the preceding listing, we call <span class="literal">next()</span> only once so we get the first line of the file, which contains the file headers <span class="ent">➌</span>. We store the data that’s returned in <span class="literal">header_row</span>. As you can see, <span class="literal">header_row</span> contains meaningful, weather-related headers that tell us what information each line of data holds:</p>
<p class="programs">['STATION', 'NAME', 'DATE', 'PRCP', 'TAVG', 'TMAX', 'TMIN']</p>
<p class="indent">The <span class="literal">reader</span> object processes the first line of comma-separated values in the file and stores each as an item in a list. The header <span class="literal">STATION</span> represents the code for the weather station that recorded this data. The position of this header tells us that the first value in each line will be the weather station code. The <span class="literal">NAME</span> header indicates that the second value in each line is the name of the weather station that made the recording. The rest of the headers specify what kinds of information were recorded in each reading. The data we’re most interested in for now are the date, the high temperature (<span class="literal">TMAX</span>), and the low temperature (<span class="literal">TMIN</span>). This is a simple data set that contains only precipitation and temperature-related data. When you download your own weather data, you can choose to include a number of other measurements relating to wind speed, direction, and more detailed precipitation data.</p>
<h4 class="h3" id="calibre_link-1047"><strong class="calibre2"><em class="calibre3">Printing the Headers and Their Positions</em></strong></h4>
<p class="noindent">To make it easier to understand the file header data, we print each header and its position in the list:</p>
<p class="margin"><em class="calibre3">sitka_highs.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">reader = csv.reader(f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">header_row = next(reader)</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for index, column_header in enumerate(header_row):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(index, column_header)</p>
<p class="indent">The <span class="literal">enumerate()</span> function returns both the index of each item and the value of each item as you loop through a list <span class="ent">➊</span>. (Note that we’ve removed the line <span class="literal">print(header_row)</span> in favor of this more detailed version.)</p>
<p class="indent">Here’s the output showing the index of each header:</p>
<p class="programs">0 STATION<br class="calibre4" />
1 NAME<br class="calibre4" />
2 DATE<br class="calibre4" />
3 PRCP<br class="calibre4" />
4 TAVG<br class="calibre4" />
5 TMAX<br class="calibre4" />
6 TMIN</p>
<p class="indent"><span type="pagebreak" id="calibre_link-286" class="calibre"></span>Here we see that the dates and their high temperatures are stored in columns 2 and 5. To explore this data, we’ll process each row of data in <em class="calibre3">sitka_weather_07-2018_simple.csv</em> and extract the values with the indexes 2 and 5.</p>
<h4 class="h3" id="calibre_link-1048"><strong class="calibre2"><em class="calibre3">Extracting and Reading Data</em></strong></h4>
<p class="noindent">Now that we know which columns of data we need, let’s read in some of that data. First, we’ll read in the high temperature for each day:</p>
<p class="margin"><em class="calibre3">sitka_highs.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash"><span class="codeitalic1">--snip--</span></span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">reader = csv.reader(f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">header_row = next(reader)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get high temperatures from this file.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;highs = []<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for row in reader:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high = int(row[5])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;highs.append(high)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(highs)</p>
<p class="indent">We make an empty list called <span class="literal">highs</span> <span class="ent">➊</span> and then loop through the remaining rows in the file <span class="ent">➋</span>. The <span class="literal">reader</span> object continues from where it left off in the CSV file and automatically returns each line following its current position. Because we’ve already read the header row, the loop will begin at the second line where the actual data begins. On each pass through the loop, we pull the data from index 5, which corresponds to the header <span class="literal">TMAX</span>, and assign it to the variable <span class="literal">high</span> <span class="ent">➌</span>. We use the <span class="literal">int()</span> function to convert the data, which is stored as a string, to a numerical format so we can use it. We then append this value to <span class="literal">highs</span>.</p>
<p class="indent">The following listing shows the data now stored in <span class="literal">highs</span>:</p>
<p class="programs">[62, 58, 70, 70, 67, 59, 58, 62, 66, 59, 56, 63, 65, 58, 56, 59, 64, 60, 60,<br class="calibre4" />
&nbsp;61, 65, 65, 63, 59, 64, 65, 68, 66, 64, 67, 65]</p>
<p class="indent">We’ve extracted the high temperature for each date and stored each value in a list. Now let’s create a visualization of this data.</p>
<h4 class="h3" id="calibre_link-1049"><strong class="calibre2"><em class="calibre3">Plotting Data in a Temperature Chart</em></strong></h4>
<p class="noindent">To visualize the temperature data we have, we’ll first create a simple plot of the daily highs using Matplotlib, as shown here:</p>
<p class="margin"><em class="calibre3">sitka_highs.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import csv</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;import matplotlib.pyplot as plt<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'data/sitka_weather_07-2018_simple.csv'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-288" class="calibre"></span>&nbsp;&nbsp;&nbsp;# Plot the high temperatures.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.style.use('seaborn')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;fig, ax = plt.subplots()<br class="calibre4" />
<span class="ent">➊</span> ax.plot(highs, c='red')<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Format plot.<br class="calibre4" />
<span class="ent">➋</span> plt.title("Daily high temperatures, July 2018", fontsize=24)<br class="calibre4" />
<span class="ent">➌</span> plt.xlabel('', fontsize=16)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.ylabel("Temperature (F)", fontsize=16)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.tick_params(axis='both', which='major', labelsize=16)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.show()</p>
<p class="indent">We pass the list of highs to <span class="literal">plot()</span> and pass <span class="literal">c='red'</span> to plot the points in red <span class="ent">➊</span>. (We’ll plot the highs in red and the lows in blue.) We then specify a few other formatting details, such as the title, font size, and labels <span class="ent">➋</span>, which you should recognize from <a href="#calibre_link-14" class="calibre6">Chapter 15</a>. Because we have yet to add the dates, we won’t label the x-axis, but <span class="literal">plt.xlabel()</span> does modify the font size to make the default labels more readable <span class="ent">➌</span>. <a href="#calibre_link-36" class="calibre6">Figure 16-1</a> shows the resulting plot: a simple line graph of the high temperatures for July 2018 in Sitka, Alaska.</p>
<div class="image1"><a id="calibre_link-36" class="calibre6"></a><img src="images/000006.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-1: A line graph showing daily high temperatures for July 2018 in Sitka, Alaska</em></p>
<h4 class="h3" id="calibre_link-1050"><strong class="calibre2"><em class="calibre3">The datetime Module</em></strong></h4>
<p class="noindent">Let’s add dates to our graph to make it more useful. The first date from the weather data file is in the second row of the file:</p>
<p class="programs">"USW00025333","SITKA AIRPORT, AK US","2018-07-01","0.25",,"62","50"</p>
<p class="indent"><span type="pagebreak" id="calibre_link-549" class="calibre"></span>The data will be read in as a string, so we need a way to convert the string <span class="literal">"2018-07-01"</span> to an object representing this date. We can construct an object representing July 1, 2018 using the <span class="literal">strptime()</span> method from the <span class="literal">datetime</span> module. Let’s see how <span class="literal">strptime()</span> works in a terminal session:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">from datetime import datetime</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">first_date = datetime.strptime('2018-07-01', '%Y-%m-%d')</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">print(first_date)</span><br class="calibre4" />
2018-07-01 00:00:00</p>
<p class="indent">We first import the <span class="literal">datetime</span> class from the <span class="literal">datetime</span> module. Then we call the method <span class="literal">strptime()</span> using the string containing the date we want to work with as its first argument. The second argument tells Python how the date is formatted. In this example, Python interprets <span class="literal">'%Y-'</span> to mean the part of the string before the first dash is a four-digit year; <span class="literal">'%m-'</span> means the part of the string before the second dash is a number representing the month; and <span class="literal">'%d'</span> means the last part of the string is the day of the month, from 1 to 31.</p>
<p class="indent">The <span class="literal">strptime()</span> method can take a variety of arguments to determine how to interpret the date. <a href="#calibre_link-37" class="calibre6">Table 16-1</a> shows some of these arguments.</p>
<p class="tabcap" id="calibre_link-37"><strong class="calibre2">Table 16-1:</strong> Date and Time Formatting Arguments from the <span class="literal1">datetime</span> Module</p>
<table class="topbot-d">
<colgroup class="calibre10">
<col class="calibre14"></col>
<col class="calibre15"></col>
</colgroup>
<tbody class="calibre12">
<tr class="calibre13">
<td class="table-h"><p class="tab_th"><strong class="calibre2">Argument</strong></p></td>
<td class="table-h"><p class="tab_th"><strong class="calibre2">Meaning</strong></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%A</span></p></td>
<td class="table-b"><p class="taba">Weekday name, such as <em class="calibre3">Monday</em></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%B</span></p></td>
<td class="table-b"><p class="taba">Month name, such as <em class="calibre3">January</em></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%m</span></p></td>
<td class="table-b"><p class="taba">Month, as a number (01 to 12)</p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%d</span></p></td>
<td class="table-b"><p class="taba">Day of the month, as a number (01 to 31)</p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%Y</span></p></td>
<td class="table-b"><p class="taba">Four-digit year, such as 2019</p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%y</span></p></td>
<td class="table-b"><p class="taba">Two-digit year, such as 19</p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%H</span></p></td>
<td class="table-b"><p class="taba">Hour, in 24-hour format (00 to 23)</p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%I</span></p></td>
<td class="table-b"><p class="taba">Hour, in 12-hour format (01 to 12)</p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%p</span></p></td>
<td class="table-b"><p class="taba"><small class="calibre5">AM</small> or <small class="calibre5">PM</small></p></td>
</tr>
<tr class="calibre13">
<td class="table-b"><p class="taba"><span class="literal">%M</span></p></td>
<td class="table-b"><p class="taba">Minutes (00 to 59)</p></td>
</tr>
<tr class="calibre13">
<td class="table-ba"><p class="taba"><span class="literal">%S</span></p></td>
<td class="table-ba"><p class="taba">Seconds (00 to 61)</p></td>
</tr>
</tbody>
</table>
<h4 class="h3" id="calibre_link-1051"><strong class="calibre2"><em class="calibre3">Plotting Dates</em></strong></h4>
<p class="noindent">Now we can improve our temperature data plot by extracting dates for the daily highs and passing those highs and dates to <span class="literal">plot()</span>, as shown here:</p>
<p class="margin"><em class="calibre3">sitka_highs.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import csv</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;from datetime import datetime<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">import matplotlib.pyplot as plt</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'data/sitka_weather_07-2018_simple.csv'</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-289" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">reader = csv.reader(f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">header_row = next(reader)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get dates and high temperatures from this file.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dates, highs = [], []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for row in reader:</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_date = datetime.strptime(row[2], '%Y-%m-%d')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">high = int(row[5])</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dates.append(current_date)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">highs.append(high)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Plot the high temperatures.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('seaborn')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
<span class="ent">➌</span> ax.plot(dates, highs, c='red')<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Format plot.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.title("Daily high temperatures, July 2018", fontsize=24)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.xlabel('', fontsize=16)</span><br class="calibre4" />
<span class="ent">➍</span> fig.autofmt_xdate()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.ylabel("Temperature (F)", fontsize=16)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.tick_params(axis='both', which='major', labelsize=16)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.show()</span></p>
<p class="indent">We create two empty lists to store the dates and high temperatures from the file <span class="ent">➊</span>. We then convert the data containing the date information (<span class="literal">row[2]</span>) to a <span class="literal">datetime</span> object <span class="ent">➋</span> and append it to <span class="literal">dates</span>. We pass the dates and the high temperature values to <span class="literal">plot()</span> <span class="ent">➌</span>. The call to <span class="literal">fig.autofmt_xdate()</span> <span class="ent">➍</span> draws the date labels diagonally to prevent them from overlapping. Figure 16-2 shows the improved graph.</p>
<div class="image1"><a id="calibre_link-1384" class="calibre6"></a><img src="images/000011.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-2: The graph is more meaningful now that it has dates on the x-axis.</em></p>
<h4 class="h3" id="calibre_link-1052"><span type="pagebreak" id="calibre_link-546" class="calibre"></span><strong class="calibre2"><em class="calibre3">Plotting a Longer Timeframe</em></strong></h4>
<p class="noindent">With our graph set up, let’s add more data to get a more complete picture of the weather in Sitka. Copy the file <em class="calibre3">sitka_weather_2018_simple.csv</em>, which contains a full year’s worth of weather data for Sitka, to the folder where you’re storing the data for this chapter’s programs.</p>
<p class="indent">Now we can generate a graph for the entire year’s weather:</p>
<p class="margin"><em class="calibre3">sitka_highs.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ent">➊</span> filename = 'data/sitka_weather_2018_simple.csv'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Format plot.</span><br class="calibre4" />
<span class="ent">➋</span> plt.title("Daily high temperatures - 2018", fontsize=24)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.xlabel('', fontsize=16)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We modify the filename to use the new data file <em class="calibre3">sitka_weather_2018_simple.csv</em> <span class="ent">➊</span>, and we update the title of our plot to reflect the change in its content <span class="ent">➋</span>. <a href="#calibre_link-38" class="calibre6">Figure 16-3</a> shows the resulting plot.</p>
<div class="image1"><a id="calibre_link-38" class="calibre6"></a><img src="images/000017.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-3: A year’s worth of data</em></p>
<h4 class="h3" id="calibre_link-1053"><strong class="calibre2"><em class="calibre3">Plotting a Second Data Series</em></strong></h4>
<p class="noindent">We can make our informative graph even more useful by including the low temperatures. We need to extract the low temperatures from the data file and then add them to our graph, as shown here:</p>
<p class="margin"><em class="calibre3">sitka_highs_lows.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'sitka_weather_2018_simple.csv'</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-1385" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">reader = csv.reader(f)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">header_row = next(reader)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get dates, and high and low temperatures from this file.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dates, highs, lows = [], [], []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for row in reader:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">current_date = datetime.strptime(row[2], '%Y-%m-%d')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">high = int(row[5])</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low = int(row[6])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">dates.append(current_date)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">highs.append(high)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lows.append(low)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Plot the high and low temperatures.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('seaborn')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">ax.plot(dates, highs, c='red')</span><br class="calibre4" />
<span class="ent">➌</span> ax.plot(dates, lows, c='blue')<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Format plot.</span><br class="calibre4" />
<span class="ent">➍</span> plt.title("Daily high and low temperatures - 2018", fontsize=24)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">At <span class="ent">➊</span> we add the empty list <span class="literal">lows</span> to hold low temperatures, and then extract and store the low temperature for each date from the seventh position in each row (<span class="literal">row[6]</span>) <span class="ent">➋</span>. At <span class="ent">➌</span> we add a call to <span class="literal">plot()</span> for the low temperatures and color these values blue. Finally, we update the title <span class="ent">➍</span>. <a href="#calibre_link-39" class="calibre6">Figure 16-4</a> shows the resulting chart.</p>
<div class="image1"><a id="calibre_link-39" class="calibre6"></a><img src="images/000024.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-4: Two data series on the same plot</em></p>
<h4 class="h3" id="calibre_link-1054"><span type="pagebreak" id="calibre_link-492" class="calibre"></span><strong class="calibre2"><em class="calibre3">Shading an Area in the Chart</em></strong></h4>
<p class="noindent">Having added two data series, we can now examine the range of temperatures for each day. Let’s add a finishing touch to the graph by using shading to show the range between each day’s high and low temperatures. To do so, we’ll use the <span class="literal">fill_between()</span> method, which takes a series of x-values and two series of y-values, and fills the space between the two y-value series:</p>
<p class="margin"><em class="calibre3">sitka_highs_lows.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Plot the high and low temperatures.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.style.use('seaborn')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">fig, ax = plt.subplots()</span><br class="calibre4" />
<span class="ent">➊</span> ax.plot(dates, highs, c='red', alpha=0.5)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ax.plot(dates, lows, c='blue', alpha=0.5)<br class="calibre4" />
<span class="ent">➋</span> plt.fill_between(dates, highs, lows, facecolor='blue', alpha=0.1)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">The <span class="literal">alpha</span> argument at <span class="ent">➊</span> controls a color’s transparency. An <span class="literal">alpha</span> value of 0 is completely transparent, and 1 (the default) is completely opaque. By setting <span class="literal">alpha</span> to 0.5, we make the red and blue plot lines appear lighter.</p>
<p class="indent">At <span class="ent">➋</span> we pass <span class="literal">fill_between()</span> the list <span class="literal">dates</span> for the x-values and then the two y-value series <span class="literal">highs</span> and <span class="literal">lows</span>. The <span class="literal">facecolor</span> argument determines the color of the shaded region; we give it a low <span class="literal">alpha</span> value of 0.1 so the filled region connects the two data series without distracting from the information they represent. <a href="#calibre_link-40" class="calibre6">Figure 16-5</a> shows the plot with the shaded region between the highs and lows.</p>
<div class="image1"><a id="calibre_link-40" class="calibre6"></a><img src="images/000031.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-5: The region between the two data sets is shaded.</em></p>
<p class="indent">The shading helps make the range between the two data sets immediately apparent.</p>
<h4 class="h3" id="calibre_link-1055"><span type="pagebreak" id="calibre_link-283" class="calibre"></span><strong class="calibre2"><em class="calibre3">Error Checking</em></strong></h4>
<p class="noindent">We should be able to run the <em class="calibre3">sitka_highs_lows.py</em> code using data for any location. But some weather stations collect different data than others, and some occasionally malfunction and fail to collect some of the data they’re supposed to. Missing data can result in exceptions that crash our programs unless we handle them properly.</p>
<p class="indent">For example, let’s see what happens when we attempt to generate a temperature plot for Death Valley, California. Copy the file <em class="calibre3">death_valley_2018_simple.csv</em> to the folder where you’re storing the data for this chapter’s programs.</p>
<p class="indent">First, let’s run the code to see the headers that are included in this data file:</p>
<p class="margin"><em class="calibre3">death_valley_highs_lows.py</em></p>
<p class="programs">import csv<br class="calibre4" />
<br class="calibre4" />
filename = 'data/death_valley_2018_simple.csv'<br class="calibre4" />
with open(filename) as f:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;reader = csv.reader(f)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;header_row = next(reader)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;for index, column_header in enumerate(header_row):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(index, column_header)</p>
<p class="indent">Here’s the output:</p>
<p class="programs">0 STATION<br class="calibre4" />
1 NAME<br class="calibre4" />
2 DATE<br class="calibre4" />
3 PRCP<br class="calibre4" />
4 TMAX<br class="calibre4" />
5 TMIN<br class="calibre4" />
6 TOBS</p>
<p class="indent">The date is in the same position at index 2. But the high and low temperatures are at indexes 4 and 5, so we’d need to change the indexes in our code to reflect these new positions. Instead of including an average temperature reading for the day, this station includes <span class="literal">TOBS</span>, a reading for a specific observation time.</p>
<p class="indent">I removed one of the temperature readings from this file to show what happens when some data is missing from a file. Change <em class="calibre3">sitka_highs_lows.py</em> to generate a graph for Death Valley using the indexes we just noted, and see what happens:</p>
<p class="margin"><em class="calibre3">death_valley_highs_lows.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;filename = 'data/death_valley_2018_simple.csv'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"><span class="codeitalic1">--snip--</span></span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Get dates, and high and low temperatures from this file.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">dates, highs, lows = [], [], []</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for row in reader:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">current_date = datetime.strptime(row[2], '%Y-%m-%d')</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-1386" class="calibre"></span><span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high = int(row[4])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low = int(row[5])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">dates.append(current_date)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">At <span class="ent">➊</span> we update the indexes to correspond to this file’s <span class="literal">TMAX</span> and <span class="literal">TMIN</span> positions.</p>
<p class="indent">When we run the program, we get an error, as shown in the last line in the following output:</p>
<p class="programs">Traceback (most recent call last):<br class="calibre4" />
&nbsp;&nbsp;File "death_valley_highs_lows.py", line 15, in &lt;module&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;high = int(row[4])<br class="calibre4" />
ValueError: invalid literal for int() with base 10: ''</p>
<p class="indent">The traceback tells us that Python can’t process the high temperature for one of the dates because it can’t turn an empty string (<span class="literal">''</span>) into an integer. Rather than look through the data and finding out which reading is missing, we’ll just handle cases of missing data directly.</p>
<p class="indent">We’ll run error-checking code when the values are being read from the CSV file to handle exceptions that might arise. Here’s how that works:</p>
<p class="margin"><em class="calibre3">death_valley_highs_lows.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">filename = 'data/death_valley_2018_simple.csv'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"><span class="codeitalic1">--snip--</span></span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">for row in reader:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">current_date = datetime.strptime(row[2], '%Y-%m-%d')</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">high = int(row[4])</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">low = int(row[5])</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except ValueError:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Missing data for {current_date}")<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">dates.append(current_date)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">highs.append(high)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">lows.append(low)</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Plot the high and low temperatures.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Format plot.</span><br class="calibre4" />
<span class="ent">➍</span> title = "Daily high and low temperatures - 2018\nDeath Valley, CA"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;plt.title(title, fontsize=20)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">plt.xlabel('', fontsize=16)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Each time we examine a row, we try to extract the date and the high and low temperature <span class="ent">➊</span>. If any data is missing, Python will raise a <span class="literal">ValueError</span> and we handle it by printing an error message that includes the date of the missing data <span class="ent">➋</span>. After printing the error, the loop will continue processing the next row. If all data for a date is retrieved without error, the <span class="literal">else</span> block <span type="pagebreak" id="calibre_link-284" class="calibre"></span>will run and the data will be appended to the appropriate lists <span class="ent">➌</span>. Because we’re plotting information for a new location, we update the title to include the location on the plot, and we use a smaller font size to accommodate the longer title <span class="ent">➍</span>.</p>
<p class="indent">When you run <em class="calibre3">death_valley_highs_lows.py</em> now, you’ll see that only one date had missing data:</p>
<p class="programs">Missing data for 2018-02-18 00:00:00</p>
<p class="indent">Because the error is handled appropriately, our code is able to generate a plot, which skips over the missing data. <a href="#calibre_link-41" class="calibre6">Figure 16-6</a> shows the resulting plot.</p>
<div class="image1"><a id="calibre_link-41" class="calibre6"></a><img src="images/000039.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-6: Daily high and low temperatures for Death Valley</em></p>
<p class="indent">Comparing this graph to the Sitka graph, we can see that Death Valley is warmer overall than southeast Alaska, as we expect. Also, the range of temperatures each day is greater in the desert. The height of the shaded region makes this clear.</p>
<p class="indent">Many data sets you work with will have missing, improperly formatted, or incorrect data. You can use the tools you learned in the first half of this book to handle these situations. Here we used a <span class="literal">try</span>-<span class="literal">except</span>-<span class="literal">else</span> block to handle missing data. Sometimes you’ll use <span class="literal">continue</span> to skip over some data or use <span class="literal">remove()</span> or <span class="literal">del</span> to eliminate some data after it’s been extracted. Use any approach that works, as long as the result is a meaningful, accurate visualization.</p>
<h4 class="h3" id="calibre_link-1056"><strong class="calibre2"><em class="calibre3">Downloading Your Own Data</em></strong></h4>
<p class="noindent">If you want to download your own weather data, follow these steps:</p>
<ol class="calibre16">
<li class="noindent1">Visit the NOAA Climate Data Online site at <em class="calibre3"><a href="https://www.ncdc.noaa.gov/cdo-web/" class="calibre6">https://www.ncdc.noaa.gov/cdo-web/</a></em>. In the <em class="calibre3">Discover Data By</em> section, click <strong class="calibre2">Search Tool</strong>. In the <em class="calibre3">Select a Dataset</em> box, choose <strong class="calibre2">Daily Summaries</strong>.</li>
<li class="noindent1"><span type="pagebreak" id="calibre_link-282" class="calibre"></span>Select a date range, and in the <em class="calibre3">Search For</em> section, choose <strong class="calibre2">ZIP Codes</strong>. Enter the ZIP Code you’re interested in, and click <strong class="calibre2">Search</strong>.</li>
<li class="noindent1">On the next page, you’ll see a map and some information about the area you’re focusing on. Below the location name, click <strong class="calibre2">View Full Details</strong>, or click the map and then click <strong class="calibre2">Full Details</strong>.</li>
<li class="noindent1">Scroll down and click <strong class="calibre2">Station List</strong> to see the weather stations that are available in this area. Choose one of the stations, and click <strong class="calibre2">Add to Cart</strong>. This data is free, even though the site uses a shopping cart icon. In the upper-right corner, click the cart.</li>
<li class="noindent1">In <em class="calibre3">Select the Output</em>, choose <strong class="calibre2">Custom GHCN-Daily CSV</strong>. Make sure the date range is correct, and click <strong class="calibre2">Continue</strong>.</li>
<li class="noindent1">On the next page, you can select the kinds of data you want. You can download one kind of data, for example, focusing on air temperature, or you can download all the data available from this station. Make your choices, and then click <strong class="calibre2">Continue</strong>.</li>
<li class="noindent1">On the last page, you’ll see a summary of your order. Enter your email address, and click <strong class="calibre2">Submit Order</strong>. You’ll receive a confirmation that your order was received, and in a few minutes you should receive another email with a link to download your data.</li>
</ol>
<p class="indent">The data you download will be structured just like the data we worked with in this section. It might have different headers than those you saw in this section. But if you follow the same steps we used here, you should be able to generate visualizations of the data you’re interested in.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1057"><strong class="calibre2">16-1. Sitka Rainfall:</strong> Sitka is in a temperate rainforest, so it gets a fair amount of rainfall. In the data file <em class="calibre3">sitka_weather_2018_simple.csv</em> is a header called <span class="literal1">PRCP</span>, which represents daily rainfall amounts. Make a visualization focusing on the data in this column. You can repeat the exercise for Death Valley if you’re curious how little rainfall occurs in a desert.</p>
<p class="sparal" id="calibre_link-1058"><strong class="calibre2">16-2. Sitka&ndash;Death Valley Comparison:</strong> The temperature scales on the Sitka and Death Valley graphs reflect the different data ranges. To accurately compare the temperature range in Sitka to that of Death Valley, you need identical scales on the y-axis. Change the settings for the y-axis on one or both of the charts in <a href="#calibre_link-40" class="calibre6">Figures 16-5</a> and <a href="#calibre_link-41" class="calibre6">16-6</a>. Then make a direct comparison between temperature ranges in Sitka and Death Valley (or any two places you want to compare).</p>
<p class="sparal" id="calibre_link-1059"><strong class="calibre2">16-3. San Francisco:</strong> Are temperatures in San Francisco more like temperatures in Sitka or temperatures in Death Valley? Download some data for San Francisco, and generate a high-low temperature plot for San Francisco to make a comparison.</p>
<p class="sparal" id="calibre_link-1060"><span type="pagebreak" id="calibre_link-453" class="calibre"></span><strong class="calibre2">16-4. Automatic Indexes:</strong> In this section, we hardcoded the indexes corresponding to the <span class="literal1">TMIN</span> and <span class="literal1">TMAX</span> columns. Use the header row to determine the indexes for these values, so your program can work for Sitka or Death Valley. Use the station name to automatically generate an appropriate title for your graph as well.</p>
<p class="sparal" id="calibre_link-1061"><strong class="calibre2">16-5. Explore:</strong> Generate a few more visualizations that examine any other weather aspect you’re interested in for any locations you’re curious about.</p>
</div>
<h3 class="h2" id="calibre_link-1062"><strong class="calibre2">Mapping Global Data Sets: JSON Format</strong></h3>
<p class="noindent">In this section, you’ll download a data set representing all the earthquakes that have occurred in the world during the previous month. Then you’ll make a map showing the location of these earthquakes and how significant each one was. Because the data is stored in the JSON format, we’ll work with it using the <span class="literal">json</span> module. Using Plotly’s beginner-friendly mapping tool for location-based data, you’ll create visualizations that clearly show the global distribution of earthquakes.</p>
<h4 class="h3" id="calibre_link-1063"><strong class="calibre2"><em class="calibre3">Downloading Earthquake Data</em></strong></h4>
<p class="noindent">Copy the file <em class="calibre3">eq_1_day_m1.json</em> to the folder where you’re storing the data for this chapter’s programs. Earthquakes are categorized by their magnitude on the Richter scale. This file includes data for all earthquakes with a magnitude M1 or greater that took place in the last 24 hours (at the time of this writing). This data comes from one of the United States Geological Survey’s earthquake data feeds, which you can find at <em class="calibre3"><a href="https://earthquake.usgs.gov/earthquakes/feed/" class="calibre6">https://earthquake.usgs.gov/earthquakes/feed/</a></em>.</p>
<h4 class="h3" id="calibre_link-1064"><strong class="calibre2"><em class="calibre3">Examining JSON Data</em></strong></h4>
<p class="noindent">When you open <em class="calibre3">eq_1_day_m1.json</em>, you’ll see that it’s very dense and hard to read:</p>
<p class="programs">{"type":"FeatureCollection","metadata":{"generated":1550361461000,...<br class="calibre4" />
{"type":"Feature","properties":{"mag":1.2,"place":"11km NNE of Nor...<br class="calibre4" />
{"type":"Feature","properties":{"mag":4.3,"place":"69km NNW of Ayn...<br class="calibre4" />
{"type":"Feature","properties":{"mag":3.6,"place":"126km SSE of Co...<br class="calibre4" />
{"type":"Feature","properties":{"mag":2.1,"place":"21km NNW of Teh...<br class="calibre4" />
{"type":"Feature","properties":{"mag":4,"place":"57km SSW of Kakto...<br class="calibre4" />
--<span class="codeitalic1">snip</span>--</p>
<p class="indent">This file is formatted more for machines than it is for humans. But we can see that the file contains some dictionaries, as well as information that we’re interested in, such as earthquake magnitudes and locations.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-364" class="calibre"></span>The <span class="literal">json</span> module provides a variety of tools for exploring and working with JSON data. Some of these tools will help us reformat the file so we can look at the raw data more easily before we begin to work with it programmatically.</p>
<p class="indent">Let’s start by loading the data and displaying it in a format that’s easier to read. This is a long data file, so instead of printing it, we’ll rewrite the data to a new file. Then we can open that file and scroll back and forth easily through the data:</p>
<p class="margin"><em class="calibre3">eq_explore_data.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;import json<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Explore the structure of the data.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;filename = 'data/eq_data_1_day_m1.json'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;with open(filename) as f:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all_eq_data = json.load(f)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> readable_file = 'data/readable_eq_data.json'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;with open(readable_file, 'w') as f:<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(all_eq_data, f, indent=4)</p>
<p class="indent">We first import the <span class="literal">json</span> module to load the data properly from the file, and then store the entire set of data in <span class="literal">all_eq_data</span> <span class="ent">➊</span>. The <span class="literal">json.load()</span> function converts the data into a format Python can work with: in this case, a giant dictionary. At <span class="ent">➋</span> we create a file to write this same data into a more readable format. The <span class="literal">json.dump()</span> function takes a JSON data object and a file object, and writes the data to that file <span class="ent">➌</span>. The <span class="literal">indent=4</span> argument tells <span class="literal">dump()</span> to format the data using indentation that matches the data’s structure.</p>
<p class="indent">When you look in your <em class="calibre3">data</em> directory and open the file <em class="calibre3">readable_eq_data.json</em>, here’s the first part of what you’ll see:</p>
<p class="margin"><em class="calibre3">readable_eq_data.json</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "FeatureCollection",<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"metadata": {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"generated": 1550361461000,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"url": "https://earthquake.usgs.gov/earthquakes/.../1.0_day.geojson",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"title": "USGS Magnitude 1.0+ Earthquakes, Past Day",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"status": 200,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"api": "1.7.0",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"count": 158<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"features": [<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--</p>
<p class="indent">The first part of the file includes a section with the key <span class="literal">"metadata"</span>. This tells us when the data file was generated and where we can find the data online. It also gives us a human-readable title and the number of earthquakes included in this file. In this 24-hour period, 158 earthquakes were recorded.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-454" class="calibre"></span>This <em class="calibre3">geoJSON</em> file has a structure that’s helpful for location-based data. The information is stored in a list associated with the key <span class="literal">"features"</span> <span class="ent">➋</span>. Because this file contains earthquake data, the data is in list form where every item in the list corresponds to a single earthquake. This structure might look confusing, but it’s quite powerful. It allows geologists to store as much information as they need to in a dictionary about each earthquake, and then stuff all those dictionaries into one big list.</p>
<p class="indent">Let’s look at a dictionary representing a single earthquake:</p>
<p class="margin"><em class="calibre3">readable_eq_data.json</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "Feature",<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"properties": {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"mag": 0.96,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"title": "M 1.0 - 8km NE of Aguanga, CA"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"geometry": {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "Point",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"coordinates": [<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-116.7941667,<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33.4863333,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.22<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"id": "ci37532978"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p>
<p class="indent">The key <span class="literal">"properties"</span> contains a lot of information about each earthquake <span class="ent">➊</span>. We’re mainly interested in the magnitude of each quake, which is associated with the key <span class="literal">"mag"</span>. We’re also interested in the title of each earthquake, which provides a nice summary of its magnitude and location <span class="ent">➋</span>.</p>
<p class="indent">The key <span class="literal">"geometry"</span> helps us understand where the earthquake occurred <span class="ent">➌</span>. We’ll need this information to map each event. We can find the longitude <span class="ent">➍</span> and the latitude <span class="ent">➎</span> for each earthquake in a list associated with the key <span class="literal">"coordinates"</span>.</p>
<p class="indent">This file contains way more nesting than we’d use in the code we write, so if it looks confusing, don’t worry: Python will handle most of the complexity. We’ll only be working with one or two nesting levels at a time. We’ll start by pulling out a dictionary for each earthquake that was recorded in the 24-hour time period.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">When we talk about locations, we often say the location’s latitude first, followed by the longitude. This convention probably arose because humans discovered latitude long before we developed the concept of longitude. However, many geospatial frameworks list the longitude first and then the latitude, because this corresponds to the</em> (x, y) <em class="calibre3">convention we use in mathematical representations. The geoJSON format follows the (longitude, latitude) convention, and if you use a different framework it’s important to learn what convention that framework follows.</em></p>
</div>
<h4 class="h3" id="calibre_link-1065"><span type="pagebreak" id="calibre_link-483" class="calibre"></span><strong class="calibre2"><em class="calibre3">Making a List of All Earthquakes</em></strong></h4>
<p class="noindent">First, we’ll make a list that contains all the information about every earthquake that occurred.</p>
<p class="margin"><em class="calibre3">eq_explore_data.py</em></p>
<p class="programs"><span class="ash">import json</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash"># Explore the structure of the data.</span><br class="calibre4" />
<span class="ash">filename = 'data/eq_data_1_day_m1.json'</span><br class="calibre4" />
<span class="ash">with open(filename) as f:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">all_eq_data = json.load(f)</span><br class="calibre4" />
<br class="calibre4" />
all_eq_dicts = all_eq_data['features']<br class="calibre4" />
print(len(all_eq_dicts))</p>
<p class="indent">We take the data associated with the key <span class="literal">'features'</span> and store it in <span class="literal">all_eq_dicts</span>. We know this file contains records about 158 earthquakes, and the output verifies that we’ve captured all of the earthquakes in the file:</p>
<p class="programs">158</p>
<p class="indent">Notice how short this code is. The neatly formatted file <em class="calibre3">readable_eq_data.json</em> has over 6,000 lines. But in just a few lines, we can read through all that data and store it in a Python list. Next, we’ll pull the magnitudes from each earthquake.</p>
<h4 class="h3" id="calibre_link-1066"><strong class="calibre2"><em class="calibre3">Extracting Magnitudes</em></strong></h4>
<p class="noindent">Using the list containing data about each earthquake, we can loop through that list and extract any information we want. Now we’ll pull the magnitude of each earthquake:</p>
<p class="margin"><em class="calibre3">eq_explore_data.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">all_eq_dicts = all_eq_data['features']</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> mags = []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for eq_dict in all_eq_dicts:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mag = eq_dict['properties']['mag']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mags.append(mag)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(mags[:10])</p>
<p class="indent">We make an empty list to store the magnitudes, and then loop through the dictionary <span class="literal">all_eq_dicts</span> <span class="ent">➊</span>. Inside this loop, each earthquake is represented by the dictionary <span class="literal">eq_dict</span>. Each earthquake’s magnitude is stored in the <span class="literal">'properties'</span> section of this dictionary under the key <span class="literal">'mag'</span> <span class="ent">➋</span>. We store each magnitude in the variable <span class="literal">mag</span>, and then append it to the list <span class="literal">mags</span>.</p>
<p class="indent">We print the first 10 magnitudes, so we can see whether we’re getting the correct data:</p>
<p class="programs">[0.96, 1.2, 4.3, 3.6, 2.1, 4, 1.06, 2.3, 4.9, 1.8]</p>
<p class="indent"><span type="pagebreak" id="calibre_link-365" class="calibre"></span>Next, we’ll pull the location data for each earthquake, and then we can make a map of the earthquakes.</p>
<h4 class="h3" id="calibre_link-1067"><strong class="calibre2"><em class="calibre3">Extracting Location Data</em></strong></h4>
<p class="noindent">The location data is stored under the key <span class="literal">"geometry"</span>. Inside the geometry dictionary is a <span class="literal">"coordinates"</span> key, and the first two values in this list are the longitude and latitude. Here’s how we’ll pull this data:</p>
<p class="margin"><em class="calibre3">eq_explore_data.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">all_eq_dicts = all_eq_data['features']</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;mags, lons, lats = [], [], []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for eq_dict in all_eq_dicts:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">mag = eq_dict['properties']['mag']</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lon = eq_dict['geometry']['coordinates'][0]<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lat = eq_dict['geometry']['coordinates'][1]<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">mags.append(mag)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lons.append(lon)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lats.append(lat)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(mags[:10])</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(lons[:5])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(lats[:5])</p>
<p class="indent">We make empty lists for the longitudes and latitudes. The code <span class="literal">eq_dict['geometry']</span> accesses the dictionary representing the geometry element of the earthquake <span class="ent">➊</span>. The second key, <span class="literal">'coordinates'</span>, pulls the list of values associated with <span class="literal">'coordinates'</span>. Finally, the 0 index asks for the first value in the list of coordinates, which corresponds to an earthquake’s longitude.</p>
<p class="indent">When we print the first five longitudes and latitudes, the output shows that we’re pulling the correct data:</p>
<p class="programs"><span class="ash">[0.96, 1.2, 4.3, 3.6, 2.1, 4, 1.06, 2.3, 4.9, 1.8]</span><br class="calibre4" />
[-116.7941667, -148.9865, -74.2343, -161.6801, -118.5316667]<br class="calibre4" />
[33.4863333, 64.6673, -12.1025, 54.2232, 35.3098333]</p>
<p class="indent">With this data, we can move on to mapping each earthquake.</p>
<h4 class="h3" id="calibre_link-1068"><strong class="calibre2"><em class="calibre3">Building a World Map</em></strong></h4>
<p class="noindent">With the information we’ve pulled so far, we can build a simple world map. Although it won’t look presentable yet, we want to make sure the information is displayed correctly before focusing on style and presentation issues. Here’s the initial map:</p>
<p class="margin"><em class="calibre3">eq_world_map.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import json</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> from plotly.graph_objs import Scattergeo, Layout<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from plotly import offline<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-486" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash">for eq_dict in all_eq_dicts:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Map the earthquakes.<br class="calibre4" />
<span class="ent">➋</span> data = [Scattergeo(lon=lons, lat=lats)]<br class="calibre4" />
<span class="ent">➌</span> my_layout = Layout(title='Global Earthquakes')<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> fig = {'data': data, 'layout': my_layout}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;offline.plot(fig, filename='global_earthquakes.html')</p>
<p class="indent">We import the <span class="literal">Scattergeo</span> chart type and the <span class="literal">Layout</span> class, and then import the <span class="literal">offline</span> module to render the map <span class="ent">➊</span>. As we did when making a bar chart, we define a list called <span class="literal">data</span>. We create the <span class="literal">Scattergeo</span> object inside this list <span class="ent">➋</span>, because you can plot more than one data set on any visualization you make. A <span class="literal">Scattergeo</span> chart type allows you to overlay a scatter plot of geographic data on a map. In the simplest use of this chart type, you only need to provide a list of longitudes and a list of latitudes.</p>
<p class="indent">We give the chart an appropriate title <span class="ent">➌</span> and create a dictionary called <span class="literal">fig</span> that contains the data and the layout <span class="ent">➍</span>. Finally, we pass <span class="literal">fig</span> to the <span class="literal">plot()</span> function along with a descriptive filename for the output. When you run this file, you should see a map that looks like the one in <a href="#calibre_link-42" class="calibre6">Figure 16-7</a>. Earthquakes usually occur near plate boundaries, which matches what we see in the chart.</p>
<div class="image1"><a id="calibre_link-42" class="calibre6"></a><img src="images/000046.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-7: A simple map showing where all the earthquakes in the last 24 hours occurred</em></p>
<p class="indent">We can do a lot of modifications to make this map more meaningful and easier to read, so let’s make some of these changes.</p>
<h4 class="h3" id="calibre_link-1069"><span type="pagebreak" id="calibre_link-485" class="calibre"></span><strong class="calibre2"><em class="calibre3">A Different Way of Specifying Chart Data</em></strong></h4>
<p class="noindent">Before we configure the chart, let’s look at a slightly different way to specify the data for a Plotly chart. In the current chart, the <span class="literal">data</span> list is defined in one line:</p>
<p class="programs">data = [Scattergeo(lon=lons, lat=lats)]</p>
<p class="indent">This is one of the simplest ways to define the data for a chart in Plotly. But it’s not the best way when you want to customize the presentation. Here’s an equivalent way to define the data for the current chart:</p>
<p class="programs">data = [{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'type': 'scattergeo',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'lon': lons,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'lat': lats,<br class="calibre4" />
}]</p>
<p class="indent">In this approach, all the information about the data is structured as key-value pairs in a dictionary. If you put this code into <em class="calibre3">eq_plot.py</em>, you’ll see the same chart we just generated. This format allows us to specify customizations more easily than the previous format.</p>
<h4 class="h3" id="calibre_link-1070"><strong class="calibre2"><em class="calibre3">Customizing Marker Size</em></strong></h4>
<p class="noindent">When we’re figuring out how to improve the map’s styling, we should focus on aspects of the data that we want to communicate more clearly. The current map shows the location of each earthquake, but it doesn’t communicate the severity of any earthquake. We want viewers to immediately see where the most significant earthquakes occur in the world.</p>
<p class="indent">To do this, we’ll change the size of markers depending on the magnitude of each earthquake:</p>
<p class="margin"><em class="calibre3">eq_world_map.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import json</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Map the earthquakes.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;data = [{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'type': 'scattergeo',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'lon': lons,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'lat': lats,<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'marker': {<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'size': [5*mag for mag in mags],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;}]<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_layout = Layout(title='Global Earthquakes')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-481" class="calibre"></span>Plotly offers a huge variety of customizations you can make to a data series, each of which can be expressed as a key-value pair. Here we’re using the key <span class="literal">'marker'</span> to specify how big each marker on the map should be <span class="ent">➊</span>. We use a nested dictionary as the value associated with <span class="literal">'marker'</span>, because you can specify a number of settings for all the markers in a series.</p>
<p class="indent">We want the size to correspond to the magnitude of each earthquake. But if we just pass in the <span class="literal">mags</span> list, the markers would be too small to easily see the size differences. We need to multiply the magnitude by a scale factor to get an appropriate marker size. On my screen, a value of 5 works well; a slightly smaller or larger value might work better for your map. We use a list comprehension, which generates an appropriate marker size for each value in the <span class="literal">mags</span> list <span class="ent">➋</span>.</p>
<p class="indent">When you run this code, you should see a map that looks like the one in <a href="#calibre_link-43" class="calibre6">Figure 16-8</a>. This is a much better map, but we can still do more.</p>
<div class="image1"><a id="calibre_link-43" class="calibre6"></a><img src="images/000054.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-8: The map now shows the magnitude of each earthquake.</em></p>
<h4 class="h3" id="calibre_link-1071"><strong class="calibre2"><em class="calibre3">Customizing Marker Colors</em></strong></h4>
<p class="noindent">We can also customize each marker’s color to provide some classification to the severity of each earthquake. We’ll use Plotly’s colorscales to do this. Before you make these changes, copy the file <em class="calibre3">eq_data_30_day_m1.json</em> to your data directory. This file includes earthquake data for a 30-day period, and the map will be much more interesting to look at using this larger data set.</p>
<p class="indent">Here’s how to use a colorscale to represent the magnitude of each earthquake:</p>
<p class="margin"><em class="calibre3">eq_world_map.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ent">➊</span> filename = 'data/eq_data_30_day_m1.json'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Map the earthquakes.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">data = [{</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1387" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'marker': {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'size': [5*mag for mag in mags],</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'color': mags,<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'colorscale': 'Viridis',<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'reversescale': True,<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'colorbar': {'title': 'Magnitude'},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">},</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">}]</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Be sure to update the filename so you’re using the 30-day data set <span class="ent">➊</span>. All the significant changes here occur in the <span class="literal">'marker'</span> dictionary, because we’re only modifying the markers’ appearance. The <span class="literal">'color'</span> setting tells Plotly what values it should use to determine where each marker falls on the colorscale <span class="ent">➋</span>. We use the <span class="literal">mags</span> list to determine the color that’s used. The <span class="literal">'colorscale'</span> setting tells Plotly which range of colors to use: <span class="literal">'Viridis'</span> is a colorscale that ranges from dark blue to bright yellow and works well for this data set <span class="ent">➌</span>. We set <span class="literal">'reversescale'</span> to <span class="literal">True</span>, because we want to use bright yellow for the lowest values and dark blue for the most severe earthquakes <span class="ent">➍</span>. The <span class="literal">'colorbar'</span> setting allows us to control the appearance of the colorscale shown on the side of the map. Here we title the colorscale <span class="literal">'Magnitude'</span> to make it clear what the colors represent <span class="ent">➍</span>.</p>
<p class="indent">When you run the program now, you’ll see a much nicer-looking map. In <a href="#calibre_link-44" class="calibre6">Figure 16-9</a>, the colorscale shows the severity of individual earthquakes. Plotting this many earthquakes really makes it clear where the tectonic plate boundaries are!</p>
<div class="image1"><a id="calibre_link-44" class="calibre6"></a><img src="images/000060.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 16-9: In 30 days’ worth of earthquakes, color and size are used to represent the magnitude of each earthquake.</em></p>
<h4 class="h3" id="calibre_link-1072"><span type="pagebreak" id="calibre_link-484" class="calibre"></span><strong class="calibre2"><em class="calibre3">Other Colorscales</em></strong></h4>
<p class="noindent">You can also choose from a number of other colorscales. To see the available colorscales, save the following short program as <em class="calibre3">show_color_scales.py</em>:</p>
<p class="margin"><em class="calibre3">show_color_scales.py</em></p>
<p class="programs">from plotly import colors<br class="calibre4" />
<br class="calibre4" />
for key in colors.PLOTLY_SCALES.keys():<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;print(key)</p>
<p class="indent">Plotly stores the colorscales in the <span class="literal">colors</span> module. The colorscales are defined in the dictionary <span class="literal">PLOTLY_SCALES</span>, and the names of the colorscales serve as the keys in the dictionary. Here’s the output showing all the available colorscales:</p>
<p class="programs">Greys<br class="calibre4" />
YlGnBu<br class="calibre4" />
Greens<br class="calibre4" />
--<span class="codeitalic1">snip</span>--<br class="calibre4" />
Viridis</p>
<p class="indent">Feel free to try out these colorscales; remember that you can reverse any of these scales using the <span class="literal">reversescale</span> setting.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you print the <span class="codeitalic">PLOTLY_SCALES</span> dictionary, you can see how colorscales are defined. Every scale has a beginning color and an end color, and some scales have one or more intermediate colors defined as well. Plotly interpolates shades between each of these defined colors.</em></p>
</div>
<h4 class="h3" id="calibre_link-1073"><strong class="calibre2"><em class="calibre3">Adding Hover Text</em></strong></h4>
<p class="noindent">To finish this map, we’ll add some informative text that appears when you hover over the marker representing an earthquake. In addition to showing the longitude and latitude, which appear by default, we’ll show the magnitude and provide a description of the approximate location as well.</p>
<p class="indent">To make this change, we need to pull a little more data from the file and add it to the dictionary in <span class="literal">data</span> as well:</p>
<p class="margin"><em class="calibre3">eq_world_map.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ent">➊</span> mags, lons, lats, hover_texts = [], [], [], []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for eq_dict in all_eq_dicts:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">lat = eq_dict['geometry']['coordinates'][1]</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title = eq_dict['properties']['title']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">mags.append(mag)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">lons.append(lon)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">lats.append(lat)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hover_texts.append(title)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-366" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash"># Map the earthquakes.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">data = [{</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'type': 'scattergeo',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'lon': lons,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'lat': lats,</span><br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'text': hover_texts,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'marker': {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">},</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">}]</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We first make a list called <span class="literal">hover_texts</span> to store the label we’ll use for each marker <span class="ent">➊</span>. The “title” section of the earthquake data contains a descriptive name of the magnitude and location of each earthquake in addition to its longitude and latitude. At <span class="ent">➋</span> we pull this information and assign it to the variable <span class="literal">title</span>, and then append it to the list <span class="literal">hover_texts</span>.</p>
<p class="indent">When we include the key <span class="literal">'text'</span> in the <span class="literal">data</span> object, Plotly uses this value as a label for each marker when the viewer hovers over the marker. When we pass a list that matches the number of markers, Plotly pulls an individual label for each marker it generates <span class="ent">➌</span>. When you run this program, you should be able to hover over any marker, see a description of where that earthquake took place, and read its exact magnitude.</p>
<p class="indent">This is impressive! In approximately 40 lines of code, we’ve created a visually appealing and meaningful map of global earthquake activity that also illustrates the geological structure of the planet. Plotly offers a wide range of ways you can customize the appearance and behavior of your visualizations. Using Plotly’s many options, you can make charts and maps that show exactly what you want them to.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1074"><strong class="calibre2">16-6. Refactoring:</strong> The loop that pulls data from <span class="literal1">all_eq_dicts</span> uses variables for the magnitude, longitude, latitude, and title of each earthquake before appending these values to their appropriate lists. This approach was chosen for clarity in how to pull data from a JSON file, but it’s not necessary in your code. Instead of using these temporary variables, pull each value from <span class="literal1">eq_dict</span> and append it to the appropriate list in one line. Doing so should shorten the body of this loop to just four lines.</p>
<p class="sparal" id="calibre_link-1075"><strong class="calibre2">16-7. Automated Title:</strong> In this section, we specified the title manually when defining <span class="literal1">my_layout</span>, which means we have to remember to update the title every time the source file changes. Instead, you can use the title for the data set in the metadata part of the JSON file. Pull this value, assign it to a variable, and use this for the title of the map when you’re defining <span class="literal1">my_layout</span>.</p>
<p class="sparal" id="calibre_link-1076"><span type="pagebreak" id="calibre_link-482" class="calibre"></span><strong class="calibre2">16-8. Recent Earthquakes:</strong> You can find data files containing information about the most recent earthquakes over 1-hour, 1-day, 7-day, and 30-day periods online. Go to <em class="calibre3"><a href="https://earthquake.usgs.gov/earthquakes/feed/v1.0/geojson.php" class="calibre6">https://earthquake.usgs.gov/earthquakes/feed/v1.0/geojson.php</a></em> and you’ll see a list of links to data sets for various time periods, focusing on earthquakes of different magnitudes. Download one of these data sets, and create a visualization of the most recent earthquake activity.</p>
<p class="sparal" id="calibre_link-1077"><strong class="calibre2">16-9. World Fires:</strong> In the resources for this chapter, you’ll find a file called <em class="calibre3">world_fires_1_day.csv</em>. This file contains information about fires burning in different locations around the globe, including the latitude and longitude, and the brightness of each fire. Using the data processing work from the first part of this chapter and the mapping work from this section, make a map that shows which parts of the world are affected by fires.</p>
<p class="sparai">You can download more recent versions of this data at <em class="calibre3"><a href="https://earthdata.nasa.gov/earth-observation-data/near-real-time/firms/active-fire-data/" class="calibre6">https://earthdata.nasa.gov/earth-observation-data/near-real-time/firms/active-fire-data/</a></em>. You can find links to the data in CSV format in the <em class="calibre3">TXT</em> section.</p>
</div>
<h3 class="h2" id="calibre_link-1078"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned to work with real-world data sets. You processed CSV and JSON files, and extracted the data you want to focus on. Using historical weather data, you learned more about working with Matplotlib, including how to use the <span class="literal">datetime</span> module and how to plot multiple data series on one chart. You plotted geographical data on a world map in Plotly and styled Plotly maps and charts as well.</p>
<p class="indent">As you gain experience working with CSV and JSON files, you’ll be able to process almost any data you want to analyze. You can download most online data sets in either or both of these formats. By working with these formats, you’ll be able to learn how to work with other data formats more easily as well.</p>
<p class="indent">In the next chapter, you’ll write programs that automatically gather their own data from online sources, and then you’ll create visualizations of that data. These are fun skills to have if you want to program as a hobby and critical skills if you’re interested in programming professionally.</p>
</div>


<div class="calibre1" id="calibre_link-66">
<h2 class="h" id="calibre_link-16"><span type="pagebreak" id="calibre_link-233" class="calibre"></span><strong class="calibre2"><span class="big">17</span><br class="calibre4" />WORKING WITH APIs</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">In this chapter, you’ll learn how to write a self-contained program that generates a visualization based on data that it retrieves. Your program will use a web <em class="calibre3">application programming interface (API)</em> to automatically request specific information from a website&mdash;rather than entire pages&mdash;and then use that information to generate a visualization. Because programs written like this will always use current data to generate a visualization, even when that data might be rapidly changing, it will always be up to date.</p>
<h3 class="h2" id="calibre_link-1079"><strong class="calibre2">Using a Web API</strong></h3>
<p class="noindent">A web API is a part of a website designed to interact with programs. Those programs use very specific URLs to request certain information. This kind of request is called an <em class="calibre3">API call</em>. The requested data will be returned in an <span type="pagebreak" id="calibre_link-239" class="calibre"></span>easily processed format, such as JSON or CSV. Most apps that rely on external data sources, such as apps that integrate with social media sites, rely on API calls.</p>
<h4 class="h3" id="calibre_link-1080"><strong class="calibre2"><em class="calibre3">Git and GitHub</em></strong></h4>
<p class="noindent">We’ll base our visualization on information from GitHub, a site that allows programmers to collaborate on coding projects. We’ll use GitHub’s API to request information about Python projects on the site, and then generate an interactive visualization of the relative popularity of these projects using Plotly.</p>
<p class="indent">GitHub (<em class="calibre3"><a href="https://github.com/" class="calibre6">https://github.com/</a></em>) takes its name from Git, a distributed version control system. Git helps people manage their work on a project, so changes made by one person won’t interfere with changes other people are making. When you implement a new feature in a project, Git tracks the changes you make to each file. When your new code works, you <em class="calibre3">commit</em> the changes you’ve made, and Git records the new state of your project. If you make a mistake and want to revert your changes, you can easily return to any previously working state. (To learn more about version control using Git, see <a href="#calibre_link-67" class="calibre6">Appendix D</a>.) Projects on GitHub are stored in <em class="calibre3">repositories</em>, which contain everything associated with the project: its code, information on its collaborators, any issues or bug reports, and so on.</p>
<p class="indent">When users on GitHub like a project, they can “star” it to show their support and keep track of projects they might want to use. In this chapter, we’ll write a program to automatically download information about the most-starred Python projects on GitHub, and then we’ll create an informative visualization of these projects.</p>
<h4 class="h3" id="calibre_link-1081"><strong class="calibre2"><em class="calibre3">Requesting Data Using an API Call</em></strong></h4>
<p class="noindent">GitHub’s API lets you request a wide range of information through API calls. To see what an API call looks like, enter the following into your browser’s address bar and press <small class="calibre5">ENTER</small>:</p>
<p class="programs"><span class="codestrong">https://api.github.com/search/repositories?q=language:python&amp;sort=stars</span></p>
<p class="indent">This call returns the number of Python projects currently hosted on GitHub, as well as information about the most popular Python repositories. Let’s examine the call. The first part, <span class="literal">https://api.github.com/</span>, directs the request to the part of GitHub that responds to API calls. The next part, <span class="literal">search/repositories</span>, tells the API to conduct a search through all repositories on GitHub.</p>
<p class="indent">The question mark after <span class="literal">repositories</span> signals that we’re about to pass an argument. The <span class="literal">q</span> stands for <em class="calibre3">query</em>, and the equal sign (<span class="literal">=</span>) lets us begin specifying a query (<span class="literal">q=</span>). By using <span class="literal">language:python</span>, we indicate that we want information only on repositories that have Python as the primary language. The final part, <span class="literal">&amp;sort=stars</span>, sorts the projects by the number of stars they’ve been given.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-237" class="calibre"></span>The following snippet shows the first few lines of the response.</p>
<p class="programs">&nbsp;&nbsp;&nbsp;{<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;"total_count": 3494012,<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;"incomplete_results": false,<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;"items": [<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"id": 21289110,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"node_id": "MDEwOlJlcG9zaXRvcnkyMTI4OTExMA==",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name": "awesome-python",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"full_name": "vinta/awesome-python",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--</p>
<p class="indent">You can see from the response that this URL is not primarily intended to be entered by humans, because it’s in a format that’s meant to be processed by a program. GitHub found 3,494,012 Python projects as of this writing <span class="ent">➊</span>. Because the value for <span class="literal">"incomplete_results"</span> is <span class="literal">false</span>, we know that the request was successful (it’s not incomplete) <span class="ent">➋</span>. If GitHub had been unable to fully process the API request, it would have returned <span class="literal">true</span> here. The <span class="literal">"items"</span> returned are displayed in the list that follows, which contains details about the most popular Python projects on GitHub <span class="ent">➌</span>.</p>
<h4 class="h3" id="calibre_link-1082"><strong class="calibre2"><em class="calibre3">Installing Requests</em></strong></h4>
<p class="noindent">The Requests package allows a Python program to easily request information from a website and examine the response. Use <span class="literal">pip</span> to install Requests:</p>
<p class="programs">$ <span class="codestrong">python -m pip install --user requests</span></p>
<p class="indent">This line tells Python to run the <span class="literal">pip</span> module and install the Requests package to the current user’s Python installation. If you use <span class="codestrong1">python3</span> or a different command when running programs or installing packages, make sure you use the same command here.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If this command doesn’t work on macOS, try running the command again without the <span class="codeitalic">--user</span> flag.</em></p>
</div>
<h4 class="h3" id="calibre_link-1083"><strong class="calibre2"><em class="calibre3">Processing an API Response</em></strong></h4>
<p class="noindent">Now we’ll begin to write a program to automatically issue an API call and process the results by identifying the most starred Python projects on GitHub:</p>
<p class="margin"><em class="calibre3">python_repos.py</em></p>
<p class="programs"><span class="ent">➊</span> import requests<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Make an API call and store the response.<br class="calibre4" />
<span class="ent">➋</span> url = 'https://api.github.com/search/repositories?q=language:python&amp;sort=stars'<br class="calibre4" />
<span class="ent">➌</span> headers = {'Accept': 'application/vnd.github.v3+json'}<br class="calibre4" />
<span class="ent">➍</span> r = requests.get(url, headers=headers)<br class="calibre4" />
<span class="ent">➎</span> print(f"Status code: {r.status_code}")<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1388" class="calibre"></span>&nbsp;&nbsp;&nbsp;# Store API response in a variable.<br class="calibre4" />
<span class="ent">➏</span> response_dict = r.json()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Process results.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(response_dict.keys())</p>
<p class="indent">At <span class="ent">➊</span> we import the <span class="literal">requests</span> module. At <span class="ent">➋</span> we store the URL of the API call in the <span class="literal">url</span> variable. GitHub is currently on the third version of its API, so we define headers for the API call <span class="ent">➌</span> that ask explicitly to use this version of the API. Then we use <span class="literal">requests</span> to make the call to the API <span class="ent">➍</span>.</p>
<p class="indent">We call <span class="literal">get()</span> and pass it the URL and the header that we defined, and we assign the response object to the variable <span class="literal">r</span>. The response object has an attribute called <span class="literal">status_code</span>, which tells us whether the request was successful. (A status code of 200 indicates a successful response.) At <span class="ent">➎</span> we print the value of <span class="literal">status_code</span> so we can make sure the call went through successfully.</p>
<p class="indent">The API returns the information in JSON format, so we use the <span class="literal">json()</span> method to convert the information to a Python dictionary <span class="ent">➏</span>. We store the resulting dictionary in <span class="literal">response_dict</span>.</p>
<p class="indent">Finally, we print the keys from <span class="literal">response_dict</span> and see this output:</p>
<p class="programs">Status code: 200<br class="calibre4" />
dict_keys(['total_count', 'incomplete_results', 'items'])</p>
<p class="indent">Because the status code is 200, we know that the request was successful. The response dictionary contains only three keys: <span class="literal">'total_count'</span>, <span class="literal">'incomplete_results'</span>, and <span class="literal">'items'</span>. Let’s take a look inside the response dictionary.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Simple calls like this should return a complete set of results, so it’s safe to ignore the value associated with <span class="codeitalic">'incomplete_results'</span>. But when you’re making more complex API calls, your program should check this value.</em></p>
</div>
<h4 class="h3" id="calibre_link-1084"><strong class="calibre2"><em class="calibre3">Working with the Response Dictionary</em></strong></h4>
<p class="noindent">With the information from the API call stored as a dictionary, we can work with the data stored there. Let’s generate some output that summarizes the information. This is a good way to make sure we received the information we expected and to start examining the information we’re interested in:</p>
<p class="margin"><em class="calibre3">python_repos.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import requests</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Make an API call and store the response.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Store API response in a variable.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">response_dict = r.json()</span><br class="calibre4" />
<span class="ent">➊</span> print(f"Total repositories: {response_dict['total_count']}")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Explore information about the repositories.<br class="calibre4" />
<span class="ent">➋</span> repo_dicts = response_dict['items']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(f"Repositories returned: {len(repo_dicts)}")<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1389" class="calibre"></span>&nbsp;&nbsp;&nbsp;# Examine the first repository.<br class="calibre4" />
<span class="ent">➌</span> repo_dict = repo_dicts[0]<br class="calibre4" />
<span class="ent">➍</span> print(f"\nKeys: {len(repo_dict)}")<br class="calibre4" />
<span class="ent">➎</span> for key in sorted(repo_dict.keys()):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(key)</p>
<p class="indent">At <span class="ent">➊</span> we print the value associated with <span class="literal">'total_count'</span>, which represents the total number of Python repositories on GitHub.</p>
<p class="indent">The value associated with <span class="literal">'items'</span> is a list containing a number of dictionaries, each of which contains data about an individual Python repository. At <span class="ent">➋</span> we store this list of dictionaries in <span class="literal">repo_dicts</span>. We then print the length of <span class="literal">repo_dicts</span> to see how many repositories we have information for.</p>
<p class="indent">To look closer at the information returned about each repository, we pull out the first item from <span class="literal">repo_dicts</span> and store it in <span class="literal">repo_dict</span> <span class="ent">➌</span>. We then print the number of keys in the dictionary to see how much information we have <span class="ent">➍</span>. At <span class="ent">➎</span> we print all the dictionary’s keys to see what kind of information is included.</p>
<p class="indent">The results give us a clearer picture of the actual data:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;Status code: 200<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Total repositories: 3494030<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Repositories returned: 30<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> Keys: 73<br class="calibre4" />
&nbsp;&nbsp;&nbsp;archive_url<br class="calibre4" />
&nbsp;&nbsp;&nbsp;archived<br class="calibre4" />
&nbsp;&nbsp;&nbsp;assignees_url<br class="calibre4" />
&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
&nbsp;&nbsp;&nbsp;url<br class="calibre4" />
&nbsp;&nbsp;&nbsp;watchers<br class="calibre4" />
&nbsp;&nbsp;&nbsp;watchers_count</p>
<p class="indent">GitHub’s API returns a lot of information about each repository: there are 73 keys in <span class="literal">repo_dict</span> <span class="ent">➊</span>. When you look through these keys, you’ll get a sense of the kind of information you can extract about a project. (The only way to know what information is available through an API is to read the documentation or to examine the information through code, as we’re doing here.)</p>
<p class="indent">Let’s pull out the values for some of the keys in <span class="literal">repo_dict</span>:</p>
<p class="margin"><em class="calibre3">python_repos.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Explore information about the repositories.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">repo_dicts = response_dict['items']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Repositories returned: {len(repo_dicts)}")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Examine the first repository.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">repo_dict = repo_dicts[0]</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print("\nSelected information about first repository:")<br class="calibre4" />
<span class="ent">➊</span> print(f"Name: {repo_dict['name']}")<br class="calibre4" />
<span class="ent">➋</span> print(f"Owner: {repo_dict['owner']['login']}")<br class="calibre4" />
<span class="ent">➌</span> print(f"Stars: {repo_dict['stargazers_count']}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(f"Repository: {repo_dict['html_url']}")<br class="calibre4" />
<span type="pagebreak" id="calibre_link-1390" class="calibre"></span><span class="ent">➍</span> print(f"Created: {repo_dict['created_at']}")<br class="calibre4" />
<span class="ent">➎</span> print(f"Updated: {repo_dict['updated_at']}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(f"Description: {repo_dict['description']}")</p>
<p class="indent">Here, we print the values for a number of keys from the first repository’s dictionary. At <span class="ent">➊</span> we print the name of the project. An entire dictionary represents the project’s owner, so at <span class="ent">➋</span> we use the key <span class="literal">owner</span> to access the dictionary representing the owner, and then use the key <span class="literal">login</span> to get the owner’s login name. At <span class="ent">➌</span> we print how many stars the project has earned and the URL for the project’s GitHub repository. We then show when it was created <span class="ent">➍</span> and when it was last updated <span class="ent">➎</span>. Finally, we print the repository’s description; the output should look something like this:</p>
<p class="programs">Status code: 200<br class="calibre4" />
Total repositories: 3494032<br class="calibre4" />
Repositories returned: 30<br class="calibre4" />
<br class="calibre4" />
Selected information about first repository:<br class="calibre4" />
Name: awesome-python<br class="calibre4" />
Owner: vinta<br class="calibre4" />
Stars: 61549<br class="calibre4" />
Repository: https://github.com/vinta/awesome-python<br class="calibre4" />
Created: 2014-06-27T21:00:06Z<br class="calibre4" />
Updated: 2019-02-17T04:30:00Z<br class="calibre4" />
Description: A curated list of awesome Python frameworks, libraries, software<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;and resources</p>
<p class="indent">We can see that the most-starred Python project on GitHub as of this writing is <em class="calibre3">awesome-python</em>, its owner is user <em class="calibre3">vinta</em>, and it has been starred by more than 60,000 GitHub users. We can see the URL for the project’s repository, its creation date of June 2014, and that it was updated recently. Additionally, the description tells us that awesome-python contains a list of popular Python resources.</p>
<h4 class="h3" id="calibre_link-1085"><strong class="calibre2"><em class="calibre3">Summarizing the Top Repositories</em></strong></h4>
<p class="noindent">When we make a visualization for this data, we’ll want to include more than one repository. Let’s write a loop to print selected information about each repository the API call returns so we can include them all in the visualization:</p>
<p class="margin"><em class="calibre3">python_repos.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Explore information about the repositories.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">repo_dicts = response_dict['items']</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Repositories returned: {len(repo_dicts)}")</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> print("\nSelected information about each repository:")<br class="calibre4" />
<span class="ent">➋</span> for repo_dict in repo_dicts:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"\nName: {repo_dict['name']}")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Owner: {repo_dict['owner']['login']}")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Stars: {repo_dict['stargazers_count']}")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Repository: {repo_dict['html_url']}")</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Description: {repo_dict['description']}")</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-238" class="calibre"></span>We print an introductory message at <span class="ent">➊</span>. At <span class="ent">➋</span> we loop through all the dictionaries in <span class="literal">repo_dicts</span>. Inside the loop, we print the name of each project, its owner, how many stars it has, its URL on GitHub, and the project’s description, as shown here:</p>
<p class="programs">Status code: 200<br class="calibre4" />
Total repositories: 3494040<br class="calibre4" />
Repositories returned: 30<br class="calibre4" />
<br class="calibre4" />
Selected information about each repository:<br class="calibre4" />
<br class="calibre4" />
Name: awesome-python<br class="calibre4" />
Owner: vinta<br class="calibre4" />
Stars: 61549<br class="calibre4" />
Repository: https://github.com/vinta/awesome-python<br class="calibre4" />
Description: A curated list of awesome Python frameworks, libraries, software<br class="calibre4" />
&nbsp;&nbsp;and resources<br class="calibre4" />
<br class="calibre4" />
Name: system-design-primer<br class="calibre4" />
Owner: donnemartin<br class="calibre4" />
Stars: 57256<br class="calibre4" />
Repository: https://github.com/donnemartin/system-design-primer<br class="calibre4" />
Description: Learn how to design large-scale systems. Prep for the system<br class="calibre4" />
&nbsp;&nbsp;design interview.&nbsp;&nbsp;Includes Anki flashcards.<br class="calibre4" />
--<span class="codeitalic1">snip</span>--<br class="calibre4" />
<br class="calibre4" />
Name: python-patterns<br class="calibre4" />
Owner: faif<br class="calibre4" />
Stars: 19058<br class="calibre4" />
Repository: https://github.com/faif/python-patterns<br class="calibre4" />
Description: A collection of design patterns/idioms in Python</p>
<p class="indent">Some interesting projects appear in these results, and it might be worth looking at a few. But don’t spend too much time, because shortly we’ll create a visualization that will make the results much easier to read.</p>
<h4 class="h3" id="calibre_link-1086"><strong class="calibre2"><em class="calibre3">Monitoring API Rate Limits</em></strong></h4>
<p class="noindent">Most APIs are rate limited, which means there’s a limit to how many requests you can make in a certain amount of time. To see if you’re approaching GitHub’s limits, enter <em class="calibre3"><a href="https://api.github.com/rate_limit" class="calibre6">https://api.github.com/rate_limit</a></em> into a web browser. You should see a response that begins like this:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"resources": {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"core": {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"limit": 60,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remaining": 58,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"reset": 1550385312<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"search": {<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"limit": 10,<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"remaining": 8,<br class="calibre4" />
<span type="pagebreak" id="calibre_link-240" class="calibre"></span><span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"reset": 1550381772<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--</p>
<p class="indent">The information we’re interested in is the rate limit for the search API <span class="ent">➊</span>. We see at <span class="ent">➋</span> that the limit is 10 requests per minute and that we have 8 requests remaining for the current minute <span class="ent">➌</span>. The reset value represents the time in <em class="calibre3">Unix</em> or <em class="calibre3">epoch time</em> (the number of seconds since midnight on January 1, 1970) when our quota will reset <span class="ent">➍</span>. If you reach your quota, you’ll get a short response that lets you know you’ve reached the API limit. If you reach the limit, just wait until your quota resets.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Many APIs require you to register and obtain an API key to make API calls. As of this writing, GitHub has no such requirement, but if you obtain an API key, your limits will be much higher.</em></p>
</div>
<h3 class="h2" id="calibre_link-1087"><strong class="calibre2">Visualizing Repositories Using Plotly</strong></h3>
<p class="noindent">Let’s make a visualization using the data we have now to show the relative popularity of Python projects on GitHub. We’ll make an interactive bar chart: the height of each bar will represent the number of stars the project has acquired, and you can click the bar’s label to go to that project’s home on GitHub. Save a copy of the program we’ve been working on as <em class="calibre3">python_repos_visual.py</em>, and then modify it so it reads as follows:</p>
<p class="margin"><em class="calibre3">python_repos_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">import requests</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> from plotly.graph_objs import Bar<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from plotly import offline<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> <span class="ash"># Make an API call and store the response.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">url = 'https://api.github.com/search/repositories?q=language:python&amp;sort=stars'</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">headers = {'Accept': 'application/vnd.github.v3+json'}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">r = requests.get(url, headers=headers)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">print(f"Status code: {r.status_code}")</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Process results.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">response_dict = r.json()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">repo_dicts = response_dict['items']</span><br class="calibre4" />
<span class="ent">➌</span> repo_names, stars = [], []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for repo_dict in repo_dicts:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repo_names.append(repo_dict['name'])<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stars.append(repo_dict['stargazers_count'])<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Make visualization.<br class="calibre4" />
<span class="ent">➍</span> data = [{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'type': 'bar',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'x': repo_names,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'y': stars,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;}]<br class="calibre4" />
<span type="pagebreak" id="calibre_link-520" class="calibre"></span><span class="ent">➎</span> my_layout = {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'title': 'Most-Starred Python Projects on GitHub',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'xaxis': {'title': 'Repository'},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'yaxis': {'title': 'Stars'},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;fig = {'data': data, 'layout': my_layout}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;offline.plot(fig, filename='python_repos.html')</p>
<p class="indent">We import the <span class="literal">Bar</span> class and the <span class="literal">offline</span> module from <span class="literal">plotly</span> <span class="ent">➊</span>. We don’t need to import the <span class="literal">Layout</span> class because we’ll use the dictionary approach to define the layout, just as we did for the <span class="literal">data</span> list in the earthquake mapping project in <a href="#calibre_link-15" class="calibre6">Chapter 16</a>. We continue to print the status of the API call response so we’ll know if there is a problem <span class="ent">➋</span>. We also remove some of the code that processes the API response, because we’re no longer in the exploratory phase; we know we have the data we want.</p>
<p class="indent">We then create two empty lists <span class="ent">➌</span> to store the data we’ll include in the initial chart. We’ll need the name of each project to label the bars, and the number of stars to determine the height of the bars. In the loop, we append the name of each project and the number of stars it has to these lists.</p>
<p class="indent">Next, we define the <span class="literal">data</span> list <span class="ent">➍</span>. This contains a dictionary, like we used in <a href="#calibre_link-15" class="calibre6">Chapter 16</a>, which defines the type of the plot and provides the data for the x- and y-values. The x-values are the names of the projects, and the y-values are the number of stars each project has been given.</p>
<p class="indent">At <span class="ent">➎</span> we define the layout for this chart using the dictionary approach. Instead of making an instance of the <span class="literal">Layout</span> class, we build a dictionary with the layout specifications we want to use. We set a title for the overall chart, and we define a label for each axis.</p>
<p class="indent"><a href="#calibre_link-68" class="calibre6">Figure 17-1</a> shows the resulting chart. We can see that the first few projects are significantly more popular than the rest, but all of them are important projects in the Python ecosystem.</p>
<div class="image1"><a id="calibre_link-68" class="calibre6"></a><img src="images/000066.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 17-1: The most-starred Python projects on GitHub</em></p>
<h4 class="h3" id="calibre_link-1088"><span type="pagebreak" id="calibre_link-517" class="calibre"></span><strong class="calibre2"><em class="calibre3">Refining Plotly Charts</em></strong></h4>
<p class="noindent">Let’s refine the chart’s styling. As you saw in <a href="#calibre_link-15" class="calibre6">Chapter 16</a>, you can include all the styling directives as key-value pairs in the <span class="literal">data</span> and <span class="literal">my_layout</span> dictionaries.</p>
<p class="indent">Changes to the <span class="literal">data</span> object affect the bars. Here’s a modified version of the <span class="literal">data</span> object for our chart that gives us a specific color and a clear border for each bar:</p>
<p class="margin"><em class="calibre3">python_repos_visual.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">data = [{</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'type': 'bar',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'x': repo_names,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'y': stars,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'marker': {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'color': 'rgb(60, 100, 150)',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'line': {'width': 1.5, 'color': 'rgb(25, 25, 25)'}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'opacity': 0.6,<br class="calibre4" />
<span class="ash">}]</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">The <span class="literal">marker</span> settings shown here affect the design of the bars. We set a custom blue color for the bars and specify that they’ll be outlined with a dark gray line that’s 1.5 pixels wide. We also set the opacity of the bars to 0.6 to soften the appearance of the chart a little.</p>
<p class="indent">Next, we’ll modify <span class="literal">my_layout</span>:</p>
<p class="margin"><em class="calibre3">python_repos_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">my_layout = {</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'title': 'Most-Starred Python Projects on GitHub',</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'titlefont': {'size': 28},<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'xaxis': {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'title': 'Repository',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'titlefont': {'size': 24},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'tickfont': {'size': 14},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'yaxis': {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'title': 'Stars',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'titlefont': {'size': 24},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'tickfont': {'size': 14},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We use the <span class="literal">'titlefont'</span> key to define the font size of the overall chart title <span class="ent">➊</span>. Within the <span class="literal">'xaxis'</span> dictionary, we add settings to control the font size of the x-axis title (<span class="literal">'titlefont'</span>) and also of the tick labels (<span class="literal">'tickfont'</span>) <span class="ent">➋</span>. Because these are individual nested dictionaries, you can include keys for the color and font family of the axis titles and tick labels. At <span class="ent">➌</span> we define similar settings for the y-axis.</p>
<p class="indent"><a href="#calibre_link-69" class="calibre6">Figure 17-2</a> shows the restyled chart.</p>
<div class="image1"><span type="pagebreak" id="calibre_link-518" class="calibre"></span><a id="calibre_link-69" class="calibre6"></a><img src="images/000003.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 17-2: The styling for the chart has been refined.</em></p>
<h4 class="h3" id="calibre_link-1089"><strong class="calibre2"><em class="calibre3">Adding Custom Tooltips</em></strong></h4>
<p class="noindent">In Plotly, you can hover the cursor over an individual bar to show the information that the bar represents. This is commonly called a <em class="calibre3">tooltip</em>, and in this case, it currently shows the number of stars a project has. Let’s create a custom tooltip to show each project’s description as well as the project’s owner.</p>
<p class="indent">We need to pull some additional data to generate the tooltips and modify the <span class="literal">data</span> object:</p>
<p class="margin"><em class="calibre3">python_repos_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Process results.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">response_dict = r.json()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">repo_dicts = response_dict['items']</span><br class="calibre4" />
<span class="ent">➊</span> repo_names, stars, labels = [], [], []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for repo_dict in repo_dicts:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">repo_names.append(repo_dict['name'])</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">stars.append(repo_dict['stargazers_count'])</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owner = repo_dict['owner']['login']<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description = repo_dict['description']<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label = f"{owner}&lt;br /&gt;{description}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labels.append(label)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Make visualization.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">data = [{</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'type': 'bar',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'x': repo_names,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'y': stars,</span><br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'hovertext': labels,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'marker': {</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-519" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'color': 'rgb(60, 100, 150)',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'line': {'width': 1.5, 'color': 'rgb(25, 25, 25)'}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">},</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'opacity': 0.6,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">}]</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We first define a new empty list, <span class="literal">labels</span>, to hold the text we want to display for each project <span class="ent">➊</span>. In the loop where we process the data, we pull the owner and the description for each project <span class="ent">➋</span>. Plotly allows you to use HTML code within text elements, so we generate a string for the label with a line break (<span class="literal">&lt;br /&gt;</span>) between the project owner’s username and the description <span class="ent">➌</span>. We then store this label in the list <span class="literal">labels</span>.</p>
<p class="indent">In the <span class="literal">data</span> dictionary, we add an entry with the key <span class="literal">'hovertext'</span> and assign it the list we just created <span class="ent">➍</span>. As Plotly creates each bar, it will pull labels from this list and only display them when the viewer hovers over a bar.</p>
<p class="indent"><a href="#calibre_link-70" class="calibre6">Figure 17-3</a> shows the resulting chart.</p>
<div class="image1"><a id="calibre_link-70" class="calibre6"></a><img src="images/000008.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 17-3: Hovering over a bar shows the project’s owner and description.</em></p>
<h4 class="h3" id="calibre_link-1090"><strong class="calibre2"><em class="calibre3">Adding Clickable Links to Our Graph</em></strong></h4>
<p class="noindent">Because Plotly allows you to use HTML on text elements, we can easily add links to a chart. Let’s use the x-axis labels as a way to let the viewer visit any project’s home page on GitHub. We need to pull the URLs from the data and use them when generating the x-axis labels:</p>
<p class="margin"><em class="calibre3">python_repos_visual.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Process results.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">response_dict = r.json()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">repo_dicts = response_dict['items']</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-234" class="calibre"></span><span class="ent">➊</span> repo_links, stars, labels = [], [], []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">for repo_dict in repo_dicts:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repo_name = repo_dict['name']<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repo_url = repo_dict['html_url']<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repo_link = f"&lt;a href='{repo_url}'&gt;{repo_name}&lt;/a&gt;"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repo_links.append(repo_link)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">stars.append(repo_dict['stargazers_count'])</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash"># Make visualization.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">data = [{</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'type': 'bar',</span><br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'x': repo_links,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'y': stars,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">}]</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We update the name of the list we’re creating from <span class="literal">repo_names</span> to <span class="literal">repo_links</span> to more accurately communicate the kind of information we’re putting together for the chart <span class="ent">➊</span>. We then pull the URL for the project from <span class="literal">repo_dict</span> and assign it to the temporary variable <span class="literal">repo_url</span> <span class="ent">➋</span>. At <span class="ent">➌</span> we generate a link to the project. We use the HTML anchor tag, which has the form <span class="literal">&lt;a href='URL'&gt;link text&lt;/a&gt;</span>, to generate the link. We then append this link to the list <span class="literal">repo_links</span>.</p>
<p class="indent">At <span class="ent">➍</span> we use this list for the x-values in the chart. The result looks the same as before, but now the viewer can click any of the project names at the bottom of the chart to visit that project’s home page on GitHub. Now we have an interactive, informative visualization of data retrieved through an API!</p>
<h4 class="h3" id="calibre_link-1091"><strong class="calibre2"><em class="calibre3">More About Plotly and the GitHub API</em></strong></h4>
<p class="noindent">To read more about working with Plotly charts, there are two good places to start. You can find the <em class="calibre3">Plotly User Guide in Python</em> at <em class="calibre3"><a href="https://plot.ly/python/user-guide/" class="calibre6">https://plot.ly/python/user-guide/</a></em>. This resource gives you a better understanding of how Plotly uses your data to construct a visualization and why it approaches defining data visualizations in this way.</p>
<p class="indent">The <em class="calibre3">python figure reference</em> at <em class="calibre3"><a href="https://plot.ly/python/reference/" class="calibre6">https://plot.ly/python/reference/</a></em> lists all the settings you can use to configure Plotly visualizations. All the possible chart types are listed as well as all the attributes you can set for every configuration option.</p>
<p class="indent">For more about the GitHub API, refer to its documentation at <em class="calibre3"><a href="https://developer.github.com/v3/" class="calibre6">https://developer.github.com/v3/</a></em>. Here you’ll learn how to pull a wide variety of specific information from GitHub. If you have a GitHub account, you can work with your own data as well as the publicly available data for other users’ repositories.</p>
<h3 class="h2" id="calibre_link-1092"><span type="pagebreak" id="calibre_link-235" class="calibre"></span><strong class="calibre2">The Hacker News API</strong></h3>
<p class="noindent">To explore how to use API calls on other sites, let’s take a quick look at Hacker News (<em class="calibre3"><a href="http://news.ycombinator.com/" class="calibre6">http://news.ycombinator.com/</a></em>). On Hacker News, people share articles about programming and technology, and engage in lively discussions about those articles. The Hacker News API provides access to data about all submissions and comments on the site, and you can use the API without having to register for a key.</p>
<p class="indent">The following call returns information about the current top article as of this writing:</p>
<p class="programs">https://hacker-news.firebaseio.com/v0/item/19155826.json</p>
<p class="indent">When you enter this URL in a browser, you’ll see that the text on the page is enclosed by braces, meaning it’s a dictionary. But the response is difficult to examine without some better formatting. Let’s run this URL through the <span class="literal">json.dump()</span> method, like we did in the earthquake project in <a href="#calibre_link-15" class="calibre6">Chapter 16</a>, so we can explore the kind of information that’s returned about an article:</p>
<p class="margin"><em class="calibre3">hn_article.py</em></p>
<p class="programs">import requests<br class="calibre4" />
import json<br class="calibre4" />
<br class="calibre4" />
# Make an API call, and store the response.<br class="calibre4" />
url = 'https://hacker-news.firebaseio.com/v0/item/19155826.json'<br class="calibre4" />
r = requests.get(url)<br class="calibre4" />
print(f"Status code: {r.status_code}")<br class="calibre4" />
<br class="calibre4" />
# Explore the structure of the data.<br class="calibre4" />
response_dict = r.json()<br class="calibre4" />
readable_file = 'data/readable_hn_data.json'<br class="calibre4" />
with open(readable_file, 'w') as f:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;json.dump(response_dict, f, indent=4)</p>
<p class="indent">Everything in this program should look familiar, because we’ve used it all in the previous two chapters. The output is a dictionary of information about the article with the ID 19155826:</p>
<p class="margin"><em class="calibre3">readable_hn_data.json</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"by": "jimktrains2",<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"descendants": 220,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"id": 19155826,<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"kids": [<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19156572,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19158857,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"score": 722,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"time": 1550085414,<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"title": "Nasa's Mars Rover Opportunity Concludes a 15-Year Mission",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "story",<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"url": "https://www.nytimes.com/.../mars-opportunity-rover-dead.html"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;}</p>
<p class="indent"><span type="pagebreak" id="calibre_link-438" class="calibre"></span>The dictionary contains a number of keys we can work with. The key <span class="literal">'descendants'</span> tells us the number of comments the article has received <span class="ent">➊</span>. The key <span class="literal">'kids'</span> provides the IDs of all comments made directly in response to this submission <span class="ent">➋</span>. Each of these comments might have comments of their own as well, so the number of descendants a submission has is usually greater than its number of kids. We can see the title of the article being discussed <span class="ent">➌</span>, and a URL for the article that’s being discussed as well <span class="ent">➍</span>.</p>
<p class="indent">The following URL returns a simple list of all the IDs of the current top articles on Hacker News:</p>
<p class="programs">https://hacker-news.firebaseio.com/v0/topstories.json</p>
<p class="indent">We can use this call to find out which articles are on the home page right now, and then generate a series of API calls similar to the one we just examined. With this approach, we can print a summary of all the articles on the front page of Hacker News at the moment:</p>
<p class="margin"><em class="calibre3">hn_submissions.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;from operator import itemgetter<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;import requests<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Make an API call and store the response.<br class="calibre4" />
<span class="ent">➊</span> url = 'https://hacker-news.firebaseio.com/v0/topstories.json'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;r = requests.get(url)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;print(f"Status code: {r.status_code}")<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Process information about each submission.<br class="calibre4" />
<span class="ent">➋</span> submission_ids = r.json()<br class="calibre4" />
<span class="ent">➌</span> submission_dicts = []<br class="calibre4" />
&nbsp;&nbsp;&nbsp;for submission_id in submission_ids[:30]:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make a separate API call for each submission.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url = f"https://hacker-news.firebaseio.com/v0/item/{submission_id}.json"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = requests.get(url)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"id: {submission_id}\tstatus: {r.status_code}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response_dict = r.json()<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Build a dictionary for each article.<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submission_dict = {<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'title': response_dict['title'],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'hn_link': f"http://news.ycombinator.com/item?id={submission_id}",<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'comments': response_dict['descendants'],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submission_dicts.append(submission_dict)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➐</span> submission_dicts = sorted(submission_dicts, key=itemgetter('comments'),<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reverse=True)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➑</span> for submission_dict in submission_dicts:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"\nTitle: {submission_dict['title']}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Discussion link: {submission_dict['hn_link']}")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Comments: {submission_dict['comments']}")</p>
<p class="indent"><span type="pagebreak" id="calibre_link-302" class="calibre"></span>First, we make an API call, and then print the status of the response <span class="ent">➊</span>. This API call returns a list containing the IDs of up to the 500 most popular articles on Hacker News at the time the call is issued. We then convert the response object to a Python list at <span class="ent">➋</span>, which we store in <span class="literal">submission_ids</span>. We’ll use these IDs to build a set of dictionaries that each store information about one of the current submissions.</p>
<p class="indent">We set up an empty list called <span class="literal">submission_dicts</span> at <span class="ent">➌</span> to store these dictionaries. We then loop through the IDs of the top 30 submissions. We make a new API call for each submission by generating a URL that includes the current value of <span class="literal">submission_id</span> <span class="ent">➍</span>. We print the status of each request along with its ID, so we can see whether it’s successful.</p>
<p class="indent">At <span class="ent">➎</span> we create a dictionary for the submission currently being processed, where we store the title of the submission, a link to the discussion page for that item, and the number of comments the article has received so far. Then we append each <span class="literal">submission_dict</span> to the list <span class="literal">submission_dicts</span> <span class="ent">➏</span>.</p>
<p class="indent">Each submission on Hacker News is ranked according to an overall score based on a number of factors including how many times it’s been voted up, how many comments it’s received, and how recent the submission is. We want to sort the list of dictionaries by the number of comments. To do this, we use a function called <span class="literal">itemgetter()</span> <span class="ent">➐</span>, which comes from the <span class="literal">operator</span> module. We pass this function the key <span class="literal">'comments'</span>, and it pulls the value associated with that key from each dictionary in the list. The <span class="literal">sorted()</span> function then uses this value as its basis for sorting the list. We sort the list in reverse order to place the most-commented stories first.</p>
<p class="indent">Once the list is sorted, we loop through the list at <span class="ent">➑</span> and print out three pieces of information about each of the top submissions: the title, a link to the discussion page, and the number of comments the submission currently has:</p>
<p class="programs">Status code: 200<br class="calibre4" />
id: 19155826&nbsp;&nbsp;&nbsp;&nbsp;status: 200<br class="calibre4" />
id: 19180181&nbsp;&nbsp;&nbsp;&nbsp;status: 200<br class="calibre4" />
id: 19181473&nbsp;&nbsp;&nbsp;&nbsp;status: 200<br class="calibre4" />
--<span class="codeitalic1">snip</span>--<br class="calibre4" />
<br class="calibre4" />
Title: Nasa's Mars Rover Opportunity Concludes a 15-Year Mission<br class="calibre4" />
Discussion link: http://news.ycombinator.com/item?id=19155826<br class="calibre4" />
Comments: 220<br class="calibre4" />
<br class="calibre4" />
Title: Ask HN: Is it practical to create a software-controlled model rocket?<br class="calibre4" />
Discussion link: http://news.ycombinator.com/item?id=19180181<br class="calibre4" />
Comments: 72<br class="calibre4" />
<br class="calibre4" />
Title: Making My Own USB Keyboard from Scratch<br class="calibre4" />
Discussion link: http://news.ycombinator.com/item?id=19181473<br class="calibre4" />
Comments: 62<br class="calibre4" />
--<span class="codeitalic1">snip</span>--</p>
<p class="indent"><span type="pagebreak" id="calibre_link-236" class="calibre"></span>You would use a similar process to access and analyze information with any API. With this data, you could make a visualization showing which submissions have inspired the most active recent discussions. This is also the basis for apps that provide a customized reading experience for sites like Hacker News. To learn more about what kind of information you can access through the Hacker News API, visit the documentation page at <em class="calibre3"><a href="https://github.com/HackerNews/API/" class="calibre6">https://github.com/HackerNews/API/</a></em>.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1093"><strong class="calibre2">17-1. Other Languages:</strong> Modify the API call in <em class="calibre3">python_repos.py</em> so it generates a chart showing the most popular projects in other languages. Try languages such as <em class="calibre3">JavaScript</em>, <em class="calibre3">Ruby</em>, <em class="calibre3">C</em>, <em class="calibre3">Java</em>, <em class="calibre3">Perl</em>, <em class="calibre3">Haskell</em>, and <em class="calibre3">Go</em>.</p>
<p class="sparal" id="calibre_link-1094"><strong class="calibre2">17-2. Active Discussions:</strong> Using the data from <em class="calibre3">hn_submissions.py</em>, make a bar chart showing the most active discussions currently happening on Hacker News. The height of each bar should correspond to the number of comments each submission has. The label for each bar should include the submission’s title and should act as a link to the discussion page for that submission.</p>
<p class="sparal" id="calibre_link-1095"><strong class="calibre2">17-3. Testing python_repos.py:</strong> In <em class="calibre3">python_repos.py</em>, we printed the value of <span class="literal1">status_code</span> to make sure the API call was successful. Write a program called <em class="calibre3">test_python_repos.py</em> that uses <span class="literal1">unittest</span> to assert that the value of <span class="literal1">status_code</span> is 200. Figure out some other assertions you can make&mdash;for example, that the number of items returned is expected and that the total number of repositories is greater than a certain amount.</p>
<p class="sparal" id="calibre_link-1096"><strong class="calibre2">17-4. Further Exploration:</strong> Visit the documentation for Plotly and either the GitHub API or the Hacker News API. Use some of the information you find there to either customize the style of the plots we’ve already made or pull some different information and create your own visualizations.</p>
</div>
<h3 class="h2" id="calibre_link-1097"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned how to use APIs to write self-contained programs that automatically gather the data they need and use that data to create a visualization. You used the GitHub API to explore the most-starred Python projects on GitHub, and you also looked briefly at the Hacker News API. You learned how to use the Requests package to automatically issue an API call to GitHub and how to process the results of that call. Some Plotly settings were also introduced that further customize the appearance of the charts you generate.</p>
<p class="indent">In the next chapter, you’ll use Django to build a web application as your final project.<span type="pagebreak" id="calibre_link-1391" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-30">
<h1 class="h1" id="calibre_link-157"><span type="pagebreak" id="calibre_link-1392" class="calibre"></span><strong class="calibre2">PROJECT 3<br class="calibre4" /><span class="f">WEB APPLICATIONS</span></strong><span type="pagebreak" id="calibre_link-1393" class="calibre"></span></h1>
</div>


<div class="calibre1" id="calibre_link-45">
<h2 class="h" id="calibre_link-17"><span type="pagebreak" id="calibre_link-312" class="calibre"></span><strong class="calibre2"><span class="big">18</span><br class="calibre4" />GETTING STARTED WITH DJANGO</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Behind the scenes, today’s websites are rich applications that act like fully developed desktop applications. Python has a great set of tools called Django for building web applications. Django is a <em class="calibre3">web framework</em>&mdash;a set of tools designed to help you build interactive websites. In this chapter, you’ll learn how to use Django (<em class="calibre3"><a href="https://djangoproject.com/" class="calibre6">https://djangoproject.com/</a></em>) to build a project called Learning Log&mdash;an online journal system that lets you keep track of information you’ve learned about particular topics.</p>
<p class="indent">We’ll write a specification for this project, and then we’ll define models for the data the app will work with. We’ll use Django’s admin system to enter some initial data, and then you’ll learn to write views and templates so Django can build the site’s pages.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-465" class="calibre"></span>Django can respond to page requests and make it easier to read and write to a database, manage users, and much more. In <a href="#calibre_link-18" class="calibre6">Chapters 19</a> and <a href="#calibre_link-19" class="calibre6">20</a>, you’ll refine the Learning Log project and then deploy it to a live server so you (and your friends) can use it.</p>
<h3 class="h2" id="calibre_link-1098"><strong class="calibre2">Setting Up a Project</strong></h3>
<p class="noindent">When beginning a project, you first need to describe the project in a specification, or <em class="calibre3">spec.</em> Then you’ll set up a virtual environment in which to build the project.</p>
<h4 class="h3" id="calibre_link-1099"><strong class="calibre2"><em class="calibre3">Writing a Spec</em></strong></h4>
<p class="noindent">A full spec details the project goals, describes the project’s functionality, and discusses its appearance and user interface. Like any good project or business plan, a spec should keep you focused and help keep your project on track. We won’t write a full project spec here, but we’ll lay out a few clear goals to keep the development process focused. Here’s the spec we’ll use:</p>
<p class="quote">We’ll write a web app called Learning Log that allows users to log the topics they’re interested in and to make journal entries as they learn about each topic. The Learning Log home page will describe the site and invite users to either register or log in. Once logged in, a user can create new topics, add new entries, and read and edit existing entries.</p>
<p class="indent">When you learn about a new topic, keeping a journal of what you’ve learned can be helpful in tracking and revisiting information. A good app makes this process efficient.</p>
<h4 class="h3" id="calibre_link-1100"><strong class="calibre2"><em class="calibre3">Creating a Virtual Environment</em></strong></h4>
<p class="noindent">To work with Django, we’ll first set up a virtual environment. A <em class="calibre3">virtual environment</em> is a place on your system where you can install packages and isolate them from all other Python packages. Separating one project’s libraries from other projects is beneficial and will be necessary when we deploy Learning Log to a server in <a href="#calibre_link-19" class="calibre6">Chapter 20</a>.</p>
<p class="indent">Create a new directory for your project called <em class="calibre3">learning_log</em>, switch to that directory in a terminal, and enter the following code to create a virtual environment:</p>
<p class="programs">learning_log$ <span class="codestrong">python -m venv ll_env</span><br class="calibre4" />
learning_log$</p>
<p class="indent">Here we’re running the <span class="literal">venv</span> virtual environment module and using it to create a virtual environment named <em class="calibre3">ll_env</em> (note that this is <em class="calibre3">ll_env</em> with two lowercase <em class="calibre3">L</em>s, not two ones). If you use a command such as <span class="codestrong1">python3</span> when running programs or installing packages, make sure to use that command here.</p>
<h4 class="h3" id="calibre_link-1101"><span type="pagebreak" id="calibre_link-329" class="calibre"></span><strong class="calibre2"><em class="calibre3">Activating the Virtual Environment</em></strong></h4>
<p class="noindent">Now we need to activate the virtual environment using the following command:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;learning_log$ <span class="codestrong">source ll_env/bin/activate</span><br class="calibre4" />
<span class="ent">➊</span> (ll_env)learning_log$</p>
<p class="indent">This command runs the script <em class="calibre3">activate</em> in <em class="calibre3">ll_env/bin</em>. When the environment is active, you’ll see the name of the environment in parentheses, as shown at <span class="ent">➊</span>; then you can install packages to the environment and use packages that have already been installed. Packages you install in <em class="calibre3">ll_env</em> will be available only while the environment is active.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you’re using Windows, use the command <span class="codeitalic">ll_env\Scripts\activate</span> (without the word <span class="codeitalic">source</span>) to activate the virtual environment. If you’re using PowerShell, you might need to capitalize <span class="codeitalic">Activate</span>.</em></p>
</div>
<p class="indent">To stop using a virtual environment, enter <span class="codestrong1">deactivate</span>:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">deactivate</span><br class="calibre4" />
learning_log$</p>
<p class="indent">The environment will also become inactive when you close the terminal it’s running in.</p>
<h4 class="h3" id="calibre_link-1102"><strong class="calibre2"><em class="calibre3">Installing Django</em></strong></h4>
<p class="noindent">Once the virtual environment is activated, enter the following to install Django:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">pip install django</span><br class="calibre4" />
Collecting django<br class="calibre4" />
--<span class="codeitalic1">snip</span>--<br class="calibre4" />
Installing collected packages: pytz, django<br class="calibre4" />
Successfully installed django-2.2.0 pytz-2018.9 sqlparse-0.2.4<br class="calibre4" />
(ll_env)learning_log$</p>
<p class="indent">Because we’re working in a virtual environment, which is its own self-contained environment, this command is the same on all systems. There’s no need to use the <span class="literal">--user</span> flag, and there’s no need to use longer commands, such as <span class="literal">python -m pip install</span> <span class="codeitalic">package_name</span>.</p>
<p class="indent">Keep in mind that Django will be available only when the <em class="calibre3">ll_env</em> environment is active.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Django releases a new version about every eight months, so you may see a newer version when you install Django. This project will most likely work as it’s written here, even on newer versions of Django. If you want to make sure to use the same version of Django you see here, use the command <span class="codeitalic">pip install django==2.2.*</span>. This will install the latest release of Django 2.2. If you have any issues related to the version you’re using, see the online resources for the book at</em> <a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a>.</p>
</div>
<h4 class="h3" id="calibre_link-1103"><span type="pagebreak" id="calibre_link-328" class="calibre"></span><strong class="calibre2"><em class="calibre3">Creating a Project in Django</em></strong></h4>
<p class="noindent">Without leaving the active virtual environment (remember to look for <em class="calibre3">ll_env</em> in parentheses in the terminal prompt), enter the following commands to create a new project:</p>
<p class="programs"><span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">django-admin startproject learning_log .</span><br class="calibre4" />
<span class="ent">➋</span> (ll_env)learning_log$ <span class="codestrong">ls</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;learning_log ll_env manage.py<br class="calibre4" />
<span class="ent">➌</span> (ll_env)learning_log$ <span class="codestrong">ls learning_log</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;__init__.py&nbsp;&nbsp;settings.py&nbsp;&nbsp;urls.py&nbsp;&nbsp;wsgi.py</p>
<p class="indent">The command at <span class="ent">➊</span> tells Django to set up a new project called <em class="calibre3">learning_log</em>. The dot at the end of the command creates the new project with a directory structure that will make it easy to deploy the app to a server when we’re finished developing it.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Don’t forget this dot, or you might run into some configuration issues when you deploy the app. If you forget the dot, delete the files and folders that were created (except</em> ll_env<em class="calibre3">), and run the command again.</em></p>
</div>
<p class="indent">Running the <span class="literal">ls</span> command (<span class="literal">dir</span> on Windows) <span class="ent">➋</span> shows that Django has created a new directory called <em class="calibre3">learning_log</em>. It also created a <em class="calibre3">manage.py</em> file, which is a short program that takes in commands and feeds them to the relevant part of Django to run them. We’ll use these commands to manage tasks, such as working with databases and running servers.</p>
<p class="indent">The <em class="calibre3">learning_log</em> directory contains four files <span class="ent">➌</span>; the most important are <em class="calibre3">settings.py</em>, <em class="calibre3">urls.py</em>, and <em class="calibre3">wsgi.py</em>. The <em class="calibre3">settings.py</em> file controls how Django interacts with your system and manages your project. We’ll modify a few of these settings and add some settings of our own as the project evolves. The <em class="calibre3">urls.py</em> file tells Django which pages to build in response to browser requests. The <em class="calibre3">wsgi.py</em> file helps Django serve the files it creates. The filename is an acronym for <em class="calibre3">web server gateway interface</em>.</p>
<h4 class="h3" id="calibre_link-1104"><strong class="calibre2"><em class="calibre3">Creating the Database</em></strong></h4>
<p class="noindent">Django stores most of the information for a project in a database, so next we need to create a database that Django can work with. Enter the following command (still in an active environment):</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py migrate</span><br class="calibre4" />
<span class="ent">➊</span> Operations to perform:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apply all migrations: admin, auth, contenttypes, sessions<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Running migrations:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applying contenttypes.0001_initial... OK<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applying auth.0001_initial... OK<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applying sessions.0001_initial... OK<br class="calibre4" />
<span class="ent">➋</span> (ll_env)learning_log$ <span class="codestrong">ls</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;db.sqlite3&nbsp;&nbsp;learning_log&nbsp;&nbsp;ll_env&nbsp;&nbsp;manage.py</p>
<p class="indent"><span type="pagebreak" id="calibre_link-326" class="calibre"></span>Any time we modify a database, we say we’re <em class="calibre3">migrating</em> the database. Issuing the <span class="literal">migrate</span> command for the first time tells Django to make sure the database matches the current state of the project. The first time we run this command in a new project using SQLite (more about SQLite in a moment), Django will create a new database for us. At <span class="ent">➊</span>, Django reports that it will prepare the database to store information it needs to handle administrative and authentication tasks.</p>
<p class="indent">Running the <span class="literal">ls</span> command shows that Django created another file called <em class="calibre3">db.sqlite3</em> <span class="ent">➋</span>. SQLite is a database that runs off a single file; it’s ideal for writing simple apps because you won’t have to pay much attention to managing the database.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">In an active virtual environment, use the command <span class="codeitalic">python</span> to run <span class="codeitalic">manage.py</span> commands, even if you use something different, like <span class="codeitalic">python3</span>, to run other programs. In a virtual environment, the command <span class="codeitalic">python</span> refers to the version of Python that created the virtual environment.</em></p>
</div>
<h4 class="h3" id="calibre_link-1105"><strong class="calibre2"><em class="calibre3">Viewing the Project</em></strong></h4>
<p class="noindent">Let’s make sure that Django has set up the project properly. Enter the <span class="literal">runserver</span> command as follows to view the project in its current state:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py runserver</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Watchman unavailable: pywatchman not installed.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Watching for file changes with StatReloader<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Performing system checks...<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> System check identified no issues (0 silenced).<br class="calibre4" />
&nbsp;&nbsp;&nbsp;February 18, 2019 - 16:26:07<br class="calibre4" />
<span class="ent">➋</span> Django version 2.2.0, using settings 'learning_log.settings'<br class="calibre4" />
<span class="ent">➌</span> Starting development server at http://127.0.0.1:8000/<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Quit the server with CONTROL-C.</p>
<p class="indent">Django should start a server called the <em class="calibre3">development server</em>, so you can view the project on your system to see how well it works. When you request a page by entering a URL in a browser, the Django server responds to that request by building the appropriate page and sending it to the browser.</p>
<p class="indent">At <span class="ent">➊</span>, Django checks to make sure the project is set up properly; at <span class="ent">➋</span> it reports the version of Django in use and the name of the settings file in use; and at <span class="ent">➌</span> it reports the URL where the project is being served. The URL <em class="calibre3">http://127.0.0.1:8000/</em> indicates that the project is listening for requests on port 8000 on your computer, which is called a localhost. The term <em class="calibre3">localhost</em> refers to a server that only processes requests on your system; it doesn’t allow anyone else to see the pages you’re developing.</p>
<p class="indent">Open a web browser and enter the URL <em class="calibre3">http://localhost:8000/</em>, or <em class="calibre3">http://127.0.0.1:8000/</em> if the first one doesn’t work. You should see something like <a href="#calibre_link-46" class="calibre6">Figure 18-1</a>, a page that Django creates to let you know all is working properly so far. Keep the server running for now, but when you want to stop the server, press <small class="calibre5">CTRL</small>-C in the terminal where the <span class="literal">runserver</span> command was issued.</p>
<div class="image1"><span type="pagebreak" id="calibre_link-351" class="calibre"></span><a id="calibre_link-46" class="calibre6"></a><img src="images/000014.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 18-1: Everything is working so far.</em></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you receive the error message</em> That port is already in use, <em class="calibre3">tell Django to use a different port by entering <span class="codeitalic">python manage.py runserver 8001</span>, and then cycle through higher numbers until you find an open port.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1106"><strong class="calibre2">18-1. New Projects:</strong> To get a better idea of what Django does, build a couple of empty projects and look at what Django creates. Make a new folder with a simple name, like <em class="calibre3">snap_gram</em> or <em class="calibre3">insta_chat</em> (outside of your <em class="calibre3">learning_log</em> directory), navigate to that folder in a terminal, and create a virtual environment. Install Django and run the command <span class="literal1">django-admin.py startproject snap_gram .</span> (make sure you include the dot at the end of the command).</p>
<p class="sparai">Look at the files and folders this command creates, and compare them to Learning Log. Do this a few times until you’re familiar with what Django creates when starting a new project. Then delete the project directories if you wish.</p>
</div>
<h3 class="h2" id="calibre_link-1107"><strong class="calibre2">Starting an App</strong></h3>
<p class="noindent">A Django <em class="calibre3">project</em> is organized as a group of individual <em class="calibre3">apps</em> that work together to make the project work as a whole. For now, we’ll create just one app to do most of our project’s work. We’ll add another app in <a href="#calibre_link-18" class="calibre6">Chapter 19</a> to manage user accounts.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-327" class="calibre"></span>You should leave the development server running in the terminal window you opened earlier. Open a new terminal window (or tab), and navigate to the directory that contains <em class="calibre3">manage.py</em>. Activate the virtual environment, and then run the <span class="literal">startapp</span> command:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;learning_log$ <span class="codestrong">source ll_env/bin/activate</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py startapp learning_logs</span><br class="calibre4" />
<span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">ls</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;db.sqlite3&nbsp;&nbsp;learning_log&nbsp;&nbsp;learning_logs&nbsp;&nbsp;ll_env&nbsp;&nbsp;manage.py<br class="calibre4" />
<span class="ent">➋</span> (ll_env)learning_log$ <span class="codestrong">ls learning_logs/</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;__init__.py&nbsp;&nbsp;admin.py&nbsp;&nbsp;apps.py&nbsp;&nbsp;migrations&nbsp;&nbsp;models.py&nbsp;&nbsp;tests.py&nbsp;&nbsp;views.py</p>
<p class="indent">The command <span class="literal">startapp</span> <span class="codeitalic">appname</span> tells Django to create the infrastructure needed to build an app. When you look in the project directory now, you’ll see a new folder called <em class="calibre3">learning_logs</em> <span class="ent">➊</span>. Open that folder to see what Django has created <span class="ent">➋</span>. The most important files are <em class="calibre3">models.py</em>, <em class="calibre3">admin.py</em>, and <em class="calibre3">views.py</em>. We’ll use <em class="calibre3">models.py</em> to define the data we want to manage in our app. We’ll look at <em class="calibre3">admin.py</em> and <em class="calibre3">views.py</em> a little later.</p>
<h4 class="h3" id="calibre_link-1108"><strong class="calibre2"><em class="calibre3">Defining Models</em></strong></h4>
<p class="noindent">Let’s think about our data for a moment. Each user will need to create a number of topics in their learning log. Each entry they make will be tied to a topic, and these entries will be displayed as text. We’ll also need to store the timestamp of each entry, so we can show users when they made each entry.</p>
<p class="indent">Open the file <em class="calibre3">models.py</em>, and look at its existing content:</p>
<p class="margin"><em class="calibre3">models.py</em></p>
<p class="programs">from django.db import models<br class="calibre4" />
<br class="calibre4" />
# Create your models here.</p>
<p class="indent">A module called <span class="literal">models</span> is being imported for us, and we’re being invited to create models of our own. A <em class="calibre3">model</em> tells Django how to work with the data that will be stored in the app. Code-wise, a model is just a class; it has attributes and methods, just like every class we’ve discussed. Here’s the model for the topics users will store:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.db import models</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class Topic(models.Model):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""A topic the user is learning about."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text = models.CharField(max_length=200)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date_added = models.DateTimeField(auto_now_add=True)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __str__(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Return a string representation of the model."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return self.text</p>
<p class="indent"><span type="pagebreak" id="calibre_link-335" class="calibre"></span>We’ve created a class called <span class="literal">Topic</span>, which inherits from <span class="literal">Model</span>&mdash;a parent class included in Django that defines a model’s basic functionality. We add two attributes to the <span class="literal">Topic</span> class: <span class="literal">text</span> and <span class="literal">date_added</span>.</p>
<p class="indent">The <span class="literal">text</span> attribute is a <span class="literal">CharField</span>&mdash;a piece of data that’s made up of characters, or text <span class="ent">➊</span>. You use <span class="literal">CharField</span> when you want to store a small amount of text, such as a name, a title, or a city. When we define a <span class="literal">CharField</span> attribute, we have to tell Django how much space it should reserve in the database. Here we give it a <span class="literal">max_length</span> of 200 characters, which should be enough to hold most topic names.</p>
<p class="indent">The <span class="literal">date_added</span> attribute is a <span class="literal">DateTimeField</span>&mdash;a piece of data that will record a date and time <span class="ent">➋</span>. We pass the argument <span class="literal">auto_now_add=True</span>, which tells Django to automatically set this attribute to the current date and time whenever the user creates a new topic.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">To see the different kinds of fields you can use in a model, see the</em> Django Model Field Reference <em class="calibre3">at</em> <a href="https://docs.djangoproject.com/en/2.2/ref/models/fields/" class="calibre6">https://docs.djangoproject.com/en/2.2/ref/models/fields/</a>. <em class="calibre3">You won’t need all the information right now, but it will be extremely useful when you’re developing your own apps.</em></p>
</div>
<p class="indent">We tell Django which attribute to use by default when it displays information about a topic. Django calls a <span class="literal">__str__()</span> method to display a simple representation of a model. Here we’ve written a <span class="literal">__str__()</span> method that returns the string stored in the <span class="literal">text</span> attribute <span class="ent">➌</span>.</p>
<h4 class="h3" id="calibre_link-1109"><strong class="calibre2"><em class="calibre3">Activating Models</em></strong></h4>
<p class="noindent">To use our models, we have to tell Django to include our app in the overall project. Open <em class="calibre3">settings.py</em> (in the <em class="calibre3">learning_log/learning_log</em> directory); you’ll see a section that tells Django which apps are installed and work together in the project:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs">--<span class="codeitalic1">snip</span>--<br class="calibre4" />
INSTALLED_APPS = [<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'django.contrib.admin',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'django.contrib.auth',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'django.contrib.contenttypes',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'django.contrib.sessions',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'django.contrib.messages',<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'django.contrib.staticfiles',<br class="calibre4" />
]<br class="calibre4" />
--<span class="codeitalic1">snip</span>--</p>
<p class="indent">Add our app to this list by modifying <span class="literal">INSTALLED_APPS</span> so it looks like this:</p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">INSTALLED_APPS = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# My apps<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'learning_logs',<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;# Default django apps.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'django.contrib.admin',</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-313" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">]</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Grouping apps together in a project helps to keep track of them as the project grows to include more apps. Here we start a section called <em class="calibre3">My apps</em>, which includes only <span class="literal">learning_logs</span> for now. It’s important to place your own apps before the default apps in case you need to override any behavior of the default apps with your own custom behavior.</p>
<p class="indent">Next, we need to tell Django to modify the database so it can store information related to the model <span class="literal">Topic</span>. From the terminal, run the following command:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">python manage.py makemigrations learning_logs</span><br class="calibre4" />
Migrations for 'learning_logs':<br class="calibre4" />
&nbsp;&nbsp;learning_logs/migrations/0001_initial.py<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;- Create model Topic<br class="calibre4" />
(ll_env)learning_log$</p>
<p class="indent">The command <span class="literal">makemigrations</span> tells Django to figure out how to modify the database so it can store the data associated with any new models we’ve defined. The output here shows that Django has created a migration file called <em class="calibre3">0001_initial.py</em>. This migration will create a table for the model <span class="literal">Topic</span> in the database.</p>
<p class="indent">Now we’ll apply this migration and have Django modify the database for us:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py migrate</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Operations to perform:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apply all migrations: admin, auth, contenttypes, learning_logs, sessions<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Running migrations:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;Applying learning_logs.0001_initial... OK</p>
<p class="indent">Most of the output from this command is identical to the first time we issued the <span class="literal">migrate</span> command. The line we need to check appears at <span class="ent">➊</span>, where Django confirms that the migration for <span class="literal">learning_logs</span> worked <span class="literal">OK</span>.</p>
<p class="indent">Whenever we want to modify the data that Learning Log manages, we’ll follow these three steps: modify <em class="calibre3">models.py</em>, call <span class="literal">makemigrations</span> on <span class="literal">learning_logs</span>, and tell Django to <span class="literal">migrate</span> the project.</p>
<h4 class="h3" id="calibre_link-1110"><strong class="calibre2"><em class="calibre3">The Django Admin Site</em></strong></h4>
<p class="noindent">Django makes it easy to work with your models through the <em class="calibre3">admin site</em>. Only the site’s administrators use the admin site, not general users. In this section, we’ll set up the admin site and use it to add some topics through the <span class="literal">Topic</span> model.</p>
<h5 class="h4" id="calibre_link-1394"><strong class="calibre2">Setting Up a Superuser</strong></h5>
<p class="noindent">Django allows you to create a <em class="calibre3">superuser</em>, a user who has all privileges available on the site. A user’s <em class="calibre3">privileges</em> control the actions that user can take. <span type="pagebreak" id="calibre_link-315" class="calibre"></span>The most restrictive privilege settings allow a user to only read public information on the site. Registered users typically have the privilege of reading their own private data and some selected information available only to members. To effectively administer a web application, the site owner usually needs access to all information stored on the site. A good administrator is careful with their users’ sensitive information, because users put a lot of trust into the apps they access.</p>
<p class="indent">To create a superuser in Django, enter the following command and respond to the prompts:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py createsuperuser</span><br class="calibre4" />
<span class="ent">➊</span> Username (leave blank to use 'eric'): <span class="codestrong">ll_admin</span><br class="calibre4" />
<span class="ent">➋</span> Email address:<br class="calibre4" />
<span class="ent">➌</span> Password:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Password (again):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Superuser created successfully.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">When you issue the command <span class="literal">createsuperuser</span>, Django prompts you to enter a username for the superuser <span class="ent">➊</span>. Here I’m using <em class="calibre3">ll_admin</em>, but you can enter any username you want. You can enter an email address if you want or just leave this field blank <span class="ent">➋</span>. You’ll need to enter your password twice <span class="ent">➌</span>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Some sensitive information can be hidden from a site’s administrators. For example, Django doesn’t store the password you enter; instead, it stores a string derived from the password, called a</em> hash. <em class="calibre3">Each time you enter your password, Django hashes your entry and compares it to the stored hash. If the two hashes match, you’re authenticated. By requiring hashes to match, if an attacker gains access to a site’s database, they’ll be able to read its stored hashes but not the passwords. When a site is set up properly, it’s almost impossible to get the original passwords from the hashes.</em></p>
</div>
<h5 class="h4" id="calibre_link-1395"><strong class="calibre2">Registering a Model with the Admin Site</strong></h5>
<p class="noindent">Django includes some models in the admin site automatically, such as <span class="literal">User</span> and <span class="literal">Group</span>, but the models we create need to be added manually.</p>
<p class="indent">When we started the <span class="literal">learning_logs</span> app, Django created an <em class="calibre3">admin.py</em> file in the same directory as <em class="calibre3">models.py</em>. Open the <em class="calibre3">admin.py</em> file:</p>
<p class="margin"><em class="calibre3">admin.py</em></p>
<p class="programs">from django.contrib import admin<br class="calibre4" />
<br class="calibre4" />
# Register your models here.</p>
<p class="indent">To register <span class="literal">Topic</span> with the admin site, enter the following:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.contrib import admin</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> from .models import Topic<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> admin.site.register(Topic)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-334" class="calibre"></span>This code first imports the model we want to register, <span class="literal">Topic</span> <span class="ent">➊</span>. The dot in front of <span class="literal">models</span> tells Django to look for <em class="calibre3">models.py</em> in the same directory as <em class="calibre3">admin.py</em>. The code <span class="literal">admin.site.register()</span> tells Django to manage our model through the admin site <span class="ent">➋</span>.</p>
<p class="indent">Now use the superuser account to access the admin site. Go to <em class="calibre3">http://localhost:8000/admin/</em>, and enter the username and password for the superuser you just created. You should see a screen like the one in <a href="#calibre_link-47" class="calibre6">Figure 18-2</a>. This page allows you to add new users and groups, and change existing ones. You can also work with data related to the <span class="literal">Topic</span> model that we just defined.</p>
<div class="image1"><a id="calibre_link-47" class="calibre6"></a><img src="images/000020.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 18-2: The admin site with <span class="codeitalic2">Topic</span> included</em></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you see a message in your browser that the web page is not available, make sure you still have the Django server running in a terminal window. If you don’t, activate a virtual environment and reissue the command <span class="codeitalic">python manage.py runserver</span>. If you’re having trouble viewing your project at any point in the development process, closing any open terminals and reissuing the <span class="codeitalic">runserver</span> command is a good first troubleshooting step.</em></p>
</div>
<h5 class="h4" id="calibre_link-1396"><strong class="calibre2">Adding Topics</strong></h5>
<p class="noindent">Now that <span class="literal">Topic</span> has been registered with the admin site, let’s add our first topic. Click <strong class="calibre2">Topics</strong> to go to the Topics page, which is mostly empty, because we have no topics to manage yet. Click <strong class="calibre2">Add Topic</strong>, and a form for adding a new topic appears. Enter <span class="codestrong1">Chess</span> in the first box and click <strong class="calibre2">Save</strong>. You’ll be sent back to the Topics admin page, and you’ll see the topic you just created.</p>
<p class="indent">Let’s create a second topic so we’ll have more data to work with. Click <strong class="calibre2">Add Topic</strong> again, and enter <span class="codestrong1">Rock Climbing</span>. Click <strong class="calibre2">Save</strong>, and you’ll be sent back to the main Topics page again. Now you’ll see Chess and Rock Climbing listed.</p>
<h4 class="h3" id="calibre_link-1111"><span type="pagebreak" id="calibre_link-330" class="calibre"></span><strong class="calibre2"><em class="calibre3">Defining the Entry Model</em></strong></h4>
<p class="noindent">For a user to record what they’ve been learning about chess and rock climbing, we need to define a model for the kinds of entries users can make in their learning logs. Each entry needs to be associated with a particular topic. This relationship is called a <em class="calibre3">many-to-one relationship</em>, meaning many entries can be associated with one topic.</p>
<p class="indent">Here’s the code for the <span class="literal">Entry</span> model. Place it in your <em class="calibre3">models.py</em> file:</p>
<p class="margin"><em class="calibre3">models.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.db import models</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class Topic(models.Model):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> class Entry(models.Model):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Something specific learned about a topic."""<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic = models.ForeignKey(Topic, on_delete=models.CASCADE)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text = models.TextField()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date_added = models.DateTimeField(auto_now_add=True)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Meta:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verbose_name_plural = 'entries'<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def __str__(self):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Return a string representation of the model."""<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return f"{self.text[:50]}..."</p>
<p class="indent">The <span class="literal">Entry</span> class inherits from Django’s base <span class="literal">Model</span> class, just as <span class="literal">Topic</span> did <span class="ent">➊</span>. The first attribute, <span class="literal">topic</span>, is a <span class="literal">ForeignKey</span> instance <span class="ent">➋</span>. A <em class="calibre3">foreign key</em> is a database term; it’s a reference to another record in the database. This is the code that connects each entry to a specific topic. Each topic is assigned a key, or ID, when it’s created. When Django needs to establish a connection between two pieces of data, it uses the key associated with each piece of information. We’ll use these connections shortly to retrieve all the entries associated with a certain topic. The <span class="literal">on_delete=models.CASCADE</span> argument tells Django that when a topic is deleted, all the entries associated with that topic should be deleted as well. This is known as a <em class="calibre3">cascading delete</em>.</p>
<p class="indent">Next is an attribute called <span class="literal">text</span>, which is an instance of <span class="literal">TextField</span> <span class="ent">➌</span>. This kind of field doesn’t need a size limit, because we don’t want to limit the size of individual entries. The <span class="literal">date_added</span> attribute allows us to present entries in the order they were created and to place a timestamp next to each entry.</p>
<p class="indent">At <span class="ent">➍</span> we nest the <span class="literal">Meta</span> class inside our <span class="literal">Entry</span> class. The <span class="literal">Meta</span> class holds extra information for managing a model; here, it allows us to set a special attribute telling Django to use <em class="calibre3">Entries</em> when it needs to refer to more than one entry. Without this, Django would refer to multiple entries as <em class="calibre3">Entrys</em>.</p>
<p class="indent">The <span class="literal">__str__()</span> method tells Django which information to show when it refers to individual entries. Because an entry can be a long body of text, we tell Django to show just the first 50 characters of <span class="literal">text</span> <span class="ent">➎</span>. We also add an ellipsis to clarify that we’re not always displaying the entire entry.</p>
<h4 class="h3" id="calibre_link-1112"><span type="pagebreak" id="calibre_link-316" class="calibre"></span><strong class="calibre2"><em class="calibre3">Migrating the Entry Model</em></strong></h4>
<p class="noindent">Because we’ve added a new model, we need to migrate the database again. This process will become quite familiar: you modify <em class="calibre3">models.py</em>, run the command <span class="literal">python manage.py makemigrations</span> <span class="codeitalic">app_name</span>, and then run the command <span class="literal">python manage.py migrate</span>.</p>
<p class="indent">Migrate the database and check the output by entering the following commands:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py makemigrations learning_logs</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Migrations for 'learning_logs':<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;learning_logs/migrations/0002_entry.py<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Create model Entry<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py migrate</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Operations to perform:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;Applying learning_logs.0002_entry... OK</p>
<p class="indent">A new migration called <em class="calibre3">0002_entry.py</em> is generated, which tells Django how to modify the database to store information related to the model <span class="literal">Entry</span> <span class="ent">➊</span>. When we issue the <span class="literal">migrate</span> command, we see that Django applied this migration, and everything was okay <span class="ent">➋</span>.</p>
<h4 class="h3" id="calibre_link-1113"><strong class="calibre2"><em class="calibre3">Registering Entry with the Admin Site</em></strong></h4>
<p class="noindent">We also need to register the <span class="literal">Entry</span> model. Here’s what <em class="calibre3">admin.py</em> should look like now:</p>
<p class="margin"><em class="calibre3">admin.py</em></p>
<p class="programs"><span class="ash">from django.contrib import admin</span><br class="calibre4" />
<br class="calibre4" />
from .models import Topic, Entry<br class="calibre4" />
<br class="calibre4" />
<span class="ash">admin.site.register(Topic)</span><br class="calibre4" />
admin.site.register(Entry)</p>
<p class="indent">Go back to <em class="calibre3">http://localhost/admin/</em>, and you should see <em class="calibre3">Entries</em> listed under <em class="calibre3">Learning_Logs</em>. Click the <strong class="calibre2">Add</strong> link for Entries, or click <strong class="calibre2">Entries</strong>, and then choose <strong class="calibre2">Add entry</strong>. You should see a drop-down list to select the topic you’re creating an entry for and a text box for adding an entry. Select <strong class="calibre2">Chess</strong> from the drop-down list, and add an entry. Here’s the first entry I made:</p>
<p class="quote">The opening is the first part of the game, roughly the first ten moves or so. In the opening, it’s a good idea to do three things&mdash;bring out your bishops and knights, try to control the center of the board, and castle your king.</p>
<p class="quote">Of course, these are just guidelines. It will be important to learn when to follow these guidelines and when to disregard these suggestions.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-314" class="calibre"></span>When you click <strong class="calibre2">Save</strong>, you’ll be brought back to the main admin page for entries. Here, you’ll see the benefit of using <span class="literal">text[:50]</span> as the string representation for each entry; it’s much easier to work with multiple entries in the admin interface if you see only the first part of an entry rather than the entire text of each entry.</p>
<p class="indent">Make a second entry for Chess and one entry for Rock Climbing so we have some initial data. Here’s a second entry for Chess:</p>
<p class="quote">In the opening phase of the game, it’s important to bring out your bishops and knights. These pieces are powerful and maneuverable enough to play a significant role in the beginning moves of a game.</p>
<p class="indent">And here’s a first entry for Rock Climbing:</p>
<p class="quote">One of the most important concepts in climbing is to keep your weight on your feet as much as possible. There’s a myth that climbers can hang all day on their arms. In reality, good climbers have practiced specific ways of keeping their weight over their feet whenever possible.</p>
<p class="indent">These three entries will give us something to work with as we continue to develop Learning Log.</p>
<h4 class="h3" id="calibre_link-1114"><strong class="calibre2"><em class="calibre3">The Django Shell</em></strong></h4>
<p class="noindent">With some data entered, we can examine that data programmatically through an interactive terminal session. This interactive environment is called the Django <em class="calibre3">shell</em>, and it’s a great environment for testing and troubleshooting your project. Here’s an example of an interactive shell session:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py shell</span><br class="calibre4" />
<span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">from learning_logs.models import Topic</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt; <span class="codestrong">Topic.objects.all()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&lt;QuerySet [&lt;Topic: Chess&gt;, &lt;Topic: Rock Climbing&gt;]&gt;</p>
<p class="indent">The command <span class="literal">python manage.py shell</span>, run in an active virtual environment, launches a Python interpreter that you can use to explore the data stored in your project’s database. Here, we import the model <span class="literal">Topic</span> from the <span class="literal">learning_logs.models</span> module <span class="ent">➊</span>. We then use the method <span class="literal">Topic.objects.all()</span> to get all the instances of the model <span class="literal">Topic</span>; the list that’s returned is called a <em class="calibre3">queryset</em>.</p>
<p class="indent">We can loop over a queryset just as we’d loop over a list. Here’s how you can see the ID that’s been assigned to each topic object:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">topics = Topic.objects.all()</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">for topic in topics:</span><br class="calibre4" />
...&nbsp;&nbsp;&nbsp;<span class="codestrong">print(topic.id, topic)</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-332" class="calibre"></span>...<br class="calibre4" />
1 Chess<br class="calibre4" />
2 Rock Climbing</p>
<p class="indent">We store the queryset in <span class="literal">topics</span>, and then print each topic’s <span class="literal">id</span> attribute and the string representation of each topic. We can see that Chess has an ID of 1, and Rock Climbing has an ID of 2.</p>
<p class="indent">If you know the ID of a particular object, you can use the method <span class="literal">Topic.objects.get()</span> to retrieve that object and examine any attribute the object has. Let’s look at the <span class="literal">text</span> and <span class="literal">date_added</span> values for Chess:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">t = Topic.objects.get(id=1)</span><br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">t.text</span><br class="calibre4" />
'Chess'<br class="calibre4" />
&gt;&gt;&gt; <span class="codestrong">t.date_added</span><br class="calibre4" />
datetime.datetime(2019, 2, 19, 1, 55, 31, 98500, tzinfo=&lt;UTC&gt;)</p>
<p class="indent">We can also look at the entries related to a certain topic. Earlier we defined the <span class="literal">topic</span> attribute for the <span class="literal">Entry</span> model. This was a <span class="literal">ForeignKey</span>, a connection between each entry and a topic. Django can use this connection to get every entry related to a certain topic, like this:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">t.entry_set.all()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&lt;QuerySet [&lt;Entry: The opening is the first part of the game, roughly...&gt;,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&lt;Entry:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;In the opening phase of the game, it's important t...&gt;]&gt;</p>
<p class="indent">To get data through a foreign key relationship, you use the lowercase name of the related model followed by an underscore and the word <span class="literal">set</span> <span class="ent">➊</span>. For example, say you have the models <span class="literal">Pizza</span> and <span class="literal">Topping</span>, and <span class="literal">Topping</span> is related to <span class="literal">Pizza</span> through a foreign key. If your object is called <span class="literal">my_pizza</span>, representing a single pizza, you can get all of the pizza’s toppings using the code <span class="literal">my_pizza.topping_set.all()</span>.</p>
<p class="indent">We’ll use this kind of syntax when we begin to code the pages users can request. The shell is very useful for making sure your code retrieves the data you want it to. If your code works as you expect it to in the shell, you can expect it to work properly in the files within your project. If your code generates errors or doesn’t retrieve the data you expect it to, it’s much easier to troubleshoot your code in the simple shell environment than within the files that generate web pages. We won’t refer to the shell much, but you should continue using it to practice working with Django’s syntax for accessing the data stored in the project.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Each time you modify your models, you’ll need to restart the shell to see the effects of those changes. To exit a shell session, press <small class="calibre5">CTRL</small>-D; on Windows, press <small class="calibre5">CTRL</small>-Z and then press <small class="calibre5">ENTER</small>.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-50" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1115"><strong class="calibre2">18-2. Short Entries:</strong> The <span class="literal1">__str__()</span> method in the <span class="literal1">Entry</span> model currently appends an ellipsis to every instance of <span class="literal1">Entry</span> when Django shows it in the admin site or the shell. Add an <span class="literal1">if</span> statement to the <span class="literal1">__str__()</span> method that adds an ellipsis only if the entry is longer than 50 characters. Use the admin site to add an entry that’s fewer than 50 characters in length, and check that it doesn’t have an ellipsis when viewed.</p>
<p class="sparal" id="calibre_link-1116"><strong class="calibre2">18-3. The Django API:</strong> When you write code to access the data in your project, you’re writing a <em class="calibre3">query</em>. Skim through the documentation for querying your data at <em class="calibre3"><a href="https://docs.djangoproject.com/en/2.2/topics/db/queries/" class="calibre6">https://docs.djangoproject.com/en/2.2/topics/db/queries/</a>.</em> Much of what you see will look new to you, but it will be very useful as you start to work on your own projects.</p>
<p class="sparal" id="calibre_link-49"><strong class="calibre2">18-4. Pizzeria:</strong> Start a new project called <span class="literal1">pizzeria</span> with an app called <span class="literal1">pizzas</span>. Define a model <span class="literal1">Pizza</span> with a field called <span class="literal1">name</span>, which will hold name values, such as <span class="literal1">Hawaiian</span> and <span class="literal1">Meat Lovers</span>. Define a model called <span class="literal1">Topping</span> with fields called <span class="literal1">pizza</span> and <span class="literal1">name</span>. The <span class="literal1">pizza</span> field should be a foreign key to <span class="literal1">Pizza</span>, and <span class="literal1">name</span> should be able to hold values such as <span class="literal1">pineapple</span>, <span class="literal1">Canadian bacon</span>, and <span class="literal1">sausage</span>.</p>
<p class="sparai">Register both models with the admin site, and use the site to enter some pizza names and toppings. Use the shell to explore the data you entered.</p>
</div>
<h3 class="h2" id="calibre_link-1117"><strong class="calibre2">Making Pages: The Learning Log Home Page</strong></h3>
<p class="noindent">Making web pages with Django consists of three stages: defining URLs, writing views, and writing templates. You can do these in any order, but in this project we’ll always start by defining the URL pattern. A URL pattern describes the way the URL is laid out. It also tells Django what to look for when matching a browser request with a site URL so it knows which page to return.</p>
<p class="indent">Each URL then maps to a particular <em class="calibre3">view</em>&mdash;the view function retrieves and processes the data needed for that page. The view function often renders the page using a <em class="calibre3">template</em>, which contains the overall structure of the page. To see how this works, let’s make the home page for Learning Log. We’ll define the URL for the home page, write its view function, and create a simple template.</p>
<p class="indent">Because all we’re doing is making sure Learning Log works as it’s supposed to, we’ll make a simple page for now. A functioning web app is fun to style when it’s complete; an app that looks good but doesn’t work well is pointless. For now, the home page will display only a title and a brief description.</p>
<h4 class="h3" id="calibre_link-1118"><span type="pagebreak" id="calibre_link-348" class="calibre"></span><strong class="calibre2"><em class="calibre3">Mapping a URL</em></strong></h4>
<p class="noindent">Users request pages by entering URLs into a browser and clicking links, so we’ll need to decide what URLs are needed. The home page URL is first: it’s the base URL people use to access the project. At the moment the base URL, <em class="calibre3">http://localhost:8000/</em>, returns the default Django site that lets us know the project was set up correctly. We’ll change this by mapping the base URL to Learning Log’s home page.</p>
<p class="indent">In the main <em class="calibre3">learning_log</em> project folder, open the file <em class="calibre3">urls.py</em>. Here’s the code you should see:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ent">➊</span> from django.contrib import admin<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from django.urls import path<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> urlpatterns = [<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path('admin/', admin.site.urls),<br class="calibre4" />
&nbsp;&nbsp;&nbsp;]</p>
<p class="indent">The first two lines import a module and a function to manage URLs for the admin site <span class="ent">➊</span>. The body of the file defines the <span class="literal">urlpatterns</span> variable <span class="ent">➋</span>. In this <em class="calibre3">urls.py</em> file, which represents the project as a whole, the <span class="literal">urlpatterns</span> variable includes sets of URLs from the apps in the project. The code at <span class="ent">➌</span> includes the module <span class="literal">admin.site.urls</span>, which defines all the URLs that can be requested from the admin site.</p>
<p class="indent">We need to include the URLs for <span class="literal">learning_logs</span>, so add the following:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.contrib import admin</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;from django.urls import path, include<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">path('admin/', admin.site.urls),</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path('', include('learning_logs.urls')),<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">]</span></p>
<p class="indent">We’ve added a line to include the module <span class="literal">learning_logs.urls</span> at <span class="ent">➊</span>.</p>
<p class="indent">The default <em class="calibre3">urls.py</em> is in the <em class="calibre3">learning_log</em> folder; now we need to make a second <em class="calibre3">urls.py</em> file in the <em class="calibre3">learning_logs</em> folder. Create a new Python file and save it as <em class="calibre3">urls.py</em> in <em class="calibre3">learning_logs</em>, and enter this code into it:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ent">➊</span> """Defines URL patterns for learning_logs."""<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> from django.urls import path<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> from . import views<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span> app_name = 'learning_logs'<br class="calibre4" />
<span class="ent">➎</span> urlpatterns = [<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Home page<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path('', views.index, name='index'),<br class="calibre4" />
&nbsp;&nbsp;&nbsp;]</p>
<p class="indent"><span type="pagebreak" id="calibre_link-349" class="calibre"></span>To make it clear which <em class="calibre3">urls.py</em> we’re working in, we add a docstring at the beginning of the file <span class="ent">➊</span>. We then import the <span class="literal">path</span> function, which is needed when mapping URLs to views <span class="ent">➋</span>. We also import the <span class="literal">views</span> module <span class="ent">➌</span>; the dot tells Python to import the <em class="calibre3">views.py</em> module from the same directory as the current <em class="calibre3">urls.py</em> module. The variable <span class="literal">app_name</span> helps Django distinguish this <em class="calibre3">urls.py</em> file from files of the same name in other apps within the project <span class="ent">➍</span>. The variable <span class="literal">urlpatterns</span> in this module is a list of individual pages that can be requested from the <span class="literal">learning_logs</span> app <span class="ent">➎</span>.</p>
<p class="indent">The actual URL pattern is a call to the <span class="literal">path()</span> function, which takes three arguments <span class="ent">➏</span>. The first argument is a string that helps Django route the current request properly. Django receives the requested URL and tries to route the request to a view. It does this by searching all the URL patterns we’ve defined to find one that matches the current request. Django ignores the base URL for the project (<em class="calibre3">http://localhost:8000/</em>), so the empty string (<span class="literal">''</span>) matches the base URL. Any other URL won’t match this pattern, and Django will return an error page if the URL requested doesn’t match any existing URL patterns.</p>
<p class="indent">The second argument in <span class="literal">path()</span> <span class="ent">➏</span> specifies which function to call in <em class="calibre3">views.py</em>. When a requested URL matches the pattern we’re defining, Django calls the <span class="literal">index()</span> function from <em class="calibre3">views.py</em> (we’ll write this view function in the next section). The third argument provides the name <span class="literal">index</span> for this URL pattern so we can refer to it in other code sections. Whenever we want to provide a link to the home page, we’ll use this name instead of writing out a URL.</p>
<h4 class="h3" id="calibre_link-1119"><strong class="calibre2"><em class="calibre3">Writing a View</em></strong></h4>
<p class="noindent">A view function takes in information from a request, prepares the data needed to generate a page, and then sends the data back to the browser, often by using a template that defines what the page will look like.</p>
<p class="indent">The file <em class="calibre3">views.py</em> in <em class="calibre3">learning_logs</em> was generated automatically when we ran the command <span class="literal">python manage.py startapp</span>. Here’s what’s in <em class="calibre3">views.py</em> right now:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">from django.shortcuts import render<br class="calibre4" />
<br class="calibre4" />
# Create your views here.</p>
<p class="indent">Currently, this file just imports the <span class="literal">render()</span> function, which renders the response based on the data provided by views. Open the views file and add the following code for the home page:</p>
<p class="programs"><span class="ash">from django.shortcuts import render</span><br class="calibre4" />
<br class="calibre4" />
def index(request):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"""The home page for Learning Log."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;return render(request, 'learning_logs/index.html')</p>
<p class="indent">When a URL request matches the pattern we just defined, Django looks for a function called <span class="literal">index()</span> in the <em class="calibre3">views.py</em> file. Django then passes the <span type="pagebreak" id="calibre_link-357" class="calibre"></span><span class="literal">request</span> object to this view function. In this case, we don’t need to process any data for the page, so the only code in the function is a call to <span class="literal">render()</span>. The <span class="literal">render()</span> function here passes two arguments&mdash;the original <span class="literal">request</span> object and a template it can use to build the page. Let’s write this template.</p>
<h4 class="h3" id="calibre_link-1120"><strong class="calibre2"><em class="calibre3">Writing a Template</em></strong></h4>
<p class="noindent">The template defines what the page should look like, and Django fills in the relevant data each time the page is requested. A template allows you to access any data provided by the view. Because our view for the home page provided no data, this template is fairly simple.</p>
<p class="indent">Inside the <em class="calibre3">learning_logs</em> folder, make a new folder called <em class="calibre3">templates</em>. Inside the <em class="calibre3">templates</em> folder, make another folder called <em class="calibre3">learning_logs</em>. This might seem a little redundant (we have a folder named <em class="calibre3">learning_logs</em> inside a folder named <em class="calibre3">templates</em> inside a folder named <em class="calibre3">learning_logs</em>), but it sets up a structure that Django can interpret unambiguously, even in the context of a large project containing many individual apps. Inside the inner <em class="calibre3">learning_logs</em> folder, make a new file called <em class="calibre3">index.html</em>. The path to the file will be <em class="calibre3">learning_log/learning_logs/templates/learning_logs/index.html</em>. Enter the following code into that file:</p>
<p class="margin"><em class="calibre3">index.html</em></p>
<p class="programs">&lt;p&gt;Learning Log&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
&lt;p&gt;Learning Log helps you keep track of your learning, for any topic you're<br class="calibre4" />
learning about.&lt;/p&gt;</p>
<p class="indent">This is a very simple file. If you’re not familiar with HTML, the <span class="literal">&lt;p&gt;&lt;/p&gt;</span> tags signify paragraphs. The <span class="literal">&lt;p&gt;</span> tag opens a paragraph, and the <span class="literal">&lt;/p&gt;</span> tag closes a paragraph. We have two paragraphs: the first acts as a title, and the second describes what users can do with Learning Log.</p>
<p class="indent">Now when you request the project’s base URL, <em class="calibre3">http://localhost:8000/</em>, you should see the page we just built instead of the default Django page. Django will take the requested URL, and that URL will match the pattern <span class="literal">''</span>; then Django will call the function <span class="literal">views.index()</span>, which will render the page using the template contained in <em class="calibre3">index.html</em>. <a href="#calibre_link-48" class="calibre6">Figure 18-3</a> shows the resulting page.</p>
<div class="image1"><a id="calibre_link-48" class="calibre6"></a><img src="images/000027.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 18-3: The home page for Learning Log</em></p>
<p class="indent"><span type="pagebreak" id="calibre_link-54" class="calibre"></span>Although it might seem like a complicated process for creating one page, this separation between URLs, views, and templates works quite well. It allows you to think about each aspect of a project separately. In larger projects, it allows individuals working on the project to focus on the areas in which they’re strongest. For example, a database specialist can focus on the models, a programmer can focus on the view code, and a web designer can focus on the templates.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You might see the following error message:</em></p>
<p class="programs">ModuleNotFoundError: No module named 'learning_logs.urls'</p>
<p class="notepi"><em class="calibre3">If you do, stop the development server by pressing <small class="calibre5">CTRL</small>-C in the terminal window where you issued the <span class="codeitalic">runserver</span> command. Then reissue the command <span class="codeitalic">python manage.py runserver</span>. You should be able to see the home page. Any time you run into an error like this, try stopping and restarting the server.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1121"><strong class="calibre2">18-5. Meal Planner:</strong> Consider an app that helps people plan their meals throughout the week. Make a new folder called <em class="calibre3">meal_planner</em>, and start a new Django project inside this folder. Then make a new app called <span class="literal1">meal_plans</span>. Make a simple home page for this project.</p>
<p class="sparal" id="calibre_link-53"><strong class="calibre2">18-6. Pizzeria Home Page:</strong> Add a home page to the Pizzeria project you started in <a href="#calibre_link-49" class="calibre6">Exercise 18-4</a> (<a href="#calibre_link-50" class="calibre6">page 394</a>).</p>
</div>
<h3 class="h2" id="calibre_link-1122"><strong class="calibre2">Building Additional Pages</strong></h3>
<p class="noindent">Now that we’ve established a routine for building a page, we can start to build out the Learning Log project. We’ll build two pages that display data: a page that lists all topics and a page that shows all the entries for a particular topic. For each page, we’ll specify a URL pattern, write a view function, and write a template. But before we do this, we’ll create a base template that all templates in the project can inherit from.</p>
<h4 class="h3" id="calibre_link-1123"><strong class="calibre2"><em class="calibre3">Template Inheritance</em></strong></h4>
<p class="noindent">When building a website, some elements will always need to be repeated on each page. Rather than writing these elements directly into each page, you can write a base template containing the repeated elements and then have each page inherit from the base. This approach lets you focus on developing the unique aspects of each page and makes it much easier to change the overall look and feel of the project.</p>
<h5 class="h4" id="calibre_link-1397"><span type="pagebreak" id="calibre_link-358" class="calibre"></span><strong class="calibre2">The Parent Template</strong></h5>
<p class="noindent">We’ll create a template called <em class="calibre3">base.html</em> in the same directory as <em class="calibre3">index.html</em>. This file will contain elements common to all pages; every other template will inherit from <em class="calibre3">base.html</em>. The only element we want to repeat on each page right now is the title at the top. Because we’ll include this template on every page, let’s make the title a link to the home page:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&lt;p&gt;<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:index' %}"&gt;Learning Log&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> {% block content %}{% endblock content %}</p>
<p class="indent">The first part of this file creates a paragraph containing the name of the project, which also acts as a home page link. To generate a link, we use a <em class="calibre3">template tag</em>, which is indicated by braces and percent signs <span class="literal">{% %}</span>. A template tag generates information to be displayed on a page. Our template tag <span class="literal">{% url 'learning_logs:index' %}</span> generates a URL matching the URL pattern defined in <em class="calibre3">learning_logs/urls.py</em> with the name <span class="literal">'index'</span> <span class="ent">➊</span>. In this example, <span class="literal">learning_logs</span> is the <em class="calibre3">namespace</em> and <span class="literal">index</span> is a uniquely named URL pattern in that namespace. The namespace comes from the value we assigned to <span class="literal">app_name</span> in the <em class="calibre3">learning_logs/urls.py</em> file.</p>
<p class="indent">In a simple HTML page, a link is surrounded by the <em class="calibre3">anchor</em> tag <span class="literal">&lt;a&gt;</span>:</p>
<p class="programs">&lt;a href="<span class="codeitalic1">link_url</span>"&gt;<span class="codeitalic1">link text</span>&lt;/a&gt;</p>
<p class="indent">Having the template tag generate the URL for us makes it much easier to keep our links up to date. We only need to change the URL pattern in <em class="calibre3">urls.py</em>, and Django will automatically insert the updated URL the next time the page is requested. Every page in our project will inherit from <em class="calibre3">base.html</em>, so from now on, every page will have a link back to the home page.</p>
<p class="indent">At <span class="ent">➋</span> we insert a pair of <span class="literal">block</span> tags. This block, named <span class="literal">content</span>, is a placeholder; the child template will define the kind of information that goes in the <span class="literal">content</span> block.</p>
<p class="indent">A child template doesn’t have to define every block from its parent, so you can reserve space in parent templates for as many blocks as you like; the child template uses only as many as it requires.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">In Python code, we almost always use four spaces when we indent. Template files tend to have more levels of nesting than Python files, so it’s common to use only two spaces for each indentation level. You just need to ensure that you’re consistent.</em></p>
</div>
<h5 class="h4" id="calibre_link-1398"><strong class="calibre2">The Child Template</strong></h5>
<p class="noindent">Now we need to rewrite <em class="calibre3">index.html</em> to inherit from <em class="calibre3">base.html</em>. Add the following code to <em class="calibre3">index.html</em>:</p>
<p class="margin"><em class="calibre3">index.html</em></p>
<p class="programs"><span class="ent">➊</span> {% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> {% block content %}<br class="calibre4" />
<span type="pagebreak" id="calibre_link-464" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;p&gt;Learning Log helps you keep track of your learning, for any topic you're</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">learning about.&lt;/p&gt;</span><br class="calibre4" />
<span class="ent">➌</span> {% endblock content %}</p>
<p class="indent">If you compare this to the original <em class="calibre3">index.html</em>, you can see that we’ve replaced the Learning Log title with the code for inheriting from a parent template <span class="ent">➊</span>. A child template must have an <span class="literal">{% extends %}</span> tag on the first line to tell Django which parent template to inherit from. The file <em class="calibre3">base.html</em> is part of <span class="literal">learning_logs</span>, so we include <em class="calibre3">learning_logs</em> in the path to the parent template. This line pulls in everything contained in the <em class="calibre3">base.html</em> template and allows <em class="calibre3">index.html</em> to define what goes in the space reserved by the <span class="literal">content</span> block.</p>
<p class="indent">We define the content block at <span class="ent">➋</span> by inserting a <span class="literal">{% block %}</span> tag with the name <span class="literal">content</span>. Everything that we aren’t inheriting from the parent template goes inside the <span class="literal">content</span> block. Here, that’s the paragraph describing the Learning Log project. At <span class="ent">➌</span> we indicate that we’re finished defining the content by using an <span class="literal">{% endblock content %}</span> tag. The <span class="literal">{% endblock %}</span> tag doesn’t require a name, but if a template grows to contain multiple blocks, it can be helpful to know exactly which block is ending.</p>
<p class="indent">You can start to see the benefit of template inheritance: in a child template, we only need to include content that’s unique to that page. This not only simplifies each template, but also makes it much easier to modify the site. To modify an element common to many pages, you only need to modify the parent template. Your changes are then carried over to every page that inherits from that template. In a project that includes tens or hundreds of pages, this structure can make it much easier and faster to improve your site.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">In a large project, it’s common to have one parent template called</em> base.html <em class="calibre3">for the entire site and parent templates for each major section of the site. All the section templates inherit from</em> base.html, <em class="calibre3">and each page in the site inherits from a section template. This way you can easily modify the look and feel of the site as a whole, any section in the site, or any individual page. This configuration provides a very efficient way to work, and it encourages you to steadily update your site over time.</em></p>
</div>
<h4 class="h3" id="calibre_link-1124"><strong class="calibre2"><em class="calibre3">The Topics Page</em></strong></h4>
<p class="noindent">Now that we have an efficient approach to building pages, we can focus on our next two pages: the general topics page and the page to display entries for a single topic. The topics page will show all topics that users have created, and it’s the first page that will involve working with data.</p>
<h5 class="h4" id="calibre_link-1399"><strong class="calibre2">The Topics URL Pattern</strong></h5>
<p class="noindent">First, we define the URL for the topics page. It’s common to choose a simple URL fragment that reflects the kind of information presented on the page. <span type="pagebreak" id="calibre_link-333" class="calibre"></span>We’ll use the word <em class="calibre3">topics</em>, so the URL <em class="calibre3">http://localhost:8000/topics/</em> will return this page. Here’s how we modify <em class="calibre3">learning_logs/urls.py</em>:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">"""Defines URL patterns for learning_logs."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Home page.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">path('', views.index, name='index'),</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Page that shows all topics.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path('topics/', views.topics, name='topics'),<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">]</span></p>
<p class="indent">We’ve simply added <span class="literal">topics/</span> into the string argument used for the home page URL <span class="ent">➊</span>. When Django examines a requested URL, this pattern will match any URL that has the base URL followed by <em class="calibre3">topics</em>. You can include or omit a forward slash at the end, but there can’t be anything else after the word <em class="calibre3">topics</em>, or the pattern won’t match. Any request with a URL that matches this pattern will then be passed to the function <span class="literal">topics()</span> in <em class="calibre3">views.py</em>.</p>
<h5 class="h4" id="calibre_link-1400"><strong class="calibre2">The Topics View</strong></h5>
<p class="noindent">The <span class="literal">topics()</span> function needs to retrieve some data from the database and send it to the template. Here’s what we need to add to <em class="calibre3">views.py</em>:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.shortcuts import render</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> from .models import Topic<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">def index(request):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> def topics(request):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Show all topics."""<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topics = Topic.objects.order_by('date_added')<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context = {'topics': topics}<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return render(request, 'learning_logs/topics.html', context)</p>
<p class="indent">We first import the model associated with the data we need <span class="ent">➊</span>. The <span class="literal">topics()</span> function needs one parameter: the <span class="literal">request</span> object Django received from the server <span class="ent">➋</span>. At <span class="ent">➌</span> we query the database by asking for the <span class="literal">Topic</span> objects, sorted by the <span class="literal">date_added</span> attribute. We store the resulting queryset in <span class="literal">topics</span>.</p>
<p class="indent">At <span class="ent">➍</span> we define a context that we’ll send to the template. A <em class="calibre3">context</em> is a dictionary in which the keys are names we’ll use in the template to access the data, and the values are the data we need to send to the template. In this case, there’s one key-value pair, which contains the set of topics we’ll display on the page. When building a page that uses data, we pass the <span class="literal">context</span> variable to <span class="literal">render()</span> as well as the <span class="literal">request</span> object and the path to the template <span class="ent">➎</span>.</p>
<h5 class="h4" id="calibre_link-1401"><span type="pagebreak" id="calibre_link-360" class="calibre"></span><strong class="calibre2">The Topics Template</strong></h5>
<p class="noindent">The template for the topics page receives the <span class="literal">context</span> dictionary, so the template can use the data that <span class="literal">topics()</span> provides. Make a file called <em class="calibre3">topics.html</em> in the same directory as <em class="calibre3">index.html</em>. Here’s how we can display the topics in the template:</p>
<p class="margin"><em class="calibre3">topics.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% block content %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Topics&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% for topic in topics %}<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;{{ topic }}&lt;/li&gt;<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% empty %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;No topics have been added yet.&lt;/li&gt;<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% endfor %}<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock content %}</p>
<p class="indent">We use the <span class="literal">{% extends %}</span> tag to inherit from <em class="calibre3">base.html</em>, just as the index template does, and then open a <span class="literal">content</span> block. The body of this page contains a bulleted list of the topics that have been entered. In standard HTML, a bulleted list is called an <em class="calibre3">unordered list</em> and is indicated by the tags <span class="literal">&lt;ul&gt;&lt;/ul&gt;</span>. We begin the bulleted list of topics at <span class="ent">➊</span>.</p>
<p class="indent">At <span class="ent">➋</span> we have another template tag equivalent to a <span class="literal">for</span> loop, which loops through the list <span class="literal">topics</span> from the <span class="literal">context</span> dictionary. The code used in templates differs from Python in some important ways. Python uses indentation to indicate which lines of a <span class="literal">for</span> statement are part of a loop. In a template, every <span class="literal">for</span> loop needs an explicit <span class="literal">{% endfor %}</span> tag indicating where the end of the loop occurs. So in a template, you’ll see loops written like this:</p>
<p class="programs">{% for <span class="codeitalic1">item</span> in <span class="codeitalic1">list</span> %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeitalic1">do something with each item</span><br class="calibre4" />
{% endfor %}</p>
<p class="indent">Inside the loop, we want to turn each topic into an item in the bulleted list. To print a variable in a template, wrap the variable name in double braces. The braces won’t appear on the page; they just indicate to Django that we’re using a template variable. So the code <span class="literal">{{ topic }}</span> at <span class="ent">➌</span> will be replaced by the value of <span class="literal">topic</span> on each pass through the loop. The HTML tag <span class="literal">&lt;li&gt;&lt;/li&gt;</span> indicates a <em class="calibre3">list item</em>. Anything between these tags, inside a pair of <span class="literal">&lt;ul&gt;&lt;/ul&gt;</span> tags, will appear as a bulleted item in the list.</p>
<p class="indent">At <span class="ent">➍</span> we use the <span class="literal">{% empty %}</span> template tag, which tells Django what to do if there are no items in the list. In this case, we print a message informing the user that no topics have been added yet. The last two lines close out the <span class="literal">for</span> loop <span class="ent">➎</span> and then close out the bulleted list <span class="ent">➏</span>.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-457" class="calibre"></span>Now we need to modify the base template to include a link to the topics page. Add the following code to <em class="calibre3">base.html</em>:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">&lt;p&gt;</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:index' %}"&gt;Learning Log&lt;/a&gt; -<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:topics' %}"&gt;Topics&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/p&gt;</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% block content %}{% endblock content %}</span></p>
<p class="indent">We add a dash after the link to the home page <span class="ent">➊</span>, and then add a link to the topics page using the <span class="literal">{% url %}</span> template tag again <span class="ent">➋</span>. This line tells Django to generate a link matching the URL pattern with the name <span class="literal">'topics'</span> in <em class="calibre3">learning_logs/urls.py</em>.</p>
<p class="indent">Now when you refresh the home page in your browser, you’ll see a <em class="calibre3">Topics</em> link. When you click the link, you’ll see a page that looks similar to <a href="#calibre_link-51" class="calibre6">Figure 18-4</a>.</p>
<div class="image1"><a id="calibre_link-51" class="calibre6"></a><img src="images/000035.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 18-4: The topics page</em></p>
<h4 class="h3" id="calibre_link-1125"><strong class="calibre2"><em class="calibre3">Individual Topic Pages</em></strong></h4>
<p class="noindent">Next, we need to create a page that can focus on a single topic, showing the topic name and all the entries for that topic. We’ll again define a new URL pattern, write a view, and create a template. We’ll also modify the topics page so each item in the bulleted list links to its corresponding topic page.</p>
<h5 class="h4" id="calibre_link-1402"><strong class="calibre2">The Topic URL Pattern</strong></h5>
<p class="noindent">The URL pattern for the topic page is a little different than the prior URL patterns because it will use the topic’s <span class="literal">id</span> attribute to indicate which topic was requested. For example, if the user wants to see the detail page for the Chess topic, where the <span class="literal">id</span> is 1, the URL will be <em class="calibre3">http://localhost:8000/topics/1/</em>. <span type="pagebreak" id="calibre_link-331" class="calibre"></span>Here’s a pattern to match this URL, which you should place in <em class="calibre3">learning_logs/urls.py</em>:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# Detail page for a single topic.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;path('topics/&lt;int:topic_id&gt;/', views.topic, name='topic'),<br class="calibre4" />
<span class="ash">]</span></p>
<p class="indent">Let’s examine the string <span class="literal">'topics/&lt;int:topic_id&gt;/'</span> in this URL pattern. The first part of the string tells Django to look for URLs that have the word <em class="calibre3">topics</em> after the base URL. The second part of the string, <span class="literal">/&lt;int:topic_id&gt;/</span>, matches an integer between two forward slashes and stores the integer value in an argument called <span class="literal">topic_id</span>.</p>
<p class="indent">When Django finds a URL that matches this pattern, it calls the view function <span class="literal">topic()</span> with the value stored in <span class="literal">topic_id</span> as an argument. We’ll use the value of <span class="literal">topic_id</span> to get the correct topic inside the function.</p>
<h5 class="h4" id="calibre_link-1403"><strong class="calibre2">The Topic View</strong></h5>
<p class="noindent">The <span class="literal">topic()</span> function needs to get the topic and all associated entries from the database, as shown here:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
<span class="ent">➊</span> def topic(request, topic_id):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Show a single topic and all its entries."""<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic = Topic.objects.get(id=topic_id)<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entries = topic.entry_set.order_by('-date_added')<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context = {'topic': topic, 'entries': entries}<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return render(request, 'learning_logs/topic.html', context)</p>
<p class="indent">This is the first view function that requires a parameter other than the <span class="literal">request</span> object. The function accepts the value captured by the expression <span class="literal">/&lt;int:topic_id&gt;/</span> and stores it in <span class="literal">topic_id</span> <span class="ent">➊</span>. At <span class="ent">➋</span> we use <span class="literal">get()</span> to retrieve the topic, just as we did in the Django shell. At <span class="ent">➌</span> we get the entries associated with this topic, and we order them according to <span class="literal">date_added</span>. The minus sign in front of <span class="literal">date_added</span> sorts the results in reverse order, which will display the most recent entries first. We store the topic and entries in the context dictionary <span class="ent">➍</span> and send <span class="literal">context</span> to the template <em class="calibre3">topic.html</em> <span class="ent">➎</span>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The code phrases at <span class="ent">➋</span> and <span class="ent">➌</span> are called</em> queries, <em class="calibre3">because they query the database for specific information. When you’re writing queries like these in your own projects, it’s helpful to try them out in the Django shell first. You’ll get much quicker feedback in the shell than you will by writing a view and template, and then checking the results in a browser.</em></p>
</div>
<h5 class="h4" id="calibre_link-1404"><strong class="calibre2">The Topic Template</strong></h5>
<p class="noindent">The template needs to display the name of the topic and the entries. We also need to inform the user if no entries have been made yet for this topic.</p>
<p class="margin"><em class="calibre3">topic.html</em></p>
<p class="programs"><span type="pagebreak" id="calibre_link-359" class="calibre"></span>&nbsp;&nbsp;&nbsp;{% extends 'learning_logs/base.html' %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% block content %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;p&gt;Topic: {{ topic }}&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Entries:&lt;/p&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;{% for entry in entries %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;{{ entry.date_added|date:'M d, Y H:i' }}&lt;/p&gt;<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;{{ entry.text|linebreaks }}&lt;/p&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;{% empty %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;There are no entries for this topic yet.&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% endfor %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock content %}</p>
<p class="indent">We extend <em class="calibre3">base.html</em>, as we do for all pages in the project. Next, we show the topic that’s currently being displayed <span class="ent">➊</span>, which is stored in the template variable <span class="literal">{{ topic }}</span>. The variable <span class="literal">topic</span> is available because it’s included in the <span class="literal">context</span> dictionary. We then start a bulleted list to show each of the entries <span class="ent">➋</span> and loop through them as we did the topics earlier <span class="ent">➌</span>.</p>
<p class="indent">Each bullet lists two pieces of information: the timestamp and the full text of each entry. For the timestamp <span class="ent">➍</span>, we display the value of the attribute <span class="literal">date_added</span>. In Django templates, a vertical line (<span class="literal">|</span>) represents a template <em class="calibre3">filter</em>&mdash;a function that modifies the value in a template variable. The filter <span class="literal">date:'M d, Y H:i'</span> displays timestamps in the format <em class="calibre3">January 1, 2018 23:00</em>. The next line displays the full value of <span class="literal">text</span> rather than just the first 50 characters from <span class="literal">entry</span>. The filter <span class="literal">linebreaks</span> <span class="ent">➎</span> ensures that long text entries include line breaks in a format understood by browsers rather than showing a block of uninterrupted text. At <span class="ent">➏</span> we use the <span class="literal">{% empty %}</span> template tag to print a message informing the user that no entries have been made.</p>
<h5 class="h4" id="calibre_link-1405"><strong class="calibre2">Links from the Topics Page</strong></h5>
<p class="noindent">Before we look at the topic page in a browser, we need to modify the topics template so each topic links to the appropriate page. Here’s the change you need to make to <em class="calibre3">topics.html</em>:</p>
<p class="margin"><em class="calibre3">topics.html</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% for topic in topics %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:topic' topic.id %}"&gt;{{ topic }}&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% empty %}</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-336" class="calibre"></span>We use the URL template tag to generate the proper link, based on the URL pattern in <span class="literal">learning_logs</span> with the name <span class="literal">'topic'</span>. This URL pattern requires a <span class="literal">topic_id</span> argument, so we add the attribute <span class="literal">topic.id</span> to the URL template tag. Now each topic in the list of topics is a link to a topic page, such as <em class="calibre3">http://localhost:8000/topics/1/</em>.</p>
<p class="indent">When you refresh the topics page and click a topic, you should see a page that looks like <a href="#calibre_link-52" class="calibre6">Figure 18-5</a>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">There’s a subtle but important difference between <span class="codeitalic">topic.id</span> and <span class="codeitalic">topic_id</span>. The expression <span class="codeitalic">topic.id</span> examines a topic and retrieves the value of the corresponding ID. The variable <span class="codeitalic">topic_id</span> is a reference to that ID in the code. If you run into errors when working with IDs, make sure you’re using these expressions in the appropriate ways.</em></p>
</div>
<div class="image1"><a id="calibre_link-52" class="calibre6"></a><img src="images/000042.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 18-5: The detail page for a single topic, showing all entries for a topic</em></p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1126"><strong class="calibre2">18-7. Template Documentation:</strong> Skim the Django template documentation at <em class="calibre3"><a href="https://docs.djangoproject.com/en/2.2/ref/templates/" class="calibre6">https://docs.djangoproject.com/en/2.2/ref/templates/</a></em>. You can refer back to it when you’re working on your own projects.</p>
<p class="sparal" id="calibre_link-1127"><strong class="calibre2">18-8. Pizzeria Pages:</strong> Add a page to the <em class="calibre3">Pizzeria</em> project from <a href="#calibre_link-53" class="calibre6">Exercise 18-6</a> (<a href="#calibre_link-54" class="calibre6">page 398</a>) that shows the names of available pizzas. Then link each pizza name to a page displaying the pizza’s toppings. Make sure you use template inheritance to build your pages efficiently.</p>
</div>
<h3 class="h2" id="calibre_link-1128"><span type="pagebreak" id="calibre_link-1406" class="calibre"></span><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned how to build simple web applications using the Django framework. You wrote a brief project specification, installed Django to a virtual environment, set up a project, and checked that the project was set up correctly. You set up an app and defined models to represent the data for your app. You learned about databases and how Django helps you migrate your database after you make a change to your models. You created a superuser for the admin site, and you used the admin site to enter some initial data.</p>
<p class="indent">You also explored the Django shell, which allows you to work with your project’s data in a terminal session. You learned to define URLs, create view functions, and write templates to make pages for your site. You also used template inheritance to simplify the structure of individual templates and make it easier to modify the site as the project evolves.</p>
<p class="indent">In <a href="#calibre_link-18" class="calibre6">Chapter 19</a>, you’ll make intuitive, user-friendly pages that allow users to add new topics and entries and edit existing entries without going through the admin site. You’ll also add a user registration system, allowing users to create an account and make their own learning log. This is the heart of a web app&mdash;the ability to create something that any number of users can interact with.<span type="pagebreak" id="calibre_link-1407" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-71">
<h2 class="h" id="calibre_link-18"><span type="pagebreak" id="calibre_link-1408" class="calibre"></span><strong class="calibre2"><span class="big">19</span><br class="calibre4" />USER ACCOUNTS</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">At the heart of a web application is the ability for any user, anywhere in the world, to register an account with your app and start using it. In this chapter, you’ll build forms so users can add their own topics and entries, and edit existing entries. You’ll also learn how Django guards against common attacks to form-based pages so you don’t have to spend much time thinking about securing your apps.</p>
<p class="indent">You’ll also implement a user authentication system. You’ll build a registration page for users to create accounts, and then restrict access to certain pages to logged-in users only. Then you’ll modify some of the view functions so users can only see their own data. You’ll learn to keep your users’ data safe and secure.</p>
<h3 class="h2" id="calibre_link-1129"><span type="pagebreak" id="calibre_link-337" class="calibre"></span><strong class="calibre2">Allowing Users to Enter Data</strong></h3>
<p class="noindent">Before we build an authentication system for creating accounts, we’ll first add some pages that allow users to enter their own data. We’ll give users the ability to add a new topic, add a new entry, and edit their previous entries.</p>
<p class="indent">Currently, only a superuser can enter data through the admin site. We don’t want users to interact with the admin site, so we’ll use Django’s form-building tools to build pages that allow users to enter data.</p>
<h4 class="h3" id="calibre_link-1130"><strong class="calibre2"><em class="calibre3">Adding New Topics</em></strong></h4>
<p class="noindent">Let’s start by allowing users to add a new topic. Adding a form-based page works in much the same way as the pages we’ve already built: we define a URL, write a view function, and write a template. The one major difference is the addition of a new module called <em class="calibre3">forms.py</em>, which will contain the forms.</p>
<h5 class="h4" id="calibre_link-1409"><strong class="calibre2">The Topic ModelForm</strong></h5>
<p class="noindent">Any page that lets a user enter and submit information on a web page is a <em class="calibre3">form</em>, even if it doesn’t look like one. When users enter information, we need to <em class="calibre3">validate</em> that the information provided is the right kind of data and is not malicious, such as code to interrupt our server. We then need to process and save valid information to the appropriate place in the database. Django automates much of this work.</p>
<p class="indent">The simplest way to build a form in Django is to use a <em class="calibre3">ModelForm</em>, which uses the information from the models we defined in <a href="#calibre_link-17" class="calibre6">Chapter 18</a> to automatically build a form. Write your first form in the file <em class="calibre3">forms.py</em>, which you should create in the same directory as <em class="calibre3">models.py</em>:</p>
<p class="margin"><em class="calibre3">forms.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;from django import forms<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from .models import Topic<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> class TopicForm(forms.ModelForm):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Meta:<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model = Topic<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields = ['text']<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labels = {'text': ''}</p>
<p class="indent">We first import the <span class="literal">forms</span> module and the model we’ll work with, called <span class="literal">Topic</span>. At <span class="ent">➊</span> we define a class called <span class="literal">TopicForm</span>, which inherits from <span class="literal">forms.ModelForm</span>.</p>
<p class="indent">The simplest version of a <span class="literal">ModelForm</span> consists of a nested <span class="literal">Meta</span> class telling Django which model to base the form on and which fields to include in the form. At <span class="ent">➋</span> we build a form from the <span class="literal">Topic</span> model and include only the <span class="literal">text</span> field <span class="ent">➌</span>. The code at <span class="ent">➍</span> tells Django not to generate a label for the <span class="literal">text</span> field.</p>
<h5 class="h4" id="calibre_link-1410"><span type="pagebreak" id="calibre_link-352" class="calibre"></span><strong class="calibre2">The new_topic URL</strong></h5>
<p class="noindent">The URL for a new page should be short and descriptive. When the user wants to add a new topic, we’ll send them to <em class="calibre3">http://localhost:8000/new_topic/</em>. Here’s the URL pattern for the <span class="literal">new_topic</span> page, which you add to <em class="calibre3">learning_logs/urls.py</em>:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# Page for adding a new topic<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;path('new_topic/', views.new_topic, name='new_topic'),<br class="calibre4" />
<span class="ash">]</span></p>
<p class="indent">This URL pattern sends requests to the view function <span class="literal">new_topic()</span>, which we’ll write next.</p>
<h5 class="h4" id="calibre_link-1411"><strong class="calibre2">The new_topic() View Function</strong></h5>
<p class="noindent">The <span class="literal">new_topic()</span> function needs to handle two different situations: initial requests for the <span class="literal">new_topic</span> page (in which case it should show a blank form) and the processing of any data submitted in the form. After data from a submitted form is processed, it needs to redirect the user back to the <span class="literal">topics</span> page:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;from django.shortcuts import render, redirect<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from .models import Topic</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;from .forms import TopicForm<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;def new_topic(request):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Add a new topic."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if request.method != 'POST':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No data submitted; create a blank form.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = TopicForm()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# POST data submitted; process data.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = TopicForm(data=request.POST)<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if form.is_valid():<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.save()<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return redirect('learning_logs:topics')<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Display a blank or invalid form.<br class="calibre4" />
<span class="ent">➐</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context = {'form': form}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return render(request, 'learning_logs/new_topic.html', context)</p>
<p class="indent">We import the function <span class="literal">redirect</span>, which we’ll use to redirect the user back to the <span class="literal">topics</span> page after they submit their topic. The <span class="literal">redirect()</span> function takes in the name of a view and redirects the user to that view. We also import the form we just wrote, <span class="literal">TopicForm</span>.</p>
<h5 class="h4" id="calibre_link-1412"><span type="pagebreak" id="calibre_link-340" class="calibre"></span><strong class="calibre2">GET and POST Requests</strong></h5>
<p class="noindent">The two main types of request you’ll use when building web apps are GET requests and POST requests. You use <em class="calibre3">GET</em> requests for pages that only read data from the server. You usually use <em class="calibre3">POST</em> requests when the user needs to submit information through a form. We’ll be specifying the POST method for processing all of our forms. (A few other kinds of requests exist, but we won’t use them in this project.)</p>
<p class="indent">The <span class="literal">new_topic()</span> function takes in the request object as a parameter. When the user initially requests this page, their browser will send a GET request. Once the user has filled out and submitted the form, their browser will submit a POST request. Depending on the request, we’ll know whether the user is requesting a blank form (a GET request) or asking us to process a completed form (a POST request).</p>
<p class="indent">The test at <span class="ent">➊</span> determines whether the request method is GET or POST. If the request method isn’t POST, the request is probably GET, so we need to return a blank form (if it’s another kind of request, it’s still safe to return a blank form). We make an instance of <span class="literal">TopicForm</span> <span class="ent">➋</span>, assign it to the variable <span class="literal">form</span>, and send the form to the template in the context dictionary <span class="ent">➐</span>. Because we included no arguments when instantiating <span class="literal">TopicForm</span>, Django creates a blank form that the user can fill out.</p>
<p class="indent">If the request method is POST, the <span class="literal">else</span> block runs and processes the data submitted in the form. We make an instance of <span class="literal">TopicForm</span> <span class="ent">➌</span> and pass it the data entered by the user, stored in <span class="literal">request.POST</span>. The <span class="literal">form</span> object that’s returned contains the information submitted by the user.</p>
<p class="indent">We can’t save the submitted information in the database until we’ve checked that it’s valid <span class="ent">➍</span>. The <span class="literal">is_valid()</span> method checks that all required fields have been filled in (all fields in a form are required by default) and that the data entered matches the field types expected&mdash;for example, that the length of <span class="literal">text</span> is less than 200 characters, as we specified in <em class="calibre3">models.py</em> in <a href="#calibre_link-17" class="calibre6">Chapter 18</a>. This automatic validation saves us a lot of work. If everything is valid, we can call <span class="literal">save()</span> <span class="ent">➎</span>, which writes the data from the form to the database.</p>
<p class="indent">Once we’ve saved the data, we can leave this page. We use <span class="literal">redirect()</span> to redirect the user’s browser to the <span class="literal">topics</span> page, where the user should see the topic they just entered in the list of topics.</p>
<p class="indent">The <span class="literal">context</span> variable is defined at the end of the view function, and the page is rendered using the template <em class="calibre3">new_topic.html</em>, which we’ll create next. This code is placed outside of any <span class="literal">if</span> block; it will run if a blank form was created, and it will run if a submitted form is determined to be invalid. An invalid form will include some default error messages to help the user submit acceptable data.</p>
<h5 class="h4" id="calibre_link-1413"><strong class="calibre2">The new_topic Template</strong></h5>
<p class="noindent">Now we’ll make a new template called <em class="calibre3">new_topic.html</em> to display the form we just created.</p>
<p class="margin"><span type="pagebreak" id="calibre_link-339" class="calibre"></span><em class="calibre3">new_topic.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% block content %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Add a new topic:&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;form action="{% url 'learning_logs:new_topic' %}" method='post'&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% csrf_token %}<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ form.as_p }}<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button name="submit"&gt;Add topic&lt;/button&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock content %}</p>
<p class="indent">This template extends <em class="calibre3">base.html</em>, so it has the same base structure as the rest of the pages in Learning Log. At <span class="ent">➊</span> we define an HTML form. The <span class="literal">action</span> argument tells the browser where to send the data submitted in the form; in this case, we send it back to the view function <span class="literal">new_topic()</span>. The <span class="literal">method</span> argument tells the browser to submit the data as a POST request.</p>
<p class="indent">Django uses the template tag <span class="literal">{% csrf_token %}</span> <span class="ent">➋</span> to prevent attackers from using the form to gain unauthorized access to the server (this kind of attack is called a <em class="calibre3">cross-site request forgery</em>). At <span class="ent">➌</span> we display the form; here you see how simple Django can make certain tasks, such as displaying a form. We only need to include the template variable <span class="literal">{{ form.as_p }}</span> for Django to create all the fields necessary to display the form automatically. The <span class="literal">as_p</span> modifier tells Django to render all the form elements in paragraph format, as a simple way to display the form neatly.</p>
<p class="indent">Django doesn’t create a submit button for forms, so we define one at <span class="ent">➍</span>.</p>
<h5 class="h4" id="calibre_link-1414"><strong class="calibre2">Linking to the new_topic Page</strong></h5>
<p class="noindent">Next, we include a link to the <span class="literal">new_topic</span> page on the <span class="literal">topics</span> page:</p>
<p class="margin"><em class="calibre3">topics.html</em></p>
<p class="programs"><span class="ash">{% extends "learning_logs/base.html" %}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">{% block content %}</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;<span class="ash">&lt;p&gt;Topics&lt;/p&gt;</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;<span class="ash">&lt;ul&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">&lt;/ul&gt;</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:new_topic' %}"&gt;Add a new topic&lt;/a&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ash">{% endblock content %}</span></p>
<p class="indent">Place the link after the list of existing topics. <a href="#calibre_link-72" class="calibre6">Figure 19-1</a> shows the resulting form. Use the form to add a few new topics of your own.</p>
<div class="image1"><span type="pagebreak" id="calibre_link-341" class="calibre"></span><a id="calibre_link-72" class="calibre6"></a><img src="images/000050.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 19-1: The page for adding a new topic</em></p>
<h4 class="h3" id="calibre_link-1131"><strong class="calibre2"><em class="calibre3">Adding New Entries</em></strong></h4>
<p class="noindent">Now that the user can add a new topic, they’ll want to add new entries too. We’ll again define a URL, write a view function and a template, and link to the page. But first, we’ll add another class to <em class="calibre3">forms.py</em>.</p>
<h5 class="h4" id="calibre_link-1415"><strong class="calibre2">The Entry ModelForm</strong></h5>
<p class="noindent">We need to create a form associated with the <span class="literal">Entry</span> model but this time with a bit more customization than <span class="literal">TopicForm</span>:</p>
<p class="margin"><em class="calibre3">forms.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django import forms</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from .models import Topic, Entry<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">class TopicForm(forms.ModelForm):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;class EntryForm(forms.ModelForm):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Meta:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model = Entry<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields = ['text']<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labels = {'text': 'Entry:'}<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;widgets = {'text': forms.Textarea(attrs={'cols': 80})}</p>
<p class="indent">We update the <span class="literal">import</span> statement to include <span class="literal">Entry</span> as well as <span class="literal">Topic</span>. We make a new class called <span class="literal">EntryForm</span> that inherits from <span class="literal">forms.ModelForm</span>. The <span class="literal">EntryForm</span> class has a nested <span class="literal">Meta</span> class listing the model it’s based on and the field to include in the form. We again give the field <span class="literal">'text'</span> a blank label <span class="ent">➊</span>.</p>
<p class="indent">At <span class="ent">➋</span> we include the <span class="literal">widgets</span> attribute. A <em class="calibre3">widget</em> is an HTML form element, such as a single-line text box, multi-line text area, or drop-down list. By including the <span class="literal">widgets</span> attribute, you can override Django’s default widget choices. By telling Django to use a <span class="literal">forms.Textarea</span> element, we’re customizing <span type="pagebreak" id="calibre_link-460" class="calibre"></span>the input widget for the field <span class="literal">'text'</span> so the text area will be 80 columns wide instead of the default 40. This gives users enough room to write a meaningful entry.</p>
<h5 class="h4" id="calibre_link-1416"><strong class="calibre2">The new_entry URL</strong></h5>
<p class="noindent">New entries must be associated with a particular topic, so we need to include a <span class="literal">topic_id</span> argument in the URL for adding a new entry. Here’s the URL, which you add to <em class="calibre3">learning_logs/urls.py</em>:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# Page for adding a new entry<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;path('new_entry/&lt;int:topic_id&gt;/', views.new_entry, name='new_entry'),<br class="calibre4" />
<span class="ash">]</span></p>
<p class="indent">This URL pattern matches any URL with the form <span class="literal">http://localhost:8000/new_entry/</span><span class="codeitalic">id</span><span class="literal">/</span>, where <span class="codeitalic">id</span> is a number matching the topic ID. The code <span class="literal">&lt;int:topic_id&gt;</span> captures a numerical value and assigns it to the variable <span class="literal">topic_id</span>. When a URL matching this pattern is requested, Django sends the request and the topic’s ID to the <span class="literal">new_entry()</span> view function.</p>
<h5 class="h4" id="calibre_link-1417"><strong class="calibre2">The new_entry() View Function</strong></h5>
<p class="noindent">The view function for <span class="literal">new_entry</span> is much like the function for adding a new topic. Add the following code to your <em class="calibre3">views.py</em> file:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.shortcuts import render, redirect</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from .models import Topic</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;from .forms import TopicForm, EntryForm<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;def new_entry(request, topic_id):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Add a new entry for a particular topic."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic = Topic.objects.get(id=topic_id)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if request.method != 'POST':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No data submitted; create a blank form.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = EntryForm()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# POST data submitted; process data.<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = EntryForm(data=request.POST)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if form.is_valid():<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_entry = form.save(commit=False)<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_entry.topic = topic<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_entry.save()<br class="calibre4" />
<span class="ent">➐</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return redirect('learning_logs:topic', topic_id=topic_id)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Display a blank or invalid form.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context = {'topic': topic, 'form': form}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return render(request, 'learning_logs/new_entry.html', context)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-343" class="calibre"></span>We update the <span class="literal">import</span> statement to include the <span class="literal">EntryForm</span> we just made. The definition of <span class="literal">new_entry()</span> has a <span class="literal">topic_id</span> parameter to store the value it receives from the URL. We’ll need the topic to render the page and process the form’s data, so we use <span class="literal">topic_id</span> to get the correct topic object at <span class="ent">➊</span>.</p>
<p class="indent">At <span class="ent">➋</span> we check whether the request method is POST or GET. The <span class="literal">if</span> block executes if it’s a GET request, and we create a blank instance of <span class="literal">EntryForm</span> <span class="ent">➌</span>.</p>
<p class="indent">If the request method is POST, we process the data by making an instance of <span class="literal">EntryForm</span>, populated with the POST data from the <span class="literal">request</span> object <span class="ent">➍</span>. We then check whether the form is valid. If it is, we need to set the entry object’s <span class="literal">topic</span> attribute before saving it to the database. When we call <span class="literal">save()</span>, we include the argument <span class="literal">commit=False</span> <span class="ent">➎</span> to tell Django to create a new entry object and assign it to <span class="literal">new_entry</span> without saving it to the database yet. We set the <span class="literal">topic</span> attribute of <span class="literal">new_entry</span> to the topic we pulled from the database at the beginning of the function <span class="ent">➏</span>. Then we call <span class="literal">save()</span> with no arguments, saving the entry to the database with the correct associated topic.</p>
<p class="indent">The <span class="literal">redirect()</span> call at <span class="ent">➐</span> requires two arguments&mdash;the name of the view we want to redirect to and the argument that view function requires. Here, we’re redirecting to <span class="literal">topic()</span>, which needs the argument <span class="literal">topic_id</span>. This view then renders the topic page that the user made an entry for, and they should see their new entry in the list of entries.</p>
<p class="indent">At the end of the function, we create a <span class="literal">context</span> dictionary and render the page using the <em class="calibre3">new_entry.html</em> template. This code will execute for a blank form or for a submitted form that is evaluated as invalid.</p>
<h5 class="h4" id="calibre_link-1418"><strong class="calibre2">The new_entry Template</strong></h5>
<p class="noindent">As you can see in the following code, the template for <span class="literal">new_entry</span> is similar to the template for <span class="literal">new_topic</span>:</p>
<p class="margin"><em class="calibre3">new_entry.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% block content %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;a href="{% url 'learning_logs:topic' topic.id %}"&gt;{{ topic }}&lt;/a&gt;&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Add a new entry:&lt;/p&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&lt;form action="{% url 'learning_logs:new_entry' topic.id %}" method='post'&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% csrf_token %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ form.as_p }}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button name='submit'&gt;Add entry&lt;/button&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock content %}</p>
<p class="indent">We show the topic at the top of the page <span class="ent">➊</span>, so the user can see which topic they’re adding an entry to. The topic also acts as a link back to the main page for that topic.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-462" class="calibre"></span>The form’s <span class="literal">action</span> argument includes the <span class="literal">topic_id</span> value in the URL, so the view function can associate the new entry with the correct topic <span class="ent">➋</span>. Other than that, this template looks just like <em class="calibre3">new_topic.html</em>.</p>
<h5 class="h4" id="calibre_link-1419"><strong class="calibre2">Linking to the new_entry Page</strong></h5>
<p class="noindent">Next, we need to include a link to the <span class="literal">new_entry</span> page from each topic page in the topic template:</p>
<p class="margin"><em class="calibre3">topic.html</em></p>
<p class="programs"><span class="ash">{% extends "learning_logs/base.html" %}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">{% block content %}</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;<span class="ash">&lt;p&gt;Topic: {{ topic }}&lt;/p&gt;</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;<span class="ash">&lt;p&gt;Entries:&lt;/p&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&lt;p&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:new_entry' topic.id %}"&gt;Add new entry&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;<span class="ash">&lt;ul&gt;</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>&mdash;</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">&lt;/ul&gt;</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">{% endblock content %}</span></p>
<p class="indent">We place the link to add entries just before showing the entries, because adding a new entry will be the most common action on this page. <a href="#calibre_link-73" class="calibre6">Figure 19-2</a> shows the <span class="literal">new_entry</span> page. Now users can add new topics and as many entries as they want for each topic. Try out the <span class="literal">new_entry</span> page by adding a few entries to some of the topics you’ve created.</p>
<div class="image1"><a id="calibre_link-73" class="calibre6"></a><img src="images/000056.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 19-2: The <span class="codeitalic2">new_entry</span> page</em></p>
<h4 class="h3" id="calibre_link-1132"><span type="pagebreak" id="calibre_link-461" class="calibre"></span><strong class="calibre2"><em class="calibre3">Editing Entries</em></strong></h4>
<p class="noindent">Now we’ll make a page so users can edit the entries they’ve added.</p>
<h5 class="h4" id="calibre_link-1420"><strong class="calibre2">The edit_entry URL</strong></h5>
<p class="noindent">The URL for the page needs to pass the ID of the entry to be edited. Here’s <em class="calibre3">learning_logs/urls.py</em>:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# Page for editing an entry.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;path('edit_entry/&lt;int:entry_id&gt;/', views.edit_entry, name='edit_entry'),<br class="calibre4" />
<span class="ash">]</span></p>
<p class="indent">The ID passed in the URL (for example, <em class="calibre3">http://localhost:8000/edit_entry/1/)</em> is stored in the parameter <span class="literal">entry_id</span>. The URL pattern sends requests that match this format to the view function <span class="literal">edit_entry()</span>.</p>
<h5 class="h4" id="calibre_link-1421"><strong class="calibre2">The edit_entry() View Function</strong></h5>
<p class="noindent">When the <span class="literal">edit_entry</span> page receives a GET request, the <span class="literal">edit_entry()</span> function returns a form for editing the entry. When the page receives a POST request with revised entry text, it saves the modified text into the database:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.shortcuts import render, redirect</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from .models import Topic, Entry<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from .forms import TopicForm, EntryForm</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;def edit_entry(request, entry_id):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Edit an existing entry."""<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry = Entry.objects.get(id=entry_id)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic = entry.topic<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if request.method != 'POST':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Initial request; pre-fill form with the current entry.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = EntryForm(instance=entry)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# POST data submitted; process data.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = EntryForm(instance=entry, data=request.POST)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if form.is_valid():<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.save()<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return redirect('learning_logs:topic', topic_id=topic.id)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context = {'entry': entry, 'topic': topic, 'form': form}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return render(request, 'learning_logs/edit_entry.html', context)</p>
<p class="indent"><span type="pagebreak" id="calibre_link-342" class="calibre"></span>We first import the <span class="literal">Entry</span> model. At <span class="ent">➊</span> we get the entry object that the user wants to edit and the topic associated with this entry. In the <span class="literal">if</span> block, which runs for a GET request, we make an instance of <span class="literal">EntryForm</span> with the argument <span class="literal">instance=entry</span> <span class="ent">➋</span>. This argument tells Django to create the form prefilled with information from the existing entry object. The user will see their existing data and be able to edit that data.</p>
<p class="indent">When processing a POST request, we pass the <span class="literal">instance=entry</span> argument and the <span class="literal">data=request.POST</span> argument <span class="ent">➌</span>. These arguments tell Django to create a form instance based on the information associated with the existing entry object, updated with any relevant data from <span class="literal">request.POST</span>. We then check whether the form is valid; if it is, we call <span class="literal">save()</span> with no arguments because the entry is already associated with the correct topic <span class="ent">➍</span>. We then redirect to the <span class="literal">topic</span> page, where the user should see the updated version of the entry they edited <span class="ent">➎</span>.</p>
<p class="indent">If we’re showing an initial form for editing the entry or if the submitted form is invalid, we create the context dictionary and render the page using the <em class="calibre3">edit_entry.html</em> template.</p>
<h5 class="h4" id="calibre_link-1422"><strong class="calibre2">The edit_entry Template</strong></h5>
<p class="noindent">Next, we create an <em class="calibre3">edit_entry.html</em> template, which is similar to <em class="calibre3">new_entry.html</em>:</p>
<p class="margin"><em class="calibre3">edit_entry.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% block content %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;a href="{% url 'learning_logs:topic' topic.id %}"&gt;{{ topic }}&lt;/a&gt;&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Edit entry:&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;form action="{% url 'learning_logs:edit_entry' entry.id %}" method='post'&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% csrf_token %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ form.as_p }}<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button name="submit"&gt;Save changes&lt;/button&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock content %}</p>
<p class="indent">At <span class="ent">➊</span> the <span class="literal">action</span> argument sends the form back to the <span class="literal">edit_entry()</span> function for processing. We include the entry ID as an argument in the <span class="literal">{% url %}</span> tag, so the view function can modify the correct entry object. We label the submit button as <em class="calibre3">Save changes</em> to remind the user they’re saving edits, not creating a new entry <span class="ent">➋</span>.</p>
<h5 class="h4" id="calibre_link-1423"><span type="pagebreak" id="calibre_link-338" class="calibre"></span><strong class="calibre2">Linking to the edit_entry Page</strong></h5>
<p class="noindent">Now we need to include a link to the <span class="literal">edit_entry</span> page for each entry on the topic page:</p>
<p class="margin"><em class="calibre3">topic.html</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">{% for entry in entries %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;li&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;p&gt;{{ entry.date_added|date:'M d, Y H:i' }}&lt;/p&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;p&gt;{{ entry.text|linebreaks }}&lt;/p&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:edit_entry' entry.id %}"&gt;Edit entry&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/li&gt;</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We include the edit link after each entry’s date and text has been displayed. We use the <span class="literal">{% url %}</span> template tag to determine the URL for the named URL pattern <span class="literal">edit_entry</span>, along with the ID attribute of the current entry in the loop (<span class="literal">entry.id</span>). The link text <em class="calibre3">Edit entry</em> appears after each entry on the page. <a href="#calibre_link-74" class="calibre6">Figure 19-3</a> shows what the topic page looks like with these links.</p>
<div class="image1"><a id="calibre_link-74" class="calibre6"></a><img src="images/000062.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 19-3: Each entry now has a link for editing that entry.</em></p>
<p class="indent">Learning Log now has most of the functionality it needs. Users can add topics and entries, and read through any set of entries they want. In the next section, we’ll implement a user registration system so anyone can make an account with Learning Log and create their own set of topics and entries.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-78" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-77"><strong class="calibre2">19-1. Blog:</strong> Start a new Django project called <em class="calibre3">Blog</em>. Create an app called <em class="calibre3">blogs</em> in the project and a model called <span class="literal1">BlogPost</span>. The model should have fields like <span class="literal1">title</span>, <span class="literal1">text</span>, and <span class="literal1">date_added</span>. Create a superuser for the project, and use the admin site to make a couple of short posts. Make a home page that shows all posts in chronological order.</p>
<p class="sparai">Create a form for making new posts and another for editing existing posts. Fill in your forms to make sure they work.</p>
</div>
<h3 class="h2" id="calibre_link-1133"><strong class="calibre2">Setting Up User Accounts</strong></h3>
<p class="noindent">In this section, we’ll set up a user registration and authorization system so people can register an account and log in and out. We’ll create a new app to contain all the functionality related to working with users. We’ll use the default user authentication system included with Django to do as much of the work as possible. We’ll also modify the <span class="literal">Topic</span> model slightly so every topic belongs to a certain user.</p>
<h4 class="h3" id="calibre_link-1134"><strong class="calibre2"><em class="calibre3">The users App</em></strong></h4>
<p class="noindent">We’ll start by creating a new app called <span class="literal">users</span>, using the <span class="literal">startapp</span> command:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py startapp users</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">ls</span><br class="calibre4" />
<span class="ent">➊</span> db.sqlite3&nbsp;&nbsp;learning_log&nbsp;&nbsp;learning_logs&nbsp;&nbsp;ll_env&nbsp;&nbsp;manage.py&nbsp;&nbsp;users<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">ls users</span><br class="calibre4" />
<span class="ent">➋</span> __init__.py admin.py apps.py migrations models.py tests.py views.py</p>
<p class="indent">This command makes a new directory called <em class="calibre3">users</em> <span class="ent">➊</span> with a structure identical to the <span class="literal">learning_logs</span> app <span class="ent">➋</span>.</p>
<h5 class="h4" id="calibre_link-1424"><strong class="calibre2">Adding users to settings.py</strong></h5>
<p class="noindent">We need to add our new app to <span class="literal">INSTALLED_APPS</span> in <em class="calibre3">settings.py</em>, like so:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">INSTALLED_APPS = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># My apps</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'learning_logs',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'users',<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Default django apps.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--snip--</span><br class="calibre4" />
<span class="ash">]</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-347" class="calibre"></span>Now Django will include the <span class="literal">users</span> app in the overall project.</p>
<h5 class="h4" id="calibre_link-1425"><strong class="calibre2">Including the URLs from users</strong></h5>
<p class="noindent">Next, we need to modify the root <em class="calibre3">urls.py</em> so it includes the URLs we’ll write for the <span class="literal">users</span> app:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ash">from django.contrib import admin</span><br class="calibre4" />
<span class="ash">from django.urls import path, include</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">path('admin/', admin.site.urls),</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;path('users/', include('users.urls')),<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">path('', include('learning_logs.urls')),</span><br class="calibre4" />
<span class="ash">]</span></p>
<p class="indent">We add a line to include the file <em class="calibre3">urls.py</em> from <span class="literal">users</span>. This line will match any URL that starts with the word <em class="calibre3">users</em>, such as <em class="calibre3">http://localhost:8000/users/login/</em>.</p>
<h4 class="h3" id="calibre_link-1135"><strong class="calibre2"><em class="calibre3">The Login Page</em></strong></h4>
<p class="noindent">We’ll first implement a login page. We’ll use the default <span class="literal">login</span> view Django provides, so the URL pattern for this app looks a little different. Make a new <em class="calibre3">urls.py</em> file in the directory <em class="calibre3">learning_log/users/</em>, and add the following to it:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;"""Defines URL patterns for users"""<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from django.urls import path, include<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> app_name = 'users'<br class="calibre4" />
&nbsp;&nbsp;&nbsp;urlpatterns = [<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Include default auth urls.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path('', include('django.contrib.auth.urls')),<br class="calibre4" />
&nbsp;&nbsp;&nbsp;]</p>
<p class="indent">We import the <span class="literal">path</span> function, and then import the <span class="literal">include</span> function so we can include some default authentication URLs that Django has defined. These default URLs include named URL patterns, such as <span class="literal">'login'</span> and <span class="literal">'logout'</span>. We set the variable <span class="literal">app_name</span> to <span class="literal">'users'</span> so Django can distinguish these URLs from URLs belonging to other apps <span class="ent">➊</span>. Even default URLs provided by Django, when included in the <span class="literal">users</span> app’s <em class="calibre3">urls.py</em> file, will be accessible through the <span class="literal">users</span> namespace.</p>
<p class="indent">The login page’s pattern matches the URL <em class="calibre3">http://localhost:8000/users/login/</em> <span class="ent">➋</span>. When Django reads this URL, the word <em class="calibre3">users</em> tells Django to look in <em class="calibre3">users/urls.py</em>, and <em class="calibre3">login</em> tells it to send requests to Django’s default <span class="literal">login</span> view.</p>
<h5 class="h4" id="calibre_link-1426"><strong class="calibre2">The login Template</strong></h5>
<p class="noindent">When the user requests the login page, Django will use a default view function, but we still need to provide a template for the page. The default <span type="pagebreak" id="calibre_link-458" class="calibre"></span>authentication views look for templates inside a folder called <em class="calibre3">registration</em>, so we’ll need to make that folder. Inside the <em class="calibre3">learning_log/users/</em> directory, make a directory called <em class="calibre3">templates</em>; inside that, make another directory called <em class="calibre3">registration</em>. Here’s the <em class="calibre3">login.html</em> template, which you should save in <em class="calibre3">learning_log/users/templates/registration</em>:</p>
<p class="margin"><em class="calibre3">login.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% block content %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;{% if form.errors %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Your username and password didn't match. Please try again.&lt;/p&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% endif %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&lt;form method="post" action="{% url 'users:login' %}"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% csrf_token %}<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ form.as_p }}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button name="submit"&gt;Log in&lt;/button&gt;<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type="hidden" name="next"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value="{% url 'learning_logs:index' %}" /&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock content %}</p>
<p class="indent">This template extends <em class="calibre3">base.html</em> to ensure that the login page will have the same look and feel as the rest of the site. Note that a template in one app can inherit from a template in another app.</p>
<p class="indent">If the form’s <span class="literal">errors</span> attribute is set, we display an error message <span class="ent">➊</span>, reporting that the username and password combination don’t match anything stored in the database.</p>
<p class="indent">We want the login view to process the form, so we set the <span class="literal">action</span> argument as the URL of the login page <span class="ent">➋</span>. The login view sends a form to the template, and it’s up to us to display the form <span class="ent">➌</span> and add a submit button <span class="ent">➍</span>. At <span class="ent">➎</span> we include a hidden form element, <span class="literal">'next'</span>; the <span class="literal">value</span> argument tells Django where to redirect the user after they’ve logged in successfully. In this case, we send the user back to the home page.</p>
<h5 class="h4" id="calibre_link-1427"><strong class="calibre2">Linking to the Login Page</strong></h5>
<p class="noindent">Let’s add the login link to <em class="calibre3">base.html</em> so it appears on every page. We don’t want the link to display when the user is already logged in, so we nest it inside an <span class="literal">{% if %}</span> tag:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">&lt;p&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;a href="{% url 'learning_logs:index' %}"&gt;Learning Log&lt;/a&gt; -</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'learning_logs:topics' %}"&gt;Topics&lt;/a&gt; -<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;{% if user.is_authenticated %}<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hello, {{ user.username }}.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% else %}<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'users:login' %}"&gt;Log in&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% endif %}<br class="calibre4" />
<span type="pagebreak" id="calibre_link-346" class="calibre"></span>&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/p&gt;</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% block content %}{% endblock content %}</span></p>
<p class="indent">In Django’s authentication system, every template has a <span class="literal">user</span> variable available, which always has an <span class="literal">is_authenticated</span> attribute set: the attribute is <span class="literal">True</span> if the user is logged in and <span class="literal">False</span> if they aren’t. This attribute allows you to display one message to authenticated users and another to unauthenticated users.</p>
<p class="indent">Here we display a greeting to users currently logged in <span class="ent">➊</span>. Authenticated users have an additional <span class="literal">username</span> attribute set, which we use to personalize the greeting and remind the user they’re logged in <span class="ent">➋</span>. At <span class="ent">➌</span> we display a link to the login page for users who haven’t been authenticated.</p>
<h5 class="h4" id="calibre_link-1428"><strong class="calibre2">Using the Login Page</strong></h5>
<p class="noindent">We’ve already set up a user account, so let’s log in to see if the page works. Go to <em class="calibre3">http://localhost:8000/admin/.</em> If you’re still logged in as an admin, look for a logout link in the header and click it.</p>
<p class="indent">When you’re logged out, go to <em class="calibre3">http://localhost:8000/users/login/</em>. You should see a login page similar to the one shown in <a href="#calibre_link-75" class="calibre6">Figure 19-4</a>. Enter the username and password you set up earlier, and you should be brought back to the index page. The header on the home page should display a greeting personalized with your username.</p>
<div class="image1"><a id="calibre_link-75" class="calibre6"></a><img src="images/000068.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 19-4: The login page</em></p>
<h4 class="h3" id="calibre_link-1136"><strong class="calibre2"><em class="calibre3">Logging Out</em></strong></h4>
<p class="noindent">Now we need to provide a way for users to log out. We’ll put a link in <em class="calibre3">base.html</em> that logs out users; when they click this link, they’ll go to a page confirming that they’ve been logged out.</p>
<h5 class="h4" id="calibre_link-1429"><span type="pagebreak" id="calibre_link-459" class="calibre"></span><strong class="calibre2">Adding a Logout Link to base.html</strong></h5>
<p class="noindent">We’ll add the link for logging out to <em class="calibre3">base.html</em> so it’s available on every page. We’ll include it in the <span class="literal">{% if user.is_authenticated %}</span> portion so only users who are already logged in can see it:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>&mdash;</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">{% if user.is_authenticated %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Hello, {{ user.username }}.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'users:logout' %}"&gt;Log out&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;<span class="ash">{% else %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">The default named URL pattern for logging out is simply <span class="literal">'logout'</span>.</p>
<h5 class="h4" id="calibre_link-1430"><strong class="calibre2">The Logout Confirmation Page</strong></h5>
<p class="noindent">Users will want to know that they’ve successfully logged out, so the default logout view renders the page using the template <em class="calibre3">logged_out.html</em>, which we’ll create now. Here’s a simple page confirming that the user has been logged out. Save this file in <em class="calibre3">templates/registration</em>, the same place where you saved <em class="calibre3">login.html</em>:</p>
<p class="margin"><em class="calibre3">logged_out.html</em></p>
<p class="programs">{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
{% block content %}<br class="calibre4" />
&nbsp;&nbsp;&lt;p&gt;You have been logged out. Thank you for visiting!&lt;/p&gt;<br class="calibre4" />
{% endblock content %}</p>
<p class="indent">We don’t need anything else on this page, because <em class="calibre3">base.html</em> provides links back to the home page and the login page if the user wants to go back to either page.</p>
<p class="indent"><a href="#calibre_link-76" class="calibre6">Figure 19-5</a> shows the logged out page as it appears to a user who has just clicked the <em class="calibre3">Log out</em> link. The styling is minimal because we’re focusing on building a site that works properly. When the required set of features works, we’ll style the site to look more professional.</p>
<div class="image1"><a id="calibre_link-76" class="calibre6"></a><img src="images/000005.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 19-5: The logged out page confirms that a user has successfully logged out.</em></p>
<h4 class="h3" id="calibre_link-1137"><span type="pagebreak" id="calibre_link-353" class="calibre"></span><strong class="calibre2"><em class="calibre3">The Registration Page</em></strong></h4>
<p class="noindent">Next, we’ll build a page so new users can register. We’ll use Django’s default <span class="literal">UserCreationForm</span> but write our own view function and template.</p>
<h5 class="h4" id="calibre_link-1431"><strong class="calibre2">The register URL</strong></h5>
<p class="noindent">The following code provides the URL pattern for the registration page, again in <em class="calibre3">users/urls.py</em>:</p>
<p class="margin"><em class="calibre3">urls.py</em></p>
<p class="programs"><span class="ash">"""Defines URL patterns for users"""</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">from django.urls import path, include</span><br class="calibre4" />
<br class="calibre4" />
from . import views<br class="calibre4" />
<br class="calibre4" />
<span class="ash">app_name = 'users'</span><br class="calibre4" />
<span class="ash">urlpatterns = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Include default auth urls.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">path('', include('django.contrib.auth.urls')),</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# Registration page.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;path('register/', views.register, name='register'),<br class="calibre4" />
<span class="ash">]</span></p>
<p class="indent">We import the <span class="literal">views</span> module from <span class="literal">users</span>, which we need because we’re writing our own view for the registration page. The pattern for the registration page matches the URL <em class="calibre3">http://localhost:8000/users/register/</em> and sends requests to the <span class="literal">register()</span> function we’re about to write.</p>
<h5 class="h4" id="calibre_link-1432"><strong class="calibre2">The register() View Function</strong></h5>
<p class="noindent">The <span class="literal">register()</span> view function needs to display a blank registration form when the registration page is first requested and then process completed registration forms when they’re submitted. When a registration is successful, the function also needs to log in the new user. Add the following code to <em class="calibre3">users/views.py</em>:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;from django.shortcuts import render, redirect<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from django.contrib.auth import login<br class="calibre4" />
&nbsp;&nbsp;&nbsp;from django.contrib.auth.forms import UserCreationForm<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;def register(request):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Register a new user."""<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if request.method != 'POST':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Display blank registration form.<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = UserCreationForm()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Process completed form.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form = UserCreationForm(data=request.POST)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if form.is_valid():<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_user = form.save()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Log the user in and then redirect to home page.<br class="calibre4" />
<span type="pagebreak" id="calibre_link-361" class="calibre"></span><span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;login(request, new_user)<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return redirect('learning_logs:index')<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Display a blank or invalid form.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context = {'form': form}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return render(request, 'registration/register.html', context)</p>
<p class="indent">We import the <span class="literal">render()</span> and <span class="literal">redirect()</span> functions. Then we import the <span class="literal">login()</span> function to log the user in if their registration information is correct. We also import the default <span class="literal">UserCreationForm</span>. In the <span class="literal">register()</span> function, we check whether or not we’re responding to a POST request. If we’re not, we make an instance of <span class="literal">UserCreationForm</span> with no initial data <span class="ent">➊</span>.</p>
<p class="indent">If we’re responding to a POST request, we make an instance of <span class="literal">UserCreationForm</span> based on the submitted data <span class="ent">➋</span>. We check that the data is valid <span class="ent">➌</span>&mdash;in this case, that the username has the appropriate characters, the passwords match, and the user isn’t trying to do anything malicious in their submission.</p>
<p class="indent">If the submitted data is valid, we call the form’s <span class="literal">save()</span> method to save the username and the hash of the password to the database <span class="ent">➍</span>. The <span class="literal">save()</span> method returns the newly created user object, which we assign to <span class="literal">new_user</span>. When the user’s information is saved, we log them in by calling the <span class="literal">login()</span> function with the <span class="literal">request</span> and <span class="literal">new_user</span> objects <span class="ent">➎</span>, which creates a valid session for the new user. Finally, we redirect the user to the home page <span class="ent">➏</span>, where a personalized greeting in the header tells them their registration was successful.</p>
<p class="indent">At the end of the function we render the page, which will either be a blank form or a submitted form that is invalid.</p>
<h5 class="h4" id="calibre_link-1433"><strong class="calibre2">The register Template</strong></h5>
<p class="noindent">Now create a template for the registration page, which will be similar to the login page. Be sure to save it in the same directory as <em class="calibre3">login.html</em>:</p>
<p class="margin"><em class="calibre3">register.html</em></p>
<p class="programs">{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
{% block content %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&lt;form method="post" action="{% url 'users:register' %}"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;{% csrf_token %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;{{ form.as_p }}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;button name="submit"&gt;Register&lt;/button&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type="hidden" name="next" value="{% url 'learning_logs:index' %}" /&gt;<br class="calibre4" />
&nbsp;&nbsp;&lt;/form&gt;<br class="calibre4" />
<br class="calibre4" />
{% endblock content %}</p>
<p class="indent">We use the <span class="literal">as_p</span> method again so Django will display all the fields in the form appropriately, including any error messages if the form isn’t filled out correctly.</p>
<h5 class="h4" id="calibre_link-1434"><span type="pagebreak" id="calibre_link-354" class="calibre"></span><strong class="calibre2">Linking to the Registration Page</strong></h5>
<p class="noindent">Next, we’ll add the code to show the registration page link to any user who isn’t currently logged in:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">{% if user.is_authenticated %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">Hello, {{ user.username }}.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;a href="{% url 'users:logout' %}"&gt;Log out&lt;/a&gt;</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">{% else %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="{% url 'users:register' %}"&gt;Register&lt;/a&gt; -<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;a href="{% url 'users:login' %}"&gt;Log in&lt;/a&gt;</span><br class="calibre4" />
&nbsp;&nbsp;<span class="ash">{% endif %}</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Now users who are logged in see a personalized greeting and a logout link. Users who aren’t logged in see a registration page link and a login link. Try out the registration page by making several user accounts with different usernames.</p>
<p class="indent">In the next section, we’ll restrict some of the pages so they’re available only to registered users, and we’ll make sure every topic belongs to a specific user.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The registration system we’ve set up allows anyone to make any number of accounts for Learning Log. But some systems require users to confirm their identity by sending a confirmation email the user must reply to. By doing so, the system generates fewer spam accounts than the simple system we’re using here. However, when you’re learning to build apps, it’s perfectly appropriate to practice with a simple user registration system like the one we’re using.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1138"><strong class="calibre2">19-2. Blog Accounts:</strong> Add a user authentication and registration system to the Blog project you started in <a href="#calibre_link-77" class="calibre6">Exercise 19-1</a> (<a href="#calibre_link-78" class="calibre6">page 421</a>). Make sure logged-in users see their username somewhere on the screen and unregistered users see a link to the registration page.</p>
</div>
<h3 class="h2" id="calibre_link-1139"><strong class="calibre2">Allowing Users to Own Their Data</strong></h3>
<p class="noindent">Users should be able to enter data exclusive to them, so we’ll create a system to figure out which data belongs to which user. Then we’ll restrict access to certain pages so users can work with only their own data.</p>
<p class="indent">We’ll modify the <span class="literal">Topic</span> model so every topic belongs to a specific user. This will also take care of entries, because every entry belongs to a specific topic. We’ll start by restricting access to certain pages.</p>
<h4 class="h3" id="calibre_link-1140"><span type="pagebreak" id="calibre_link-290" class="calibre"></span><strong class="calibre2"><em class="calibre3">Restricting Access with @login_required</em></strong></h4>
<p class="noindent">Django makes it easy to restrict access to certain pages to logged-in users through the <span class="literal">@login_required</span> decorator. A <em class="calibre3">decorator</em> is a directive placed just before a function definition that Python applies to the function before it runs, to alter how the function code behaves. Let’s look at an example.</p>
<h5 class="h4" id="calibre_link-1435"><strong class="calibre2">Restricting Access to the Topics Page</strong></h5>
<p class="noindent">Each topic will be owned by a user, so only registered users can request the topics page. Add the following code to <em class="calibre3">learning_logs/views.py</em>:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs"><span class="ash">from django.shortcuts import render, redirect</span><br class="calibre4" />
from django.contrib.auth.decorators import login_required<br class="calibre4" />
<br class="calibre4" />
<span class="ash">from .models import Topic, Entry</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
@login_required<br class="calibre4" />
<span class="ash">def topics(request):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Show all topics."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We first import the <span class="literal">login_required()</span> function. We apply <span class="literal">login_required()</span> as a decorator to the <span class="literal">topics()</span> view function by prepending <span class="literal">login_required</span> with the <span class="literal">@</span> symbol. As a result, Python knows to run the code in <span class="literal">login_required()</span> before the code in <span class="literal">topics()</span>.</p>
<p class="indent">The code in <span class="literal">login_required()</span> checks whether a user is logged in, and Django runs the code in <span class="literal">topics()</span> only if they are. If the user isn’t logged in, they’re redirected to the login page.</p>
<p class="indent">To make this redirect work, we need to modify <em class="calibre3">settings.py</em> so Django knows where to find the login page. Add the following at the very end of <em class="calibre3">settings.py</em>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
# My settings<br class="calibre4" />
LOGIN_URL = 'users:login'</p>
<p class="indent">Now when an unauthenticated user requests a page protected by the <span class="literal">@login_required</span> decorator, Django will send the user to the URL defined by <span class="literal">LOGIN_URL</span> in <em class="calibre3">settings.py</em>.</p>
<p class="indent">You can test this setting by logging out of any user accounts and going to the home page. Click the <strong class="calibre2">Topics</strong> link, which should redirect you to the login page. Then log in to any of your accounts, and from the home page click the <strong class="calibre2">Topics</strong> link again. You should be able to access the topics page.</p>
<h5 class="h4" id="calibre_link-1436"><span type="pagebreak" id="calibre_link-463" class="calibre"></span><strong class="calibre2">Restricting Access Throughout Learning Log</strong></h5>
<p class="noindent">Django makes it easy to restrict access to pages, but you have to decide which pages to protect. It’s best to think about which pages need to be unrestricted first, and then restrict all the other pages in the project. You can easily correct overrestricting access, and it’s less dangerous than leaving sensitive pages unrestricted.</p>
<p class="indent">In Learning Log, we’ll keep the home page and the registration page unrestricted. We’ll restrict access to every other page.</p>
<p class="indent">Here’s <em class="calibre3">learning_logs/views.py</em> with <span class="literal">@login_required</span> decorators applied to every view except <span class="literal">index()</span>:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">@login_required</span><br class="calibre4" />
<span class="ash">def topics(request):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
@login_required<br class="calibre4" />
<span class="ash">def topic(request, topic_id):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
@login_required<br class="calibre4" />
<span class="ash">def new_topic(request):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
@login_required<br class="calibre4" />
<span class="ash">def new_entry(request, topic_id):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<br class="calibre4" />
@login_required<br class="calibre4" />
<span class="ash">def edit_entry(request, entry_id):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Try accessing each of these pages while logged out: you’ll be redirected back to the login page. You’ll also be unable to click links to pages such as <span class="literal">new_topic</span>. But if you enter the URL <em class="calibre3">http://localhost:8000/new_topic/</em>, you’ll be redirected to the login page. You should restrict access to any URL that’s publicly accessible and relates to private user data.</p>
<h4 class="h3" id="calibre_link-1141"><strong class="calibre2"><em class="calibre3">Connecting Data to Certain Users</em></strong></h4>
<p class="noindent">Next, we need to connect the data to the user who submitted it. We need to connect only the data highest in the hierarchy to a user, and the lower-level data will follow. For example, in Learning Log, topics are the highest level of data in the app, and all entries are connected to a topic. As long as each topic belongs to a specific user, we can trace the ownership of each entry in the database.</p>
<p class="indent">We’ll modify the <span class="literal">Topic</span> model by adding a foreign key relationship to a user. We’ll then have to migrate the database. Finally, we’ll modify some of the views so they only show the data associated with the currently logged in user.</p>
<h5 class="h4" id="calibre_link-1437"><span type="pagebreak" id="calibre_link-350" class="calibre"></span><strong class="calibre2">Modifying the Topic Model</strong></h5>
<p class="noindent">The modification to <em class="calibre3">models.py</em> is just two lines:</p>
<p class="margin"><em class="calibre3">models.py</em></p>
<p class="programs"><span class="ash">from django.db import models</span><br class="calibre4" />
from django.contrib.auth.models import User<br class="calibre4" />
<br class="calibre4" />
<span class="ash">class Topic(models.Model):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">"""A topic the user is learning about."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">text = models.CharField(max_length=200)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">date_added = models.DateTimeField(auto_now_add=True)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;owner = models.ForeignKey(User, on_delete=models.CASCADE)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">def __str__(self):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Return a string representation of the model."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return self.text</span><br class="calibre4" />
<br class="calibre4" />
<span class="ash">class Entry(models.Model):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We import the <span class="literal">User</span> model from <span class="literal">django.contrib.auth</span>. Then we add an <span class="literal">owner</span> field to <span class="literal">Topic</span>, which establishes a foreign key relationship to the <span class="literal">User</span> model. If a user is deleted, all the topics associated with that user will be deleted as well.</p>
<h5 class="h4" id="calibre_link-1438"><strong class="calibre2">Identifying Existing Users</strong></h5>
<p class="noindent">When we migrate the database, Django will modify the database so it can store a connection between each topic and a user. To make the migration, Django needs to know which user to associate with each existing topic. The simplest approach is to start by giving all existing topics to one user&mdash;for example, the superuser. But first we need to know that user’s ID.</p>
<p class="indent">Let’s look at the IDs of all users created so far. Start a Django shell session and issue the following commands:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py shell</span><br class="calibre4" />
<span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">from django.contrib.auth.models import User</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">User.objects.all()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&lt;QuerySet [&lt;User: ll_admin&gt;, &lt;User: eric&gt;, &lt;User: willie&gt;]&gt;<br class="calibre4" />
<span class="ent">➌</span> &gt;&gt;&gt; <span class="codestrong">for user in User.objects.all():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codestrong">print(user.username, user.id)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;...<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ll_admin 1<br class="calibre4" />
&nbsp;&nbsp;&nbsp;eric 2<br class="calibre4" />
&nbsp;&nbsp;&nbsp;willie 3<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;</p>
<p class="indent">At <span class="ent">➊</span> we import the <span class="literal">User</span> model into the shell session. We then look at all the users that have been created so far <span class="ent">➋</span>. The output shows three users: <em class="calibre3">ll_admin</em>, <em class="calibre3">eric</em>, and <em class="calibre3">willie</em>.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-325" class="calibre"></span>At <span class="ent">➌</span> we loop through the list of users and print each user’s username and ID. When Django asks which user to associate the existing topics with, we’ll use one of these ID values.</p>
<h5 class="h4" id="calibre_link-1439"><strong class="calibre2">Migrating the Database</strong></h5>
<p class="noindent">Now that we know the IDs, we can migrate the database. When we do this, Python will ask us to connect the <span class="literal">Topic</span> model to a particular owner temporarily or to add a default to our <em class="calibre3">models.py</em> file to tell it what to do. Choose option 1:</p>
<p class="programs"><span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">python manage.py makemigrations learning_logs</span><br class="calibre4" />
<span class="ent">➋</span> You are trying to add a non-nullable field 'owner' to topic without a default;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;we can't do that (the database needs something to populate existing rows).<br class="calibre4" />
<span class="ent">➌</span> Please select a fix:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;1) Provide a one-off default now (will be set on all existing rows with a<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null value for this column)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;2) Quit, and let me add a default in models.py<br class="calibre4" />
<span class="ent">➍</span> Select an option: <span class="codestrong">1</span><br class="calibre4" />
<span class="ent">➎</span> Please enter the default value now, as valid Python<br class="calibre4" />
&nbsp;&nbsp;&nbsp;The datetime and django.utils.timezone modules are available, so you can do e.g. timezone.now<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Type 'exit' to exit this prompt<br class="calibre4" />
<span class="ent">➏</span> &gt;&gt;&gt; <span class="codestrong">1</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Migrations for 'learning_logs':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;learning_logs/migrations/0003_topic_owner.py<br class="calibre4" />
&nbsp;&nbsp;&nbsp;- Add field owner to topic<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">We start by issuing the <span class="literal">makemigrations</span> command <span class="ent">➊</span>. In the output at <span class="ent">➋</span>, Django indicates that we’re trying to add a required (<span class="literal">non-nullable</span>) field to an existing model (<span class="literal">topic</span>) with no default value specified. Django gives us two options at <span class="ent">➌</span>: we can provide a default right now, or we can quit and add a default value in <em class="calibre3">models.py</em>. At <span class="ent">➍</span> we’ve chosen the first option. Django then asks us to enter the default value <span class="ent">➎</span>.</p>
<p class="indent">To associate all existing topics with the original admin user, <em class="calibre3">ll_admin</em>, I entered the user ID of 1 at <span class="ent">➏</span>. You can use the ID of any user you’ve created; it doesn’t have to be a superuser. Django then migrates the database using this value and generates the migration file <em class="calibre3">0003_topic_owner.py</em>, which adds the field <span class="literal">owner</span> to the <span class="literal">Topic</span> model.</p>
<p class="indent">Now we can execute the migration. Enter the following in an active virtual environment:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">python manage.py migrate</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Operations to perform:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apply all migrations: admin, auth, contenttypes, learning_logs, sessions<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Running migrations:<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;Applying learning_logs.0003_topic_owner... OK<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">Django applies the new migration, and the result is <span class="literal">OK</span> <span class="ent">➊</span>.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-324" class="calibre"></span>We can verify that the migration worked as expected in the shell session, like this:</p>
<p class="programs"><span class="ent">➊</span> &gt;&gt;&gt; <span class="codestrong">from learning_logs.models import Topic</span><br class="calibre4" />
<span class="ent">➋</span> &gt;&gt;&gt; <span class="codestrong">for topic in Topic.objects.all():</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codestrong">print(topic, topic.owner)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;...<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Chess ll_admin<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Rock Climbing ll_admin<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&gt;&gt;&gt;</p>
<p class="indent">We import <span class="literal">Topic</span> from <span class="literal">learning_logs.models</span> <span class="ent">➊</span>, and then loop through all existing topics, printing each topic and the user it belongs to <span class="ent">➋</span>. You can see that each topic now belongs to the user <em class="calibre3">ll_admin</em>. (If you get an error when you run this code, try exiting the shell and starting a new shell.)</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You can simply reset the database instead of migrating, but that will lose all existing data. It’s good practice to learn how to migrate a database while maintaining the integrity of users’ data. If you do want to start with a fresh database, issue the command <span class="codeitalic">python manage.py flush</span> to rebuild the database structure. You’ll have to create a new superuser, and all of your data will be gone.</em></p>
</div>
<h4 class="h3" id="calibre_link-1142"><strong class="calibre2"><em class="calibre3">Restricting Topics Access to Appropriate Users</em></strong></h4>
<p class="noindent">Currently, if you’re logged in, you’ll be able to see all the topics, no matter which user you’re logged in as. We’ll change that by showing users only the topics that belong to them.</p>
<p class="indent">Make the following change to the <span class="literal">topics()</span> function in <em class="calibre3">views.py</em>:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">@login_required</span><br class="calibre4" />
<span class="ash">def topics(request):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Show all topics."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;topics = Topic.objects.filter(owner=request.user).order_by('date_added')<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">context = {'topics': topics}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return render(request, 'learning_logs/topics.html', context)</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>&mdash;</span></p>
<p class="indent">When a user is logged in, the request object has a <span class="literal">request.user</span> attribute set that stores information about the user. The query <span class="literal">Topic.objects.filter(owner=request.user)</span> tells Django to retrieve only the <span class="literal">Topic</span> objects from the database whose <span class="literal">owner</span> attribute matches the current user. Because we’re not changing how the topics are displayed, we don’t need to change the template for the topics page at all.</p>
<p class="indent">To see if this works, log in as the user you connected all existing topics to, and go to the topics page. You should see all the topics. Now log out, and log back in as a different user. The topics page should list no topics.</p>
<h4 class="h3" id="calibre_link-1143"><span type="pagebreak" id="calibre_link-345" class="calibre"></span><strong class="calibre2"><em class="calibre3">Protecting a User’s Topics</em></strong></h4>
<p class="noindent">We haven’t restricted access to the topic pages yet, so any registered user could try a bunch of URLs, like <em class="calibre3">http://localhost:8000/topics/1/</em>, and retrieve topic pages that happen to match.</p>
<p class="indent">Try it yourself. While logged in as the user that owns all topics, copy the URL or note the ID in the URL of a topic, and then log out and log back in as a different user. Enter that topic’s URL. You should be able to read the entries, even though you’re logged in as a different user.</p>
<p class="indent">We’ll fix this now by performing a check before retrieving the requested entries in the <span class="literal">topic()</span> view function:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">from django.shortcuts import render, redirect</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">from django.contrib.auth.decorators import login_required</span><br class="calibre4" />
<span class="ent">➊</span> from django.http import Http404<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">@login_required</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">def topic(request, topic_id):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Show a single topic and all its entries."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">topic = Topic.objects.get(id=topic_id)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make sure the topic belongs to the current user.<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if topic.owner != request.user:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise Http404<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">entries = topic.entry_set.order_by('-date_added')</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">context = {'topic': topic, 'entries': entries}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return render(request, 'learning_logs/topic.html', context)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">A 404 response is a standard error response that’s returned when a requested resource doesn’t exist on a server. Here we import the <span class="literal">Http404</span> exception <span class="ent">➊</span>, which we’ll raise if the user requests a topic they shouldn’t see. After receiving a topic request, we make sure the topic’s user matches the currently logged in user before rendering the page. If the current user doesn’t own the requested topic, we raise the <span class="literal">Http404</span> exception <span class="ent">➋</span>, and Django returns a 404 error page.</p>
<p class="indent">Now if you try to view another user’s topic entries, you’ll see a <em class="calibre3">Page Not Found</em> message from Django. In <a href="#calibre_link-19" class="calibre6">Chapter 20</a>, we’ll configure the project so users will see a proper error page.</p>
<h4 class="h3" id="calibre_link-1144"><strong class="calibre2"><em class="calibre3">Protecting the edit_entry Page</em></strong></h4>
<p class="noindent">The <span class="literal">edit_entry</span> pages have URLs in the form <span class="literal">http://localhost:8000/edit_entry/</span><span class="codeitalic">entry_id</span><span class="literal">/</span>, where the <span class="codeitalic">entry_id</span> is a number. Let’s protect this page so no one can use the URL to gain access to someone else’s entries:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">@login_required</span><br class="calibre4" />
<span class="ash">def edit_entry(request, entry_id):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Edit an existing entry."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">entry = Entry.objects.get(id=entry_id)</span><br class="calibre4" />
<span type="pagebreak" id="calibre_link-317" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">topic = entry.topic</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;if topic.owner != request.user:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise Http404<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if request.method != 'POST':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">We retrieve the entry and the topic associated with this entry. We then check whether the owner of the topic matches the currently logged in user; if they don’t match, we raise an <span class="literal">Http404</span> exception.</p>
<h4 class="h3" id="calibre_link-1145"><strong class="calibre2"><em class="calibre3">Associating New Topics with the Current User</em></strong></h4>
<p class="noindent">Currently, our page for adding new topics is broken, because it doesn’t associate new topics with any particular user. If you try adding a new topic, you’ll see the error message <span class="literal">IntegrityError</span> along with <span class="literal">NOT NULL constraint failed: learning_logs_topic.owner_id</span>. Django’s saying you can’t create a new topic without specifying a value for the topic’s <span class="literal">owner</span> field.</p>
<p class="indent">There’s a straightforward fix for this problem, because we have access to the current user through the <span class="literal">request</span> object. Add the following code, which associates the new topic with the current user:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">@login_required</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">def new_topic(request):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Add a new topic."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if request.method != 'POST':</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># No data submitted; create a blank form.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">form = TopicForm()</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">else:</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># POST data submitted; process data.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">form = TopicForm(data=request.POST)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">if form.is_valid():</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_topic = form.save(commit=False)<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_topic.owner = request.user<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_topic.save()<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return redirect('learning_logs:topics')</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Display a blank or invalid form.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">context = {'form': form}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">return render(request, 'learning_logs/new_topic.html', context)</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">When we first call <span class="literal">form.save()</span>, we pass the <span class="literal">commit=False</span> argument because we need to modify the new topic before saving it to the database <span class="ent">➊</span>. We then set the new topic’s <span class="literal">owner</span> attribute to the current user <span class="ent">➋</span>. Finally, we call <span class="literal">save()</span> on the topic instance just defined <span class="ent">➌</span>. Now the topic has all the required data and will save successfully.</p>
<p class="indent">You should be able to add as many new topics as you want for as many different users as you want. Each user will have access only to their own data, whether they’re viewing data, entering new data, or modifying old data.</p>
<div class="sidebar">
<p class="sidebart"><span type="pagebreak" id="calibre_link-1440" class="calibre"></span><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1146"><strong class="calibre2">19-3. Refactoring:</strong> There are two places in <em class="calibre3">views.py</em> where we make sure the user associated with a topic matches the currently logged in user. Put the code for this check in a function called <span class="literal1">check_topic_owner()</span>, and call this function where appropriate.</p>
<p class="sparal" id="calibre_link-1147"><strong class="calibre2">19-4. Protecting new_entry:</strong> Currently, a user can add a new entry to another user’s learning log by entering a URL with the ID of a topic belonging to another user. Prevent this attack by checking that the current user owns the entry’s topic before saving the new entry.</p>
<p class="sparal" id="calibre_link-1148"><strong class="calibre2">19-5. Protected Blog:</strong> In your Blog project, make sure each blog post is connected to a particular user. Make sure all posts are publicly accessible but only registered users can add posts and edit existing posts. In the view that allows users to edit their posts, make sure the user is editing their own post before processing the form.</p>
</div>
<h3 class="h2" id="calibre_link-1149"><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned to use forms to allow users to add new topics and entries, and edit existing entries. You then learned how to implement user accounts. You allowed existing users to log in and out, and used Django’s default <span class="literal">UserCreationForm</span> to let people create new accounts.</p>
<p class="indent">After building a simple user authentication and registration system, you restricted access to logged-in users for certain pages using the <span class="literal">@login_required</span> decorator. You then attributed data to specific users through a foreign key relationship. You also learned to migrate the database when the migration requires you to specify some default data.</p>
<p class="indent">Finally, you learned how to make sure a user can only see data that belongs to them by modifying the view functions. You retrieved appropriate data using the <span class="literal">filter()</span> method and compared the owner of the requested data to the currently logged in user.</p>
<p class="indent">It might not always be immediately obvious what data you should make available and what data you should protect, but this skill will come with practice. The decisions we’ve made in this chapter to secure our users’ data also illustrate why working with others is a good idea when building a project: having someone else look over your project makes it more likely that you’ll spot vulnerable areas.</p>
<p class="indent">You now have a fully functioning project running on your local machine. In the final chapter, you’ll style Learning Log to make it visually appealing, and you’ll deploy the project to a server so anyone with internet access can register and make an account.</p>
</div>


<div class="calibre1" id="calibre_link-100">
<h2 class="h" id="calibre_link-19"><span type="pagebreak" id="calibre_link-430" class="calibre"></span><strong class="calibre2"><span class="big">20</span><br class="calibre4" />STYLING AND DEPLOYING AN APP</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Learning Log is fully functional now, but it has no styling and runs only on your local machine. In this chapter, you’ll style the project in a simple but professional manner and then deploy it to a live server so anyone in the world can make an account and use it.</p>
<p class="indent">For the styling we’ll use the Bootstrap library, a collection of tools for styling web applications so they look professional on all modern devices, from a large flat-screen monitor to a smartphone. To do this, we’ll use the django-bootstrap4 app, which will also give you practice using apps made by other Django developers.</p>
<p class="indent">We’ll deploy Learning Log using Heroku, a site that lets you push your project to one of its servers, making it available to anyone with an internet connection. We’ll also start using a version control system called Git to track changes to the project.</p>
<p class="indent">When you’re finished with Learning Log, you’ll be able to develop simple web applications, make them look good, and deploy them to a live server. You’ll also be able to use more advanced learning resources as you develop your skills.</p>
<h3 class="h2" id="calibre_link-1150"><span type="pagebreak" id="calibre_link-253" class="calibre"></span><strong class="calibre2">Styling Learning Log</strong></h3>
<p class="noindent">We’ve purposely ignored styling until now to focus on Learning Log’s functionality first. This is a good way to approach development, because an app is useful only if it works. Of course, once it’s working, appearance is critical so people will want to use it.</p>
<p class="indent">In this section, I’ll introduce the django-bootstrap4 app and show you how to integrate it into a project to make it ready for live deployment.</p>
<h4 class="h3" id="calibre_link-1151"><strong class="calibre2"><em class="calibre3">The django-bootstrap4 App</em></strong></h4>
<p class="noindent">We’ll use django-bootstrap4 to integrate Bootstrap into our project. This app downloads the required Bootstrap files, places them in an appropriate location in your project, and makes the styling directives available in your project’s templates.</p>
<p class="indent">To install django-bootstrap4, issue the following command in an active virtual environment:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">pip install django-bootstrap4</span><br class="calibre4" />
--<span class="codeitalic1">snip</span>--<br class="calibre4" />
Successfully installed django-bootstrap4-0.0.7</p>
<p class="indent">Next, we need to add the following code to include django-bootstrap4 in <span class="literal">INSTALLED_APPS</span> in <em class="calibre3">settings.py</em>:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">INSTALLED_APPS = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># My apps.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'learning_logs',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'users',</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;# Third party apps.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;'bootstrap4',<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Default django apps.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'django.contrib.admin',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Start a new section called <em class="calibre3">Third party apps</em> for apps created by other developers and add <span class="literal">'bootstrap4'</span> to this section. Make sure you place this section after <span class="literal"># My apps</span> but before the section containing Django’s default apps.</p>
<h4 class="h3" id="calibre_link-1152"><strong class="calibre2"><em class="calibre3">Using Bootstrap to Style Learning Log</em></strong></h4>
<p class="noindent">Bootstrap is a large collection of styling tools. It also has a number of templates you can apply to your project to create an overall style. It’s much easier to use these templates than it is to use individual styling tools. To see the templates Bootstrap offers, go to <em class="calibre3"><a href="https://getbootstrap.com/" class="calibre6">https://getbootstrap.com/</a></em>, click <strong class="calibre2">Examples</strong>, and look for the <em class="calibre3">Navbars</em> section. We’ll use the <em class="calibre3">Navbar static</em> template, which provides a simple top navigation bar and a container for the page’s content.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-320" class="calibre"></span><a href="#calibre_link-101" class="calibre6">Figure 20-1</a> shows what the home page will look like after we apply Bootstrap’s template to <em class="calibre3">base.html</em> and modify <em class="calibre3">index.html</em> slightly.</p>
<div class="image1"><a id="calibre_link-101" class="calibre6"></a><img src="images/000010.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 20-1: The Learning Log home page using Bootstrap</em></p>
<h4 class="h3" id="calibre_link-1153"><strong class="calibre2"><em class="calibre3">Modifying base.html</em></strong></h4>
<p class="noindent">We need to modify the <em class="calibre3">base.html</em> template to accommodate the Bootstrap template. I’ll introduce the new <em class="calibre3">base.html</em> in parts.</p>
<h5 class="h4" id="calibre_link-1441"><strong class="calibre2">Defining the HTML Headers</strong></h5>
<p class="noindent">The first change we’ll make to <em class="calibre3">base.html</em> defines the HTML headers in the file, so whenever a Learning Log page is open, the browser title bar displays the site name. We’ll also add some requirements for using Bootstrap in our templates. Delete everything in <em class="calibre3">base.html</em> and replace it with the following code:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs"><span class="ent">➊</span> {% load bootstrap4 %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> &lt;!doctype html&gt;<br class="calibre4" />
<span class="ent">➌</span> &lt;html lang="en"&gt;<br class="calibre4" />
<span class="ent">➍</span> &lt;head&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta charset="utf-8"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="viewport" content="width=device-width, initial-scale=1,<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shrink-to-fit=no"&gt;<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&lt;title&gt;Learning Log&lt;/title&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➏</span>&nbsp;&nbsp;&nbsp;{% bootstrap_css %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% bootstrap_javascript jquery='full' %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➐</span> &lt;/head&gt;</p>
<p class="indent"><span type="pagebreak" id="calibre_link-251" class="calibre"></span>At <span class="ent">➊</span> we load the collection of template tags available in django-bootstrap4. Next, we declare this file as an HTML document <span class="ent">➋</span> written in English <span class="ent">➌</span>. An HTML file is divided into two main parts, the <em class="calibre3">head</em> and the <em class="calibre3">body</em>&mdash;the head of the file begins at <span class="ent">➍</span>. The head of an HTML file doesn’t contain any content: it just tells the browser what it needs to know to display the page correctly. At <span class="ent">➎</span> we include a <span class="literal">title</span> element for the page, which will display in the browser’s title bar whenever Learning Log is open.</p>
<p class="indent">At <span class="ent">➏</span> we use one of django-bootstrap4’s custom template tags, which tells Django to include all the Bootstrap style files. The tag that follows enables all the interactive behavior you might use on a page, such as collapsible navigation bars. At <span class="ent">➐</span> is the closing <span class="literal">&lt;/head&gt;</span> tag.</p>
<h5 class="h4" id="calibre_link-1442"><strong class="calibre2">Defining the Navigation Bar</strong></h5>
<p class="noindent">The code that defines the navigation bar at the top of the page is fairly long, because it has to work well on narrow phone screens and wide desktop monitors. We’ll work through the navigation bar in sections.</p>
<p class="indent">Here’s the first part of the navigation bar:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/head&gt;</span><br class="calibre4" />
<span class="ent">➊</span> &lt;body&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&lt;nav class="navbar navbar-expand-md navbar-light bg-light mb-4 border"&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a class="navbar-brand" href="{% url 'learning_logs:index'%}"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Learning Log&lt;/a&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button class="navbar-toggler" type="button" data-toggle="collapse"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-target="#navbarCollapse" aria-controls="navbarCollapse"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aria-expanded="false" aria-label="Toggle navigation"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;&lt;/button&gt;</p>
<p class="indent">The first element is the opening <span class="literal">&lt;body&gt;</span> tag <span class="ent">➊</span>. The <em class="calibre3">body</em> of an HTML file contains the content users will see on a page. At <span class="ent">➋</span> is a <span class="literal">&lt;nav&gt;</span> element that indicates the page’s navigation links section. Everything contained in this element is styled according to the Bootstrap style rules defined by the selectors <span class="literal">navbar</span>, <span class="literal">navbar-expand-md</span>, and the rest that you see here. A <em class="calibre3">selector</em> determines which elements on a page a certain style rule applies to. The <span class="literal">navbar-light</span> and <span class="literal">bg-light</span> selectors style the navigation bar with a light-themed background. The <span class="literal">mb</span> in <span class="literal">mb-4</span> is short for <em class="calibre3">margin-bottom</em>; this selector ensures that a little space appears between the navigation bar and the rest of the page. The <span class="literal">border</span> selector provides a thin border around the light background to set it off a little from the rest of the page.</p>
<p class="indent">At <span class="ent">➌</span> we set the project’s name to appear at the far left of the navigation bar and make it a link to the home page; it will appear on every page in the project. The <span class="literal">navbar-brand</span> selector styles this link so it stands out from the rest of the links and is a way of branding the site.</p>
<p class="indent">At <span class="ent">➍</span> the template defines a button that appears if the browser window is too narrow to display the whole navigation bar horizontally. When the <span type="pagebreak" id="calibre_link-310" class="calibre"></span>user clicks the button, the navigation elements will appear in a drop-down list. The <span class="literal">collapse</span> reference causes the navigation bar to collapse when the user shrinks the browser window or when the site is displayed on mobile devices with small screens.</p>
<p class="indent">Here’s the next section of code that defines the navigation bar:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;&lt;/button&gt;</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="collapse navbar-collapse" id="navbarCollapse"&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul class="navbar-nav mr-auto"&gt;<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="nav-item"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a class="nav-link" href="{% url 'learning_logs:topics'%}"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Topics&lt;/a&gt;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;</p>
<p class="indent">At <span class="ent">➊</span> we open a new section of the navigation bar. The term <em class="calibre3">div</em> is short for division; you build a web page by dividing it into sections and defining style and behavior rules that apply to that section. Any styling or behavior rules that are defined in an opening div tag affect everything you see until the next closing div tag, which is written as <span class="literal">&lt;/div&gt;</span>. This is the beginning of the part of the navigation bar that will be collapsed on narrow screens and windows.</p>
<p class="indent">At <span class="ent">➋</span> we define a new set of links. Bootstrap defines navigation elements as items in an unordered list with style rules that make it look nothing like a list. Every link or element you need on the bar can be included as an item in one of these lists. Here, the only item in the list is our link to the Topics page <span class="ent">➌</span>.</p>
<p class="indent">Here’s the next part of the navigation bar:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/ul&gt;</span><br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul class="navbar-nav ml-auto"&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% if user.is_authenticated %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="nav-item"&gt;<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span class="navbar-text"}"&gt;Hello, {{ user.username }}.&lt;/span&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="nav-item"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a class="nav-link" href="{% url 'users:logout' %}"&gt;Log out&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% else %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="nav-item"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a class="nav-link" href="{% url 'users:register' %}"&gt;Register&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="nav-item"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a class="nav-link" href="{% url 'users:login' %}"&gt;Log in&lt;/a&gt;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% endif %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/nav&gt;</p>
<p class="indent"><span type="pagebreak" id="calibre_link-321" class="calibre"></span>At <span class="ent">➊</span> we begin a new set of links by using another opening <span class="literal">&lt;ul&gt;</span> tag. You can have as many groups of links as you need on a page. This will be the group of links related to login and registration that appears on the right side of the navigation bar. The selector <span class="literal">ml-auto</span> is short for <em class="calibre3">margin-left-automatic</em>: this selector examines the other elements in the navigation bar and works out a left margin that pushes this group of links to the right side of the screen.</p>
<p class="indent">The <span class="literal">if</span> block at <span class="ent">➋</span> is the same conditional block we used earlier to display appropriate messages to users depending on whether or not they’re logged in. The block is a little longer now because some styling rules are inside the conditional tags. At <span class="ent">➌</span> is a <span class="literal">&lt;span&gt;</span> element. The <em class="calibre3">span element</em> styles pieces of text, or elements of a page, that are part of a longer line. Whereas div elements create their own division in a page, span elements are continuous within a larger section. This can be confusing at first, because many pages have deeply nested div elements. Here, we’re using the span element to style informational text on the navigation bar, such as the logged-in user’s name. We want this information to appear different from a link, so users aren’t tempted to click these elements.</p>
<p class="indent">At <span class="ent">➍</span> we close the div element that contains the parts of the navigation bar that will collapse on narrow screens, and at the end of this section we close the navigation bar overall. If you wanted to add more links to the navigation bar, you’d add another <span class="literal">&lt;li&gt;</span> item to any of the <span class="literal">&lt;ul&gt;</span> groups that we’ve defined in the navigation bar by using identical styling directives as what you’ve seen here.</p>
<p class="indent">There’s still a bit more we need to add to <em class="calibre3">base.html</em>. We need to define two blocks that the individual pages can use to place the content specific to those pages.</p>
<h5 class="h4" id="calibre_link-1443"><strong class="calibre2">Defining the Main Part of the Page</strong></h5>
<p class="noindent">The rest of <em class="calibre3">base.html</em> contains the main part of the page:</p>
<p class="margin"><em class="calibre3">base.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/nav&gt;</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&lt;main role="main" class="container"&gt;<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="pb-2 mb-2 border-bottom"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% block page_header %}{% endblock page_header %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% block content %}{% endblock content %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/main&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&lt;/html&gt;</p>
<p class="indent">At <span class="ent">➊</span> we open a <span class="literal">&lt;main&gt;</span> tag. The <em class="calibre3">main</em> element is used for the most significant part of the body of a page. Here we assign the bootstrap selector <span type="pagebreak" id="calibre_link-319" class="calibre"></span><span class="literal">container</span>, which is a simple way to group elements on a page. We’ll place two div elements in this container.</p>
<p class="indent">The first div element <span class="ent">➋</span> contains a <span class="literal">page_header</span> block. We’ll use this block to title most pages. To make this section stand out from the rest of the page, we place some padding below the header. <em class="calibre3">Padding</em> refers to space between an element’s content and its border. The selector <span class="literal">pb-2</span> is a bootstrap directive that provides a moderate amount of padding at the bottom of the styled element. A <em class="calibre3">margin</em> is the space between an element’s border and other elements on the page. We want a border only on the bottom of the page, so we use the selector <span class="literal">border-bottom</span>, which provides a thin border at the bottom of the <span class="literal">page_header</span> block.</p>
<p class="indent">At <span class="ent">➌</span> we define one more div element, which contains the block <span class="literal">content</span>. We don’t apply any specific style to this block, so we can style the content of any page as we see fit for that page. We end the <em class="calibre3">base.html</em> file with closing tags for the <span class="literal">main</span>, <span class="literal">body</span>, and <span class="literal">html</span> elements.</p>
<p class="indent">When you load Learning Log’s home page in a browser, you should see a professional-looking navigation bar that matches the one shown in <a href="#calibre_link-101" class="calibre6">Figure 20-1</a>. Try resizing the window so it’s very narrow; a button should replace the navigation bar. Click the button, and all the links should appear in a drop-down list.</p>
<h4 class="h3" id="calibre_link-1154"><strong class="calibre2"><em class="calibre3">Styling the Home Page Using a Jumbotron</em></strong></h4>
<p class="noindent">To update the home page, we’ll use a Bootstrap element called a <em class="calibre3">jumbotron</em>, which is a large box that stands out from the rest of the page and can contain anything you want. Typically, it’s used on home pages to hold a brief description of the overall project and a call to action that invites the viewer to get involved.</p>
<p class="indent">Here’s the revised <em class="calibre3">index.html</em> file:</p>
<p class="margin"><em class="calibre3">index.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">{% extends "learning_logs/base.html" %}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> {% block page_header %}<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&lt;div class="jumbotron"&gt;<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1 class="display-3"&gt;Track your learning.&lt;/h1&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p class="lead"&gt;Make your own Learning Log, and keep a list of the<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topics you're learning about. Whenever you learn something new<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;about a topic, make an entry summarizing what you've learned.&lt;/p&gt;<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a class="btn btn-lg btn-primary" href="{% url 'users:register' %}"<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;role="button"&gt;Register »&lt;/a&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br class="calibre4" />
<span class="ent">➏</span> {% endblock page_header %}</p>
<p class="indent">At <span class="ent">➊</span> we tell Django that we’re about to define what goes in the <span class="literal">page_header</span> block. A jumbotron is just a div element with a set of styling directives applied to it <span class="ent">➋</span>. The <span class="literal">jumbotron</span> selector applies this group of styling directives from the Bootstrap library to this element.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-322" class="calibre"></span>Inside the jumbotron are three elements. The first is a short message, <em class="calibre3">Track your learning</em>, that gives first-time visitors a sense of what Learning Log does. The <span class="literal">h1</span> class is a first-level header, and the <span class="literal">display-3</span> selector adds a thinner and taller look to this particular header <span class="ent">➌</span>. At <span class="ent">➍</span> we include a longer message that provides more information about what the user can do with their learning log.</p>
<p class="indent">Rather than just using a text link, we create a button at <span class="ent">➎</span> that invites users to register their Learning Log account. This is the same link as in the header, but the button stands out on the page and shows the viewer what they need to do to start using the project. The selectors you see here style this as a large button that represents a call to action. The code <span class="literal">»</span> is an <em class="calibre3">HTML entity</em> that looks like two right angle brackets combined (&gt;&gt;). At <span class="ent">➏</span> we close the <span class="literal">page_header</span> block. We aren’t adding any more content to this page, so we don’t need to define the <span class="literal">content</span> block on this page.</p>
<p class="indent">The index page now looks like <a href="#calibre_link-101" class="calibre6">Figure 20-1</a> and is a significant improvement over our unstyled project.</p>
<h4 class="h3" id="calibre_link-1155"><strong class="calibre2"><em class="calibre3">Styling the Login Page</em></strong></h4>
<p class="noindent">We’ve refined the overall appearance of the login page but not the login form yet. Let’s make the form look consistent with the rest of the page by modifying the <em class="calibre3">login.html</em> file:</p>
<p class="margin"><em class="calibre3">login.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">{% extends "learning_logs/base.html" %}</span><br class="calibre4" />
<span class="ent">➊</span> {% load bootstrap4 %}<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> {% block page_header %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h2&gt;Log in to your account.&lt;/h2&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock page_header %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% block content %}</span><br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&lt;form method="post" action="{% url 'users:login' %}" class="form"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% csrf_token %}</span><br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% bootstrap_form form %}<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% buttons %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button name="submit" class="btn btn-primary"&gt;Log in&lt;/button&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% endbuttons %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;input type="hidden" name="next"</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">value="{% url 'learning_logs:index' %}" /&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/form&gt;</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% endblock content %}</span></p>
<p class="indent">At <span class="ent">➊</span> we load the bootstrap4 template tags into this template. At <span class="ent">➋</span> we define the <span class="literal">page_header</span> block, which tells the user what the page is for. Notice that we’ve removed the <span class="literal">{% if form.errors %}</span> block from the template; django-bootstrap4 manages form errors automatically.</p>
<p class="indent">At <span class="ent">➌</span> we add a <span class="literal">class="form"</span> attribute, and then we use the template tag <span class="literal">{% bootstrap_form %}</span> when we display the form <span class="ent">➍</span>; this replaces the <span class="literal">{{ form.as_p }}</span> tag we were using in <a href="#calibre_link-18" class="calibre6">Chapter 19</a>. The <span class="literal">{% booststrap_form %}</span> template <span type="pagebreak" id="calibre_link-323" class="calibre"></span>tag inserts Bootstrap style rules into the form’s individual elements as the form is rendered. At <span class="ent">➎</span> we open a bootstrap4 template tag <span class="literal">{% buttons %}</span>, which adds Bootstrap styling to buttons.</p>
<p class="indent"><a href="#calibre_link-102" class="calibre6">Figure 20-2</a> shows the login form now. The page is much cleaner and has consistent styling and a clear purpose. Try logging in with an incorrect username or password; you’ll see that even the error messages are styled consistently and integrate well with the overall site.</p>
<div class="image1"><a id="calibre_link-102" class="calibre6"></a><img src="images/000016.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 20-2: The login page styled with Bootstrap</em></p>
<h4 class="h3" id="calibre_link-1156"><strong class="calibre2"><em class="calibre3">Styling the Topics Page</em></strong></h4>
<p class="noindent">Let’s make sure the pages for viewing information are styled appropriately as well, starting with the topics page:</p>
<p class="margin"><em class="calibre3">topics.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">{% extends "learning_logs/base.html" %}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> {% block page_header %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&gt;Topics&lt;/h1&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock page_header %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% block content %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;ul&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% for topic in topics %}</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;h3&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;a href="{% url 'learning_logs:topic' topic.id %}"&gt;{{ topic }}&lt;/a&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/h3&gt;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% empty %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;h3&gt;No topics have been added yet.&lt;/h3&gt;&lt;/li&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% endfor %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/ul&gt;</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&lt;h3&gt;&lt;a href="{% url 'learning_logs:new_topic' %}"&gt;Add a new topic&lt;/a&gt;&lt;/h3&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% endblock content %}</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-318" class="calibre"></span>We don’t need the <span class="literal">{% load bootstrap4 %}</span> tag, because we’re not using any custom bootstrap4 template tags in this file. We move the heading <em class="calibre3">Topics</em> into the <span class="literal">page_header</span> block and give it a header styling instead of using the simple paragraph tag <span class="ent">➊</span>. We style each topic as an <span class="literal">&lt;h3&gt;</span> element to make them a little larger on the page <span class="ent">➋</span> and do the same for the link to add a new topic <span class="ent">➌</span>.</p>
<h4 class="h3" id="calibre_link-1157"><strong class="calibre2"><em class="calibre3">Styling the Entries on the Topic Page</em></strong></h4>
<p class="noindent">The topic page has more content than most pages, so it needs a bit more work. We’ll use Bootstrap’s card component to make each entry stand out. A <em class="calibre3">card</em> is a div with a set of flexible, predefined styles that’s perfect for displaying a topic’s entries:</p>
<p class="margin"><em class="calibre3">topic.html</em></p>
<p class="programs">&nbsp;&nbsp;&nbsp;<span class="ash">{% extends 'learning_logs/base.html' %}</span><br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> {% block page_header %}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h3&gt;{{ topic }}&lt;/h3&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;{% endblock page_header %}<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% block content %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;p&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;a href="{% url 'learning_logs:new_entry' topic.id %}"&gt;Add new entry&lt;/a&gt;</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">&lt;/p&gt;</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% for entry in entries %}</span><br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="card mb-3"&gt;<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h4 class="card-header"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ entry.date_added|date:'M d, Y H:i' }}<br class="calibre4" />
<span class="ent">➍</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;small&gt;&lt;a href="{% url 'learning_logs:edit_entry' entry.id %}"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edit entry&lt;/a&gt;&lt;/small&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/h4&gt;<br class="calibre4" />
<span class="ent">➎</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="card-body"&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ entry.text|linebreaks }}<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% empty %}</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;There are no entries for this topic yet.&lt;/p&gt;<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{% endfor %}</span><br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;<span class="ash">{% endblock content %}</span></p>
<p class="indent">We first place the topic in the <span class="literal">page_header</span> block <span class="ent">➊</span>. Then we delete the unordered list structure previously used in this template. Instead of making each entry a list item, we create a div element with the selector <span class="literal">card</span> at <span class="ent">➋</span>. This card has two nested elements: one to hold the timestamp and the link to edit the entry, and another to hold the body of the entry.</p>
<p class="indent">The first element in the card is a header, which is an <span class="literal">&lt;h4&gt;</span> element with the selector <span class="literal">card-header</span> <span class="ent">➌</span>. This card header contains the date the entry was made and a link to edit the entry. The <span class="literal">&lt;small&gt;</span> tag around the <span class="literal">edit_entry</span> link <span type="pagebreak" id="calibre_link-254" class="calibre"></span>makes it appear a little smaller than the timestamp <span class="ent">➍</span>. The second element is a div with the selector <span class="literal">card-body</span> <span class="ent">➎</span>, which places the text of the entry in a simple box on the card. Notice that the Django code for including the information on the page hasn’t changed; only the elements that affect the appearance of the page have changed.</p>
<p class="indent"><a href="#calibre_link-103" class="calibre6">Figure 20-3</a> shows the topic page with its new look. Learning Log’s functionality hasn’t changed, but it looks more professional and inviting to users now.</p>
<div class="image1"><a id="calibre_link-103" class="calibre6"></a><img src="images/000022.jpg" alt="image" class="calibre7" /></div>
<p class="figcap"><em class="calibre3">Figure 20-3: The topic page with Bootstrap styling</em></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you want to use a different Bootstrap template, follow a similar process to what we’ve done so far in this chapter. Copy the template you want to use into</em> base.html, <em class="calibre3">and modify the elements that contain actual content so the template displays your project’s information. Then use Bootstrap’s individual styling tools to style the content on each page.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1158"><strong class="calibre2">20-1. Other Forms:</strong> We applied Bootstrap’s styles to the <span class="literal1">login</span> page. Make similar changes to the rest of the form-based pages including <span class="literal1">new_topic</span>, <span class="literal1">new_entry</span>, <span class="literal1">edit_entry</span>, and <span class="literal1">register</span>.</p>
<p class="sparal" id="calibre_link-1159"><strong class="calibre2">20-2. Stylish Blog:</strong> Use Bootstrap to style the Blog project you created in <a href="#calibre_link-18" class="calibre6">Chapter 19</a>.</p>
</div>
<h3 class="h2" id="calibre_link-1160"><span type="pagebreak" id="calibre_link-356" class="calibre"></span><strong class="calibre2">Deploying Learning Log</strong></h3>
<p class="noindent">Now that we have a professional-looking project, let’s deploy it to a live server so anyone with an internet connection can use it. We’ll use Heroku, a web-based platform that allows you to manage the deployment of web applications. We’ll get Learning Log up and running on Heroku.</p>
<h4 class="h3" id="calibre_link-1161"><strong class="calibre2"><em class="calibre3">Making a Heroku Account</em></strong></h4>
<p class="noindent">To make an account, go to <em class="calibre3"><a href="https://heroku.com/" class="calibre6">https://heroku.com/</a></em> and click one of the signup links. It’s free to make an account, and Heroku has a free tier that allows you to test your projects in live deployment before properly deploying them.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Heroku’s free tier has limits, such as the number of apps you can deploy and how often people can visit your app. But these limits are generous enough to let you practice deploying apps without any cost.</em></p>
</div>
<h4 class="h3" id="calibre_link-1162"><strong class="calibre2"><em class="calibre3">Installing the Heroku CLI</em></strong></h4>
<p class="noindent">To deploy and manage a project on Heroku’s servers, you’ll need the tools available in the Heroku Command Line Interface (CLI). To install the latest version of the Heroku CLI, visit <em class="calibre3"><a href="https://devcenter.heroku.com/articles/heroku-cli/" class="calibre6">https://devcenter.heroku.com/articles/heroku-cli/</a></em> and follow the instructions for your operating system. The instructions will include either a one-line terminal command or an installer you can download and run.</p>
<h4 class="h3" id="calibre_link-1163"><strong class="calibre2"><em class="calibre3">Installing Required Packages</em></strong></h4>
<p class="noindent">You’ll also need to install three packages that help serve Django projects on a live server. In an active virtual environment, issue the following commands:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">pip install psycopg2==2.7.*</span><br class="calibre4" />
(ll_env)learning_log$ <span class="codestrong">pip install django-heroku</span><br class="calibre4" />
(ll_env)learning_log$ <span class="codestrong">pip install gunicorn</span></p>
<p class="indent">The <span class="literal">psycopg2</span> package is required to manage the database that Heroku uses. The <span class="literal">django-heroku</span> package handles almost the entire configuration our app needs to run properly on Heroku servers. This includes managing the database and storing static files in a place where they can be served properly. <em class="calibre3">Static files</em> contain style rules and JavaScript files. The <span class="literal">gunicorn</span> package provides a server capable of serving apps in a live environment.</p>
<h4 class="h3" id="calibre_link-1164"><strong class="calibre2"><em class="calibre3">Creating a requirements.txt File</em></strong></h4>
<p class="noindent">Heroku needs to know which packages our project depends on, so we’ll use pip to generate a file listing them. Again, from an active virtual environment, issue the following command:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">pip freeze &gt; requirements.txt</span></p>
<p class="indent"><span type="pagebreak" id="calibre_link-436" class="calibre"></span>The <span class="literal">freeze</span> command tells pip to write the names of all the packages currently installed in the project into the file <em class="calibre3">requirements.txt</em>. Open this file to see the packages and version numbers installed in your project:</p>
<p class="margin"><em class="calibre3">requirements.txt</em></p>
<p class="programs">dj-database-url==0.5.0<br class="calibre4" />
Django==2.2.0<br class="calibre4" />
django-bootstrap4==0.0.7<br class="calibre4" />
django-heroku==0.3.1<br class="calibre4" />
gunicorn==19.9.0<br class="calibre4" />
psycopg2==2.7.7<br class="calibre4" />
pytz==2018.9<br class="calibre4" />
sqlparse==0.2.4<br class="calibre4" />
whitenoise==4.1.2</p>
<p class="indent">Learning Log already depends on eight different packages with specific version numbers, so it requires a specific environment to run properly. (We installed four of these packages manually, and four of them were installed automatically as dependencies of these packages.)</p>
<p class="indent">When we deploy Learning Log, Heroku will install all the packages listed in <em class="calibre3">requirements.txt</em>, creating an environment with the same packages we’re using locally. For this reason, we can be confident the deployed project will behave the same as it does on our local system. This is a huge advantage as you start to build and maintain various projects on your system.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If a package is listed on your system but the version number differs from what’s shown here, keep the version you have on your system.</em></p>
</div>
<h4 class="h3" id="calibre_link-1165"><strong class="calibre2"><em class="calibre3">Specifying the Python Runtime</em></strong></h4>
<p class="noindent">Unless you specify a Python version, Heroku will use its current default version of Python. Let’s make sure Heroku uses the same version of Python we’re using. In an active virtual environment, issue the command <span class="literal">python --version</span>:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">python --version</span><br class="calibre4" />
Python 3.7.2</p>
<p class="indent">In this example I’m running Python 3.7.2. Make a new file called <em class="calibre3">runtime.txt</em> in the same directory as <em class="calibre3">manage.py</em>, and enter the following:</p>
<p class="margin"><em class="calibre3">runtime.txt</em></p>
<p class="programs">python-3.7.2</p>
<p class="indent">This file should contain one line with your Python version specified in the format shown; make sure you enter <span class="literal">python</span> in lowercase, followed by a hyphen, followed by the three-part version number.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you get an error reporting that the Python runtime you requested isn’t available, go to</em> <a href="https://devcenter.heroku.com/categories/language-support/" class="calibre6">https://devcenter.heroku.com/categories/language-support/</a> <em class="calibre3">and look for a link to</em> Specifying a Python Runtime. <em class="calibre3">Scan through the article to find the available runtimes, and use the one that most closely matches your Python version.</em></p>
</div>
<h4 class="h3" id="calibre_link-1166"><span type="pagebreak" id="calibre_link-413" class="calibre"></span><strong class="calibre2"><em class="calibre3">Modifying settings.py for Heroku</em></strong></h4>
<p class="noindent">Now we need to add a section at the end of <em class="calibre3">settings.py</em> to define some specific settings for the Heroku environment:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash"># My settings</span><br class="calibre4" />
<span class="ash">LOGIN_URL = 'users:login'</span><br class="calibre4" />
<br class="calibre4" />
# Heroku settings.<br class="calibre4" />
import django_heroku<br class="calibre4" />
django_heroku.settings(locals())</p>
<p class="indent">Here we import the <span class="literal">django_heroku</span> module and call the <span class="literal">settings()</span> function. This function modifies some settings that need specific values for the Heroku environment.</p>
<h4 class="h3" id="calibre_link-1167"><strong class="calibre2"><em class="calibre3">Making a Procfile to Start Processes</em></strong></h4>
<p class="noindent">A <em class="calibre3">Procfile</em> tells Heroku which processes to start to properly serve the project. Save this one-line file as <em class="calibre3">Procfile</em>, with an uppercase <em class="calibre3">P</em> and no file extension, in the same directory as <em class="calibre3">manage.py</em>.</p>
<p class="indent">Here’s the line that goes in <em class="calibre3">Procfile</em>:</p>
<p class="margin"><em class="calibre3">Procfile</em></p>
<p class="programs">web: gunicorn learning_log.wsgi --log-file -</p>
<p class="indent">This line tells Heroku to use gunicorn as a server and to use the settings in <em class="calibre3">learning_log/wsgi.py</em> to launch the app. The <span class="literal">log-file</span> flag tells Heroku the kinds of events to log.</p>
<h4 class="h3" id="calibre_link-1168"><strong class="calibre2"><em class="calibre3">Using Git to Track the Project’s Files</em></strong></h4>
<p class="noindent">As discussed in <a href="#calibre_link-16" class="calibre6">Chapter 17</a>, Git is a version control program that allows you to take a snapshot of the code in your project each time you implement a new feature successfully. If anything goes wrong, you can easily return to the last working snapshot of your project; for example, if you accidentally introduce a bug while working on a new feature. Each snapshot is called a <em class="calibre3">commit</em>.</p>
<p class="indent">Using Git, you can try implementing new features without worrying about breaking your project. When you’re deploying to a live server, you need to make sure you’re deploying a working version of your project. To read more about Git and version control, see <a href="#calibre_link-67" class="calibre6">Appendix D</a>.</p>
<h5 class="h4" id="calibre_link-1444"><strong class="calibre2">Installing Git</strong></h5>
<p class="noindent">Git may already be installed on your system. To find out if Git is already installed, open a new terminal window and issue the command <span class="literal">git --version</span>:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">git --version</span><br class="calibre4" />
git version 2.17.0</p>
<p class="indent"><span type="pagebreak" id="calibre_link-420" class="calibre"></span>If you get an error message for some reason, see the installation instructions for Git in <a href="#calibre_link-67" class="calibre6">Appendix D</a>.</p>
<h5 class="h4" id="calibre_link-1445"><strong class="calibre2">Configuring Git</strong></h5>
<p class="noindent">Git keeps track of who makes changes to a project, even when only one person is working on the project. To do this, Git needs to know your username and email. You must provide your username, but you can make up an email for your practice projects:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">git config --global user.name "ehmatthes"</span><br class="calibre4" />
(ll_env)learning_log$ <span class="codestrong">git config --global user.email "eric@example.com"</span></p>
<p class="indent">If you forget this step, Git will prompt you for this information when you make your first commit.</p>
<h5 class="h4" id="calibre_link-1446"><strong class="calibre2">Ignoring Files</strong></h5>
<p class="noindent">We don’t need Git to track every file in the project, so we’ll tell it to ignore some files. Create a file called <em class="calibre3">.gitignore</em> in the folder that contains <em class="calibre3">manage.py</em>. Notice that this filename begins with a dot and has no file extension. Here’s the code that goes in <em class="calibre3">.gitignore</em>:</p>
<p class="margin"><em class="calibre3">.gitignore</em></p>
<p class="programs">ll_env/<br class="calibre4" />
__pycache__/<br class="calibre4" />
*.sqlite3</p>
<p class="indent">We tell Git to ignore the entire <em class="calibre3">ll_env</em> directory, because we can re-create it automatically at any time. We also don’t track the <em class="calibre3">__pycache__</em> directory, which contains the <em class="calibre3">.pyc</em> files that are created automatically when Django runs the <em class="calibre3">.py</em> files. We don’t track changes to the local database, because it’s a bad habit: if you’re ever using SQLite on a server, you might accidentally overwrite the live database with your local test database when you push the project to the server. The asterisk in <span class="literal">*.sqlite3</span> tells Git to ignore any file that ends with the extension <em class="calibre3">.sqlite3</em>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you’re using macOS, add <span class="codeitalic">.DS_Store</span> to your</em> .gitignore <em class="calibre3">file. This is a file that stores information about folder settings on macOS, and it has nothing to do with this project.</em></p>
</div>
<h5 class="h4" id="calibre_link-1447"><strong class="calibre2">Making Hidden Files Visible</strong></h5>
<p class="noindent">Most operating systems hide files and folders that begin with a dot, such as <em class="calibre3">.gitignore</em>. When you open a file browser or try to open a file from an application such as Sublime Text, you won’t see these kinds of files by default. But as a programmer, you’ll need to see them. Here’s how to view hidden files, depending on your operating system:</p>
<ul class="calibre8">
<li class="noindent1">On Windows, open Windows Explorer, and then open a folder such as <em class="calibre3">Desktop</em>. Click the <strong class="calibre2">View</strong> tab, and make sure <strong class="calibre2">File name extensions</strong> and <strong class="calibre2">Hidden items</strong> are checked.</li>
<li class="noindent1"><span type="pagebreak" id="calibre_link-414" class="calibre"></span>On macOS, you can press <img class="middle" src="images/000044.jpg" alt="Image" />-<small class="calibre5">SHIFT</small>-. (dot) in any file browser window to see hidden files and folders.</li>
<li class="noindent1">On Linux systems such as Ubuntu, you can press <small class="calibre5">CTRL</small>-H in any file browser to display hidden files and folders. To make this setting permanent, open a file browser such as Nautilus and click the options tab (indicated by three lines). Select the <strong class="calibre2">Show Hidden Files</strong> checkbox.</li>
</ul>
<h5 class="h4" id="calibre_link-1448"><strong class="calibre2">Committing the Project</strong></h5>
<p class="noindent">We need to initialize a Git repository for Learning Log, add all the necessary files to the repository, and commit the initial state of the project. Here’s how to do that:</p>
<p class="programs"><span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">git init</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Initialized empty Git repository in /home/ehmatthes/pcc/learning_log/.git/<br class="calibre4" />
<span class="ent">➋</span> (ll_env)learning_log$ <span class="codestrong">git add .</span><br class="calibre4" />
<span class="ent">➌</span> (ll_env)learning_log$ <span class="codestrong">git commit -am "Ready for deployment to heroku."</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;[master (root-commit) 79fef72] Ready for deployment to heroku.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;45 files changed, 712 insertions(+)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 .gitignore<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 Procfile<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 users/views.py<br class="calibre4" />
<span class="ent">➍</span> (ll_env)learning_log$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working tree clean<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">At <span class="ent">➊</span> we issue the <span class="literal">git init</span> command to initialize an empty repository in the directory containing Learning Log. At <span class="ent">➋</span> we use the <span class="literal">git add .</span> command, which adds all the files that aren’t being ignored to the repository. (Don’t forget the dot.) At <span class="ent">➌</span> we issue the command <span class="literal">git commit -am</span> <span class="codeitalic">commit message</span>: the <span class="literal">-a</span> flag tells Git to include all changed files in this commit, and the <span class="literal">-m</span> flag tells Git to record a log message.</p>
<p class="indent">Issuing the <span class="literal">git status</span> command <span class="ent">➍</span> indicates that we’re on the <em class="calibre3">master</em> branch and that our working tree is <em class="calibre3">clean</em>. This is the status you’ll want to see any time you push your project to Heroku.</p>
<h4 class="h3" id="calibre_link-1169"><strong class="calibre2"><em class="calibre3">Pushing to Heroku</em></strong></h4>
<p class="noindent">We’re finally ready to push the project to Heroku. In an active virtual environment, issue the following commands:</p>
<p class="programs"><span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">heroku login</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;heroku: Press any key to open up the browser to login or q to exit:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Logging in... done<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Logged in as eric@example.com<br class="calibre4" />
<span class="ent">➋</span> (ll_env)learning_log$ <span class="codestrong">heroku create</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Creating app... done, <img class="middle" src="images/000047.jpg" alt="Image" /> secret-lowlands-82594<br class="calibre4" />
&nbsp;&nbsp;&nbsp;https://secret-lowlands-82594.herokuapp.com/ |<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://git.heroku.com/secret-lowlands-82594.git<br class="calibre4" />
<span type="pagebreak" id="calibre_link-434" class="calibre"></span><span class="ent">➌</span> (ll_env)learning_log$ <span class="codestrong">git push heroku master</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
&nbsp;&nbsp;&nbsp;remote: -----&gt; Launching...<br class="calibre4" />
&nbsp;&nbsp;&nbsp;remote:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Released v5<br class="calibre4" />
<span class="ent">➍</span> remote:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://secret-lowlands-82594.herokuapp.com/ deployed to Heroku<br class="calibre4" />
&nbsp;&nbsp;&nbsp;remote: Verifying deploy... done.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;To https://git.heroku.com/secret-lowlands-82594.git<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;* [new branch]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;master -&gt; master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">First you issue the <span class="literal">heroku login</span> command, which will take you to a page in your browser where you can log in to your Heroku account <span class="ent">➊</span>. Then you tell Heroku to build an empty project <span class="ent">➋</span>. Heroku generates a name made up of two words and a number; you can change this later on. Next, we issue the command <span class="literal">git push heroku master</span> <span class="ent">➌</span>, which tells Git to push the master branch of the project to the repository Heroku just created. Then Heroku builds the project on its servers using these files. At <span class="ent">➍</span> is the URL we’ll use to access the live project, which we can change along with the project name.</p>
<p class="indent">When you’ve issued these commands, the project is deployed but not fully configured. To check that the server process started correctly, use the <span class="literal">heroku ps</span> command:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">heroku ps</span><br class="calibre4" />
<span class="ent">➊</span> Free dyno hours quota remaining this month: 450h 44m (81%)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Free dyno usage for this app: 0h 0m (0%)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;For more information on dyno sleeping and how to upgrade, see:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;https://devcenter.heroku.com/articles/dyno-sleeping<br class="calibre4" />
<span class="ent">➋</span> === web (Free): gunicorn learning_log.wsgi --log-file - (1)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;web.1: up 2019/02/19 23:40:12 -0900 (~ 10m ago)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">The output shows how much more time the project can be active in the next month <span class="ent">➊</span>. At the time of this writing, Heroku allows free deployments to be active for up to 550 hours in a month. If a project exceeds this limit, a standard server error page will display; we’ll customize this error page shortly. At <span class="ent">➋</span> we see that the process defined in <em class="calibre3">Procfile</em> has been started.</p>
<p class="indent">Now we can open the app in a browser using the command <span class="literal">heroku open</span>:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">heroku open</span><br class="calibre4" />
(ll_env)learning_log$</p>
<p class="indent">This command spares you from opening a browser and entering the URL Heroku showed you, but that’s another way to open the site. You should see the home page for Learning Log, styled correctly. However, you can’t use the app yet because we haven’t set up the database.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Heroku’s deployment process changes from time to time. If you have any unresolvable issues, look at Heroku’s documentation for help. Go to</em> <a href="https://devcenter.heroku.com/" class="calibre6">https://devcenter.heroku.com/</a>, <em class="calibre3">click <strong class="calibre2"><em class="calibre3">Python</em></strong>, and look for a link to</em> Get Started with Python <em class="calibre3">or</em> Deploying Python and Django Apps on Heroku. <em class="calibre3">If you don’t understand what you see there, check out the suggestions in <a href="#calibre_link-6" class="calibre6">Appendix C</a>.</em></p>
</div>
<h4 class="h3" id="calibre_link-1170"><span type="pagebreak" id="calibre_link-431" class="calibre"></span><strong class="calibre2"><em class="calibre3">Setting Up the Database on Heroku</em></strong></h4>
<p class="noindent">We need to run <span class="literal">migrate</span> once to set up the live database and apply all the migrations we generated during development. You can run Django and Python commands on a Heroku project using the command <span class="literal">heroku run</span>. Here’s how to run <span class="literal">migrate</span> on the Heroku deployment:</p>
<p class="programs"><span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">heroku run python manage.py migrate</span><br class="calibre4" />
<span class="ent">➋</span> Running 'python manage.py migrate' on <img class="middle" src="images/000047.jpg" alt="Image" /> secret-lowlands-82594... up, run.3060<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
<span class="ent">➌</span> Running migrations:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applying learning_logs.0001_initial... OK<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applying learning_logs.0002_entry... OK<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applying learning_logs.0003_topic_owner... OK<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applying sessions.0001_initial... OK<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">We first issue the command <span class="literal">heroku run python manage.py migrate</span> <span class="ent">➊</span>. Heroku then creates a terminal session to run the <span class="literal">migrate</span> command <span class="ent">➋</span>. At <span class="ent">➌</span> Django applies the default migrations and the migrations we generated during the development of Learning Log.</p>
<p class="indent">Now when you visit your deployed app, you should be able to use it just as you did on your local system. But you won’t see any of the data you entered on your local deployment, including your superuser account, because we didn’t copy the data to the live server. This is normal practice: you don’t usually copy local data to a live deployment because the local data is usually test data.</p>
<p class="indent">You can share your Heroku link to let anyone use your version of Learning Log. In the next section, we’ll complete a few more tasks to finish the deployment process and set you up to continue developing Learning Log.</p>
<h4 class="h3" id="calibre_link-1171"><strong class="calibre2"><em class="calibre3">Refining the Heroku Deployment</em></strong></h4>
<p class="noindent">Now we’ll refine the deployment by creating a superuser, just as we did locally. We’ll also make the project more secure by changing the setting <span class="literal">DEBUG</span> to <span class="literal">False</span>, so users won’t see any extra information in error messages that they could use to attack the server.</p>
<h5 class="h4" id="calibre_link-1449"><strong class="calibre2">Creating a Superuser on Heroku</strong></h5>
<p class="noindent">You’ve already seen that we can run one-off commands using the <span class="literal">heroku run</span> command. But you can also run commands by opening a Bash terminal session while connected to the Heroku server using the command <span class="literal">heroku run bash</span>. Bash is the language that runs in many Linux terminals. We’ll use the Bash terminal session to create a superuser so we can access the admin site on the live app:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;(ll_env)learning_log$ <span class="codestrong">heroku run bash</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Running 'bash' on <img class="middle" src="images/000047.jpg" alt="Image" /> secret-lowlands-82594... up, run.9858<br class="calibre4" />
<span class="ent">➊</span> ~ $ <span class="codestrong">ls</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;learning_log learning_logs manage.py Procfile requirements.txt runtime.txt<br class="calibre4" />
<span type="pagebreak" id="calibre_link-435" class="calibre"></span>&nbsp;&nbsp;&nbsp;staticfiles users<br class="calibre4" />
<span class="ent">➋</span> ~ $ <span class="codestrong">python manage.py createsuperuser</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Username (leave blank to use ' u47318'): <span class="codestrong">ll_admin</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Email address:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Password:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Password (again):<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Superuser created successfully.<br class="calibre4" />
<span class="ent">➌</span> ~ $ <span class="codestrong">exit</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;exit<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">At <span class="ent">➊</span> we run <span class="literal">ls</span> to see which files and directories exist on the server, which should be the same files we have on our local system. You can navigate this filesystem like any other.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Windows users will use the same commands shown here (such as <span class="codeitalic">ls</span> instead of <span class="codeitalic">dir</span>), because you’re running a Linux terminal through a remote connection.</em></p>
</div>
<p class="indent">At <span class="ent">➋</span> we run the command to create a superuser, which outputs the same prompts we saw on our local system when we created a superuser in <a href="#calibre_link-17" class="calibre6">Chapter 18</a>. When you’re finished creating the superuser in this terminal session, run the <span class="codestrong1">exit</span> command to return to your local system’s terminal session <span class="ent">➌</span>.</p>
<p class="indent">Now you can add <em class="calibre3">/admin/</em> to the end of the URL for the live app and log in to the admin site. For me, the URL is <em class="calibre3">https://secret-lowlands-82594.herokuapp.com/admin/</em>.</p>
<p class="indent">If others have already started using your project, be aware that you’ll have access to all of their data! Don’t take this lightly, and users will continue to trust you with their data.</p>
<h5 class="h4" id="calibre_link-1450"><strong class="calibre2">Creating a User-Friendly URL on Heroku</strong></h5>
<p class="noindent">Most likely, you’ll want your URL to be friendlier and more memorable than <em class="calibre3">https://secret-lowlands-82594.herokuapp.com/</em>. You can rename the app using a single command:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">heroku apps:rename learning-log</span><br class="calibre4" />
Renaming secret-lowlands-82594 to learning-log-2e... done<br class="calibre4" />
https://learning-log.herokuapp.com/ | https://git.heroku.com/learning-log.git<br class="calibre4" />
Git remote heroku updated<br class="calibre4" />
&nbsp;<img class="middle" src="images/000047.jpg" alt="Image" />&nbsp;&nbsp;Don't forget to update git remotes for all other local checkouts of the app.<br class="calibre4" />
(ll_env)learning_log$</p>
<p class="indent">You can use letters, numbers, and dashes when naming your app, and call it whatever you want, as long as no one else has claimed the name. This deployment now lives at <em class="calibre3"><a href="https://learning-log.herokuapp.com/" class="calibre6">https://learning-log.herokuapp.com/</a></em>. The project is no longer available at the previous URL; the <span class="literal">apps:rename</span> command completely moves the project to the new URL.</p>
<div class="note">
<p class="notet"><span type="pagebreak" id="calibre_link-252" class="calibre"></span><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">When you deploy your project using Heroku’s free service, Heroku puts your deployment to sleep if it hasn’t received any requests after a certain amount of time or if it’s been too active for the free tier. The first time a user accesses the site after it’s been sleeping, it will take longer to load, but the server will respond to subsequent requests more quickly. This is how Heroku can afford to offer free deployments.</em></p>
</div>
<h4 class="h3" id="calibre_link-1172"><strong class="calibre2"><em class="calibre3">Securing the Live Project</em></strong></h4>
<p class="noindent">One glaring security issue exists in the way our project is currently deployed: the setting <span class="literal">DEBUG=True</span> in <em class="calibre3">settings.py</em>, which provides debug messages when errors occur. Django’s error pages give you vital debugging information when you’re developing a project; however, they give way too much information to attackers if you leave them enabled on a live server.</p>
<p class="indent">We’ll control whether debugging information is shown on the live site by setting an environment variable. <em class="calibre3">Environment variables</em> are values set in a specific environment. This is one of the ways sensitive information is stored on a server, keeping it separate from the rest of the project’s code.</p>
<p class="indent">Let’s modify <em class="calibre3">settings.py</em> so it looks for an environment variable when the project is running on Heroku:</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash"># Heroku settings.</span><br class="calibre4" />
<span class="ash">import django_heroku</span><br class="calibre4" />
<span class="ash">django_heroku.settings(locals())</span><br class="calibre4" />
<br class="calibre4" />
if os.environ.get('DEBUG') == 'TRUE':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;DEBUG = True<br class="calibre4" />
elif os.environ.get('DEBUG') == 'FALSE':<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;DEBUG = False</p>
<p class="indent">The method <span class="literal">os.environ.get()</span> reads the value associated with a specific environment variable in any environment where the project is running. If the variable we’re asking for is set, the method returns its value; if it’s not set, the method returns <span class="literal">None</span>. Using environment variables to store Boolean values can be confusing. In most cases, environment variables are stored as strings, and you have to be careful about this. Consider this snippet from a simple Python terminal session:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">bool('False')</span><br class="calibre4" />
True</p>
<p class="indent">The Boolean value of the string <span class="literal">'False'</span> is <span class="literal">True</span>, because any non-empty string evaluates to <span class="literal">True</span>. So we’ll use the strings <span class="literal">'TRUE'</span> and <span class="literal">'FALSE'</span>, in all capitals, to be clear that we’re not storing Python’s actual <span class="literal">True</span> and <span class="literal">False</span> Boolean values. When Django reads in the environment variable with the key <span class="literal">'DEBUG'</span> on Heroku, we’ll set <span class="literal">DEBUG</span> to <span class="literal">True</span> if the value is <span class="literal">'TRUE'</span> and <span class="literal">False</span> if the value is <span class="literal">'FALSE'</span>.</p>
<h4 class="h3" id="calibre_link-1173"><span type="pagebreak" id="calibre_link-418" class="calibre"></span><strong class="calibre2"><em class="calibre3">Committing and Pushing Changes</em></strong></h4>
<p class="noindent">Now we need to commit the changes made to <em class="calibre3">settings.py</em> to the Git repository, and then push the changes to Heroku. Here’s a terminal session showing this process:</p>
<p class="programs"><span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">git commit -am "Set DEBUG based on environment variables."</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;[master 3427244] Set DEBUG based on environment variables.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;1 file changed, 4 insertions(+)<br class="calibre4" />
<span class="ent">➋</span> (ll_env)learning_log$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working tree clean<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">We issue the <span class="literal">git commit</span> command with a short but descriptive commit message <span class="ent">➊</span>. Remember that the <span class="literal">-am</span> flag makes sure Git commits all the files that have changed and records the log message. Git recognizes that one file has changed and commits this change to the repository.</p>
<p class="indent">At <span class="ent">➋</span> the status shows that we’re working on the master branch of the repository and that there are now no new changes to commit. It’s essential that you check the status for this message before pushing to Heroku. If you don’t see this message, some changes haven’t been committed, and those changes won’t be pushed to the server. You can try issuing the <span class="literal">commit</span> command again, but if you’re not sure how to resolve the issue, read through <a href="#calibre_link-67" class="calibre6">Appendix D</a> to better understand how to work with Git.</p>
<p class="indent">Now let’s push the updated repository to Heroku:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">git push heroku master</span><br class="calibre4" />
remote: Building source:<br class="calibre4" />
remote:<br class="calibre4" />
remote: -----&gt; Python app detected<br class="calibre4" />
remote: -----&gt; Installing requirements with pip<br class="calibre4" />
--<span class="codeitalic1">snip</span>--<br class="calibre4" />
remote: -----&gt; Launching...<br class="calibre4" />
remote:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Released v6<br class="calibre4" />
remote:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://learning-log.herokuapp.com/ deployed to Heroku<br class="calibre4" />
remote:<br class="calibre4" />
remote: Verifying deploy... done.<br class="calibre4" />
To https://git.heroku.com/learning-log.git<br class="calibre4" />
&nbsp;&nbsp;&nbsp;144f020..d5075a1&nbsp;&nbsp;master -&gt; master<br class="calibre4" />
(ll_env)learning_log$</p>
<p class="indent">Heroku recognizes that the repository has been updated, and it rebuilds the project to make sure all the changes have been taken into account. It doesn’t rebuild the database, so we won’t have to run <span class="literal">migrate</span> for this update.</p>
<h4 class="h3" id="calibre_link-1174"><span type="pagebreak" id="calibre_link-432" class="calibre"></span><strong class="calibre2"><em class="calibre3">Setting Environment Variables on Heroku</em></strong></h4>
<p class="noindent">Now we can set the value we want for <span class="literal">DEBUG</span> in <em class="calibre3">settings.py</em> through Heroku. The command <span class="literal">heroku config:set</span> sets an environment variable for us:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">heroku config:set DEBUG='FALSE'</span><br class="calibre4" />
Setting DEBUG and restarting <img class="middle" src="images/000047.jpg" alt="Image" /> learning-log... done, v7<br class="calibre4" />
DEBUG: FALSE<br class="calibre4" />
(ll_env)learning_log$</p>
<p class="indent">Whenever you set an environment variable on Heroku, it automatically restarts the project so the environment variable can take effect.</p>
<p class="indent">To check that the deployment is more secure now, enter your project’s URL with a path we haven’t defined. For example, try to visit <em class="calibre3">http://learning-log.herokuapp.com/letmein/</em>. You should see a generic error page on your live deployment that doesn’t give away any specific information about the project. If you try the same request on the local version of Learning Log at <em class="calibre3">http://localhost:8000/letmein/</em>, you should see the full Django error page. The result is perfect: you’ll see informative error messages when you’re developing the project further on your own system. But users on the live site won’t see critical information about the project’s code.</p>
<p class="indent">If you’re just deploying an app and you’re troubleshooting the initial deployment, you can run <span class="literal">heroku config:set DEBUG='TRUE'</span> and temporarily see a full error report on the live site. Just make sure you reset the value to <span class="literal">'FALSE'</span> once you’ve finished troubleshooting. Also, be careful not to do this once users are regularly accessing your site.</p>
<h4 class="h3" id="calibre_link-1175"><strong class="calibre2"><em class="calibre3">Creating Custom Error Pages</em></strong></h4>
<p class="noindent">In <a href="#calibre_link-18" class="calibre6">Chapter 19</a>, we configured Learning Log to return a 404 error if the user requests a topic or entry that doesn’t belong to them. You’ve probably seen some 500 server errors (internal errors) by this point as well. A 404 error usually means your Django code is correct, but the object being requested doesn’t exist; a 500 error usually means there’s an error in the code you’ve written, such as an error in a function in <em class="calibre3">views.py</em>. Currently, Django returns the same generic error page in both situations. But we can write our own 404 and 500 error page templates that match Learning Log’s overall appearance. These templates must go in the root template directory.</p>
<h5 class="h4" id="calibre_link-1451"><strong class="calibre2">Making Custom Templates</strong></h5>
<p class="noindent">In the outermost <em class="calibre3">learning_log</em> folder, make a new folder called <em class="calibre3">templates</em>. Then make a new file called <em class="calibre3">404.html</em>; the path to this file should be <em class="calibre3">learning_log/templates/404.html</em>. Here’s the code for this file:</p>
<p class="margin"><em class="calibre3">404.html</em></p>
<p class="programs">{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
{% block page_header %}<br class="calibre4" />
&nbsp;&nbsp;&lt;h2&gt;The item you requested is not available. (404)&lt;/h2&gt;<br class="calibre4" />
{% endblock page_header %}</p>
<p class="indent"><span type="pagebreak" id="calibre_link-437" class="calibre"></span>This simple template provides the generic 404 error page information but is styled to match the rest of the site.</p>
<p class="indent">Make another file called <em class="calibre3">500.html</em> using the following code:</p>
<p class="margin"><em class="calibre3">500.html</em></p>
<p class="programs">{% extends "learning_logs/base.html" %}<br class="calibre4" />
<br class="calibre4" />
{% block page_header %}<br class="calibre4" />
&nbsp;&nbsp;&lt;h2&gt;There has been an internal error. (500)&lt;/h2&gt;<br class="calibre4" />
{% endblock page_header %}</p>
<p class="indent">These new files require a slight change to <em class="calibre3">settings.py</em>.</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">TEMPLATES = [</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">{</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'BACKEND': 'django.template.backends.django.DjangoTemplates',</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'DIRS': [os.path.join(BASE_DIR, 'templates')],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">'APP_DIRS': True,</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">},</span><br class="calibre4" />
<span class="ash">]</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">This change tells Django to look in the root template directory for the error page templates.</p>
<h5 class="h4" id="calibre_link-1452"><strong class="calibre2">Viewing the Error Pages Locally</strong></h5>
<p class="noindent">If you want to see what the error pages look like on your system before pushing them to Heroku, you’ll first need to set <span class="literal">Debug=False</span> on your local settings to suppress the default Django debug pages. To do so, make the following change to <em class="calibre3">settings.py</em> (make sure you’re working in the part of <em class="calibre3">settings.py</em> that applies to the local environment, not the part that applies to Heroku):</p>
<p class="margin"><em class="calibre3">settings.py</em></p>
<p class="programs"><span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash"># SECURITY WARNING: don't run with debug turned on in production!</span><br class="calibre4" />
DEBUG = False<br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Now request a topic or entry that doesn’t belong to you to see the 404 error page. To test the 500 error page, request a topic or entry that doesn’t exist. For example, the URL <em class="calibre3">http://localhost:8000/topics/999/</em> should generate a 500 error unless you’ve generated 999 example topics already!</p>
<p class="indent">When you’re finished checking the error pages, set the local value of <span class="literal">DEBUG</span> back to <span class="literal">True</span> to further develop Learning Log. (Make sure you don’t change the way <span class="literal">DEBUG</span> is handled in the section that manages settings in the Heroku environment.)</p>
<div class="note">
<p class="notet"><span type="pagebreak" id="calibre_link-344" class="calibre"></span><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The 500 error page won’t show any information about the user who’s logged in, because Django doesn’t send any context information in the response when there’s a server error.</em></p>
</div>
<h5 class="h4" id="calibre_link-1453"><strong class="calibre2">Pushing the Changes to Heroku</strong></h5>
<p class="noindent">Now we need to commit the error page changes we just made, and push them live to Heroku:</p>
<p class="programs"><span class="ent">➊</span> (ll_env)learning_log$ <span class="codestrong">git add .</span><br class="calibre4" />
<span class="ent">➋</span> (ll_env)learning_log$ <span class="codestrong">git commit -am "Added custom 404 and 500 error pages."</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;3 files changed, 15 insertions(+), 10 deletions(-)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 templates/404.html<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 templates/500.html<br class="calibre4" />
<span class="ent">➌</span> (ll_env)learning_log$ <span class="codestrong">git push heroku master</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;--<span class="codeitalic1">snip</span>--<br class="calibre4" />
&nbsp;&nbsp;&nbsp;remote: Verifying deploy.... done.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;To https://git.heroku.com/learning-log.git<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d5075a1..4bd3b1c&nbsp;&nbsp;master -&gt; master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;(ll_env)learning_log$</p>
<p class="indent">We issue the <span class="literal">git add .</span> command at <span class="ent">➊</span> because we created some new files in the project, so we need to tell Git to start tracking these files. Then we commit the changes <span class="ent">➋</span> and push the updated project to Heroku <span class="ent">➌</span>.</p>
<p class="indent">Now when an error page appears, it should have the same styling as the rest of the site, making for a smoother user experience when errors arise.</p>
<h5 class="h4" id="calibre_link-1454"><strong class="calibre2">Using the get_object_or_404() Method</strong></h5>
<p class="noindent">At this point, if a user manually requests a topic or entry that doesn’t exist, they’ll get a 500 server error. Django tries to render the nonexistent page, but it doesn’t have enough information to do so, and the result is a 500 error. This situation is more accurately handled as a 404 error, and we can implement this behavior using the Django shortcut function <span class="literal">get_object_or_404()</span>. This function tries to get the requested object from the database, but if that object doesn’t exist, it raises a 404 exception. We’ll import this function into <em class="calibre3">views.py</em> and use it in place of <span class="literal">get()</span>:</p>
<p class="margin"><em class="calibre3">views.py</em></p>
<p class="programs">from django.shortcuts import render, redirect, get_object_or_404<br class="calibre4" />
<span class="ash">from django.contrib.auth.decorators import login_required</span><br class="calibre4" />
<span class="ash">--<span class="codeitalic1">snip</span>--</span><br class="calibre4" />
<span class="ash">@login_required</span><br class="calibre4" />
<span class="ash">def topic(request, topic_id):</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">"""Show a single topic and all its entries."""</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;topic = get_object_or_404(Topic, id=topic_id)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash"># Make sure the topic belongs to the current user.</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ash">--<span class="codeitalic1">snip</span>--</span></p>
<p class="indent">Now when you request a topic that doesn’t exist (for example, <em class="calibre3">http://localhost:8000/topics/999/</em>), you’ll see a 404 error page. To deploy this change, make a new commit and then push the project to Heroku.</p>
<h4 class="h3" id="calibre_link-1176"><span type="pagebreak" id="calibre_link-355" class="calibre"></span><strong class="calibre2"><em class="calibre3">Ongoing Development</em></strong></h4>
<p class="noindent">You might want to further develop Learning Log after your initial push to a live server or develop your own projects to deploy. There’s a fairly consistent process for updating projects.</p>
<p class="indent">First, you’ll make any changes needed to your local project. If your changes result in any new files, add those files to the Git repository using the command <span class="literal">git add .</span> (be sure to include the dot at the end of the command). Any change that requires a database migration will need this command, because each migration generates a new migration file.</p>
<p class="indent">Second, commit the changes to your repository using <span class="literal">git commit -am "commit message"</span>. Then push your changes to Heroku using the command <span class="literal">git push heroku master</span>. If you migrated your database locally, you’ll need to migrate the live database as well. You can either use the one-off command <span class="literal">heroku run python manage.py migrate</span>, or open a remote terminal session with <span class="literal">heroku run bash</span> and run the command <span class="literal">python manage.py migrate</span>. Then visit your live project, and make sure the changes you expect to see have taken effect.</p>
<p class="indent">It’s easy to make mistakes during this process, so don’t be surprised when something goes wrong. If the code doesn’t work, review what you’ve done and try to spot the mistake. If you can’t find the mistake or you can’t figure out how to undo the mistake, refer to the suggestions for getting help in <a href="#calibre_link-6" class="calibre6">Appendix C</a>. Don’t be shy about asking for help: everyone else learned to build projects by asking the same questions you’re likely to ask, so someone will be happy to help you. Solving each problem that arises helps you steadily develop your skills until you’re building meaningful, reliable projects and you’re answering other people’s questions as well.</p>
<h4 class="h3" id="calibre_link-1177"><strong class="calibre2"><em class="calibre3">The SECRET_KEY Setting</em></strong></h4>
<p class="noindent">Django uses the value of the <span class="literal">SECRET_KEY</span> setting in <em class="calibre3">settings.py</em> to implement a number of security protocols. In this project, we’ve committed our settings file to the repository with the <span class="literal">SECRET_KEY</span> setting included. This is fine for a practice project, but the <span class="literal">SECRET_KEY</span> setting should be handled more carefully for a production site. If you build a project that’s getting meaningful use, make sure you research how to handle your <span class="literal">SECRET_KEY</span> setting more securely.</p>
<h4 class="h3" id="calibre_link-1178"><strong class="calibre2"><em class="calibre3">Deleting a Project on Heroku</em></strong></h4>
<p class="noindent">It’s great practice to run through the deployment process a number of times with the same project or with a series of small projects to get the hang of deployment. But you’ll need to know how to delete a project that’s been deployed. Heroku also limits the number of projects you can host for free, and you don’t want to clutter your account with practice projects.</p>
<p class="indent">Log in to the Heroku website (<em class="calibre3"><a href="https://heroku.com/" class="calibre6">https://heroku.com/</a></em>); you’ll be redirected to a page showing a list of your projects. Click the project you want to delete. You’ll see a new page with information about the project. Click the <strong class="calibre2">Settings</strong> <span type="pagebreak" id="calibre_link-433" class="calibre"></span>link, and scroll down until you see a link to delete the project. This action can’t be reversed, so Heroku will ask you to confirm the request for deletion by manually entering the project’s name.</p>
<p class="indent">If you prefer working from a terminal, you can also delete a project by issuing the <span class="literal">destroy</span> command:</p>
<p class="programs">(ll_env)learning_log$ <span class="codestrong">heroku apps:destroy --app</span> <span class="codestrongitalic">appname</span></p>
<p class="indent">Here, <span class="codeitalic">appname</span> is the name of your project, which is either something like <span class="literal">secret-lowlands-82594</span> or <span class="literal">learning-log</span> if you’ve renamed the project. You’ll be prompted to reenter the project name to confirm the deletion.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">Deleting a project on Heroku does nothing to your local version of the project. If no one has used your deployed project and you’re just practicing the deployment process, it’s perfectly reasonable to delete your project on Heroku and redeploy it.</em></p>
</div>
<div class="sidebar">
<p class="sidebart"><strong class="calibre2">TRY IT YOURSELF</strong></p>
<p class="sparal" id="calibre_link-1179"><strong class="calibre2">20-3. Live Blog:</strong> Deploy the Blog project you’ve been working on to Heroku. Make sure you set <span class="literal1">DEBUG</span> to <span class="literal1">False</span>, so users don’t see the full Django error pages when something goes wrong.</p>
<p class="sparal" id="calibre_link-1180"><strong class="calibre2">20-4. More 404s:</strong> The <span class="literal1">get_object_or_404()</span> function should also be used in the <span class="literal1">new_entry()</span> and <span class="literal1">edit_entry()</span> views. Make this change, test it by entering a URL like <em class="calibre3">http://localhost:8000/new_entry/999/</em>, and check that you see a 404 error.</p>
<p class="sparal" id="calibre_link-1181"><strong class="calibre2">20-5. Extended Learning Log:</strong> Add one feature to Learning Log, and push the change to your live deployment. Try a simple change, such as writing more about the project on the home page. Then try adding a more advanced feature, such as giving users the option of making a topic public. This would require an attribute called <span class="literal1">public</span> as part of the <span class="literal1">Topic</span> model (this should be set to <span class="literal1">False</span> by default) and a form element on the new_topic page that allows the user to change a topic from private to public. You’d then need to migrate the project and revise <em class="calibre3">views.py</em> so any topic that’s public is visible to unauthenticated users as well. Remember to migrate the live database after you’ve pushed your changes to Heroku.</p>
</div>
<h3 class="h2" id="calibre_link-1182"><span type="pagebreak" id="calibre_link-1455" class="calibre"></span><strong class="calibre2">Summary</strong></h3>
<p class="noindent">In this chapter, you learned to give your projects a simple but professional appearance using the Bootstrap library and the django-bootstrap4 app. Using Bootstrap, the styles you choose will work consistently on almost any device people use to access your project.</p>
<p class="indent">You learned about Bootstrap’s templates and used the <em class="calibre3">Navbar static</em> template to create a simple look and feel for Learning Log. You used a jumbotron to make a home page’s message stand out and learned to style all the pages in a site consistently.</p>
<p class="indent">In the final part of the project, you learned how to deploy a project to Heroku’s servers so anyone can access it. You made a Heroku account and installed some tools that help manage the deployment process. You used Git to commit the working project to a repository and then pushed the repository to Heroku’s servers. Finally, you learned to begin securing your app by setting <span class="literal">DEBUG=False</span> on the live server.</p>
<p class="indent">Now that you’ve finished Learning Log, you can start building your own projects. Start simple, and make sure the project works before adding complexity. Enjoy your continued learning, and good luck with your projects!<span type="pagebreak" id="calibre_link-1456" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-150">
<h2 class="h" id="calibre_link-158"><span type="pagebreak" id="calibre_link-1457" class="calibre"></span><strong class="calibre2">AFTERWORD</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Congratulations! You’ve learned the basics of Python and applied your knowledge to meaningful projects. You’ve made a game, visualized some data, and made a web application. From here, you can go in a number of different directions to continue developing your programming skills.</p>
<p class="indent">First, you should continue to work on meaningful projects that interest you. Programming is more appealing when you’re solving relevant and significant problems, and you now have the skills to engage in a variety of projects. You could invent your own game or write your own version of a classic arcade game. You might want to explore some data that’s important to you and make visualizations that show interesting patterns and connections. You could create your own web application or try to emulate one of your favorite apps.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1458" class="calibre"></span>Whenever possible, invite other people to try using your programs. If you write a game, let other people play it. If you make a visualization, show it to others and see if it makes sense to them. If you make a web app, deploy it online and invite others to try it out. Listen to your users and try to incorporate their feedback into your projects; you’ll become a better programmer if you do.</p>
<p class="indent">When you work on your own projects, you’ll run into problems that are challenging, or even impossible, to solve on your own. Keep finding ways to ask for help, and find your own place in the Python community. Join a local Python User Group or explore some online Python communities. Consider attending a PyCon near you as well.</p>
<p class="indent">You should strive to maintain a balance between working on projects that interest you and developing your Python skills in general. Many Python learning sources are available online, and a large number of Python books target intermediate programmers. Many of these resources will be accessible to you now that you know the basics and how to apply your skills. Working through Python tutorials and books will build directly on what you learned here and deepen your understanding of programming in general and Python in particular. Then when you go back to working on projects after focusing on learning about Python, you’ll be capable of solving a wider variety of problems more efficiently.</p>
<p class="indent">Congratulations on how far you’ve come, and good luck with your continued learning!</p>
</div>


<div class="calibre1" id="calibre_link-20">
<h2 class="h" id="calibre_link-1"><span type="pagebreak" id="calibre_link-534" class="calibre"></span><strong class="calibre2"><span class="big">A</span><br class="calibre4" />INSTALLATION AND TROUBLESHOOTING</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Python has several versions, and there are a number of ways to set it up on each operating system. Use this appendix to install Python if the approach in <a href="#calibre_link-21" class="calibre6">Chapter 1</a> didn’t work or if you want to install a different version of Python than the one that came with your system.</p>
<h3 class="h2" id="calibre_link-1183"><strong class="calibre2">Python on Windows</strong></h3>
<p class="noindent">The instructions in <a href="#calibre_link-21" class="calibre6">Chapter 1</a> show you how to install Python using the official installer at <em class="calibre3"><a href="https://python.org/" class="calibre6">https://python.org/</a></em>. If you couldn’t get Python to run after using the installer, the troubleshooting instructions in this section should help you get Python up and running.</p>
<h4 class="h3" id="calibre_link-1184"><strong class="calibre2"><em class="calibre3">Finding the Python Interpreter</em></strong></h4>
<p class="noindent">If you’ve entered the simple command <span class="literal">python</span> and get an error, such as <em class="calibre3">python is not recognized as an internal or external command</em>, you most likely <span type="pagebreak" id="calibre_link-1459" class="calibre"></span>forgot to select the <em class="calibre3">Add Python to PATH</em> option when you ran the installer. In this case, you’ll need to tell Windows where to find the Python interpreter. To find it, open your C drive and find the folder that starts with the name <em class="calibre3">Python</em> (you might need to enter the word <span class="literal">python</span> in the Windows Explorer search bar to find the right folder, because it might be nested further down). Open the folder, and look for a file named <em class="calibre3">python</em> in lowercase. Right-click this file and choose <strong class="calibre2">Properties</strong>; the path to this file will be listed under the heading <em class="calibre3">Location</em>.</p>
<p class="indent">To tell Windows where to find the interpreter, open a terminal window and enter the path followed by the <span class="literal">--version</span> command, like so:</p>
<p class="programs">$ <span class="codestrong">C:\Python37\python --version</span><br class="calibre4" />
Python 3.7.2</p>
<p class="indent">Your path might look something more like <span class="literal">C:\Users\username\Programs\Python37\python</span> on your system. Using this path, Windows should then run the Python interpreter.</p>
<h4 class="h3" id="calibre_link-1185"><strong class="calibre2"><em class="calibre3">Adding Python to Your Path Variable</em></strong></h4>
<p class="noindent">It’s annoying to type the full path each time you want to start a Python terminal session, so let’s add the path to the system so you can just use the <span class="literal">python</span> command. Open your system’s <strong class="calibre2">Control Panel</strong>, click <strong class="calibre2">System and Security</strong>, and then click <strong class="calibre2">System</strong>. Click <strong class="calibre2">Advanced System Settings</strong>. In the window that appears, click <strong class="calibre2">Environment Variables</strong>.</p>
<p class="indent">In the box labeled <em class="calibre3">System variables</em>, look for a variable called <span class="literal">Path</span>. Click the word <span class="codestrong1">Path</span>, and then click <strong class="calibre2">Edit</strong>. You should see a list of locations that your system searches through when it looks for programs. Click <strong class="calibre2">New</strong>, and paste the path to your <em class="calibre3">python.exe</em> file in the text box that appears. If your system is set up like mine, that would be:</p>
<p class="programs"><span class="codestrong">C:\Python37</span></p>
<p class="indent">Notice that we’re not including the name of the <em class="calibre3">python.exe</em> file; we’re just telling the system where to look for it.</p>
<p class="indent">Close your terminal window and open a new one. Doing so will load the new <span class="literal">Path</span> variable into your terminal session. Now when you enter <span class="literal">python --version</span>, you should see the version of Python you just added to your <span class="literal">Path</span> variable. You can now start a Python terminal session by just entering <span class="literal">python</span> at a command prompt.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">If you’re using an earlier version of Windows, you might see a box labeled</em> Variable value <em class="calibre3">when you click <strong class="calibre2"><em class="calibre3">Edit</em></strong>. If you see this box, use the right arrow key to scroll all the way to the right. Be careful not to overwrite the existing variable; if you do, click <strong class="calibre2"><em class="calibre3">Cancel</em></strong> and try again. Add a semicolon and the path to your</em> python.exe <em class="calibre3">file to the existing variable:</em></p>
<p class="programs"><span class="ash">%SystemRoot%\system32\...\System32\WindowsPowerShell\v1.0\</span>;C:\Python37</p>
</div>
<h4 class="h3" id="calibre_link-1186"><span type="pagebreak" id="calibre_link-439" class="calibre"></span><strong class="calibre2"><em class="calibre3">Reinstalling Python</em></strong></h4>
<p class="noindent">If you’re still unable to run Python, oftentimes uninstalling Python and running the installer again will address any problems that occurred in your first attempt.</p>
<p class="indent">To do this, open your system’s <strong class="calibre2">Control Panel</strong> and click <strong class="calibre2">Programs and Features</strong>. Scroll down until you see the version of Python you just installed, and select it. Click <strong class="calibre2">Uninstall/Change</strong>, and then click <strong class="calibre2">Uninstall</strong> in the dialog that appears. Then run the installer again using the instructions in <a href="#calibre_link-21" class="calibre6">Chapter 1</a>, but this time make sure you select the <strong class="calibre2">Add Python to PATH</strong> option and any other settings that are relevant to your system. If you’re still running into trouble and aren’t sure where to get help, see the suggestions in <a href="#calibre_link-6" class="calibre6">Appendix C</a>.</p>
<h3 class="h2" id="calibre_link-1187"><strong class="calibre2">Python on macOS</strong></h3>
<p class="noindent">The installation instructions in <a href="#calibre_link-21" class="calibre6">Chapter 1</a> use the official Python installer at <em class="calibre3"><a href="https://python.org/" class="calibre6">https://python.org/</a></em>, which I recommend you use unless you have a specific reason not to. Another approach uses Homebrew, a tool you can use to install a variety of software on macOS. If you’re already using Homebrew and want to use it to install Python, or if the people you’re working with use Homebrew and you want a similar setup to what they’re using, you can use the following instructions.</p>
<h4 class="h3" id="calibre_link-1188"><strong class="calibre2"><em class="calibre3">Installing Homebrew</em></strong></h4>
<p class="noindent">Homebrew depends on some of the command line tools from Apple’s Xcode package, so you’ll first need to install the Xcode command line tools. Open a terminal and run this command:</p>
<p class="programs">$ <span class="codestrong">xcode-select --install</span></p>
<p class="indent">Click through the confirmation dialogs that appear (this might take a while, depending on your connection speed). Next, install Homebrew by entering the following command:</p>
<p class="programs">$ <span class="codestrong">/usr/bin/ruby -e "$(curl -fsSL</span><br class="calibre4" />
<span class="codestrong">https://raw.githubusercontent.com/Homebrew/install/master/install)"</span></p>
<p class="indent">You can find this command at <em class="calibre3"><a href="https://brew.sh/" class="calibre6">https://brew.sh/</a></em>. Make sure you include a space between <span class="literal">curl -fsSL</span> and the URL.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">The <span class="codeitalic">-e</span> in this command tells Ruby (the programming language Homebrew is written in) to execute the code that’s downloaded here. You should only run commands like this from sources you trust.</em></p>
</div>
<p class="indent">To confirm that Homebrew installed correctly, run this command:</p>
<p class="programs">$ <span class="codestrong">brew doctor</span><br class="calibre4" />
Your system is ready to brew.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-466" class="calibre"></span>This output means you’re ready to use Homebrew to install packages to your system.</p>
<h4 class="h3" id="calibre_link-1189"><strong class="calibre2"><em class="calibre3">Installing Python</em></strong></h4>
<p class="noindent">To install the latest version of Python, enter the following command:</p>
<p class="programs">$ <span class="codestrong">brew install python</span></p>
<p class="indent">Check which version was installed by using this command:</p>
<p class="programs">$ <span class="codestrong">python3 --version</span><br class="calibre4" />
Python 3.7.2<br class="calibre4" />
$</p>
<p class="indent">Now you can start a Python terminal session using the command <span class="literal">python3</span>. You can also use the <span class="literal">python3</span> command in your text editor so it runs programs with the version of Python you just installed instead of the system’s earlier version. If you need help configuring Sublime Text to use the version you just installed, see the instructions in <a href="#calibre_link-21" class="calibre6">Chapter 1</a>.</p>
<h3 class="h2" id="calibre_link-1190"><strong class="calibre2">Python on Linux</strong></h3>
<p class="noindent">Python is included by default on almost every Linux system. But if the default version is earlier than Python 3.6, you should install the latest version. The following instructions should work for most apt-based systems.</p>
<p class="indent">We’ll use a package called <span class="literal">deadsnakes</span>, which makes it easy to install multiple versions of Python. Enter the following commands:</p>
<p class="programs">$ <span class="codestrong">sudo add-apt-repository ppa:deadsnakes/ppa</span><br class="calibre4" />
$ <span class="codestrong">sudo apt-get update</span><br class="calibre4" />
$ <span class="codestrong">sudo apt install python3.7</span></p>
<p class="indent">These commands should install Python 3.7 onto your system.</p>
<p class="indent">Enter the following command to start a terminal session that runs Python 3.7:</p>
<p class="programs">$ <span class="codestrong">python3.7</span><br class="calibre4" />
&gt;&gt;&gt;</p>
<p class="indent">You’ll also want to use this command when you configure your text editor and when you run programs from the terminal.</p>
<h3 class="h2" id="calibre_link-63"><span type="pagebreak" id="calibre_link-64" class="calibre"></span><strong class="calibre2">Python Keywords and Built-in Functions</strong></h3>
<p class="noindent">Python comes with its own set of keywords and built-in functions. It’s important to be aware of these when you’re naming variables: your variable names cannot be the same as these keywords and shouldn’t be the same as the function names, or you’ll overwrite the functions.</p>
<p class="indent">In this section, we’ll list Python’s keywords and built-in function names, so you’ll know which names to avoid.</p>
<h4 class="h3" id="calibre_link-1191"><strong class="calibre2"><em class="calibre3">Python Keywords</em></strong></h4>
<p class="noindent">Each of the following keywords has a specific meaning, and you’ll see an error if you try to use any of them as a variable name.</p>
<p class="programs">False&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;await&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass<br class="calibre4" />
None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise<br class="calibre4" />
True&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finally&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br class="calibre4" />
and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue&nbsp;&nbsp;&nbsp;for&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lambda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br class="calibre4" />
as&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonlocal&nbsp;&nbsp;&nbsp;while<br class="calibre4" />
assert&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;del&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with<br class="calibre4" />
async&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yield</p>
<h4 class="h3" id="calibre_link-1192"><strong class="calibre2"><em class="calibre3">Python Built-in Functions</em></strong></h4>
<p class="noindent">You won’t get an error if you use one of the following readily available built-in functions as a variable name, but you’ll override the behavior of that function:</p>
<p class="programs">abs()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delattr()&nbsp;&nbsp;&nbsp;hash()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memoryview()&nbsp;&nbsp;&nbsp;&nbsp;set()<br class="calibre4" />
all()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dict()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr()<br class="calibre4" />
any()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dir()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice()<br class="calibre4" />
ascii()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;divmod()&nbsp;&nbsp;&nbsp;&nbsp;id()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sorted()<br class="calibre4" />
bin()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enumerate() input()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oct()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;staticmethod()<br class="calibre4" />
bool()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str()<br class="calibre4" />
breakpoint()&nbsp;&nbsp;&nbsp;&nbsp;exec()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isinstance()&nbsp;&nbsp;&nbsp;&nbsp;ord()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum()<br class="calibre4" />
bytearray()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter()&nbsp;&nbsp;&nbsp;&nbsp;issubclass()&nbsp;&nbsp;&nbsp;&nbsp;pow()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super()<br class="calibre4" />
bytes()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuple()<br class="calibre4" />
callable()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format()&nbsp;&nbsp;&nbsp;&nbsp;len()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type()<br class="calibre4" />
chr()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frozenset() list()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vars()<br class="calibre4" />
classmethod()&nbsp;&nbsp;&nbsp;getattr()&nbsp;&nbsp;&nbsp;locals()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repr()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zip()<br class="calibre4" />
compile()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;globals()&nbsp;&nbsp;&nbsp;map()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reversed()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__import__()<br class="calibre4" />
complex()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hasattr()&nbsp;&nbsp;&nbsp;max()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;round()<span type="pagebreak" id="calibre_link-1460" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-1244">
<h2 class="h" id="calibre_link-2"><span type="pagebreak" id="calibre_link-440" class="calibre"></span><strong class="calibre2"><span class="big">B</span><br class="calibre4" />TEXT EDITORS AND IDEs</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Programmers spend a lot of time writing, reading, and editing code, and using a text editor or an <em class="calibre3">integrated development environment (IDE)</em> to make this work as efficient as possible is essential. A good editor will do simple tasks, like highlight your code’s structure so you can catch common bugs as you’re working. But it won’t do so much that it distracts you from your thinking. Editors also have useful features like automatic indenting, markers to show appropriate line length, and keyboard shortcuts for common operations.</p>
<p class="indent">An IDE is a text editor with a number of other tools included, like interactive debuggers and code introspection. An IDE examines your code as you enter it and tries to learn about the project you’re building. For example, when you start typing the name of a function, an IDE might show you all the arguments that function accepts. This behavior can be very helpful when everything works and you understand what you’re seeing. But it can also be overwhelming as a beginner and difficult to troubleshoot when you aren’t sure why your code isn’t working in the IDE.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-551" class="calibre"></span>I encourage you to use a simple text editor while you’re learning to code. Text editors also put a much lighter load on your system; so if you’re working on an older machine or one with fewer resources, a text editor will work better than an IDE. If you’re already familiar with IDEs or if people around you use an IDE and you want to use a similar environment, by all means try them out.</p>
<p class="indent">Don’t worry too much about choosing your tools at this point; your time will be better spent digging into the language and working on the projects you’re interested in. Once you’ve mastered the basics, you’ll have a better idea what tools work for you.</p>
<p class="indent">In this appendix, we’ll set up the Sublime Text text editor to help you work more efficiently. We’ll also take a brief look at a number of other editors you might consider using or see other Python programmers using.</p>
<h3 class="h2" id="calibre_link-1193"><strong class="calibre2">Customizing Sublime Text Settings</strong></h3>
<p class="noindent">In <a href="#calibre_link-21" class="calibre6">Chapter 1</a>, you configured Sublime Text to use the Python version you want it to when running your programs. Now we’ll configure it to do some of the tasks mentioned at the beginning of this appendix.</p>
<h4 class="h3" id="calibre_link-1194"><strong class="calibre2"><em class="calibre3">Converting Tabs to Spaces</em></strong></h4>
<p class="noindent">If you use a mix of tabs and spaces in your code, it can cause problems in your programs that are difficult to diagnose. To avoid this, you can configure Sublime Text to always use spaces for indentation, even when you press the <small class="calibre5">TAB</small> key. Go to <strong class="calibre2">View <span class="ent">▸</span> Indentation</strong> and make sure the <strong class="calibre2">Indent Using Spaces</strong> option is selected. If it’s not, select it. Also, make sure the <strong class="calibre2">Tab Width</strong> is set to <strong class="calibre2">4</strong> spaces.</p>
<p class="indent">If you already have a mix of tabs and spaces in one of your programs, you can convert all tabs to spaces by clicking <strong class="calibre2">View <span class="ent">▸</span> Indentation <span class="ent">▸</span> Convert Tabs to Spaces</strong>. You can also access these settings by clicking <strong class="calibre2">Spaces</strong> at the bottom right of the Sublime Text window.</p>
<p class="indent">Now you can use the <small class="calibre5">TAB</small> key to indent lines of code, and Sublime Text will insert spaces automatically to indent those lines.</p>
<h4 class="h3" id="calibre_link-1195"><strong class="calibre2"><em class="calibre3">Setting the Line Length Indicator</em></strong></h4>
<p class="noindent">Most editors allow you to set up a visual cue, usually a vertical line, to show where your lines should end. In the Python community, the convention is to limit lines to 79 characters or less. To set this feature, select <strong class="calibre2">View <span class="ent">▸</span> Ruler</strong>, and then click <strong class="calibre2">80</strong>. Sublime Text will place a vertical line at the 80-character mark to help restrict your code lines to an appropriate length.</p>
<h4 class="h3" id="calibre_link-1196"><strong class="calibre2"><em class="calibre3">Indenting and Unindenting Code Blocks</em></strong></h4>
<p class="noindent">To indent an entire block of code, highlight it and select <strong class="calibre2">Edit <span class="ent">▸</span> Line <span class="ent">▸</span> Indent</strong> or press <small class="calibre5">CTRL</small>-], or <img class="middle" src="images/000044.jpg" alt="Image" />-] on macOS. To unindent a block of code, click <strong class="calibre2">Edit <span class="ent">▸</span> Line <span class="ent">▸</span> Unindent</strong> or press <small class="calibre5">CTRL</small>-[, or <img class="middle" src="images/000044.jpg" alt="Image" />-[.</p>
<h4 class="h3" id="calibre_link-1197"><span type="pagebreak" id="calibre_link-441" class="calibre"></span><strong class="calibre2"><em class="calibre3">Commenting Out Blocks of Code</em></strong></h4>
<p class="noindent">To temporarily disable a block of code, you can highlight the block and comment it so Python will ignore it. Select <strong class="calibre2">Edit <span class="ent">▸</span> Comment <span class="ent">▸</span> Toggle Comment</strong> (<small class="calibre5">CTRL</small>-/ or <img class="middle" src="images/000044.jpg" alt="Image" />-/). The selected lines will be commented out with a hash mark (<span class="literal">#</span>) indented at the same level as the line of code to indicate these are not regular comments. When you want to uncomment the block of code, highlight the block and reissue the same command.</p>
<h4 class="h3" id="calibre_link-1198"><strong class="calibre2"><em class="calibre3">Saving Your Configuration</em></strong></h4>
<p class="noindent">Some of the settings mentioned only affect the current file you’re working in. To make your settings affect all files you open in Sublime Text, you’ll need to define your user settings. Select <strong class="calibre2">Sublime Text <span class="ent">▸</span> Preferences <span class="ent">▸</span> Settings</strong>, and look for the file <em class="calibre3">Preferences.sublime-settings &ndash; User</em>. Enter the following in this file:</p>
<p class="programs">{<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"rulers": [80],<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;"translate_tabs_to_spaces": true<br class="calibre4" />
}</p>
<p class="indent">Save this file, and your ruler and tab settings will apply to all files you work with in Sublime Text. If you add more settings to this file, make sure each line ends with a comma except the last line. You can look at other users’ settings files online and customize your editor to the settings that help you work most efficiently.</p>
<h4 class="h3" id="calibre_link-1199"><strong class="calibre2"><em class="calibre3">Further Customizations</em></strong></h4>
<p class="noindent">You can customize Sublime Text in many ways to help you work even more efficiently. As you’re exploring the menus, keep an eye out for keyboard shortcuts for the menu items you use most often. Every time you use a keyboard shortcut instead of reaching for the mouse or trackpad, you become a bit more efficient. Don’t try to learn everything at once; just try to become efficient with the actions you use most, and be on the lookout for other features that might help you develop your own workflow.</p>
<h3 class="h2" id="calibre_link-1200"><strong class="calibre2">Other Text Editors and IDEs</strong></h3>
<p class="noindent">You’ll hear about and see people using a number of other text editors. Most of them can be configured to help you in the same way you customized Sublime Text. Here’s a small selection of text editors you might hear about.</p>
<h4 class="h3" id="calibre_link-1201"><strong class="calibre2"><em class="calibre3">IDLE</em></strong></h4>
<p class="noindent">IDLE is a text editor that’s included with Python. It’s a little less intuitive to work with than Sublime Text, but you’ll see references to it in other tutorials aimed at beginners, so you might want to give it a try.</p>
<h4 class="h3" id="calibre_link-1202"><span type="pagebreak" id="calibre_link-406" class="calibre"></span><strong class="calibre2"><em class="calibre3">Geany</em></strong></h4>
<p class="noindent">Geany is a simple text editor that lets you run all of your programs directly from the editor. It displays all of your output in a terminal window, which helps you become comfortable using terminals. Geany has a very simple interface, but it’s powerful enough that a significant number of experienced programmers still use it.</p>
<h4 class="h3" id="calibre_link-1203"><strong class="calibre2"><em class="calibre3">Emacs and Vim</em></strong></h4>
<p class="noindent">Emacs and Vim are two popular editors favored by many experienced programmers because they’re designed to be used so your hands never have to leave the keyboard. This makes writing, reading, and modifying code very efficient once you learn how the editor works. It also means both editors have a fairly steep learning curve. Vim is included on most Linux and macOS machines, and both Emacs and Vim can be run entirely inside a terminal. For this reason, they’re often used to write code on servers through a remote terminal session.</p>
<p class="indent">Programmers will often recommend that you give them a try. But many proficient programmers forget how much new programmers are already trying to learn. It’s beneficial to be aware of these editors, but hold off on using them until you’re comfortable working with code in a simpler editor that lets you focus on learning to program rather than learning to use an editor.</p>
<h4 class="h3" id="calibre_link-1204"><strong class="calibre2"><em class="calibre3">Atom</em></strong></h4>
<p class="noindent">Atom is a text editor with some features that you’d normally find in an IDE. You can open an individual file you’re working on, or you can open a project folder and Atom will instantly make all the files in that project easily accessible. Atom is integrated with Git and GitHub, so as you start to use version control you’ll be able to work with local and remote repositories from within your editor instead of having to do so in a separate terminal.</p>
<p class="indent">Atom allows you to install packages as well, so you can extend its behavior in many ways. A number of these packages incorporate behavior that makes Atom behave more like an IDE.</p>
<h4 class="h3" id="calibre_link-1205"><strong class="calibre2"><em class="calibre3">Visual Studio Code</em></strong></h4>
<p class="noindent">Visual Studio Code, also called VS Code, is another editor that acts more like an IDE. VS Code supports efficient use of a debugger, has integrated version control support, and also offers code completion tools.</p>
<h4 class="h3" id="calibre_link-1206"><strong class="calibre2"><em class="calibre3">PyCharm</em></strong></h4>
<p class="noindent">PyCharm is a popular IDE among Python programmers because it was built to work specifically with Python. The full version requires a paid subscription, but a free version called the PyCharm Community Edition is also available that many developers find useful.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-559" class="calibre"></span>PyCharm features a <em class="calibre3">linter</em>, which checks that your coding style matches common Python conventions, and offers suggestions when you deviate from normal Python formatting. It also has an integrated debugger to help you resolve errors proficiently and modes that help you work efficiently with a number of popular Python libraries.</p>
<h4 class="h3" id="calibre_link-1207"><strong class="calibre2"><em class="calibre3">Jupyter Notebooks</em></strong></h4>
<p class="noindent">Jupyter Notebook is a different kind of tool than traditional text editors or IDEs in that it’s a web app primarily built of blocks; each block is either a code block or a text block. The text blocks are rendered in Markdown, so you can include simple formatting in your text blocks.</p>
<p class="indent">Jupyter Notebooks were developed to support the use of Python in scientific applications, but they have since expanded to become useful in a wide variety of situations. Rather than just writing comments inside a <em class="calibre3">.py</em> file, you can write clear text with simple formatting, such as headers, bulleted lists, and hyperlinks in between sections of code. Every code block can be run independently, allowing you to test small pieces of your program, or you can run all the code blocks at once. Each code block has its own output area, and you can toggle the output areas on or off as needed.</p>
<p class="indent">Jupyter Notebooks can be confusing at times because of the interactions between different cells. If you define a function in one cell, that function is available to other cells as well. This is beneficial most of the time, but it can be confusing in longer notebooks and if you don’t fully understand how the Notebook environment works.</p>
<p class="indent">If you’re doing any scientific or data-focused work in Python, you’ll almost certainly see Jupyter Notebooks at some point.<span type="pagebreak" id="calibre_link-1461" class="calibre"></span></p>
</div>


<div class="calibre1" id="calibre_link-95">
<h2 class="h" id="calibre_link-6"><span type="pagebreak" id="calibre_link-412" class="calibre"></span><strong class="calibre2"><span class="big">C</span><br class="calibre4" />GETTING HELP</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Everyone gets stuck at some point when they’re learning to program. So one of the most important skills to learn as a programmer is how to get unstuck efficiently. This appendix outlines several ways to help you get going again when programming gets confusing.</p>
<h3 class="h2" id="calibre_link-1208"><strong class="calibre2">First Steps</strong></h3>
<p class="noindent">When you’re stuck, your first step should be to assess your situation. Before you ask for help from anyone else, answer the following three questions clearly:</p>
<ul class="calibre8">
<li class="noindent1">What are you trying to do?</li>
<li class="noindent1">What have you tried so far?</li>
<li class="noindent1">What results have you been getting?</li>
</ul>
<p class="indent"><span type="pagebreak" id="calibre_link-411" class="calibre"></span>Make your answers as specific as possible. For the first question, explicit statements like “I’m trying to install the latest version of Python on my Windows 10 laptop” are detailed enough for others in the Python community to help you. Statements like “I’m trying to install Python” don’t provide enough information for others to offer much help.</p>
<p class="indent">Your answer to the second question should provide enough detail so you won’t be advised to repeat what you’ve already tried: “I went to <em class="calibre3"><a href="https://python.org/downloads/" class="calibre6">https://python.org/downloads/</a></em> and clicked the Download button for my system. Then I ran the installer,” is more helpful than “I went to the Python website and downloaded something.”</p>
<p class="indent">For the third question, it’s helpful to know the exact error messages you received so you can search online for a solution or provide them when asking for help.</p>
<p class="indent">Sometimes just answering these three questions before you ask for help from others allows you to see something you’re missing and get you unstuck without having to go any further. Programmers even have a name for this: it’s called <em class="calibre3">rubber duck debugging</em>. The idea is that if you clearly explain your situation to a rubber duck (or any inanimate object), and ask it a specific question, you’ll often be able to answer your own question. Some programming shops even keep a real rubber duck around to encourage people to “talk to the duck.”</p>
<h4 class="h3" id="calibre_link-1209"><strong class="calibre2"><em class="calibre3">Try It Again</em></strong></h4>
<p class="noindent">Just going back to the start and trying again can be enough to solve many problems. Say you’re trying to write a <span class="literal">for</span> loop based on an example in this book. You might have only missed something simple, like a colon at the end of the <span class="literal">for</span> line. Going through the steps again might help you avoid repeating the same mistake.</p>
<h4 class="h3" id="calibre_link-1210"><strong class="calibre2"><em class="calibre3">Take a Break</em></strong></h4>
<p class="noindent">If you’ve been working on the same problem for a while, taking a break is one of the best tactics you can try. When we work on the same task for long periods of time, our brains start to zero in on only one solution. We lose sight of the assumptions we’ve made, and taking a break helps us get a fresh perspective on the problem. It doesn’t need to be a long break, just something that gets you out of your current mind-set. If you’ve been sitting for a long time, do something physical: take a short walk or go outside for a bit; perhaps drink a glass of water or eat a light and healthy snack.</p>
<p class="indent">If you’re getting frustrated, it might be worth putting your work away for the day. A good night’s sleep almost always makes a problem more approachable.</p>
<h4 class="h3" id="calibre_link-1211"><strong class="calibre2"><em class="calibre3">Refer to This Book’s Resources</em></strong></h4>
<p class="noindent">The online resources for this book, available at <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em>, include a number of helpful sections about setting <span type="pagebreak" id="calibre_link-410" class="calibre"></span>up your system and working through each chapter. If you haven’t done so already, take a look at these resources and see if there’s anything that helps your situation.</p>
<h3 class="h2" id="calibre_link-1212"><strong class="calibre2">Searching Online</strong></h3>
<p class="noindent">Chances are that someone else has had the same problem you’re having and has written about it online. Good searching skills and specific inquiries will help you find existing resources to solve the issue you’re facing. For example, if you’re struggling to install the latest version of Python on Windows 10, searching for <em class="calibre3">install python windows 10</em> and limiting the results to resources from the last year might direct you to a clear answer.</p>
<p class="indent">Searching the exact error message can be extremely helpful too. For example, say you get the following error when you try to start a Python terminal session:</p>
<p class="programs">&gt; <span class="codestrong">python</span><br class="calibre4" />
'python' is not recognized as an internal or external command,<br class="calibre4" />
operable program or batch file<br class="calibre4" />
&gt;</p>
<p class="indent">Searching for the full phrase “python is not recognized as an internal or external command” will probably yield some good advice.</p>
<p class="indent">When you start searching for programming-related topics, a few sites will appear repeatedly. I’ll describe some of these sites briefly, so you’ll know how helpful they’re likely to be.</p>
<h4 class="h3" id="calibre_link-1213"><strong class="calibre2"><em class="calibre3">Stack Overflow</em></strong></h4>
<p class="noindent">Stack Overflow (<em class="calibre3"><a href="https://stackoverflow.com/" class="calibre6">https://stackoverflow.com/</a></em>) is one of the most popular question-and-answer sites for programmers, and will often appear in the first page of results on Python-related searches. Members post questions when they’re stuck, and other members try to give helpful responses. Users can vote for the responses they find most helpful, so the best answers are usually the first ones you’ll find.</p>
<p class="indent">Many basic Python questions have very clear answers on Stack Overflow, because the community has refined them over time. Users are encouraged to post updates too, so responses tend to stay relatively current. At the time of this writing, over one million Python-related questions have been answered on Stack Overflow.</p>
<h4 class="h3" id="calibre_link-1214"><strong class="calibre2"><em class="calibre3">The Official Python Documentation</em></strong></h4>
<p class="noindent">The official Python documentation (<em class="calibre3"><a href="https://docs.python.org/" class="calibre6">https://docs.python.org/</a></em>) is a bit more hit or miss for beginners, because its purpose is more to document the language than to provide explanations. The examples in the official documentation should work, but you might not understand everything shown. Still, it’s a good resource to check when it comes up in your searches and will become more useful to you as you continue building your understanding of Python.</p>
<h4 class="h3" id="calibre_link-1215"><span type="pagebreak" id="calibre_link-408" class="calibre"></span><strong class="calibre2"><em class="calibre3">Official Library Documentation</em></strong></h4>
<p class="noindent">If you’re using a specific library, such as Pygame, Matplotlib, Django, and so on, links to the official documentation for that project will often appear in searches&mdash;for example, <em class="calibre3"><a href="https://docs.djangoproject.com/" class="calibre6">https://docs.djangoproject.com/</a></em> is very helpful. If you’re planning to work with any of these libraries, it’s a good idea to become familiar with their official documentation.</p>
<h4 class="h3" id="calibre_link-1216"><strong class="calibre2"><em class="calibre3">r/learnpython</em></strong></h4>
<p class="noindent">Reddit is made up of a number of subforums called <em class="calibre3">subreddits</em>. The <em class="calibre3">r/learnpython</em> subreddit (<em class="calibre3"><a href="https://reddit.com/r/learnpython/" class="calibre6">https://reddit.com/r/learnpython/</a></em>) is fairly active and supportive. Here you can read others’ questions and post your own.</p>
<h4 class="h3" id="calibre_link-1217"><strong class="calibre2"><em class="calibre3">Blog Posts</em></strong></h4>
<p class="noindent">Many programmers maintain blogs and share posts about the parts of the language they’re working with. You should skim the first few comments on a blog post to see what reactions other people have had before taking any advice. If no comments appear, take the post with a grain of salt. It’s possible no one else has verified the advice.</p>
<h3 class="h2" id="calibre_link-1218"><strong class="calibre2">Internet Relay Chat</strong></h3>
<p class="noindent">Many programmers interact in real time through Internet Relay Chat (IRC). If you’re stuck on a problem and searching online isn’t providing answers, asking in an IRC channel might be a good option. Most people who hang out in these channels are polite and helpful, especially if you can be specific about what you’re trying to do, what you’ve already tried, and what results you’re getting.</p>
<h4 class="h3" id="calibre_link-1219"><strong class="calibre2"><em class="calibre3">Making an IRC Account</em></strong></h4>
<p class="noindent">To create an account on IRC, go to <em class="calibre3"><a href="https://webchat.freenode.net/" class="calibre6">https://webchat.freenode.net/</a></em>. Choose a nickname, fill out the CAPTCHA box, and click <strong class="calibre2">Connect</strong>. You’ll see a message welcoming you to the freenode IRC server. In the box at the bottom of the window, enter the following command:</p>
<p class="programs"><span class="codestrong">/msg nickserv register</span> <span class="codestrongitalic">password email</span></p>
<p class="indent">Enter your own password and email address in place of <span class="codeitalic">password</span> and <span class="codeitalic">email</span>. Choose a password that you don’t use for any other account. You’ll receive an email with instructions to verify your account. The email will provide you with a command like this:</p>
<p class="programs"><span class="codestrong">/msg nickserv verify register</span> <span class="codestrongitalic">nickname verification_code</span></p>
<p class="indent">Paste this line into the IRC site with <span class="codeitalic">nickname</span> as the name you chose earlier and a value for <span class="codeitalic">verification_code</span>. Now you’re ready to join a channel.</p>
<p class="indent"><span type="pagebreak" id="calibre_link-409" class="calibre"></span>If you have trouble logging into your account at some point, you can issue the following command:</p>
<p class="programs"><span class="codestrong">/msg nickserv identify</span> <span class="codestrongitalic">nickname password</span></p>
<p class="indent">Replace <span class="codeitalic">nickname</span> and <span class="codeitalic">password</span> with your own nickname and password. This will authenticate you on the network, and you’ll be able to access channels that require an authenticated nickname.</p>
<h4 class="h3" id="calibre_link-1220"><strong class="calibre2"><em class="calibre3">Channels to Join</em></strong></h4>
<p class="noindent">To join the main Python channel, enter <span class="codestrong1">/join #python</span> in the input box. You’ll see a confirmation that you joined the channel and some general information about the channel.</p>
<p class="indent">The channel <em class="calibre3">##learnpython</em> (with two hashtags) is usually quite active as well. This channel is associated with <em class="calibre3"><a href="https://reddit.com/r/learnpython/" class="calibre6">https://reddit.com/r/learnpython/</a></em>, so you’ll see messages about posts on <em class="calibre3">r/learnpython</em> too. You might want to join the <em class="calibre3">#django</em> channel if you’re working on web applications.</p>
<p class="indent">After you’ve joined a channel, you can read the conversations other people are having and ask your own questions as well.</p>
<h4 class="h3" id="calibre_link-1221"><strong class="calibre2"><em class="calibre3">IRC Culture</em></strong></h4>
<p class="noindent">To get effective help, you should know a few details about IRC culture. Focusing on the three questions at the beginning of this appendix will definitely help guide you to a successful solution. People will be happy to help you if you can explain precisely what you’re trying to do, what you’ve already tried, and the exact results you’re getting. If you need to share code or output, IRC members use external sites made for this purpose, such as <em class="calibre3"><a href="https://bpaste.net/+python" class="calibre6">https://bpaste.net/+python</a></em>. (This is where <span class="literal">#python</span> sends you to share code and output.) This keeps the channels from being flooded with code and also makes it much easier to read the code that people share.</p>
<p class="indent">Being patient will always make people more likely to help you. Ask your question concisely, and then wait for someone to respond. Often, people are in the middle of many conversations, but usually someone will address you in a reasonable amount of time. If few people are in the channel, it might take a while to get a response.</p>
<h3 class="h2" id="calibre_link-1222"><strong class="calibre2">Slack</strong></h3>
<p class="noindent">Slack is like a modern-day reinvention of IRC. It’s often used for internal company communications, but there are also many public groups you can join. If you want to check out Python Slack groups, start with <em class="calibre3"><a href="https://pyslackers.com/" class="calibre6">https://pyslackers.com/</a></em>. Click the <strong class="calibre2">Slack</strong> link at the top of the page, and enter your email address to get an invitation.</p>
<p class="indent">Once you’re in the Python Developers workspace, you’ll see a list of channels. Click <strong class="calibre2">Channels</strong>, and then choose the topics that interest you. You might want to start with the <em class="calibre3">#learning_python</em> and <em class="calibre3">#django</em> channels.</p>
<h3 class="h2" id="calibre_link-1223"><span type="pagebreak" id="calibre_link-407" class="calibre"></span><strong class="calibre2">Discord</strong></h3>
<p class="noindent">Discord is another online chat environment with a Python community where you can ask for help and follow Python-related discussions.</p>
<p class="indent">To check it out, head to <em class="calibre3"><a href="https://pythondiscord.com/" class="calibre6">https://pythondiscord.com/</a></em> and click the <strong class="calibre2">Chat Now</strong> link. You should see a screen with an automatically generated invitation; click <strong class="calibre2">Accept Invite</strong>. If you already have a Discord account, you can log in with your existing account. If you don’t have an account, enter a username and follow the prompts to complete your Discord registration.</p>
<p class="indent">If this is your first time visiting the Python Discord, you’ll need to accept the rules for the community before participating fully. Once you’ve done that, you can join any of the channels that interest you. If you’re looking for help, be sure to post in one of the Python Help channels.</p>
</div>


<div class="calibre1" id="calibre_link-1240">
<h2 class="h" id="calibre_link-67"><span type="pagebreak" id="calibre_link-561" class="calibre"></span><strong class="calibre2"><span class="big">D</span><br class="calibre4" />USING GIT FOR VERSION CONTROL</strong></h2>
<div class="image"><img src="images/000037.jpg" alt="Image" class="calibre7" /></div>
<p class="noindent">Version control software allows you to take snapshots of a project whenever it’s in a working state. When you make changes to a project&mdash;for example, when you implement a new feature&mdash;you can revert back to a previous working state if the project’s current state isn’t functioning well.</p>
<p class="indent">Using version control software gives you the freedom to work on improvements and make mistakes without worrying about ruining your project. This is especially critical in large projects, but can also be helpful in smaller projects, even when you’re working on programs contained in a single file.</p>
<p class="indent">In this appendix, you’ll learn to install Git and use it for version control in the programs you’re working on now. Git is the most popular version control software in use today. Many of its advanced tools help teams collaborate on large projects, but its most basic features also work well for solo developers. Git implements version control by tracking the changes made to every file in a project; if you make a mistake, you can just return to a previously saved state.</p>
<h3 class="h2" id="calibre_link-1224"><span type="pagebreak" id="calibre_link-421" class="calibre"></span><strong class="calibre2">Installing Git</strong></h3>
<p class="noindent">Git runs on all operating systems, but there are different approaches to installing it on each system. The following sections provide specific instructions for each operating system.</p>
<h4 class="h3" id="calibre_link-1225"><strong class="calibre2"><em class="calibre3">Installing Git on Windows</em></strong></h4>
<p class="noindent">You can download an installer for Git at <em class="calibre3"><a href="https://git-scm.com/" class="calibre6">https://git-scm.com/</a></em>. You should see a download link for an installer that’s appropriate for your system.</p>
<h4 class="h3" id="calibre_link-1226"><strong class="calibre2"><em class="calibre3">Installing Git on macOS</em></strong></h4>
<p class="noindent">Git might already be installed on your system, so try issuing the command <span class="codestrong1">git --version</span>. If you see output listing a specific version number, Git is installed on your system. If you see a message prompting you to install or update Git, simply follow the onscreen directions.</p>
<p class="indent">You can also visit <em class="calibre3"><a href="https://git-scm.com/" class="calibre6">https://git-scm.com/</a></em>, where you should see a download link for an appropriate installer for your system.</p>
<h4 class="h3" id="calibre_link-1227"><strong class="calibre2"><em class="calibre3">Installing Git on Linux</em></strong></h4>
<p class="noindent">To install Git on Linux, enter the following command:</p>
<p class="programs">$ <span class="codestrong">sudo apt install git-all</span></p>
<p class="indent">That’s it. You can now use Git in your projects.</p>
<h4 class="h3" id="calibre_link-1228"><strong class="calibre2"><em class="calibre3">Configuring Git</em></strong></h4>
<p class="noindent">Git keeps track of who makes changes to a project, even when only one person is working on the project. To do this, Git needs to know your username and email. You must provide a username, but you can make up a fake email address:</p>
<p class="programs">$ <span class="codestrong">git config --global user.name "</span><span class="codestrongitalic">username</span><span class="codestrong">"</span><br class="calibre4" />
$ <span class="codestrong">git config --global user.email "</span><span class="codestrongitalic">username@example.com</span><span class="codestrong">"</span></p>
<p class="indent">If you forget this step, Git will prompt you for this information when you make your first commit.</p>
<h3 class="h2" id="calibre_link-1229"><strong class="calibre2">Making a Project</strong></h3>
<p class="noindent">Let’s make a project to work with. Create a folder somewhere on your system called <em class="calibre3">git_practice</em>. Inside the folder, make a simple Python program:</p>
<p class="margin"><em class="calibre3">hello_git.py</em></p>
<p class="programs">print("Hello Git world!")</p>
<p class="indent">We’ll use this program to explore Git’s basic functionality.</p>
<h3 class="h2" id="calibre_link-1230"><span type="pagebreak" id="calibre_link-423" class="calibre"></span><strong class="calibre2">Ignoring Files</strong></h3>
<p class="noindent">Files with the extension <em class="calibre3">.pyc</em> are automatically generated from <em class="calibre3">.py</em> files, so we don’t need Git to keep track of them. These files are stored in a directory called <em class="calibre3">__pycache__</em>. To tell Git to ignore this directory, make a special file called <em class="calibre3">.gitignore</em>&mdash;with a dot at the beginning of the filename and no file extension&mdash;and add the following line to it:</p>
<p class="margin"><em class="calibre3">.gitignore</em></p>
<p class="programs">__pycache__/</p>
<p class="indent">This file tells Git to ignore any file in the <em class="calibre3">__pycache__</em> directory. Using a <em class="calibre3">.gitignore</em> file will keep your project clutter free and easier to work with.</p>
<p class="indent">You might need to modify your text editor’s settings so it will show hidden files in order to open <em class="calibre3">.gitignore</em>. Some editors are set to ignore filenames that begin with a dot.</p>
<h3 class="h2" id="calibre_link-1231"><strong class="calibre2">Initializing a Repository</strong></h3>
<p class="noindent">Now that you have a directory containing a Python file and a <em class="calibre3">.gitignore</em> file, you can initialize a Git repository. Open a terminal, navigate to the <em class="calibre3">git_practice</em> folder, and run the following command:</p>
<p class="programs">git_practice$ <span class="codestrong">git init</span><br class="calibre4" />
Initialized empty Git repository in git_practice/.git/<br class="calibre4" />
git_practice$</p>
<p class="indent">The output shows that Git has initialized an empty repository in <em class="calibre3">git_practice</em>. A <em class="calibre3">repository</em> is the set of files in a program that Git is actively tracking. All the files Git uses to manage the repository are located in the hidden directory <em class="calibre3">.git</em>, which you won’t need to work with at all. Just don’t delete that directory, or you’ll lose your project’s history.</p>
<h3 class="h2" id="calibre_link-1232"><strong class="calibre2">Checking the Status</strong></h3>
<p class="noindent">Before doing anything else, let’s look at the project’s status:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
<span class="ent">➊</span> On branch master<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;No commits yet<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span> Untracked files:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(use "git add &lt;file&gt;..." to include in what will be committed)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.gitignore<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hello_git.py<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> nothing added to commit but untracked files present (use "git add" to track)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent"><span type="pagebreak" id="calibre_link-415" class="calibre"></span>In Git, a <em class="calibre3">branch</em> is a version of the project you’re working on; here you can see that we’re on a branch named <span class="literal">master</span> <span class="ent">➊</span>. Each time you check your project’s status, it should show that you’re on the branch <span class="literal">master</span>. You then see that we’re about to make the initial commit. A <em class="calibre3">commit</em> is a snapshot of the project at a particular point in time.</p>
<p class="indent">Git informs us that untracked files are in the project <span class="ent">➋</span>, because we haven’t told it which files to track yet. Then we’re told that there’s nothing added to the current commit, but untracked files are present that we might want to add to the repository <span class="ent">➌</span>.</p>
<h3 class="h2" id="calibre_link-1233"><strong class="calibre2">Adding Files to the Repository</strong></h3>
<p class="noindent">Let’s add the two files to the repository, and check the status again:</p>
<p class="programs"><span class="ent">➊</span> git_practice$ <span class="codestrong">git add .</span><br class="calibre4" />
<span class="ent">➋</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;No commits yet<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Changes to be committed:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(use "git rm --cached &lt;file&gt;..." to unstage)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;&nbsp;new file:&nbsp;&nbsp;&nbsp;.gitignore<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new file:&nbsp;&nbsp;&nbsp;hello_git.py<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent">The command <span class="literal">git add .</span> adds all files within a project that aren’t already being tracked to the repository <span class="ent">➊</span>. It doesn’t commit the files; it just tells Git to start paying attention to them. When we check the status of the project now, we can see that Git recognizes some changes that need to be committed <span class="ent">➋</span>. The label <em class="calibre3">new file</em> means these files were newly added to the repository <span class="ent">➌</span>.</p>
<h3 class="h2" id="calibre_link-1234"><strong class="calibre2">Making a Commit</strong></h3>
<p class="noindent">Let’s make the first commit:</p>
<p class="programs"><span class="ent">➊</span> git_practice$ <span class="codestrong">git commit -m "Started project."</span><br class="calibre4" />
<span class="ent">➋</span> [master (root-commit) ee76419] Started project.<br class="calibre4" />
<span class="ent">➌</span>&nbsp;&nbsp;2 files changed, 4 insertions(+)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 .gitignore<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 hello_git.py<br class="calibre4" />
<span class="ent">➍</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working tree clean<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent"><span type="pagebreak" id="calibre_link-424" class="calibre"></span>We issue the command <span class="literal">git commit -m "</span><span class="codeitalic">message</span><span class="literal">"</span> <span class="ent">➊</span> to take a snapshot of the project. The <span class="literal">-m</span> flag tells Git to record the message that follows (<span class="literal">"Started project."</span>) in the project’s log. The output shows that we’re on the <span class="literal">master</span> branch <span class="ent">➋</span> and that two files have changed <span class="ent">➌</span>.</p>
<p class="indent">When we check the status now, we can see that we’re on the <span class="literal">master</span> branch, and we have a clean working tree <span class="ent">➍</span>. This is the message you want to see each time you commit a working state of your project. If you get a different message, read it carefully; it’s likely you forgot to add a file before making a commit.</p>
<h3 class="h2" id="calibre_link-1235"><strong class="calibre2">Checking the Log</strong></h3>
<p class="noindent">Git keeps a log of all commits made to the project. Let’s check the log:</p>
<p class="programs">git_practice$ <span class="codestrong">git log</span><br class="calibre4" />
commit a9d74d87f1aa3b8f5b2688cb586eac1a908cfc7f (HEAD -&gt; master)<br class="calibre4" />
Author: Eric Matthes &lt;eric@example.com&gt;<br class="calibre4" />
Date:&nbsp;&nbsp;&nbsp;Mon Jan 21 21:24:28 2019 -0900<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;Started project.<br class="calibre4" />
git_practice$</p>
<p class="indent">Each time you make a commit, Git generates a unique, 40-character reference ID. It records who made the commit, when it was made, and the message recorded. You won’t always need all of this information, so Git provides an option to print a simpler version of the log entries:</p>
<p class="programs">git_practice$ <span class="codestrong">git log --pretty=oneline</span><br class="calibre4" />
ee76419954379819f3f2cacafd15103ea900ecb2 (HEAD -&gt; master) Started project.<br class="calibre4" />
git_practice$</p>
<p class="indent">The <span class="literal">--pretty=oneline</span> flag provides the two most important pieces of information: the reference ID of the commit and the message recorded for the commit.</p>
<h3 class="h2" id="calibre_link-1236"><strong class="calibre2">The Second Commit</strong></h3>
<p class="noindent">To see the real power of version control, we need to make a change to the project and commit that change. Here we’ll just add another line to <em class="calibre3">hello_git.py</em>:</p>
<p class="margin"><em class="calibre3">hello_git.py</em></p>
<p class="programs"><span class="ash">print("Hello Git world!")</span><br class="calibre4" />
print("Hello everyone.")</p>
<p class="indent">When we check the status of the project, we’ll see that Git has noticed the file that changed:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
<span class="ent">➊</span> On branch master<br class="calibre4" />
<br class="calibre4" />
<span type="pagebreak" id="calibre_link-419" class="calibre"></span>&nbsp;&nbsp;&nbsp;Changes not staged for commit:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(use "git add &lt;file&gt;..." to update what will be committed)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➋</span>&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;hello_git.py<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➌</span> no changes added to commit (use "git add" and/or "git commit -a")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent">We see the branch we’re working on <span class="ent">➊</span>, the name of the file that was modified <span class="ent">➋</span>, and that no changes have been committed <span class="ent">➌</span>. Let’s commit the change and check the status again:</p>
<p class="programs"><span class="ent">➊</span> git_practice$ <span class="codestrong">git commit -am "Extended greeting."</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;[master 51f0fe5] Extended greeting.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;1 file changed, 1 insertion(+), 1 deletion(-)<br class="calibre4" />
<span class="ent">➋</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working tree clean<br class="calibre4" />
<span class="ent">➌</span> git_practice$ <span class="codestrong">git log --pretty=oneline</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;51f0fe5884e045b91c12c5449fabf4ad0eef8e5d (HEAD -&gt; master) Extended greeting.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ee76419954379819f3f2cacafd15103ea900ecb2 Started project.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent">We make a new commit, passing the <span class="literal">-am</span> flags when we use the command <span class="literal">git commit</span> <span class="ent">➊</span>. The <span class="literal">-a</span> flag tells Git to add all modified files in the repository to the current commit. (If you create any new files between commits, simply reissue the <span class="literal">git add .</span> command to include the new files in the repository.) The <span class="literal">-m</span> flag tells Git to record a message in the log for this commit.</p>
<p class="indent">When we check the project’s status, we see that we once again have a clean working directory <span class="ent">➋</span>. Finally, we see the two commits in the log <span class="ent">➌</span>.</p>
<h3 class="h2" id="calibre_link-1237"><strong class="calibre2">Reverting a Change</strong></h3>
<p class="noindent">Now let’s look at how to abandon a change and revert back to the previous working state. First, add a new line to <em class="calibre3">hello_git.py</em>:</p>
<p class="margin"><em class="calibre3">hello_git.py</em></p>
<p class="programs"><span class="ash">print("Hello Git world!")</span><br class="calibre4" />
<span class="ash">print("Hello everyone.")</span><br class="calibre4" />
<br class="calibre4" />
print("Oh no, I broke the project!")</p>
<p class="indent">Save and run this file.</p>
<p class="indent">We check the status and see that Git notices this change:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Changes not staged for commit:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(use "git add &lt;file&gt;..." to update what will be committed)<br class="calibre4" />
<span type="pagebreak" id="calibre_link-416" class="calibre"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(use "git checkout -- &lt;file&gt;..." to discard changes in working directory)<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;hello_git.py<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;no changes added to commit (use "git add" and/or "git commit -a")<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent">Git sees that we modified <em class="calibre3">hello_git.py</em> <span class="ent">➊</span>, and we can commit the change if we want to. But this time, instead of committing the change, we’ll revert back to the last commit when we knew our project was working. We won’t do anything to <em class="calibre3">hello_git.py</em>: we won’t delete the line or use the Undo feature in the text editor. Instead, enter the following commands in your terminal session:</p>
<p class="programs">git_practice$ <span class="codestrong">git checkout .</span><br class="calibre4" />
git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
On branch master<br class="calibre4" />
nothing to commit, working tree clean<br class="calibre4" />
git_practice$</p>
<p class="indent">The command <span class="literal">git checkout</span> allows you to work with any previous commit. The command <span class="literal">git checkout .</span> abandons any changes made since the last commit and restores the project to the last committed state.</p>
<p class="indent">When you return to your text editor, you’ll see that <em class="calibre3">hello_git.py</em> has changed back to this:</p>
<p class="programs"><span class="ash">print("Hello Git world!")</span><br class="calibre4" />
<span class="ash">print("Hello everyone.")</span></p>
<p class="indent">Although going back to a previous state might seem trivial in this simple project, if we were working on a large project with dozens of modified files, all the files that had changed since the last commit would be reverted. This feature is incredibly useful: you can make as many changes as you want when implementing a new feature, and if they don’t work, you can discard them without affecting the project. You don’t have to remember those changes and manually undo them. Git does all of that for you.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre3">You might have to refresh the file in your editor to see the previous version.</em></p>
</div>
<h3 class="h2" id="calibre_link-1238"><strong class="calibre2">Checking Out Previous Commits</strong></h3>
<p class="noindent">You can check out any commit in your log, not just the most recent, by including the first six characters of the reference ID instead of a dot. By checking out and reviewing an earlier commit, you can then return to the latest commit or abandon your recent work and pick up development from the earlier commit:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;git_practice$ <span class="codestrong">git log --pretty=oneline</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;51f0fe5884e045b91c12c5449fabf4ad0eef8e5d (HEAD -&gt; master) Extended greeting.<br class="calibre4" />
<span type="pagebreak" id="calibre_link-422" class="calibre"></span>&nbsp;&nbsp;&nbsp;ee76419954379819f3f2cacafd15103ea900ecb2 Started project.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$ <span class="codestrong">git checkout ee7641</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Note: checking out 'ee7641'.<br class="calibre4" />
<br class="calibre4" />
<span class="ent">➊</span> You are in 'detached HEAD' state. You can look around, make experimental<br class="calibre4" />
&nbsp;&nbsp;&nbsp;changes and commit them, and you can discard any commits you make in this<br class="calibre4" />
&nbsp;&nbsp;&nbsp;state without impacting any branches by performing another checkout.<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;If you want to create a new branch to retain commits you create, you may<br class="calibre4" />
&nbsp;&nbsp;&nbsp;do so (now or later) by using -b with the checkout command again. Example:<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;git checkout -b &lt;new-branch-name&gt;<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;HEAD is now at ee7641... Started project.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent">When you check out a previous commit, you leave the master branch and enter what Git refers to as a <em class="calibre3">detached HEAD</em> state <span class="ent">➊</span>. <em class="calibre3">HEAD</em> is the current committed state of the project; you’re <em class="calibre3">detached</em> because you’ve left a named branch (<span class="literal">master</span>, in this case).</p>
<p class="indent">To get back to the <span class="literal">master</span> branch, you check it out:</p>
<p class="programs">git_practice$ <span class="codestrong">git checkout master</span><br class="calibre4" />
Previous HEAD position was ee76419 Started project.<br class="calibre4" />
Switched to branch 'master'<br class="calibre4" />
git_practice$</p>
<p class="indent">This command brings you back to the <span class="literal">master</span> branch. Unless you want to work with some more advanced features of Git, it’s best not to make any changes to your project when you’ve checked out an old commit. However, if you’re the only one working on a project and you want to discard all of the more recent commits and go back to a previous state, you can reset the project to a previous commit. Working from the <span class="literal">master</span> branch, enter the following:</p>
<p class="programs"><span class="ent">➊</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working directory clean<br class="calibre4" />
<span class="ent">➋</span> git_practice$ <span class="codestrong">git log --pretty=oneline</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;51f0fe5884e045b91c12c5449fabf4ad0eef8e5d (HEAD -&gt; master) Extended greeting.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;ee76419954379819f3f2cacafd15103ea900ecb2 Started project.<br class="calibre4" />
<span class="ent">➌</span> git_practice$ <span class="codestrong">git reset --hard ee76419</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;HEAD is now at ee76419 Started project.<br class="calibre4" />
<span class="ent">➍</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working directory clean<br class="calibre4" />
<span class="ent">➎</span> git_practice$ <span class="codestrong">git log --pretty=oneline</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;ee76419954379819f3f2cacafd15103ea900ecb2 (HEAD -&gt; master) Started project.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent">We first check the status to make sure we’re on the <span class="literal">master</span> branch <span class="ent">➊</span>. When we look at the log, we see both commits <span class="ent">➋</span>. We then issue the <span class="literal">git reset --hard</span> <span type="pagebreak" id="calibre_link-417" class="calibre"></span>command with the first six characters of the reference ID of the commit we want to revert to permanently <span class="ent">➌</span>. We check the status again and see we’re on the <span class="literal">master</span> branch with nothing to commit <span class="ent">➍</span>. When we look at the log again, we see that we’re at the commit we wanted to start over from <span class="ent">➎</span>.</p>
<h3 class="h2" id="calibre_link-1239"><strong class="calibre2">Deleting the Repository</strong></h3>
<p class="noindent">Sometimes you’ll mess up your repository’s history and won’t know how to recover it. If this happens, first consider asking for help using the methods discussed in <a href="#calibre_link-6" class="calibre6">Appendix C</a>. If you can’t fix it and you’re working on a solo project, you can continue working with the files but get rid of the project’s history by deleting the <em class="calibre3">.git</em> directory. This won’t affect the current state of any of the files, but it will delete all commits, so you won’t be able to check out any other states of the project.</p>
<p class="indent">To do this, either open a file browser and delete the <em class="calibre3">.git</em> repository or delete it from the command line. Afterwards, you’ll need to start over with a fresh repository to start tracking your changes again. Here’s what this entire process looks like in a terminal session:</p>
<p class="programs"><span class="ent">➊</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working directory clean<br class="calibre4" />
<span class="ent">➋</span> git_practice$ <span class="codestrong">rm -rf .git</span><br class="calibre4" />
<span class="ent">➌</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;fatal: Not a git repository (or any of the parent directories): .git<br class="calibre4" />
<span class="ent">➍</span> git_practice$ <span class="codestrong">git init</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;Initialized empty Git repository in git_practice/.git/<br class="calibre4" />
<span class="ent">➎</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;No commits yet<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;Untracked files:<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(use "git add &lt;file&gt;..." to include in what will be committed)<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.gitignore<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hello_git.py<br class="calibre4" />
<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing added to commit but untracked files present (use "git add" to track)<br class="calibre4" />
<span class="ent">➏</span> git_practice$ <span class="codestrong">git add .</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$ <span class="codestrong">git commit -m "Starting over."</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;[master (root-commit) 6baf231] Starting over.<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;2 files changed, 4 insertions(+)<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 .gitignore<br class="calibre4" />
&nbsp;&nbsp;&nbsp;&nbsp;create mode 100644 hello_git.py<br class="calibre4" />
<span class="ent">➐</span> git_practice$ <span class="codestrong">git status</span><br class="calibre4" />
&nbsp;&nbsp;&nbsp;On branch master<br class="calibre4" />
&nbsp;&nbsp;&nbsp;nothing to commit, working tree clean<br class="calibre4" />
&nbsp;&nbsp;&nbsp;git_practice$</p>
<p class="indent"><span type="pagebreak" id="calibre_link-1462" class="calibre"></span>We first check the status and see that we have a clean working tree <span class="ent">➊</span>. Then we use the command <span class="literal">rm -rf .git</span> to delete the <em class="calibre3">.git</em> directory (<span class="literal">rmdir /s .git</span> on Windows) <span class="ent">➋</span>. When we check the status after deleting the <em class="calibre3">.git</em> folder, we’re told that this is not a Git repository <span class="ent">➌</span>. All the information Git uses to track a repository is stored in the <em class="calibre3">.git</em> folder, so removing it deletes the entire repository.</p>
<p class="indent">We’re then free to use <span class="literal">git init</span> to start a fresh repository <span class="ent">➍</span>. Checking the status shows that we’re back at the initial stage, awaiting the first commit <span class="ent">➎</span>. We add the files and make the first commit <span class="ent">➏</span>. Checking the status now shows us that we’re on the new <span class="literal">master</span> branch with nothing to commit <span class="ent">➐</span>.</p>
<p class="indent">Using version control takes a bit of practice, but once you start using it you’ll never want to work without it again.</p>
</div>


<div class="calibre1" id="calibre_link-167">
<h2 class="h2c" id="calibre_link-159"><span type="pagebreak" id="calibre_link-1463" class="calibre"></span><strong class="calibre2">INDEX</strong></h2>
<h3 class="h2"><strong class="calibre2">Symbols</strong></h3>
<p class="indexmain"><span class="literal">+</span> (addition), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><span class="literal">*</span> (asterisk) operator, <a href="#calibre_link-169" class="calibre6">147</a></p>
<p class="indexmain"><span class="literal">{}</span> (braces), <a href="#calibre_link-170" class="calibre6">92</a>, <a href="#calibre_link-171" class="calibre6">105</a></p>
<p class="indexmain"><span class="literal">/</span> (division), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><span class="literal">**</span> (double asterisk) operator, <a href="#calibre_link-28" class="calibre6">149</a></p>
<p class="indexmain"><span class="literal">==</span> (equality operator), <a href="#calibre_link-172" class="calibre6">72</a>&ndash;<a href="#calibre_link-173" class="calibre6">73</a></p>
<p class="indexmain"><span class="literal">**</span> (exponent), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><span class="literal">//</span> (floor division), <a href="#calibre_link-174" class="calibre6">260</a></p>
<p class="indexmain"><span class="literal">&gt;</span> (greater than), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain"><span class="literal">&gt;=</span> (greater than or equal to), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain"><span class="literal">#</span> (hash mark), for comments, <a href="#calibre_link-176" class="calibre6">29</a></p>
<p class="indexmain"><span class="literal">!=</span> (inequality operator), <a href="#calibre_link-177" class="calibre6">74</a></p>
<p class="indexmain"><span class="literal">&lt;</span> (less than), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain"><span class="literal">&lt;=</span> (less than or equal to), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain"><span class="literal">%</span> (modulo operator), <a href="#calibre_link-178" class="calibre6">116</a>&ndash;<a href="#calibre_link-179" class="calibre6">117</a>, <a href="#calibre_link-180" class="calibre6">122</a></p>
<p class="indexmain"><span class="literal">*</span> (multiplication), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><span class="literal">\n</span> (newline), <a href="#calibre_link-181" class="calibre6">22</a></p>
<p class="indexmain"><span class="literal">!</span> (not), <a href="#calibre_link-177" class="calibre6">74</a></p>
<p class="indexmain"><span class="literal">+=</span> operator, <a href="#calibre_link-182" class="calibre6">115</a></p>
<p class="indexmain"><span class="literal">[]</span> (square brackets), <a href="#calibre_link-183" class="calibre6">34</a></p>
<p class="indexmain"><span class="literal">-</span> (subtraction), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><span class="literal">\t</span> (tab), <a href="#calibre_link-181" class="calibre6">22</a></p>
<h3 class="h2"><strong class="calibre2">A</strong></h3>
<p class="indexmain">addition (<span class="literal">+</span>), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain">aliases, <a href="#calibre_link-184" class="calibre6">152</a></p>
<p class="indexmain"><em class="calibre3">alice.py</em>, <a href="#calibre_link-185" class="calibre6">197</a>&ndash;<a href="#calibre_link-186" class="calibre6">199</a></p>
<p class="indexmain">Alien Invasion project. <em class="calibre3">See also</em> Pygame</p>
<p class="indexsub">aliens</p>
<p class="indexsubsub">checking edges, <a href="#calibre_link-187" class="calibre6">266</a></p>
<p class="indexsubsub">collisions, with bullets, <a href="#calibre_link-188" class="calibre6">268</a>&ndash;<a href="#calibre_link-189" class="calibre6">269</a>, <a href="#calibre_link-190" class="calibre6">291</a>&ndash;<a href="#calibre_link-191" class="calibre6">292</a></p>
<p class="indexsubsub">collisions, with ship, <a href="#calibre_link-192" class="calibre6">272</a>&ndash;<a href="#calibre_link-193" class="calibre6">275</a></p>
<p class="indexsubsub">controlling fleet direction, <a href="#calibre_link-187" class="calibre6">266</a></p>
<p class="indexsubsub">creating an alien, <a href="#calibre_link-194" class="calibre6">256</a></p>
<p class="indexsubsub">creating the fleet, <a href="#calibre_link-195" class="calibre6">258</a>&ndash;<a href="#calibre_link-196" class="calibre6">264</a></p>
<p class="indexsubsub">dropping the fleet, <a href="#calibre_link-197" class="calibre6">267</a></p>
<p class="indexsubsub">reaching bottom of screen, <a href="#calibre_link-198" class="calibre6">276</a></p>
<p class="indexsubsub">rebuilding the fleet, <a href="#calibre_link-199" class="calibre6">270</a></p>
<p class="indexsub">bullets, <a href="#calibre_link-200" class="calibre6">246</a>&ndash;<a href="#calibre_link-201" class="calibre6">252</a></p>
<p class="indexsubsub">collisions, with aliens, <a href="#calibre_link-188" class="calibre6">268</a>&ndash;<a href="#calibre_link-189" class="calibre6">269</a>, <a href="#calibre_link-190" class="calibre6">291</a>&ndash;<a href="#calibre_link-191" class="calibre6">292</a></p>
<p class="indexsubsub">deleting old, <a href="#calibre_link-202" class="calibre6">250</a></p>
<p class="indexsubsub">firing, <a href="#calibre_link-203" class="calibre6">249</a></p>
<p class="indexsubsub">limiting number of, <a href="#calibre_link-204" class="calibre6">251</a></p>
<p class="indexsubsub">making larger, <a href="#calibre_link-199" class="calibre6">270</a></p>
<p class="indexsubsub">settings, <a href="#calibre_link-205" class="calibre6">247</a></p>
<p class="indexsubsub">speeding up, <a href="#calibre_link-206" class="calibre6">271</a></p>
<p class="indexsub">classes</p>
<p class="indexsubsub"><span class="literal">Alien</span>, <a href="#calibre_link-194" class="calibre6">256</a>&ndash;<a href="#calibre_link-195" class="calibre6">258</a></p>
<p class="indexsubsub"><span class="literal">Bullet</span>, <a href="#calibre_link-205" class="calibre6">247</a>&ndash;<a href="#calibre_link-207" class="calibre6">248</a></p>
<p class="indexsubsub"><span class="literal">Button</span>, <a href="#calibre_link-208" class="calibre6">280</a>&ndash;<a href="#calibre_link-209" class="calibre6">281</a></p>
<p class="indexsubsub"><span class="literal">GameStats</span>, <a href="#calibre_link-210" class="calibre6">273</a></p>
<p class="indexsubsub"><span class="literal">Scoreboard</span>, <a href="#calibre_link-211" class="calibre6">288</a>&ndash;<a href="#calibre_link-212" class="calibre6">289</a></p>
<p class="indexsubsub"><span class="literal">Settings</span>, <a href="#calibre_link-213" class="calibre6">231</a></p>
<p class="indexsubsub"><span class="literal">Ship</span>, <a href="#calibre_link-214" class="calibre6">233</a>&ndash;<a href="#calibre_link-215" class="calibre6">235</a></p>
<p class="indexsub">ending the game, <a href="#calibre_link-198" class="calibre6">276</a></p>
<p class="indexsub">files</p>
<p class="indexsubsub"><em class="calibre3">alien_invasion.py</em>, <a href="#calibre_link-216" class="calibre6">229</a></p>
<p class="indexsubsub"><em class="calibre3">bullet.py</em>, <a href="#calibre_link-205" class="calibre6">247</a></p>
<p class="indexsubsub"><em class="calibre3">button.py</em>, <a href="#calibre_link-208" class="calibre6">280</a></p>
<p class="indexsubsub"><em class="calibre3">game_stats.py</em>, <a href="#calibre_link-210" class="calibre6">273</a></p>
<p class="indexsubsub"><em class="calibre3">scoreboard.py</em>, <a href="#calibre_link-211" class="calibre6">288</a></p>
<p class="indexsubsub"><em class="calibre3">settings.py</em>, <a href="#calibre_link-213" class="calibre6">231</a></p>
<p class="indexsubsub"><em class="calibre3">ship.bmp</em>, <a href="#calibre_link-214" class="calibre6">233</a></p>
<p class="indexsub">initializing dynamic settings, <a href="#calibre_link-217" class="calibre6">286</a></p>
<p class="indexsub">levels</p>
<p class="indexsubsub">adding, <a href="#calibre_link-108" class="calibre6">285</a>&ndash;<a href="#calibre_link-218" class="calibre6">287</a></p>
<p class="indexsubsub">modifying speed settings, <a href="#calibre_link-108" class="calibre6">285</a></p>
<p class="indexsubsub">resetting the speed, <a href="#calibre_link-218" class="calibre6">287</a></p>
<p class="indexsub">planning, <a href="#calibre_link-219" class="calibre6">228</a></p>
<p class="indexsub"><span type="pagebreak" id="calibre_link-1464" class="calibre"></span>Play button</p>
<p class="indexsubsub">adding, <a href="#calibre_link-208" class="calibre6">280</a>&ndash;<a href="#calibre_link-108" class="calibre6">285</a></p>
<p class="indexsubsub">deactivating, <a href="#calibre_link-220" class="calibre6">284</a></p>
<p class="indexsubsub">drawing, <a href="#calibre_link-209" class="calibre6">281</a></p>
<p class="indexsubsub">hiding the mouse cursor, <a href="#calibre_link-220" class="calibre6">284</a></p>
<p class="indexsubsub">resetting the game, <a href="#calibre_link-221" class="calibre6">283</a></p>
<p class="indexsubsub">starting the game, <a href="#calibre_link-221" class="calibre6">283</a></p>
<p class="indexsub">scoring, <a href="#calibre_link-211" class="calibre6">288</a>&ndash;<a href="#calibre_link-222" class="calibre6">300</a></p>
<p class="indexsubsub">all hits, <a href="#calibre_link-191" class="calibre6">292</a></p>
<p class="indexsubsub">high score, <a href="#calibre_link-223" class="calibre6">294</a></p>
<p class="indexsubsub">increasing point values, <a href="#calibre_link-191" class="calibre6">292</a></p>
<p class="indexsubsub">level, <a href="#calibre_link-224" class="calibre6">296</a>&ndash;<a href="#calibre_link-225" class="calibre6">298</a></p>
<p class="indexsubsub">number of ships, <a href="#calibre_link-225" class="calibre6">298</a>&ndash;<a href="#calibre_link-222" class="calibre6">300</a></p>
<p class="indexsubsub">resetting, <a href="#calibre_link-190" class="calibre6">291</a></p>
<p class="indexsubsub">rounding and formatting, <a href="#calibre_link-226" class="calibre6">293</a>&ndash;<a href="#calibre_link-223" class="calibre6">294</a></p>
<p class="indexsubsub"><span class="literal">score</span> attribute, <a href="#calibre_link-211" class="calibre6">288</a></p>
<p class="indexsubsub">updating, <a href="#calibre_link-190" class="calibre6">291</a></p>
<p class="indexsub">settings, storing, <a href="#calibre_link-213" class="calibre6">231</a></p>
<p class="indexsub">ship</p>
<p class="indexsubsub">adjusting speed, <a href="#calibre_link-227" class="calibre6">241</a>&ndash;<a href="#calibre_link-228" class="calibre6">243</a></p>
<p class="indexsubsub">continuous movement, <a href="#calibre_link-229" class="calibre6">239</a>&ndash;<a href="#calibre_link-227" class="calibre6">241</a></p>
<p class="indexsubsub">finding an image, <a href="#calibre_link-230" class="calibre6">232</a></p>
<p class="indexsubsub">limiting range, <a href="#calibre_link-228" class="calibre6">243</a></p>
<p class="indexmain"><em class="calibre3">amusement_park.py</em>, <a href="#calibre_link-231" class="calibre6">80</a>&ndash;<a href="#calibre_link-232" class="calibre6">83</a></p>
<p class="indexmain"><span class="literal">and</span> keyword, <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain">API (application programming interface), <a href="#calibre_link-233" class="calibre6">359</a></p>
<p class="indexsub">calls, <a href="#calibre_link-233" class="calibre6">359</a></p>
<p class="indexsub">for GitHub, <a href="#calibre_link-234" class="calibre6">371</a></p>
<p class="indexsub">for Hacker News, <a href="#calibre_link-235" class="calibre6">372</a>&ndash;<a href="#calibre_link-236" class="calibre6">375</a></p>
<p class="indexsub">processing responses, <a href="#calibre_link-237" class="calibre6">361</a>&ndash;<a href="#calibre_link-238" class="calibre6">365</a></p>
<p class="indexsub">rate limits, <a href="#calibre_link-238" class="calibre6">365</a></p>
<p class="indexsub">requesting data, <a href="#calibre_link-239" class="calibre6">360</a></p>
<p class="indexsub">visualizing results, <a href="#calibre_link-240" class="calibre6">366</a>&ndash;<a href="#calibre_link-234" class="calibre6">371</a></p>
<p class="indexmain"><em class="calibre3">apostrophe.py</em>, <a href="#calibre_link-241" class="calibre6">24</a></p>
<p class="indexmain"><span class="literal">append()</span> method, <a href="#calibre_link-242" class="calibre6">37</a></p>
<p class="indexmain">application programming interface. <em class="calibre3">See</em> API (application programming interface)</p>
<p class="indexmain">arguments, <a href="#calibre_link-243" class="calibre6">131</a>&ndash;<a href="#calibre_link-244" class="calibre6">137</a>. <em class="calibre3">See also</em> functions: arguments</p>
<p class="indexmain">arithmetic, <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><span class="literal">as</span> keyword, <a href="#calibre_link-184" class="calibre6">152</a></p>
<p class="indexmain">assert methods, <a href="#calibre_link-245" class="calibre6">212</a>, <a href="#calibre_link-246" class="calibre6">216</a></p>
<p class="indexmain">asterisk (<span class="literal">*</span>) operator, <a href="#calibre_link-169" class="calibre6">147</a></p>
<p class="indexmain">attributes, <a href="#calibre_link-247" class="calibre6">159</a>. <em class="calibre3">See also</em> classes: attributes</p>
<h3 class="h2"><strong class="calibre2">B</strong></h3>
<p class="indexmain"><em class="calibre3">banned_users.py</em>, <a href="#calibre_link-248" class="calibre6">77</a></p>
<p class="indexmain"><em class="calibre3">bicycles.py</em>, <a href="#calibre_link-183" class="calibre6">34</a>&ndash;<a href="#calibre_link-249" class="calibre6">36</a></p>
<p class="indexmain"><em class="calibre3">.bmp</em> (bitmap) image files, <a href="#calibre_link-230" class="calibre6">232</a></p>
<p class="indexmain">body</p>
<p class="indexsub">of a function, <a href="#calibre_link-250" class="calibre6">130</a></p>
<p class="indexsub">of an HTML file, <a href="#calibre_link-251" class="calibre6">440</a></p>
<p class="indexmain">Boolean values, <a href="#calibre_link-248" class="calibre6">77</a>, <a href="#calibre_link-252" class="calibre6">456</a></p>
<p class="indexmain">Bootstrap, <a href="#calibre_link-253" class="calibre6">438</a>&ndash;<a href="#calibre_link-254" class="calibre6">447</a></p>
<p class="indexmain">braces (<span class="literal">{}</span>), <a href="#calibre_link-170" class="calibre6">92</a>, <a href="#calibre_link-171" class="calibre6">105</a></p>
<p class="indexmain">built-in functions, <a href="#calibre_link-64" class="calibre6">471</a></p>
<h3 class="h2"><strong class="calibre2">C</strong></h3>
<p class="indexmain">CamelCase, <a href="#calibre_link-255" class="calibre6">181</a></p>
<p class="indexmain"><em class="calibre3">car.py</em>, <a href="#calibre_link-256" class="calibre6">162</a>&ndash;<a href="#calibre_link-257" class="calibre6">179</a></p>
<p class="indexmain"><em class="calibre3">cars.py</em>, <a href="#calibre_link-258" class="calibre6">43</a>&ndash;<a href="#calibre_link-259" class="calibre6">45</a>, <a href="#calibre_link-172" class="calibre6">72</a></p>
<p class="indexmain"><em class="calibre3">cities.py</em>, <a href="#calibre_link-260" class="calibre6">121</a></p>
<p class="indexmain">classes</p>
<p class="indexsub">attributes, <a href="#calibre_link-247" class="calibre6">159</a></p>
<p class="indexsubsub">accessing, <a href="#calibre_link-261" class="calibre6">160</a></p>
<p class="indexsubsub">default values, <a href="#calibre_link-262" class="calibre6">163</a></p>
<p class="indexsubsub">modifying, <a href="#calibre_link-263" class="calibre6">164</a>&ndash;<a href="#calibre_link-264" class="calibre6">166</a></p>
<p class="indexsub">creating, <a href="#calibre_link-265" class="calibre6">158</a>&ndash;<a href="#calibre_link-256" class="calibre6">162</a></p>
<p class="indexsub">importing, <a href="#calibre_link-266" class="calibre6">174</a>&ndash;<a href="#calibre_link-257" class="calibre6">179</a></p>
<p class="indexsubsub">all classes from a module, <a href="#calibre_link-267" class="calibre6">177</a></p>
<p class="indexsubsub">multiple classes, <a href="#calibre_link-268" class="calibre6">175</a>&ndash;<a href="#calibre_link-267" class="calibre6">177</a></p>
<p class="indexsubsub">single class, <a href="#calibre_link-266" class="calibre6">174</a>&ndash;<a href="#calibre_link-268" class="calibre6">175</a></p>
<p class="indexsub">inheritance, <a href="#calibre_link-269" class="calibre6">167</a>&ndash;<a href="#calibre_link-270" class="calibre6">173</a></p>
<p class="indexsubsub">attributes and methods, <a href="#calibre_link-271" class="calibre6">169</a></p>
<p class="indexsubsub">child classes, <a href="#calibre_link-269" class="calibre6">167</a></p>
<p class="indexsubsub"><span class="literal">__init__()</span> method, <a href="#calibre_link-269" class="calibre6">167</a>&ndash;<a href="#calibre_link-271" class="calibre6">169</a></p>
<p class="indexsubsub">instances as attributes, <a href="#calibre_link-272" class="calibre6">170</a>&ndash;<a href="#calibre_link-273" class="calibre6">172</a></p>
<p class="indexsubsub">overriding methods, <a href="#calibre_link-272" class="calibre6">170</a></p>
<p class="indexsubsub">parent classes, <a href="#calibre_link-269" class="calibre6">167</a></p>
<p class="indexsubsub">subclasses, <a href="#calibre_link-274" class="calibre6">168</a></p>
<p class="indexsubsub"><span class="literal">super()</span> function, <a href="#calibre_link-274" class="calibre6">168</a></p>
<p class="indexsubsub">superclasses, <a href="#calibre_link-274" class="calibre6">168</a></p>
<p class="indexsub">instances, <a href="#calibre_link-275" class="calibre6">157</a></p>
<p class="indexsub">methods, <a href="#calibre_link-247" class="calibre6">159</a></p>
<p class="indexsubsub">calling, <a href="#calibre_link-261" class="calibre6">160</a></p>
<p class="indexsubsub"><span class="literal">__init__()</span> method, <a href="#calibre_link-247" class="calibre6">159</a></p>
<p class="indexsub"><span type="pagebreak" id="calibre_link-1465" class="calibre"></span>modeling real-world objects, <a href="#calibre_link-270" class="calibre6">173</a></p>
<p class="indexsub">multiple instances, <a href="#calibre_link-276" class="calibre6">161</a></p>
<p class="indexsub">naming conventions, <a href="#calibre_link-247" class="calibre6">159</a></p>
<p class="indexsub">objects, <a href="#calibre_link-275" class="calibre6">157</a></p>
<p class="indexsub">styling guidelines, <a href="#calibre_link-255" class="calibre6">181</a></p>
<p class="indexmain">comma-separated value files. <em class="calibre3">See</em> CSV (comma-separated value) files</p>
<p class="indexmain"><em class="calibre3">comment.py</em>, <a href="#calibre_link-176" class="calibre6">29</a></p>
<p class="indexmain">comments, <a href="#calibre_link-176" class="calibre6">29</a>&ndash;<a href="#calibre_link-277" class="calibre6">30</a></p>
<p class="indexmain">conditional tests, <a href="#calibre_link-172" class="calibre6">72</a>&ndash;<a href="#calibre_link-248" class="calibre6">77</a>. <em class="calibre3">See also</em> <span class="literal">if</span> statements</p>
<p class="indexmain"><em class="calibre3">confirmed_users.py</em>, <a href="#calibre_link-278" class="calibre6">124</a></p>
<p class="indexmain">constants, <a href="#calibre_link-279" class="calibre6">28</a></p>
<p class="indexmain"><em class="calibre3">counting.py</em>, <a href="#calibre_link-280" class="calibre6">118</a>, <a href="#calibre_link-180" class="calibre6">122</a></p>
<p class="indexmain">CSV (comma-separated value) files, <a href="#calibre_link-281" class="calibre6">334</a>&ndash;<a href="#calibre_link-282" class="calibre6">346</a></p>
<p class="indexsub">error-checking, <a href="#calibre_link-283" class="calibre6">343</a>&ndash;<a href="#calibre_link-284" class="calibre6">345</a></p>
<p class="indexsub">parsing headers, <a href="#calibre_link-281" class="calibre6">334</a>&ndash;<a href="#calibre_link-285" class="calibre6">335</a></p>
<p class="indexsub">reading data, <a href="#calibre_link-286" class="calibre6">336</a></p>
<h3 class="h2"><strong class="calibre2">D</strong></h3>
<p class="indexmain">data analysis, <a href="#calibre_link-287" class="calibre6">305</a></p>
<p class="indexmain">databases. <em class="calibre3">See</em> Django: databases</p>
<p class="indexmain">data visualization, <a href="#calibre_link-287" class="calibre6">305</a>. <em class="calibre3">See also</em> Matplotlib; Plotly</p>
<p class="indexmain"><span class="literal">datetime</span> module, <a href="#calibre_link-288" class="calibre6">337</a>&ndash;<a href="#calibre_link-289" class="calibre6">339</a></p>
<p class="indexmain"><em class="calibre3">death_valley_highs_lows.py</em>, <a href="#calibre_link-283" class="calibre6">343</a>&ndash;<a href="#calibre_link-284" class="calibre6">345</a></p>
<p class="indexmain">decorators, <a href="#calibre_link-290" class="calibre6">429</a></p>
<p class="indexmain">default values, <a href="#calibre_link-291" class="calibre6">134</a></p>
<p class="indexsub">class attributes, <a href="#calibre_link-262" class="calibre6">163</a></p>
<p class="indexsub">function parameters, <a href="#calibre_link-291" class="calibre6">134</a></p>
<p class="indexmain"><span class="literal">def</span> keyword, <a href="#calibre_link-250" class="calibre6">130</a></p>
<p class="indexmain"><span class="literal">del</span> statement, <a href="#calibre_link-292" class="calibre6">39</a></p>
<p class="indexmain"><em class="calibre3">dice_visual.py</em>, <a href="#calibre_link-293" class="calibre6">328</a>&ndash;<a href="#calibre_link-294" class="calibre6">330</a></p>
<p class="indexmain">dictionaries</p>
<p class="indexsub">defining, <a href="#calibre_link-170" class="calibre6">92</a></p>
<p class="indexsub">empty, <a href="#calibre_link-295" class="calibre6">94</a></p>
<p class="indexsub">formatting larger, <a href="#calibre_link-122" class="calibre6">97</a></p>
<p class="indexsub"><span class="literal">get()</span> method, <a href="#calibre_link-296" class="calibre6">98</a></p>
<p class="indexsub"><span class="literal">KeyError</span>, <a href="#calibre_link-296" class="calibre6">98</a></p>
<p class="indexsub">key-value pairs, <a href="#calibre_link-170" class="calibre6">92</a>&ndash;<a href="#calibre_link-124" class="calibre6">99</a></p>
<p class="indexsubsub">adding, <a href="#calibre_link-297" class="calibre6">93</a></p>
<p class="indexsubsub">removing, <a href="#calibre_link-298" class="calibre6">96</a></p>
<p class="indexsub">looping through, <a href="#calibre_link-124" class="calibre6">99</a>&ndash;<a href="#calibre_link-171" class="calibre6">105</a></p>
<p class="indexsubsub">keys, <a href="#calibre_link-299" class="calibre6">101</a></p>
<p class="indexsubsub">keys in order, <a href="#calibre_link-300" class="calibre6">103</a></p>
<p class="indexsubsub">key-value pairs, <a href="#calibre_link-124" class="calibre6">99</a></p>
<p class="indexsubsub">values, <a href="#calibre_link-301" class="calibre6">104</a></p>
<p class="indexsub">ordering in, <a href="#calibre_link-295" class="calibre6">94</a></p>
<p class="indexsub">sorting a list of, <a href="#calibre_link-302" class="calibre6">374</a></p>
<p class="indexsub">values</p>
<p class="indexsubsub">accessing, <a href="#calibre_link-297" class="calibre6">93</a></p>
<p class="indexsubsub">modifying, <a href="#calibre_link-303" class="calibre6">95</a></p>
<p class="indexmain"><em class="calibre3">die.py</em>, <a href="#calibre_link-304" class="calibre6">324</a></p>
<p class="indexmain"><em class="calibre3">die_visual.py</em>, <a href="#calibre_link-305" class="calibre6">325</a>&ndash;<a href="#calibre_link-306" class="calibre6">327</a></p>
<p class="indexmain"><em class="calibre3">dimensions.py</em>, <a href="#calibre_link-307" class="calibre6">66</a>&ndash;<a href="#calibre_link-308" class="calibre6">67</a></p>
<p class="indexmain">Discord, <a href="#calibre_link-309" class="calibre6">48</a></p>
<p class="indexmain">div (HTML), <a href="#calibre_link-310" class="calibre6">441</a></p>
<p class="indexmain">division (<span class="literal">/</span>), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><em class="calibre3">division_calculator.py</em>, <a href="#calibre_link-311" class="calibre6">194</a>&ndash;<a href="#calibre_link-185" class="calibre6">197</a></p>
<p class="indexmain">Django, <a href="#calibre_link-312" class="calibre6">379</a>. <em class="calibre3">See also</em> Heroku; Learning Log project</p>
<p class="indexsub">admin site, <a href="#calibre_link-313" class="calibre6">387</a>&ndash;<a href="#calibre_link-314" class="calibre6">392</a></p>
<p class="indexsubsub">registering models, <a href="#calibre_link-315" class="calibre6">388</a>, <a href="#calibre_link-316" class="calibre6">391</a></p>
<p class="indexsub">associating data with users, <a href="#calibre_link-317" class="calibre6">435</a></p>
<p class="indexsub">Bootstrap, <a href="#calibre_link-253" class="calibre6">438</a>&ndash;<a href="#calibre_link-254" class="calibre6">447</a></p>
<p class="indexsubsub">card, <a href="#calibre_link-318" class="calibre6">446</a></p>
<p class="indexsubsub">collapsible navigation, <a href="#calibre_link-251" class="calibre6">440</a></p>
<p class="indexsubsub">container element, <a href="#calibre_link-319" class="calibre6">443</a></p>
<p class="indexsubsub">django-bootstrap4 app, <a href="#calibre_link-253" class="calibre6">438</a></p>
<p class="indexsubsub">HTML headers, <a href="#calibre_link-320" class="calibre6">439</a>&ndash;<a href="#calibre_link-251" class="calibre6">440</a></p>
<p class="indexsubsub">jumbotron, <a href="#calibre_link-319" class="calibre6">443</a></p>
<p class="indexsubsub">navigation bar, <a href="#calibre_link-251" class="calibre6">440</a>&ndash;<a href="#calibre_link-321" class="calibre6">442</a></p>
<p class="indexsubsub">styling forms, <a href="#calibre_link-322" class="calibre6">444</a>&ndash;<a href="#calibre_link-323" class="calibre6">445</a></p>
<p class="indexsub">commands</p>
<p class="indexsubsub"><span class="literal">createsuperuser</span>, <a href="#calibre_link-315" class="calibre6">388</a></p>
<p class="indexsubsub"><span class="literal">flush</span>, <a href="#calibre_link-324" class="calibre6">433</a></p>
<p class="indexsubsub"><span class="literal">makemigrations</span>, <a href="#calibre_link-313" class="calibre6">387</a>, <a href="#calibre_link-316" class="calibre6">391</a>, <a href="#calibre_link-325" class="calibre6">432</a></p>
<p class="indexsubsub"><span class="literal">migrate</span>, <a href="#calibre_link-326" class="calibre6">383</a></p>
<p class="indexsubsub"><span class="literal">shell</span>, <a href="#calibre_link-314" class="calibre6">392</a></p>
<p class="indexsubsub"><span class="literal">startapp</span>, <a href="#calibre_link-327" class="calibre6">385</a>, <a href="#calibre_link-78" class="calibre6">421</a></p>
<p class="indexsubsub"><span class="literal">startproject</span>, <a href="#calibre_link-328" class="calibre6">382</a></p>
<p class="indexsub">creating a project, <a href="#calibre_link-329" class="calibre6">381</a></p>
<p class="indexsub">databases</p>
<p class="indexsubsub">cascading delete, <a href="#calibre_link-330" class="calibre6">390</a></p>
<p class="indexsubsub">creating, <a href="#calibre_link-328" class="calibre6">382</a></p>
<p class="indexsubsub">foreign keys, <a href="#calibre_link-330" class="calibre6">390</a></p>
<p class="indexsubsub">many-to-one relationships, <a href="#calibre_link-330" class="calibre6">390</a></p>
<p class="indexsubsub">migrating, <a href="#calibre_link-326" class="calibre6">383</a>, <a href="#calibre_link-316" class="calibre6">391</a></p>
<p class="indexsubsub">queries, <a href="#calibre_link-331" class="calibre6">404</a>, <a href="#calibre_link-324" class="calibre6">433</a></p>
<p class="indexsubsub">querysets, <a href="#calibre_link-314" class="calibre6">392</a>&ndash;<a href="#calibre_link-332" class="calibre6">393</a>, <a href="#calibre_link-333" class="calibre6">401</a></p>
<p class="indexsubsub">required (non-nullable) fields, <a href="#calibre_link-325" class="calibre6">432</a></p>
<p class="indexsubsub"><span type="pagebreak" id="calibre_link-1466" class="calibre"></span>resetting, <a href="#calibre_link-324" class="calibre6">433</a></p>
<p class="indexsubsub">SQLite, <a href="#calibre_link-326" class="calibre6">383</a></p>
<p class="indexsub">decorators, <a href="#calibre_link-290" class="calibre6">429</a></p>
<p class="indexsub">deployment. <em class="calibre3">See</em> Heroku</p>
<p class="indexsub">development server, <a href="#calibre_link-326" class="calibre6">383</a>, <a href="#calibre_link-334" class="calibre6">389</a></p>
<p class="indexsub">documentation</p>
<p class="indexsubsub">Django, <a href="#calibre_link-312" class="calibre6">379</a></p>
<p class="indexsubsub">models, <a href="#calibre_link-335" class="calibre6">386</a></p>
<p class="indexsubsub">queries, <a href="#calibre_link-50" class="calibre6">394</a></p>
<p class="indexsubsub">templates, <a href="#calibre_link-336" class="calibre6">406</a></p>
<p class="indexsub">forms, <a href="#calibre_link-337" class="calibre6">410</a>&ndash;<a href="#calibre_link-338" class="calibre6">420</a></p>
<p class="indexsubsub"><span class="literal">action</span> argument, <a href="#calibre_link-339" class="calibre6">413</a></p>
<p class="indexsubsub">cross-site request forgery, <a href="#calibre_link-339" class="calibre6">413</a></p>
<p class="indexsubsub">displaying, <a href="#calibre_link-339" class="calibre6">413</a></p>
<p class="indexsubsub">GET and POST requests, <a href="#calibre_link-340" class="calibre6">412</a></p>
<p class="indexsubsub"><span class="literal">ModelForm</span>, <a href="#calibre_link-337" class="calibre6">410</a>, <a href="#calibre_link-341" class="calibre6">414</a></p>
<p class="indexsubsub">pre-filling with data, <a href="#calibre_link-342" class="calibre6">419</a></p>
<p class="indexsubsub">processing, <a href="#calibre_link-340" class="calibre6">412</a>, <a href="#calibre_link-343" class="calibre6">416</a></p>
<p class="indexsubsub">validation, <a href="#calibre_link-337" class="calibre6">410</a></p>
<p class="indexsubsub">widgets, <a href="#calibre_link-341" class="calibre6">414</a></p>
<p class="indexsub"><span class="literal">get_object_or_404()</span> method, <a href="#calibre_link-344" class="calibre6">460</a></p>
<p class="indexsub">hashes (for passwords), <a href="#calibre_link-315" class="calibre6">388</a></p>
<p class="indexsub">HTML</p>
<p class="indexsubsub">div element, <a href="#calibre_link-310" class="calibre6">441</a></p>
<p class="indexsubsub">main element, <a href="#calibre_link-321" class="calibre6">442</a></p>
<p class="indexsubsub">margin, <a href="#calibre_link-319" class="calibre6">443</a></p>
<p class="indexsubsub">padding, <a href="#calibre_link-319" class="calibre6">443</a></p>
<p class="indexsubsub">span element, <a href="#calibre_link-321" class="calibre6">442</a></p>
<p class="indexsub">HTTP 404 error, <a href="#calibre_link-345" class="calibre6">434</a></p>
<p class="indexsub"><span class="literal">INSTALLED_APPS</span>, <a href="#calibre_link-335" class="calibre6">386</a>, <a href="#calibre_link-78" class="calibre6">421</a>, <a href="#calibre_link-253" class="calibre6">438</a></p>
<p class="indexsub">installing, <a href="#calibre_link-329" class="calibre6">381</a></p>
<p class="indexsub">localhost, <a href="#calibre_link-326" class="calibre6">383</a></p>
<p class="indexsub">logging out, <a href="#calibre_link-346" class="calibre6">424</a></p>
<p class="indexsub">login page, <a href="#calibre_link-347" class="calibre6">422</a></p>
<p class="indexsub"><span class="literal">@login_required</span>, <a href="#calibre_link-290" class="calibre6">429</a></p>
<p class="indexsub">login template, <a href="#calibre_link-347" class="calibre6">422</a></p>
<p class="indexsub">mapping URLs, <a href="#calibre_link-348" class="calibre6">395</a>&ndash;<a href="#calibre_link-349" class="calibre6">396</a></p>
<p class="indexsub">migrating the database, <a href="#calibre_link-326" class="calibre6">383</a>, <a href="#calibre_link-316" class="calibre6">391</a></p>
<p class="indexsub">models, <a href="#calibre_link-327" class="calibre6">385</a>&ndash;<a href="#calibre_link-332" class="calibre6">393</a>, <a href="#calibre_link-350" class="calibre6">431</a></p>
<p class="indexsub">privileges, <a href="#calibre_link-313" class="calibre6">387</a></p>
<p class="indexsub">projects (vs. apps), <a href="#calibre_link-351" class="calibre6">384</a></p>
<p class="indexsub"><span class="literal">redirect()</span> function, <a href="#calibre_link-352" class="calibre6">411</a></p>
<p class="indexsub">registration page, <a href="#calibre_link-353" class="calibre6">426</a>&ndash;<a href="#calibre_link-354" class="calibre6">428</a></p>
<p class="indexsub">release cycle, <a href="#calibre_link-329" class="calibre6">381</a></p>
<p class="indexsub">restricting access to data, <a href="#calibre_link-324" class="calibre6">433</a>&ndash;<a href="#calibre_link-317" class="calibre6">435</a></p>
<p class="indexsub">restricting access to pages, <a href="#calibre_link-354" class="calibre6">428</a>&ndash;<a href="#calibre_link-317" class="calibre6">435</a></p>
<p class="indexsub"><em class="calibre3">settings.py</em></p>
<p class="indexsubsub"><span class="literal">INSTALLED APPS</span>, <a href="#calibre_link-335" class="calibre6">386</a>, <a href="#calibre_link-78" class="calibre6">421</a>, <a href="#calibre_link-253" class="calibre6">438</a></p>
<p class="indexsubsub"><span class="literal">LOGIN_URL</span>, <a href="#calibre_link-290" class="calibre6">429</a></p>
<p class="indexsubsub"><span class="literal">SECRET_KEY</span>, <a href="#calibre_link-355" class="calibre6">461</a></p>
<p class="indexsub">shell, <a href="#calibre_link-314" class="calibre6">392</a>, <a href="#calibre_link-350" class="calibre6">431</a></p>
<p class="indexsub">starting an app, <a href="#calibre_link-327" class="calibre6">385</a></p>
<p class="indexsub">starting a new project, <a href="#calibre_link-328" class="calibre6">382</a></p>
<p class="indexsub">static files, <a href="#calibre_link-356" class="calibre6">448</a></p>
<p class="indexsub">styling. <em class="calibre3">See</em> Django: Bootstrap</p>
<p class="indexsub">superuser, <a href="#calibre_link-313" class="calibre6">387</a></p>
<p class="indexsub">templates, <a href="#calibre_link-357" class="calibre6">397</a></p>
<p class="indexsubsub">anchor tags, <a href="#calibre_link-358" class="calibre6">399</a></p>
<p class="indexsubsub"><span class="literal">block</span> tags, <a href="#calibre_link-358" class="calibre6">399</a></p>
<p class="indexsubsub">context dictionary, <a href="#calibre_link-333" class="calibre6">401</a></p>
<p class="indexsubsub">filters, <a href="#calibre_link-359" class="calibre6">405</a></p>
<p class="indexsubsub"><span class="literal">for</span> loop, <a href="#calibre_link-360" class="calibre6">402</a></p>
<p class="indexsubsub">indentation in, <a href="#calibre_link-358" class="calibre6">399</a></p>
<p class="indexsubsub">inheritance, <a href="#calibre_link-54" class="calibre6">398</a></p>
<p class="indexsubsub"><span class="literal">linebreaks</span> filter, <a href="#calibre_link-359" class="calibre6">405</a></p>
<p class="indexsubsub">template tags, <a href="#calibre_link-358" class="calibre6">399</a></p>
<p class="indexsub">third-party apps, <a href="#calibre_link-253" class="calibre6">438</a></p>
<p class="indexsub">URLs</p>
<p class="indexsubsub">capturing values, <a href="#calibre_link-331" class="calibre6">404</a></p>
<p class="indexsubsub">namespaces, <a href="#calibre_link-358" class="calibre6">399</a></p>
<p class="indexsubsub">URL patterns, <a href="#calibre_link-348" class="calibre6">395</a>&ndash;<a href="#calibre_link-349" class="calibre6">396</a></p>
<p class="indexsubsub"><span class="literal">url</span> template tag, <a href="#calibre_link-358" class="calibre6">399</a></p>
<p class="indexsub">user ID values, <a href="#calibre_link-350" class="calibre6">431</a></p>
<p class="indexsub">users</p>
<p class="indexsubsub">default login view, <a href="#calibre_link-347" class="calibre6">422</a></p>
<p class="indexsubsub">displaying message to logged-in user, <a href="#calibre_link-346" class="calibre6">424</a></p>
<p class="indexsubsub">logging in a user, <a href="#calibre_link-361" class="calibre6">427</a></p>
<p class="indexsubsub"><span class="literal">UserCreationForm</span>, <a href="#calibre_link-361" class="calibre6">427</a></p>
<p class="indexsub">versions, <a href="#calibre_link-329" class="calibre6">381</a></p>
<p class="indexsub">views, <a href="#calibre_link-349" class="calibre6">396</a></p>
<p class="indexsubsub">retrieving objects, <a href="#calibre_link-333" class="calibre6">401</a>, <a href="#calibre_link-331" class="calibre6">404</a></p>
<p class="indexmain">docstrings, <a href="#calibre_link-250" class="calibre6">130</a></p>
<p class="indexmain"><em class="calibre3">dog.py</em>, <a href="#calibre_link-265" class="calibre6">158</a>&ndash;<a href="#calibre_link-256" class="calibre6">162</a></p>
<p class="indexmain">dot notation, <a href="#calibre_link-362" class="calibre6">151</a>, <a href="#calibre_link-261" class="calibre6">160</a></p>
<p class="indexmain">double asterisk (<span class="literal">**</span>) operator, <a href="#calibre_link-28" class="calibre6">149</a></p>
<h3 class="h2"><span type="pagebreak" id="calibre_link-1467" class="calibre"></span><strong class="calibre2">E</strong></h3>
<p class="indexmain">earthquakes. <em class="calibre3">See</em> mapping earthquakes</p>
<p class="indexmain"><em class="calibre3">electric_car.py</em>, <a href="#calibre_link-274" class="calibre6">168</a>&ndash;<a href="#calibre_link-270" class="calibre6">173</a></p>
<p class="indexmain"><em class="calibre3">electric_car.py</em> module, <a href="#calibre_link-363" class="calibre6">178</a></p>
<p class="indexmain"><span class="literal">enumerate()</span> function, <a href="#calibre_link-285" class="calibre6">335</a></p>
<p class="indexmain">environment variables, <a href="#calibre_link-252" class="calibre6">456</a></p>
<p class="indexmain">epoch time, <a href="#calibre_link-240" class="calibre6">366</a></p>
<p class="indexmain"><em class="calibre3">eq_explore_data.py</em>, <a href="#calibre_link-364" class="calibre6">348</a>&ndash;<a href="#calibre_link-365" class="calibre6">351</a></p>
<p class="indexmain">equality operator (<span class="literal">==</span>), <a href="#calibre_link-172" class="calibre6">72</a>&ndash;<a href="#calibre_link-173" class="calibre6">73</a></p>
<p class="indexmain"><em class="calibre3">eq_world_map.py</em>, <a href="#calibre_link-365" class="calibre6">351</a>&ndash;<a href="#calibre_link-366" class="calibre6">357</a></p>
<p class="indexmain"><em class="calibre3">even_numbers.py</em>, <a href="#calibre_link-367" class="calibre6">58</a></p>
<p class="indexmain"><em class="calibre3">even_or_odd.py</em>, <a href="#calibre_link-179" class="calibre6">117</a></p>
<p class="indexmain">exceptions, <a href="#calibre_link-368" class="calibre6">183</a>, <a href="#calibre_link-311" class="calibre6">194</a>&ndash;<a href="#calibre_link-369" class="calibre6">202</a></p>
<p class="indexsub">deciding which errors to report, <a href="#calibre_link-370" class="calibre6">201</a></p>
<p class="indexsub"><span class="literal">else</span> blocks, <a href="#calibre_link-371" class="calibre6">196</a></p>
<p class="indexsub">failing silently, <a href="#calibre_link-372" class="calibre6">200</a></p>
<p class="indexsub"><span class="literal">FileNotFoundError</span>, <a href="#calibre_link-185" class="calibre6">197</a></p>
<p class="indexsub">handling, <a href="#calibre_link-311" class="calibre6">194</a></p>
<p class="indexsub"><span class="literal">try</span>-<span class="literal">except</span> blocks, <a href="#calibre_link-311" class="calibre6">194</a></p>
<p class="indexsub">using to prevent crashes, <a href="#calibre_link-373" class="calibre6">195</a></p>
<p class="indexsub"><span class="literal">ZeroDivisionError</span>, <a href="#calibre_link-311" class="calibre6">194</a></p>
<p class="indexmain">exponents (<span class="literal">**</span>), <a href="#calibre_link-168" class="calibre6">26</a></p>
<h3 class="h2"><strong class="calibre2">F</strong></h3>
<p class="indexmain"><em class="calibre3">favorite_languages.py</em>, <a href="#calibre_link-122" class="calibre6">97</a>&ndash;<a href="#calibre_link-296" class="calibre6">98</a></p>
<p class="indexmain"><span class="literal">FileNotFoundError</span>, <a href="#calibre_link-185" class="calibre6">197</a></p>
<p class="indexmain"><em class="calibre3">file_reader.py</em>, <a href="#calibre_link-374" class="calibre6">184</a>&ndash;<a href="#calibre_link-375" class="calibre6">188</a></p>
<p class="indexmain">files</p>
<p class="indexsub">closing, <a href="#calibre_link-376" class="calibre6">185</a></p>
<p class="indexsub">file paths, <a href="#calibre_link-376" class="calibre6">185</a></p>
<p class="indexsubsub">absolute, <a href="#calibre_link-377" class="calibre6">186</a></p>
<p class="indexsubsub">relative, <a href="#calibre_link-377" class="calibre6">186</a></p>
<p class="indexsub">opening, <a href="#calibre_link-374" class="calibre6">184</a></p>
<p class="indexsubsub">append mode, <a href="#calibre_link-378" class="calibre6">192</a></p>
<p class="indexsubsub">read mode, <a href="#calibre_link-378" class="calibre6">192</a></p>
<p class="indexsubsub">write mode, <a href="#calibre_link-378" class="calibre6">192</a></p>
<p class="indexsub">reading from, <a href="#calibre_link-374" class="calibre6">184</a>&ndash;<a href="#calibre_link-379" class="calibre6">190</a></p>
<p class="indexsubsub">entire files, <a href="#calibre_link-374" class="calibre6">184</a>&ndash;<a href="#calibre_link-376" class="calibre6">185</a></p>
<p class="indexsubsub">line by line, <a href="#calibre_link-380" class="calibre6">187</a></p>
<p class="indexsubsub">making a list of lines, <a href="#calibre_link-375" class="calibre6">188</a></p>
<p class="indexsubsub">working with contents, <a href="#calibre_link-375" class="calibre6">188</a></p>
<p class="indexsubsub">working with large files, <a href="#calibre_link-381" class="calibre6">189</a></p>
<p class="indexsub">writing to</p>
<p class="indexsubsub">by appending, <a href="#calibre_link-382" class="calibre6">193</a></p>
<p class="indexsubsub">empty files, <a href="#calibre_link-383" class="calibre6">191</a></p>
<p class="indexsubsub">multiple lines, <a href="#calibre_link-378" class="calibre6">192</a></p>
<p class="indexmain"><em class="calibre3">first_numbers.py</em>, <a href="#calibre_link-384" class="calibre6">57</a></p>
<p class="indexmain">flags, <a href="#calibre_link-385" class="calibre6">120</a></p>
<p class="indexmain">floats, <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><em class="calibre3">foods.py</em>, <a href="#calibre_link-386" class="calibre6">63</a>&ndash;<a href="#calibre_link-387" class="calibre6">65</a></p>
<p class="indexmain"><span class="literal">for</span> loops, <a href="#calibre_link-388" class="calibre6">49</a>. <em class="calibre3">See also</em> dictionaries; lists</p>
<p class="indexmain"><em class="calibre3">formatted_name.py</em>, <a href="#calibre_link-389" class="calibre6">138</a>&ndash;<a href="#calibre_link-390" class="calibre6">140</a></p>
<p class="indexmain"><em class="calibre3">full_name.py</em>, <a href="#calibre_link-391" class="calibre6">21</a>&ndash;<a href="#calibre_link-181" class="calibre6">22</a></p>
<p class="indexmain">functions, <a href="#calibre_link-392" class="calibre6">129</a></p>
<p class="indexsub">alias (<span class="literal">as</span>), <a href="#calibre_link-184" class="calibre6">152</a></p>
<p class="indexsub">arguments, <a href="#calibre_link-243" class="calibre6">131</a>&ndash;<a href="#calibre_link-244" class="calibre6">137</a></p>
<p class="indexsubsub">arbitrary keyword, <a href="#calibre_link-393" class="calibre6">148</a></p>
<p class="indexsubsub">arbitrary number of, <a href="#calibre_link-169" class="calibre6">147</a></p>
<p class="indexsubsub">avoiding errors, <a href="#calibre_link-394" class="calibre6">136</a></p>
<p class="indexsubsub">keyword, <a href="#calibre_link-395" class="calibre6">133</a></p>
<p class="indexsubsub">lists as, <a href="#calibre_link-396" class="calibre6">143</a>&ndash;<a href="#calibre_link-397" class="calibre6">146</a></p>
<p class="indexsubsub">mixing positional and arbitrary, <a href="#calibre_link-393" class="calibre6">148</a></p>
<p class="indexsubsub">optional, <a href="#calibre_link-389" class="calibre6">138</a></p>
<p class="indexsubsub">order of, <a href="#calibre_link-395" class="calibre6">133</a></p>
<p class="indexsubsub">positional, <a href="#calibre_link-398" class="calibre6">132</a>&ndash;<a href="#calibre_link-395" class="calibre6">133</a></p>
<p class="indexsub">built-in, <a href="#calibre_link-64" class="calibre6">471</a></p>
<p class="indexsub">calling, <a href="#calibre_link-250" class="calibre6">130</a>&ndash;<a href="#calibre_link-244" class="calibre6">137</a></p>
<p class="indexsubsub">equivalent calls, <a href="#calibre_link-399" class="calibre6">135</a>&ndash;<a href="#calibre_link-394" class="calibre6">136</a></p>
<p class="indexsubsub">multiple times, <a href="#calibre_link-398" class="calibre6">132</a></p>
<p class="indexsub">defining, <a href="#calibre_link-250" class="calibre6">130</a></p>
<p class="indexsub">dictionaries, returning, <a href="#calibre_link-390" class="calibre6">140</a></p>
<p class="indexsub">lists in</p>
<p class="indexsubsub">modifying, <a href="#calibre_link-396" class="calibre6">143</a>&ndash;<a href="#calibre_link-400" class="calibre6">145</a></p>
<p class="indexsubsub">protecting, <a href="#calibre_link-400" class="calibre6">145</a></p>
<p class="indexsub">modules, <a href="#calibre_link-401" class="calibre6">150</a>&ndash;<a href="#calibre_link-402" class="calibre6">155</a></p>
<p class="indexsubsub">alias (<span class="literal">as</span>), <a href="#calibre_link-403" class="calibre6">153</a></p>
<p class="indexsubsub">importing all functions (<span class="literal">*</span>), <a href="#calibre_link-403" class="calibre6">153</a></p>
<p class="indexsubsub">importing entire modules, <a href="#calibre_link-401" class="calibre6">150</a></p>
<p class="indexsubsub">importing specific functions, <a href="#calibre_link-184" class="calibre6">152</a></p>
<p class="indexsub">parameters, default values for, <a href="#calibre_link-291" class="calibre6">134</a></p>
<p class="indexsub">passing information to. <em class="calibre3">See</em> functions: arguments</p>
<p class="indexsub">return values, <a href="#calibre_link-244" class="calibre6">137</a>&ndash;<a href="#calibre_link-404" class="calibre6">142</a></p>
<p class="indexsub">styling, <a href="#calibre_link-405" class="calibre6">154</a></p>
<h3 class="h2"><span type="pagebreak" id="calibre_link-1468" class="calibre"></span><strong class="calibre2">G</strong></h3>
<p class="indexmain">games. <em class="calibre3">See</em> Alien Invasion project; Pygame</p>
<p class="indexmain">Geany, <a href="#calibre_link-406" class="calibre6">476</a></p>
<p class="indexmain">GET requests, <a href="#calibre_link-340" class="calibre6">412</a></p>
<p class="indexmain">getting help</p>
<p class="indexsub">Discord, <a href="#calibre_link-407" class="calibre6">484</a></p>
<p class="indexsub">IRC (Internet Relay Chat), <a href="#calibre_link-408" class="calibre6">482</a>&ndash;<a href="#calibre_link-409" class="calibre6">483</a></p>
<p class="indexsub">official Python documentation, <a href="#calibre_link-410" class="calibre6">481</a></p>
<p class="indexsub">online resources, <a href="#calibre_link-411" class="calibre6">480</a></p>
<p class="indexsub">r/learnpython, <a href="#calibre_link-408" class="calibre6">482</a></p>
<p class="indexsub">rubber duck debugging, <a href="#calibre_link-411" class="calibre6">480</a></p>
<p class="indexsub">Slack, <a href="#calibre_link-409" class="calibre6">483</a></p>
<p class="indexsub">Stack Overflow, <a href="#calibre_link-410" class="calibre6">481</a></p>
<p class="indexsub">three main questions, <a href="#calibre_link-412" class="calibre6">479</a></p>
<p class="indexmain">Git, <a href="#calibre_link-239" class="calibre6">360</a>, <a href="#calibre_link-413" class="calibre6">450</a></p>
<p class="indexsub">branches, <a href="#calibre_link-414" class="calibre6">452</a>, <a href="#calibre_link-415" class="calibre6">488</a></p>
<p class="indexsub">commits, <a href="#calibre_link-239" class="calibre6">360</a>, <a href="#calibre_link-413" class="calibre6">450</a></p>
<p class="indexsubsub">checking out, <a href="#calibre_link-416" class="calibre6">491</a>&ndash;<a href="#calibre_link-417" class="calibre6">493</a></p>
<p class="indexsubsub">making, <a href="#calibre_link-414" class="calibre6">452</a>, <a href="#calibre_link-418" class="calibre6">457</a>, <a href="#calibre_link-344" class="calibre6">460</a>, <a href="#calibre_link-415" class="calibre6">488</a>, <a href="#calibre_link-419" class="calibre6">490</a>, <a href="#calibre_link-417" class="calibre6">493</a></p>
<p class="indexsub">configuring, <a href="#calibre_link-420" class="calibre6">451</a>, <a href="#calibre_link-421" class="calibre6">486</a></p>
<p class="indexsub">detached HEAD, <a href="#calibre_link-422" class="calibre6">492</a></p>
<p class="indexsub">files</p>
<p class="indexsubsub">adding, <a href="#calibre_link-414" class="calibre6">452</a>, <a href="#calibre_link-344" class="calibre6">460</a>, <a href="#calibre_link-415" class="calibre6">488</a>, <a href="#calibre_link-417" class="calibre6">493</a></p>
<p class="indexsubsub">ignoring, <a href="#calibre_link-420" class="calibre6">451</a>, <a href="#calibre_link-423" class="calibre6">487</a></p>
<p class="indexsub">HEAD, <a href="#calibre_link-422" class="calibre6">492</a></p>
<p class="indexsub">installing, <a href="#calibre_link-413" class="calibre6">450</a>, <a href="#calibre_link-421" class="calibre6">486</a></p>
<p class="indexsub">log, checking, <a href="#calibre_link-424" class="calibre6">489</a></p>
<p class="indexsub">repositories, <a href="#calibre_link-239" class="calibre6">360</a></p>
<p class="indexsubsub">deleting, <a href="#calibre_link-417" class="calibre6">493</a></p>
<p class="indexsubsub">initializing, <a href="#calibre_link-414" class="calibre6">452</a>, <a href="#calibre_link-423" class="calibre6">487</a>, <a href="#calibre_link-417" class="calibre6">493</a></p>
<p class="indexsub">reverting changes, <a href="#calibre_link-419" class="calibre6">490</a></p>
<p class="indexsub">status, checking, <a href="#calibre_link-414" class="calibre6">452</a>, <a href="#calibre_link-418" class="calibre6">457</a>, <a href="#calibre_link-423" class="calibre6">487</a>&ndash;<a href="#calibre_link-417" class="calibre6">493</a></p>
<p class="indexmain">GitHub, <a href="#calibre_link-239" class="calibre6">360</a></p>
<p class="indexmain">greater than (<span class="literal">&gt;</span>), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain">greater than or equal to (<span class="literal">&gt;=</span>), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain"><em class="calibre3">greeter.py</em>, <a href="#calibre_link-425" class="calibre6">114</a>, <a href="#calibre_link-250" class="calibre6">130</a>&ndash;<a href="#calibre_link-243" class="calibre6">131</a></p>
<p class="indexmain"><em class="calibre3">greet_users.py</em>, <a href="#calibre_link-396" class="calibre6">143</a></p>
<p class="indexmain"><span class="literal">gunicorn</span> package, <a href="#calibre_link-356" class="calibre6">448</a></p>
<h3 class="h2"><strong class="calibre2">H</strong></h3>
<p class="indexmain">Hacker News, <a href="#calibre_link-235" class="calibre6">372</a></p>
<p class="indexmain">hash mark (<span class="literal">#</span>), for comments, <a href="#calibre_link-176" class="calibre6">29</a></p>
<p class="indexmain">head, of an HTML file, <a href="#calibre_link-251" class="calibre6">440</a></p>
<p class="indexmain">HEAD (Git), <a href="#calibre_link-422" class="calibre6">492</a></p>
<p class="indexmain">Hello World, <a href="#calibre_link-426" class="calibre6">9</a></p>
<p class="indexmain"><em class="calibre3">hello_git.py</em>, <a href="#calibre_link-421" class="calibre6">486</a>&ndash;<a href="#calibre_link-416" class="calibre6">491</a></p>
<p class="indexmain"><em class="calibre3">hello_world.py</em>, <a href="#calibre_link-427" class="calibre6">10</a>, <a href="#calibre_link-428" class="calibre6">15</a>&ndash;<a href="#calibre_link-429" class="calibre6">19</a></p>
<p class="indexmain">Heroku, <a href="#calibre_link-430" class="calibre6">437</a>. <em class="calibre3">See also</em> Django; Git; Learning Log project</p>
<p class="indexsub">Bash shell, <a href="#calibre_link-431" class="calibre6">454</a></p>
<p class="indexsub">CLI, installing, <a href="#calibre_link-356" class="calibre6">448</a></p>
<p class="indexsub">commands</p>
<p class="indexsubsub"><span class="literal">config</span>, <a href="#calibre_link-432" class="calibre6">458</a></p>
<p class="indexsubsub"><span class="literal">destroy</span>, <a href="#calibre_link-433" class="calibre6">462</a></p>
<p class="indexsubsub"><span class="literal">login</span>, <a href="#calibre_link-434" class="calibre6">453</a></p>
<p class="indexsubsub"><span class="literal">open</span>, <a href="#calibre_link-434" class="calibre6">453</a></p>
<p class="indexsubsub"><span class="literal">ps</span>, <a href="#calibre_link-434" class="calibre6">453</a></p>
<p class="indexsubsub"><span class="literal">rename</span>, <a href="#calibre_link-435" class="calibre6">455</a></p>
<p class="indexsubsub"><span class="literal">run</span>, <a href="#calibre_link-431" class="calibre6">454</a></p>
<p class="indexsubsub"><span class="literal">set</span>, <a href="#calibre_link-432" class="calibre6">458</a></p>
<p class="indexsub">databases, setting up, <a href="#calibre_link-431" class="calibre6">454</a></p>
<p class="indexsub"><span class="literal">django-heroku</span> package, <a href="#calibre_link-356" class="calibre6">448</a></p>
<p class="indexsub">documentation, <a href="#calibre_link-434" class="calibre6">453</a></p>
<p class="indexsub">environment variables, setting, <a href="#calibre_link-252" class="calibre6">456</a>&ndash;<a href="#calibre_link-432" class="calibre6">458</a></p>
<p class="indexsub">error pages, custom, <a href="#calibre_link-432" class="calibre6">458</a>&ndash;<a href="#calibre_link-344" class="calibre6">460</a></p>
<p class="indexsub">free plan, limitations of, <a href="#calibre_link-356" class="calibre6">448</a>, <a href="#calibre_link-252" class="calibre6">456</a></p>
<p class="indexsub">making an account, <a href="#calibre_link-356" class="calibre6">448</a></p>
<p class="indexsub"><em class="calibre3">Procfile</em>, <a href="#calibre_link-413" class="calibre6">450</a></p>
<p class="indexsub">projects</p>
<p class="indexsubsub">deleting, <a href="#calibre_link-355" class="calibre6">461</a></p>
<p class="indexsubsub">pushing to Heroku, <a href="#calibre_link-414" class="calibre6">452</a>&ndash;<a href="#calibre_link-434" class="calibre6">453</a>, <a href="#calibre_link-418" class="calibre6">457</a></p>
<p class="indexsubsub">viewing live, <a href="#calibre_link-434" class="calibre6">453</a></p>
<p class="indexsub">Python runtime, specifying, <a href="#calibre_link-436" class="calibre6">449</a></p>
<p class="indexsub"><em class="calibre3">requirements.txt</em>, <a href="#calibre_link-356" class="calibre6">448</a>&ndash;<a href="#calibre_link-436" class="calibre6">449</a></p>
<p class="indexsub">securing, <a href="#calibre_link-252" class="calibre6">456</a></p>
<p class="indexsub"><em class="calibre3">settings.py</em>, modifying for, <a href="#calibre_link-413" class="calibre6">450</a>, <a href="#calibre_link-252" class="calibre6">456</a>, <a href="#calibre_link-437" class="calibre6">459</a></p>
<p class="indexsub">superuser, creating, <a href="#calibre_link-431" class="calibre6">454</a>&ndash;<a href="#calibre_link-435" class="calibre6">455</a></p>
<p class="indexsub">URLs, user-friendly, <a href="#calibre_link-435" class="calibre6">455</a></p>
<p class="indexmain">hidden files, <a href="#calibre_link-420" class="calibre6">451</a></p>
<p class="indexmain"><span type="pagebreak" id="calibre_link-1469" class="calibre"></span><em class="calibre3">hn_article.py</em>, <a href="#calibre_link-235" class="calibre6">372</a></p>
<p class="indexmain"><em class="calibre3">hn_submissions.py</em>, <a href="#calibre_link-438" class="calibre6">373</a></p>
<p class="indexmain">Homebrew, <a href="#calibre_link-439" class="calibre6">469</a></p>
<h3 class="h2"><strong class="calibre2">I</strong></h3>
<p class="indexmain">IDE (integrated development environment), <a href="#calibre_link-440" class="calibre6">473</a></p>
<p class="indexmain">IDLE, <a href="#calibre_link-441" class="calibre6">475</a></p>
<p class="indexmain"><span class="literal">if</span> statements</p>
<p class="indexsub"><span class="literal">and</span> keyword, <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexsub">Boolean expressions, <a href="#calibre_link-248" class="calibre6">77</a></p>
<p class="indexsub">checking for</p>
<p class="indexsubsub">equality (<span class="literal">==</span>), <a href="#calibre_link-172" class="calibre6">72</a></p>
<p class="indexsubsub">equality, ignoring case, <a href="#calibre_link-173" class="calibre6">73</a></p>
<p class="indexsubsub">empty lists, <a href="#calibre_link-442" class="calibre6">87</a></p>
<p class="indexsubsub">inequality (<span class="literal">!=</span>), <a href="#calibre_link-177" class="calibre6">74</a></p>
<p class="indexsubsub">items in a list, <a href="#calibre_link-443" class="calibre6">76</a></p>
<p class="indexsubsub">items not in a list, <a href="#calibre_link-248" class="calibre6">77</a></p>
<p class="indexsub">conditional tests, <a href="#calibre_link-172" class="calibre6">72</a>&ndash;<a href="#calibre_link-248" class="calibre6">77</a></p>
<p class="indexsub"><span class="literal">elif</span> statement, <a href="#calibre_link-231" class="calibre6">80</a>&ndash;<a href="#calibre_link-444" class="calibre6">84</a></p>
<p class="indexsub"><span class="literal">else</span> statement, <a href="#calibre_link-445" class="calibre6">79</a></p>
<p class="indexsub">lists and, <a href="#calibre_link-446" class="calibre6">85</a>&ndash;<a href="#calibre_link-447" class="calibre6">88</a></p>
<p class="indexsub">numerical comparisons, <a href="#calibre_link-177" class="calibre6">74</a>&ndash;<a href="#calibre_link-443" class="calibre6">76</a></p>
<p class="indexsub"><span class="literal">or</span> keyword, <a href="#calibre_link-443" class="calibre6">76</a></p>
<p class="indexsub">simple, <a href="#calibre_link-448" class="calibre6">78</a></p>
<p class="indexsub">styling guidelines, <a href="#calibre_link-449" class="calibre6">90</a></p>
<p class="indexsub">testing multiple conditions, <a href="#calibre_link-232" class="calibre6">83</a>&ndash;<a href="#calibre_link-444" class="calibre6">84</a></p>
<p class="indexmain">immutable, <a href="#calibre_link-387" class="calibre6">65</a></p>
<p class="indexmain"><span class="literal">import *</span>, <a href="#calibre_link-403" class="calibre6">153</a></p>
<p class="indexmain"><span class="literal">import this</span>, <a href="#calibre_link-277" class="calibre6">30</a></p>
<p class="indexmain">indentation errors, <a href="#calibre_link-450" class="calibre6">53</a>&ndash;<a href="#calibre_link-60" class="calibre6">56</a></p>
<p class="indexmain">index errors, <a href="#calibre_link-451" class="calibre6">47</a></p>
<p class="indexmain">inequality operator (<span class="literal">!=</span>), <a href="#calibre_link-177" class="calibre6">74</a></p>
<p class="indexmain">infinite loops, <a href="#calibre_link-180" class="calibre6">122</a></p>
<p class="indexmain">inheritance, <a href="#calibre_link-269" class="calibre6">167</a>. <em class="calibre3">See also</em> classes: inheritance</p>
<p class="indexmain"><span class="literal">input()</span> function, <a href="#calibre_link-425" class="calibre6">114</a>&ndash;<a href="#calibre_link-179" class="calibre6">117</a></p>
<p class="indexsub">numerical input, <a href="#calibre_link-182" class="calibre6">115</a>&ndash;<a href="#calibre_link-178" class="calibre6">116</a></p>
<p class="indexsub">prompts, <a href="#calibre_link-425" class="calibre6">114</a></p>
<p class="indexmain"><span class="literal">insert()</span> method, <a href="#calibre_link-452" class="calibre6">38</a></p>
<p class="indexmain">IRC (Internet Relay Chat), <a href="#calibre_link-408" class="calibre6">482</a>&ndash;<a href="#calibre_link-409" class="calibre6">483</a></p>
<p class="indexmain"><span class="literal">itemgetter()</span> function, <a href="#calibre_link-302" class="calibre6">374</a></p>
<p class="indexmain"><span class="literal">items()</span> method, <a href="#calibre_link-125" class="calibre6">100</a></p>
<h3 class="h2"><strong class="calibre2">J</strong></h3>
<p class="indexmain">JSON files</p>
<p class="indexsub">examining data, <a href="#calibre_link-453" class="calibre6">347</a></p>
<p class="indexsub">geoJSON file format, <a href="#calibre_link-454" class="calibre6">349</a></p>
<p class="indexsub"><span class="literal">json.dump()</span> function, <a href="#calibre_link-364" class="calibre6">348</a></p>
<p class="indexsub"><span class="literal">json.load()</span> function, <a href="#calibre_link-455" class="calibre6">204</a></p>
<p class="indexmain">jumbotron, <a href="#calibre_link-319" class="calibre6">443</a></p>
<h3 class="h2"><strong class="calibre2">K</strong></h3>
<p class="indexmain"><span class="literal">keys()</span> method, <a href="#calibre_link-299" class="calibre6">101</a></p>
<p class="indexmain">key-value pairs, <a href="#calibre_link-170" class="calibre6">92</a>&ndash;<a href="#calibre_link-124" class="calibre6">99</a>. <em class="calibre3">See also</em> dictionaries</p>
<p class="indexmain">keyword arguments, <a href="#calibre_link-398" class="calibre6">132</a>, <a href="#calibre_link-395" class="calibre6">133</a>. <em class="calibre3">See also</em> functions</p>
<p class="indexmain">keywords, <a href="#calibre_link-64" class="calibre6">471</a></p>
<h3 class="h2"><strong class="calibre2">L</strong></h3>
<p class="indexmain"><em class="calibre3">language_survey.py</em>, <a href="#calibre_link-456" class="calibre6">217</a></p>
<p class="indexmain">Learning Log project, <a href="#calibre_link-312" class="calibre6">379</a>. <em class="calibre3">See also</em> Django; Heroku</p>
<p class="indexsub">deployment. <em class="calibre3">See</em> Git, Heroku</p>
<p class="indexsub">files</p>
<p class="indexsubsub"><em class="calibre3">404.html</em>, <a href="#calibre_link-432" class="calibre6">458</a></p>
<p class="indexsubsub"><em class="calibre3">500.html</em>, <a href="#calibre_link-437" class="calibre6">459</a></p>
<p class="indexsubsub"><em class="calibre3">admin.py</em>, <a href="#calibre_link-315" class="calibre6">388</a></p>
<p class="indexsubsub"><em class="calibre3">base.html</em>, <a href="#calibre_link-358" class="calibre6">399</a>, <a href="#calibre_link-457" class="calibre6">403</a>, <a href="#calibre_link-458" class="calibre6">423</a>, <a href="#calibre_link-459" class="calibre6">425</a>, <a href="#calibre_link-354" class="calibre6">428</a>, <a href="#calibre_link-320" class="calibre6">439</a>&ndash;<a href="#calibre_link-319" class="calibre6">443</a></p>
<p class="indexsubsub"><em class="calibre3">edit_entry.html</em>, <a href="#calibre_link-342" class="calibre6">419</a></p>
<p class="indexsubsub"><em class="calibre3">forms.py</em>, <a href="#calibre_link-337" class="calibre6">410</a>, <a href="#calibre_link-341" class="calibre6">414</a></p>
<p class="indexsubsub"><em class="calibre3">.gitignore</em>, <a href="#calibre_link-420" class="calibre6">451</a></p>
<p class="indexsubsub"><em class="calibre3">index.html</em>, <a href="#calibre_link-357" class="calibre6">397</a>, <a href="#calibre_link-319" class="calibre6">443</a></p>
<p class="indexsubsub"><em class="calibre3">learning_logs/urls.py</em>, <a href="#calibre_link-348" class="calibre6">395</a>, <a href="#calibre_link-333" class="calibre6">401</a>, <a href="#calibre_link-331" class="calibre6">404</a>, <a href="#calibre_link-352" class="calibre6">411</a>, <a href="#calibre_link-460" class="calibre6">415</a>, <a href="#calibre_link-461" class="calibre6">418</a></p>
<p class="indexsubsub"><em class="calibre3">learning_log/urls.py</em>, <a href="#calibre_link-348" class="calibre6">395</a>, <a href="#calibre_link-347" class="calibre6">422</a></p>
<p class="indexsubsub"><em class="calibre3">logged_out.html</em>, <a href="#calibre_link-459" class="calibre6">425</a></p>
<p class="indexsubsub"><em class="calibre3">login.html</em>, <a href="#calibre_link-347" class="calibre6">422</a>&ndash;<a href="#calibre_link-458" class="calibre6">423</a>, <a href="#calibre_link-322" class="calibre6">444</a></p>
<p class="indexsubsub"><em class="calibre3">models.py</em>, <a href="#calibre_link-327" class="calibre6">385</a>, <a href="#calibre_link-330" class="calibre6">390</a>, <a href="#calibre_link-350" class="calibre6">431</a></p>
<p class="indexsubsub"><em class="calibre3">new_entry.html</em>, <a href="#calibre_link-343" class="calibre6">416</a></p>
<p class="indexsubsub"><em class="calibre3">new_topic.html</em>, <a href="#calibre_link-340" class="calibre6">412</a></p>
<p class="indexsubsub"><em class="calibre3">Procfile</em>, <a href="#calibre_link-413" class="calibre6">450</a></p>
<p class="indexsubsub"><em class="calibre3">register.html</em>, <a href="#calibre_link-361" class="calibre6">427</a></p>
<p class="indexsubsub"><em class="calibre3">requirements.txt</em>, <a href="#calibre_link-356" class="calibre6">448</a></p>
<p class="indexsubsub"><em class="calibre3">runtime.txt</em>, <a href="#calibre_link-436" class="calibre6">449</a></p>
<p class="indexsubsub"><em class="calibre3">settings.py</em>, <a href="#calibre_link-335" class="calibre6">386</a>, <a href="#calibre_link-78" class="calibre6">421</a>, <a href="#calibre_link-290" class="calibre6">429</a>, <a href="#calibre_link-413" class="calibre6">450</a>, <a href="#calibre_link-252" class="calibre6">456</a>, <a href="#calibre_link-437" class="calibre6">459</a></p>
<p class="indexsubsub"><span type="pagebreak" id="calibre_link-1470" class="calibre"></span><em class="calibre3">topic.html</em>, <a href="#calibre_link-331" class="calibre6">404</a>&ndash;<a href="#calibre_link-359" class="calibre6">405</a>, <a href="#calibre_link-462" class="calibre6">417</a>, <a href="#calibre_link-338" class="calibre6">420</a></p>
<p class="indexsubsub"><em class="calibre3">topics.html</em>, <a href="#calibre_link-360" class="calibre6">402</a>, <a href="#calibre_link-359" class="calibre6">405</a>, <a href="#calibre_link-339" class="calibre6">413</a>, <a href="#calibre_link-323" class="calibre6">445</a></p>
<p class="indexsubsub"><em class="calibre3">users/urls.py</em>, <a href="#calibre_link-347" class="calibre6">422</a>, <a href="#calibre_link-353" class="calibre6">426</a></p>
<p class="indexsubsub"><em class="calibre3">users/views.py</em>, <a href="#calibre_link-353" class="calibre6">426</a></p>
<p class="indexsubsub"><em class="calibre3">views.py</em>, <a href="#calibre_link-349" class="calibre6">396</a>, <a href="#calibre_link-333" class="calibre6">401</a>, <a href="#calibre_link-331" class="calibre6">404</a>, <a href="#calibre_link-352" class="calibre6">411</a>, <a href="#calibre_link-460" class="calibre6">415</a>, <a href="#calibre_link-461" class="calibre6">418</a>, <a href="#calibre_link-290" class="calibre6">429</a>, <a href="#calibre_link-463" class="calibre6">430</a>, <a href="#calibre_link-324" class="calibre6">433</a>, <a href="#calibre_link-344" class="calibre6">460</a></p>
<p class="indexsub">pages</p>
<p class="indexsubsub">edit entry, <a href="#calibre_link-461" class="calibre6">418</a>&ndash;<a href="#calibre_link-338" class="calibre6">420</a></p>
<p class="indexsubsub">home, <a href="#calibre_link-50" class="calibre6">394</a>&ndash;<a href="#calibre_link-54" class="calibre6">398</a></p>
<p class="indexsubsub">login, <a href="#calibre_link-347" class="calibre6">422</a>&ndash;<a href="#calibre_link-346" class="calibre6">424</a></p>
<p class="indexsubsub">logout, <a href="#calibre_link-346" class="calibre6">424</a></p>
<p class="indexsubsub">new entry, <a href="#calibre_link-341" class="calibre6">414</a>&ndash;<a href="#calibre_link-462" class="calibre6">417</a></p>
<p class="indexsubsub">new topic, <a href="#calibre_link-337" class="calibre6">410</a>&ndash;<a href="#calibre_link-339" class="calibre6">413</a></p>
<p class="indexsubsub">register, <a href="#calibre_link-353" class="calibre6">426</a></p>
<p class="indexsubsub">topic, <a href="#calibre_link-457" class="calibre6">403</a></p>
<p class="indexsubsub">topics, <a href="#calibre_link-464" class="calibre6">400</a>&ndash;<a href="#calibre_link-457" class="calibre6">403</a></p>
<p class="indexsub"><span class="literal">users</span> app, <a href="#calibre_link-78" class="calibre6">421</a>&ndash;<a href="#calibre_link-354" class="calibre6">428</a></p>
<p class="indexsub">virtual environment, <a href="#calibre_link-465" class="calibre6">380</a>&ndash;<a href="#calibre_link-329" class="calibre6">381</a></p>
<p class="indexsub">writing a specification (spec), <a href="#calibre_link-465" class="calibre6">380</a></p>
<p class="indexmain"><span class="literal">len()</span> function, <a href="#calibre_link-259" class="calibre6">45</a></p>
<p class="indexmain">less than (<span class="literal">&lt;</span>), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain">less than or equal to (<span class="literal">&lt;=</span>), <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain">Linux</p>
<p class="indexsub">Hello World, running, <a href="#calibre_link-427" class="calibre6">10</a></p>
<p class="indexsub">Python</p>
<p class="indexsubsub">checking installed version, <a href="#calibre_link-5" class="calibre6">8</a></p>
<p class="indexsubsub">installing, <a href="#calibre_link-466" class="calibre6">470</a></p>
<p class="indexsubsub">troubleshooting installation, <a href="#calibre_link-467" class="calibre6">11</a></p>
<p class="indexsub">Sublime Text, installing, <a href="#calibre_link-426" class="calibre6">9</a></p>
<p class="indexsub">terminal</p>
<p class="indexsubsub">running programs from, <a href="#calibre_link-131" class="calibre6">12</a></p>
<p class="indexsubsub">starting Python session, <a href="#calibre_link-426" class="calibre6">9</a></p>
<p class="indexmain">lists, <a href="#calibre_link-468" class="calibre6">33</a></p>
<p class="indexsub">as arguments, <a href="#calibre_link-396" class="calibre6">143</a>&ndash;<a href="#calibre_link-397" class="calibre6">146</a></p>
<p class="indexsub">copying, <a href="#calibre_link-386" class="calibre6">63</a>&ndash;<a href="#calibre_link-387" class="calibre6">65</a></p>
<p class="indexsub">elements</p>
<p class="indexsubsub">accessing, <a href="#calibre_link-183" class="calibre6">34</a></p>
<p class="indexsubsub">accessing last, <a href="#calibre_link-469" class="calibre6">35</a></p>
<p class="indexsubsub">adding with <span class="literal">append()</span>, <a href="#calibre_link-242" class="calibre6">37</a></p>
<p class="indexsubsub">adding with <span class="literal">insert()</span>, <a href="#calibre_link-452" class="calibre6">38</a></p>
<p class="indexsubsub">identifying unique, <a href="#calibre_link-301" class="calibre6">104</a></p>
<p class="indexsubsub">modifying, <a href="#calibre_link-249" class="calibre6">36</a></p>
<p class="indexsubsub">removing with <span class="literal">del</span>, <a href="#calibre_link-292" class="calibre6">39</a></p>
<p class="indexsubsub">removing with <span class="literal">pop()</span>, <a href="#calibre_link-292" class="calibre6">39</a>&ndash;<a href="#calibre_link-470" class="calibre6">41</a></p>
<p class="indexsubsub">removing with <span class="literal">remove()</span>, <a href="#calibre_link-470" class="calibre6">41</a></p>
<p class="indexsub">empty, <a href="#calibre_link-452" class="calibre6">38</a></p>
<p class="indexsub"><span class="literal">enumerate()</span> function, <a href="#calibre_link-285" class="calibre6">335</a></p>
<p class="indexsub"><span class="literal">for</span> loops, <a href="#calibre_link-388" class="calibre6">49</a>&ndash;<a href="#calibre_link-60" class="calibre6">56</a></p>
<p class="indexsubsub">nested, <a href="#calibre_link-471" class="calibre6">109</a>, <a href="#calibre_link-472" class="calibre6">263</a></p>
<p class="indexsub"><span class="literal">if</span> statements and, <a href="#calibre_link-446" class="calibre6">85</a>&ndash;<a href="#calibre_link-447" class="calibre6">88</a></p>
<p class="indexsub">indentation errors, <a href="#calibre_link-450" class="calibre6">53</a>&ndash;<a href="#calibre_link-60" class="calibre6">56</a></p>
<p class="indexsub">indexes, <a href="#calibre_link-469" class="calibre6">35</a></p>
<p class="indexsubsub">errors, <a href="#calibre_link-473" class="calibre6">46</a>&ndash;<a href="#calibre_link-451" class="calibre6">47</a></p>
<p class="indexsubsub">negative, <a href="#calibre_link-469" class="calibre6">35</a></p>
<p class="indexsub"><span class="literal">len()</span> function, <a href="#calibre_link-259" class="calibre6">45</a></p>
<p class="indexsub">list comprehensions, <a href="#calibre_link-474" class="calibre6">59</a></p>
<p class="indexsub">naming, <a href="#calibre_link-183" class="calibre6">34</a></p>
<p class="indexsub">numerical lists, <a href="#calibre_link-384" class="calibre6">57</a>&ndash;<a href="#calibre_link-475" class="calibre6">60</a></p>
<p class="indexsub"><span class="literal">range()</span> function, <a href="#calibre_link-367" class="calibre6">58</a>&ndash;<a href="#calibre_link-474" class="calibre6">59</a></p>
<p class="indexsub">removing all occurrences of a value, <a href="#calibre_link-476" class="calibre6">125</a></p>
<p class="indexsub">slices, <a href="#calibre_link-477" class="calibre6">61</a>&ndash;<a href="#calibre_link-386" class="calibre6">63</a></p>
<p class="indexsub">sorting, <a href="#calibre_link-258" class="calibre6">43</a>&ndash;<a href="#calibre_link-473" class="calibre6">46</a></p>
<p class="indexsubsub"><span class="literal">reverse()</span> method, <a href="#calibre_link-259" class="calibre6">45</a></p>
<p class="indexsubsub"><span class="literal">sorted()</span> function, <a href="#calibre_link-478" class="calibre6">44</a></p>
<p class="indexsubsub"><span class="literal">sort()</span> method, <a href="#calibre_link-258" class="calibre6">43</a></p>
<p class="indexmain">logical errors, <a href="#calibre_link-58" class="calibre6">54</a></p>
<h3 class="h2"><strong class="calibre2">M</strong></h3>
<p class="indexmain">macOS</p>
<p class="indexsub">Hello World, running, <a href="#calibre_link-427" class="calibre6">10</a></p>
<p class="indexsub">Python</p>
<p class="indexsubsub">checking installed version, <a href="#calibre_link-479" class="calibre6">7</a></p>
<p class="indexsubsub">installing, with Homebrew, <a href="#calibre_link-439" class="calibre6">469</a>&ndash;<a href="#calibre_link-466" class="calibre6">470</a></p>
<p class="indexsubsub">installing, official version, <a href="#calibre_link-479" class="calibre6">7</a>&ndash;<a href="#calibre_link-5" class="calibre6">8</a></p>
<p class="indexsubsub">troubleshooting installation, <a href="#calibre_link-467" class="calibre6">11</a></p>
<p class="indexsub">Sublime Text, installing, <a href="#calibre_link-5" class="calibre6">8</a></p>
<p class="indexsub">terminal</p>
<p class="indexsubsub">running programs from, <a href="#calibre_link-131" class="calibre6">12</a></p>
<p class="indexsubsub">starting a Python session, <a href="#calibre_link-5" class="calibre6">8</a></p>
<p class="indexmain"><em class="calibre3">magicians.py</em>, <a href="#calibre_link-480" class="calibre6">50</a>&ndash;<a href="#calibre_link-450" class="calibre6">53</a></p>
<p class="indexmain"><em class="calibre3">magic_number.py</em>, <a href="#calibre_link-175" class="calibre6">75</a></p>
<p class="indexmain"><em class="calibre3">making_pizzas.py</em>, <a href="#calibre_link-362" class="calibre6">151</a>&ndash;<a href="#calibre_link-403" class="calibre6">153</a></p>
<p class="indexmain">mapping earthquakes, <a href="#calibre_link-453" class="calibre6">347</a>&ndash;<a href="#calibre_link-366" class="calibre6">357</a></p>
<p class="indexsub">building a world map, <a href="#calibre_link-365" class="calibre6">351</a></p>
<p class="indexsub">colorscales, <a href="#calibre_link-481" class="calibre6">354</a></p>
<p class="indexsub"><span type="pagebreak" id="calibre_link-1471" class="calibre"></span>data</p>
<p class="indexsubsub">downloading, <a href="#calibre_link-453" class="calibre6">347</a>, <a href="#calibre_link-482" class="calibre6">358</a></p>
<p class="indexsubsub">examining JSON data, <a href="#calibre_link-453" class="calibre6">347</a></p>
<p class="indexsubsub">extracting locations, <a href="#calibre_link-365" class="calibre6">351</a></p>
<p class="indexsubsub">extracting magnitudes, <a href="#calibre_link-483" class="calibre6">350</a></p>
<p class="indexsubsub">geoJSON file format, <a href="#calibre_link-454" class="calibre6">349</a></p>
<p class="indexsub">hover text, <a href="#calibre_link-484" class="calibre6">356</a></p>
<p class="indexsub">latitude-longitude ordering, <a href="#calibre_link-454" class="calibre6">349</a></p>
<p class="indexsub">magnitudes, representing, <a href="#calibre_link-485" class="calibre6">353</a></p>
<p class="indexsub">Scattergeo chart type, <a href="#calibre_link-486" class="calibre6">352</a></p>
<p class="indexmain">Matplotlib, <a href="#calibre_link-487" class="calibre6">306</a>&ndash;<a href="#calibre_link-488" class="calibre6">323</a>, <a href="#calibre_link-286" class="calibre6">336</a>&ndash;<a href="#calibre_link-453" class="calibre6">347</a></p>
<p class="indexsub">axes</p>
<p class="indexsubsub"><span class="literal">axis()</span> method, <a href="#calibre_link-489" class="calibre6">313</a></p>
<p class="indexsubsub"><span class="literal">ax</span> variable, <a href="#calibre_link-490" class="calibre6">307</a></p>
<p class="indexsubsub">removing, <a href="#calibre_link-491" class="calibre6">321</a></p>
<p class="indexsub"><span class="literal">fig</span> variable, <a href="#calibre_link-490" class="calibre6">307</a></p>
<p class="indexsub">formatting plots</p>
<p class="indexsubsub">alpha argument, <a href="#calibre_link-492" class="calibre6">342</a></p>
<p class="indexsubsub">built-in styles, <a href="#calibre_link-493" class="calibre6">310</a></p>
<p class="indexsubsub">colormaps, <a href="#calibre_link-494" class="calibre6">314</a></p>
<p class="indexsubsub">custom colors, <a href="#calibre_link-494" class="calibre6">314</a></p>
<p class="indexsubsub">labels, <a href="#calibre_link-490" class="calibre6">307</a>&ndash;<a href="#calibre_link-495" class="calibre6">308</a></p>
<p class="indexsubsub">line thickness, <a href="#calibre_link-490" class="calibre6">307</a></p>
<p class="indexsubsub">shading, <a href="#calibre_link-492" class="calibre6">342</a></p>
<p class="indexsubsub">size, <a href="#calibre_link-496" class="calibre6">322</a></p>
<p class="indexsub">gallery, <a href="#calibre_link-487" class="calibre6">306</a></p>
<p class="indexsub">installing, <a href="#calibre_link-487" class="calibre6">306</a></p>
<p class="indexsub">line graphs, <a href="#calibre_link-487" class="calibre6">306</a></p>
<p class="indexsub"><span class="literal">plot()</span> method, <a href="#calibre_link-490" class="calibre6">307</a>, <a href="#calibre_link-497" class="calibre6">309</a></p>
<p class="indexsub"><span class="literal">pyplot</span> module, <a href="#calibre_link-490" class="calibre6">307</a></p>
<p class="indexsub">saving plots, <a href="#calibre_link-498" class="calibre6">315</a></p>
<p class="indexsub">scatter plots, <a href="#calibre_link-493" class="calibre6">310</a>&ndash;<a href="#calibre_link-489" class="calibre6">313</a></p>
<p class="indexsub"><span class="literal">subplots()</span> function, <a href="#calibre_link-490" class="calibre6">307</a></p>
<p class="indexmain">methods, <a href="#calibre_link-499" class="calibre6">20</a>, <a href="#calibre_link-500" class="calibre6">236</a>&ndash;<a href="#calibre_link-501" class="calibre6">237</a>. <em class="calibre3">See also</em> classes</p>
<p class="indexmain">modules, <a href="#calibre_link-401" class="calibre6">150</a>. <em class="calibre3">See also</em> classes: modules; functions: modules</p>
<p class="indexmain">modulo operator (<span class="literal">%</span>), <a href="#calibre_link-178" class="calibre6">116</a>&ndash;<a href="#calibre_link-179" class="calibre6">117</a>, <a href="#calibre_link-180" class="calibre6">122</a></p>
<p class="indexmain"><em class="calibre3">motorcycles.py</em>, <a href="#calibre_link-242" class="calibre6">37</a>&ndash;<a href="#calibre_link-166" class="calibre6">42</a></p>
<p class="indexmain"><em class="calibre3">mountain_poll.py</em>, <a href="#calibre_link-502" class="calibre6">126</a></p>
<p class="indexmain"><em class="calibre3">mpl_squares.py</em>, <a href="#calibre_link-487" class="calibre6">306</a>&ndash;<a href="#calibre_link-493" class="calibre6">310</a></p>
<p class="indexmain">multiplication (<span class="literal">*</span>), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain"><em class="calibre3">my_car.py</em>, <a href="#calibre_link-268" class="calibre6">175</a></p>
<p class="indexmain"><em class="calibre3">my_cars.py</em>, <a href="#calibre_link-267" class="calibre6">177</a>&ndash;<a href="#calibre_link-257" class="calibre6">179</a></p>
<p class="indexmain"><em class="calibre3">my_electric_car.py</em>, <a href="#calibre_link-503" class="calibre6">176</a></p>
<h3 class="h2"><strong class="calibre2">N</strong></h3>
<p class="indexmain">name errors, <a href="#calibre_link-504" class="calibre6">17</a></p>
<p class="indexmain"><em class="calibre3">name_function.py</em>, <a href="#calibre_link-505" class="calibre6">210</a>&ndash;<a href="#calibre_link-506" class="calibre6">215</a></p>
<p class="indexmain"><em class="calibre3">name.py</em>, <a href="#calibre_link-499" class="calibre6">20</a></p>
<p class="indexmain"><em class="calibre3">names.py</em>, <a href="#calibre_link-505" class="calibre6">210</a></p>
<p class="indexmain">nesting, <a href="#calibre_link-507" class="calibre6">106</a>&ndash;<a href="#calibre_link-508" class="calibre6">112</a></p>
<p class="indexsub">depth, <a href="#calibre_link-509" class="calibre6">110</a></p>
<p class="indexsub">dictionaries in dictionaries, <a href="#calibre_link-509" class="calibre6">110</a>&ndash;<a href="#calibre_link-510" class="calibre6">111</a></p>
<p class="indexsub">dictionaries in lists, <a href="#calibre_link-507" class="calibre6">106</a>&ndash;<a href="#calibre_link-511" class="calibre6">108</a></p>
<p class="indexsub">lists in dictionaries, <a href="#calibre_link-511" class="calibre6">108</a>&ndash;<a href="#calibre_link-509" class="calibre6">110</a></p>
<p class="indexmain">newline (<span class="literal">\n</span>), <a href="#calibre_link-181" class="calibre6">22</a></p>
<p class="indexmain"><span class="literal">None</span>, <a href="#calibre_link-124" class="calibre6">99</a></p>
<p class="indexmain">not (<span class="literal">!</span>), <a href="#calibre_link-177" class="calibre6">74</a></p>
<p class="indexmain"><em class="calibre3">number_reader.py</em>, <a href="#calibre_link-512" class="calibre6">203</a></p>
<p class="indexmain">numbers, <a href="#calibre_link-513" class="calibre6">25</a>&ndash;<a href="#calibre_link-279" class="calibre6">28</a></p>
<p class="indexsub">arithmetic, <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexsub">comparisons, <a href="#calibre_link-177" class="calibre6">74</a>&ndash;<a href="#calibre_link-443" class="calibre6">76</a></p>
<p class="indexsub">exponents, <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexsub">floats, <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexsub">floor division (<span class="literal">//</span>), <a href="#calibre_link-174" class="calibre6">260</a></p>
<p class="indexsub">integers, <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexsub">mixing integers and floats, <a href="#calibre_link-514" class="calibre6">27</a></p>
<p class="indexsub">order of operations, <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexsub"><span class="literal">round()</span> function, <a href="#calibre_link-223" class="calibre6">294</a></p>
<p class="indexsub">underscores in, <a href="#calibre_link-279" class="calibre6">28</a></p>
<p class="indexmain"><em class="calibre3">number_writer.py</em>, <a href="#calibre_link-512" class="calibre6">203</a></p>
<h3 class="h2"><strong class="calibre2">O</strong></h3>
<p class="indexmain">object-oriented programming, <a href="#calibre_link-275" class="calibre6">157</a>. <em class="calibre3">See also</em> classes</p>
<p class="indexmain"><span class="literal">open()</span> function, <a href="#calibre_link-374" class="calibre6">184</a></p>
<p class="indexmain"><span class="literal">or</span> keyword, <a href="#calibre_link-443" class="calibre6">76</a></p>
<h3 class="h2"><strong class="calibre2">P</strong></h3>
<p class="indexmain">parameters, <a href="#calibre_link-243" class="calibre6">131</a></p>
<p class="indexmain">parent classes, <a href="#calibre_link-269" class="calibre6">167</a>. <em class="calibre3">See also</em> classes: inheritance</p>
<p class="indexmain"><em class="calibre3">parrot.py</em>, <a href="#calibre_link-425" class="calibre6">114</a>, <a href="#calibre_link-280" class="calibre6">118</a>&ndash;<a href="#calibre_link-260" class="calibre6">121</a></p>
<p class="indexmain"><span class="literal">pass</span> statement, <a href="#calibre_link-372" class="calibre6">200</a></p>
<p class="indexmain">PEP 8, <a href="#calibre_link-515" class="calibre6">68</a>&ndash;<a href="#calibre_link-516" class="calibre6">70</a>, <a href="#calibre_link-449" class="calibre6">90</a>, <a href="#calibre_link-405" class="calibre6">154</a></p>
<p class="indexmain"><em class="calibre3">person.py</em>, <a href="#calibre_link-390" class="calibre6">140</a>&ndash;<a href="#calibre_link-404" class="calibre6">142</a></p>
<p class="indexmain"><em class="calibre3">pets.py</em>, <a href="#calibre_link-476" class="calibre6">125</a>, <a href="#calibre_link-398" class="calibre6">132</a>&ndash;<a href="#calibre_link-394" class="calibre6">136</a></p>
<p class="indexmain"><span type="pagebreak" id="calibre_link-1472" class="calibre"></span>pip, <a href="#calibre_link-219" class="calibre6">228</a></p>
<p class="indexsub">installing Django, <a href="#calibre_link-329" class="calibre6">381</a></p>
<p class="indexsub">installing Matplotlib, <a href="#calibre_link-487" class="calibre6">306</a></p>
<p class="indexsub">installing Plotly, <a href="#calibre_link-304" class="calibre6">324</a></p>
<p class="indexsub">installing Pygame, <a href="#calibre_link-219" class="calibre6">228</a></p>
<p class="indexsub">installing Requests, <a href="#calibre_link-237" class="calibre6">361</a></p>
<p class="indexmain"><em class="calibre3">pi_string.py</em>, <a href="#calibre_link-375" class="calibre6">188</a>&ndash;<a href="#calibre_link-379" class="calibre6">190</a></p>
<p class="indexmain"><em class="calibre3">pizza.py</em>, <a href="#calibre_link-169" class="calibre6">147</a>&ndash;<a href="#calibre_link-393" class="calibre6">148</a></p>
<p class="indexmain"><em class="calibre3">players.py</em>, <a href="#calibre_link-477" class="calibre6">61</a>&ndash;<a href="#calibre_link-386" class="calibre6">63</a></p>
<p class="indexmain">Plotly, <a href="#calibre_link-487" class="calibre6">306</a></p>
<p class="indexsub"><span class="literal">Bar()</span> class, <a href="#calibre_link-306" class="calibre6">327</a></p>
<p class="indexsub"><span class="literal">data</span>, long format, <a href="#calibre_link-485" class="calibre6">353</a></p>
<p class="indexsub">formatting plots</p>
<p class="indexsubsub">bars, <a href="#calibre_link-517" class="calibre6">368</a></p>
<p class="indexsubsub">colorscales, <a href="#calibre_link-481" class="calibre6">354</a></p>
<p class="indexsubsub">hover text, <a href="#calibre_link-484" class="calibre6">356</a>, <a href="#calibre_link-518" class="calibre6">369</a>&ndash;<a href="#calibre_link-519" class="calibre6">370</a></p>
<p class="indexsubsub">marker color, <a href="#calibre_link-517" class="calibre6">368</a></p>
<p class="indexsubsub">marker size, <a href="#calibre_link-485" class="calibre6">353</a></p>
<p class="indexsubsub"><span class="literal">Layout()</span> class, <a href="#calibre_link-306" class="calibre6">327</a></p>
<p class="indexsubsub">layout, long format, <a href="#calibre_link-520" class="calibre6">367</a></p>
<p class="indexsubsub">x-axis, <a href="#calibre_link-517" class="calibre6">368</a></p>
<p class="indexsubsub">y-axis, <a href="#calibre_link-517" class="calibre6">368</a></p>
<p class="indexsub">gallery, <a href="#calibre_link-304" class="calibre6">324</a></p>
<p class="indexsub">histogram, <a href="#calibre_link-521" class="calibre6">326</a></p>
<p class="indexsub">installing, <a href="#calibre_link-304" class="calibre6">324</a></p>
<p class="indexsub"><span class="literal">offline.plot()</span> function, <a href="#calibre_link-306" class="calibre6">327</a></p>
<p class="indexsub">Python figure reference, <a href="#calibre_link-234" class="calibre6">371</a></p>
<p class="indexsub">Scattergeo chart type, <a href="#calibre_link-486" class="calibre6">352</a></p>
<p class="indexsub">user guide, <a href="#calibre_link-234" class="calibre6">371</a></p>
<p class="indexmain">positional arguments. <em class="calibre3">See</em> functions: arguments</p>
<p class="indexmain">POST requests, <a href="#calibre_link-340" class="calibre6">412</a></p>
<p class="indexmain"><em class="calibre3">printing_models.py</em>, <a href="#calibre_link-396" class="calibre6">143</a>&ndash;<a href="#calibre_link-397" class="calibre6">146</a></p>
<p class="indexmain">Project Gutenberg, <a href="#calibre_link-522" class="calibre6">198</a></p>
<p class="indexmain"><em class="calibre3">.py</em> file extension, <a href="#calibre_link-523" class="calibre6">16</a></p>
<p class="indexmain">Pygame. <em class="calibre3">See also</em> Alien Invasion project</p>
<p class="indexsub">background colors, <a href="#calibre_link-524" class="calibre6">230</a>&ndash;<a href="#calibre_link-213" class="calibre6">231</a></p>
<p class="indexsub">collisions, <a href="#calibre_link-188" class="calibre6">268</a>&ndash;<a href="#calibre_link-189" class="calibre6">269</a>, <a href="#calibre_link-192" class="calibre6">272</a>&ndash;<a href="#calibre_link-193" class="calibre6">275</a>, <a href="#calibre_link-190" class="calibre6">291</a>&ndash;<a href="#calibre_link-191" class="calibre6">292</a></p>
<p class="indexsub">colors, <a href="#calibre_link-213" class="calibre6">231</a></p>
<p class="indexsub">creating empty windows, <a href="#calibre_link-216" class="calibre6">229</a></p>
<p class="indexsub">cursor, hiding, <a href="#calibre_link-108" class="calibre6">285</a></p>
<p class="indexsub">displaying text, <a href="#calibre_link-208" class="calibre6">280</a></p>
<p class="indexsub">ending games, <a href="#calibre_link-198" class="calibre6">276</a></p>
<p class="indexsub">event loops, <a href="#calibre_link-524" class="calibre6">230</a></p>
<p class="indexsub">fullscreen mode, <a href="#calibre_link-525" class="calibre6">244</a></p>
<p class="indexsub">groups, <a href="#calibre_link-207" class="calibre6">248</a></p>
<p class="indexsubsub">drawing all elements in, <a href="#calibre_link-526" class="calibre6">259</a></p>
<p class="indexsubsub">emptying, <a href="#calibre_link-206" class="calibre6">271</a></p>
<p class="indexsubsub">looping through, <a href="#calibre_link-202" class="calibre6">250</a></p>
<p class="indexsubsub">removing elements from, <a href="#calibre_link-204" class="calibre6">251</a></p>
<p class="indexsubsub">storing elements in, <a href="#calibre_link-207" class="calibre6">248</a></p>
<p class="indexsubsub">updating all elements in, <a href="#calibre_link-203" class="calibre6">249</a></p>
<p class="indexsub">images, drawing to screen, <a href="#calibre_link-215" class="calibre6">235</a></p>
<p class="indexsub">images, loading, <a href="#calibre_link-527" class="calibre6">234</a></p>
<p class="indexsub">installing, <a href="#calibre_link-219" class="calibre6">228</a></p>
<p class="indexsub"><span class="literal">print()</span> calls in, <a href="#calibre_link-204" class="calibre6">251</a></p>
<p class="indexsub">quitting, <a href="#calibre_link-525" class="calibre6">244</a></p>
<p class="indexsub">rect objects</p>
<p class="indexsubsub">creating from scratch, <a href="#calibre_link-205" class="calibre6">247</a></p>
<p class="indexsubsub">positioning, <a href="#calibre_link-527" class="calibre6">234</a>, <a href="#calibre_link-205" class="calibre6">247</a>&ndash;<a href="#calibre_link-207" class="calibre6">248</a>, <a href="#calibre_link-528" class="calibre6">257</a>&ndash;<a href="#calibre_link-195" class="calibre6">258</a>, <a href="#calibre_link-174" class="calibre6">260</a>&ndash;<a href="#calibre_link-529" class="calibre6">261</a>, <a href="#calibre_link-472" class="calibre6">263</a>&ndash;<a href="#calibre_link-196" class="calibre6">264</a></p>
<p class="indexsub">responding to input, <a href="#calibre_link-524" class="calibre6">230</a></p>
<p class="indexsubsub">keypresses, <a href="#calibre_link-530" class="calibre6">238</a></p>
<p class="indexsubsub">mouse clicks, <a href="#calibre_link-221" class="calibre6">283</a></p>
<p class="indexsub">screen coordinates, <a href="#calibre_link-527" class="calibre6">234</a></p>
<p class="indexsub">surfaces, <a href="#calibre_link-524" class="calibre6">230</a></p>
<p class="indexsub">testing games, <a href="#calibre_link-199" class="calibre6">270</a></p>
<p class="indexmain"><span class="literal">pyplot</span> module, <a href="#calibre_link-490" class="calibre6">307</a></p>
<p class="indexmain">Python</p>
<p class="indexsub"><span class="literal">&gt;&gt;&gt;</span> prompt, <a href="#calibre_link-531" class="calibre6">4</a></p>
<p class="indexsub">built-in functions, <a href="#calibre_link-64" class="calibre6">471</a></p>
<p class="indexsub">documentation, <a href="#calibre_link-410" class="calibre6">481</a></p>
<p class="indexsub">installing</p>
<p class="indexsubsub">on Linux, <a href="#calibre_link-466" class="calibre6">470</a></p>
<p class="indexsubsub">on macOS, official, <a href="#calibre_link-479" class="calibre6">7</a>&ndash;<a href="#calibre_link-5" class="calibre6">8</a></p>
<p class="indexsubsub">on macOS, using Homebrew, <a href="#calibre_link-439" class="calibre6">469</a>&ndash;<a href="#calibre_link-466" class="calibre6">470</a></p>
<p class="indexsubsub">on Windows, <a href="#calibre_link-532" class="calibre6">5</a>&ndash;<a href="#calibre_link-533" class="calibre6">6</a>, <a href="#calibre_link-534" class="calibre6">467</a>&ndash;<a href="#calibre_link-439" class="calibre6">469</a></p>
<p class="indexsub">interpreter, <a href="#calibre_link-523" class="calibre6">16</a></p>
<p class="indexsub">keywords, <a href="#calibre_link-64" class="calibre6">471</a></p>
<p class="indexsub">PEP 8, <a href="#calibre_link-515" class="calibre6">68</a>&ndash;<a href="#calibre_link-516" class="calibre6">70</a>, <a href="#calibre_link-449" class="calibre6">90</a>, <a href="#calibre_link-405" class="calibre6">154</a></p>
<p class="indexsub">standard library, <a href="#calibre_link-535" class="calibre6">180</a>&ndash;<a href="#calibre_link-255" class="calibre6">181</a></p>
<p class="indexsub">terminal sessions, <a href="#calibre_link-531" class="calibre6">4</a></p>
<p class="indexsub">versions, <a href="#calibre_link-531" class="calibre6">4</a></p>
<p class="indexsub">Zen of, <a href="#calibre_link-277" class="calibre6">30</a>&ndash;<a href="#calibre_link-536" class="calibre6">31</a></p>
<p class="indexmain">Python Enhancement Proposal (PEP), <a href="#calibre_link-515" class="calibre6">68</a></p>
<p class="indexmain"><em class="calibre3">python_repos.py</em>, <a href="#calibre_link-237" class="calibre6">361</a>&ndash;<a href="#calibre_link-238" class="calibre6">365</a></p>
<p class="indexmain"><em class="calibre3">python_repos_visual.py</em>, <a href="#calibre_link-240" class="calibre6">366</a>&ndash;<a href="#calibre_link-234" class="calibre6">371</a></p>
<h3 class="h2"><span type="pagebreak" id="calibre_link-1473" class="calibre"></span><strong class="calibre2">Q</strong></h3>
<p class="indexmain">quit values, <a href="#calibre_link-280" class="calibre6">118</a>&ndash;<a href="#calibre_link-385" class="calibre6">120</a></p>
<h3 class="h2"><strong class="calibre2">R</strong></h3>
<p class="indexmain"><em class="calibre3">random_walk.py</em>, <a href="#calibre_link-537" class="calibre6">316</a>&ndash;<a href="#calibre_link-538" class="calibre6">317</a></p>
<p class="indexmain">random walks, <a href="#calibre_link-498" class="calibre6">315</a>&ndash;<a href="#calibre_link-488" class="calibre6">323</a></p>
<p class="indexsub"><span class="literal">choice()</span> function, <a href="#calibre_link-538" class="calibre6">317</a></p>
<p class="indexsub">coloring points, <a href="#calibre_link-539" class="calibre6">319</a></p>
<p class="indexsub"><span class="literal">fill_walk()</span> method, <a href="#calibre_link-537" class="calibre6">316</a></p>
<p class="indexsub">multiple walks, generating, <a href="#calibre_link-540" class="calibre6">318</a></p>
<p class="indexsub">plotting, <a href="#calibre_link-538" class="calibre6">317</a></p>
<p class="indexsub"><span class="literal">RandomWalk</span> class, <a href="#calibre_link-537" class="calibre6">316</a></p>
<p class="indexsub">starting and ending points, <a href="#calibre_link-541" class="calibre6">320</a></p>
<p class="indexmain"><span class="literal">range()</span> function, <a href="#calibre_link-384" class="calibre6">57</a>&ndash;<a href="#calibre_link-474" class="calibre6">59</a></p>
<p class="indexmain"><span class="literal">readlines()</span> method, <a href="#calibre_link-375" class="calibre6">188</a></p>
<p class="indexmain"><span class="literal">read()</span> method, <a href="#calibre_link-376" class="calibre6">185</a></p>
<p class="indexmain">refactoring, <a href="#calibre_link-542" class="calibre6">206</a>&ndash;<a href="#calibre_link-543" class="calibre6">208</a>, <a href="#calibre_link-500" class="calibre6">236</a></p>
<p class="indexmain"><em class="calibre3">remember_me.py</em>, <a href="#calibre_link-455" class="calibre6">204</a>&ndash;<a href="#calibre_link-543" class="calibre6">208</a></p>
<p class="indexmain">Requests package, <a href="#calibre_link-237" class="calibre6">361</a></p>
<p class="indexmain">return values, <a href="#calibre_link-244" class="calibre6">137</a></p>
<p class="indexmain">r/learnpython, <a href="#calibre_link-408" class="calibre6">482</a></p>
<p class="indexmain"><em class="calibre3">rollercoaster.py</em>, <a href="#calibre_link-178" class="calibre6">116</a></p>
<p class="indexmain">rolling dice, <a href="#calibre_link-488" class="calibre6">323</a>&ndash;<a href="#calibre_link-294" class="calibre6">330</a></p>
<p class="indexsub">analyzing results, <a href="#calibre_link-305" class="calibre6">325</a></p>
<p class="indexsub"><span class="literal">Die</span> class, <a href="#calibre_link-304" class="calibre6">324</a></p>
<p class="indexsub">different sizes, <a href="#calibre_link-544" class="calibre6">329</a></p>
<p class="indexsub"><span class="literal">randint()</span> function, <a href="#calibre_link-304" class="calibre6">324</a></p>
<p class="indexsub">two dice, <a href="#calibre_link-293" class="calibre6">328</a></p>
<p class="indexmain">rubber duck debugging, <a href="#calibre_link-411" class="calibre6">480</a></p>
<p class="indexmain"><em class="calibre3">rw_visual.py</em>, <a href="#calibre_link-538" class="calibre6">317</a>&ndash;<a href="#calibre_link-488" class="calibre6">323</a></p>
<h3 class="h2"><strong class="calibre2">S</strong></h3>
<p class="indexmain"><em class="calibre3">scatter_squares.py</em>, <a href="#calibre_link-545" class="calibre6">311</a>&ndash;<a href="#calibre_link-498" class="calibre6">315</a></p>
<p class="indexmain">sets, <a href="#calibre_link-301" class="calibre6">104</a></p>
<p class="indexmain"><em class="calibre3">sitka_highs_lows.py</em>, <a href="#calibre_link-546" class="calibre6">340</a>&ndash;<a href="#calibre_link-492" class="calibre6">342</a></p>
<p class="indexmain"><em class="calibre3">sitka_highs.py</em>, <a href="#calibre_link-281" class="calibre6">334</a>&ndash;<a href="#calibre_link-546" class="calibre6">340</a></p>
<p class="indexmain">Slack, <a href="#calibre_link-409" class="calibre6">483</a></p>
<p class="indexmain"><span class="literal">sleep()</span> function, <a href="#calibre_link-547" class="calibre6">274</a></p>
<p class="indexmain">slice, <a href="#calibre_link-477" class="calibre6">61</a></p>
<p class="indexmain"><span class="literal">split()</span> method, <a href="#calibre_link-522" class="calibre6">198</a></p>
<p class="indexmain">square brackets (<span class="literal">[]</span>), <a href="#calibre_link-183" class="calibre6">34</a></p>
<p class="indexmain"><em class="calibre3">squares.py</em>, <a href="#calibre_link-367" class="calibre6">58</a>, <a href="#calibre_link-475" class="calibre6">60</a></p>
<p class="indexmain">Stack Overflow, <a href="#calibre_link-410" class="calibre6">481</a></p>
<p class="indexmain">storing data, <a href="#calibre_link-369" class="calibre6">202</a>&ndash;<a href="#calibre_link-548" class="calibre6">205</a>. <em class="calibre3">See also</em> JSON</p>
<p class="indexmain">strings, <a href="#calibre_link-429" class="calibre6">19</a>&ndash;<a href="#calibre_link-513" class="calibre6">25</a></p>
<p class="indexsub">changing case, <a href="#calibre_link-499" class="calibre6">20</a></p>
<p class="indexsub"><span class="literal">format()</span> method, <a href="#calibre_link-181" class="calibre6">22</a></p>
<p class="indexsub">f-strings, <a href="#calibre_link-391" class="calibre6">21</a></p>
<p class="indexsub">newlines in, <a href="#calibre_link-181" class="calibre6">22</a></p>
<p class="indexsub">single and double quotes, <a href="#calibre_link-429" class="calibre6">19</a>, <a href="#calibre_link-241" class="calibre6">24</a></p>
<p class="indexsub">tabs in, <a href="#calibre_link-181" class="calibre6">22</a></p>
<p class="indexsub">using variables in, <a href="#calibre_link-391" class="calibre6">21</a></p>
<p class="indexsub">whitespace in, <a href="#calibre_link-181" class="calibre6">22</a>&ndash;<a href="#calibre_link-241" class="calibre6">24</a></p>
<p class="indexmain"><span class="literal">strptime()</span> method, <a href="#calibre_link-549" class="calibre6">338</a></p>
<p class="indexmain">style guidelines, <a href="#calibre_link-515" class="calibre6">68</a>&ndash;<a href="#calibre_link-516" class="calibre6">70</a></p>
<p class="indexsub">blank lines, <a href="#calibre_link-550" class="calibre6">69</a></p>
<p class="indexsub">CamelCase, <a href="#calibre_link-255" class="calibre6">181</a></p>
<p class="indexsub">classes, <a href="#calibre_link-255" class="calibre6">181</a></p>
<p class="indexsub">functions, <a href="#calibre_link-405" class="calibre6">154</a></p>
<p class="indexsub"><span class="literal">if</span> statements, <a href="#calibre_link-449" class="calibre6">90</a></p>
<p class="indexsub">indentation, <a href="#calibre_link-550" class="calibre6">69</a></p>
<p class="indexsub">line length, <a href="#calibre_link-550" class="calibre6">69</a></p>
<p class="indexsub">PEP 8, <a href="#calibre_link-515" class="calibre6">68</a></p>
<p class="indexmain">Sublime Text, <a href="#calibre_link-531" class="calibre6">4</a>&ndash;<a href="#calibre_link-427" class="calibre6">10</a>, <a href="#calibre_link-551" class="calibre6">474</a>&ndash;<a href="#calibre_link-441" class="calibre6">475</a></p>
<p class="indexsub">commenting out code, <a href="#calibre_link-441" class="calibre6">475</a></p>
<p class="indexsub">configuring, <a href="#calibre_link-426" class="calibre6">9</a></p>
<p class="indexsub">customizing, <a href="#calibre_link-551" class="calibre6">474</a></p>
<p class="indexsub">indenting and unindenting code blocks, <a href="#calibre_link-551" class="calibre6">474</a></p>
<p class="indexsub">installing, <a href="#calibre_link-479" class="calibre6">7</a>&ndash;<a href="#calibre_link-426" class="calibre6">9</a></p>
<p class="indexsub">line length indicator, <a href="#calibre_link-551" class="calibre6">474</a></p>
<p class="indexsub">running Python programs, <a href="#calibre_link-426" class="calibre6">9</a>&ndash;<a href="#calibre_link-427" class="calibre6">10</a></p>
<p class="indexsub">saving your configuration, <a href="#calibre_link-441" class="calibre6">475</a></p>
<p class="indexsub">tabs and spaces, <a href="#calibre_link-551" class="calibre6">474</a></p>
<p class="indexmain">subtraction (<span class="literal">-</span>), <a href="#calibre_link-168" class="calibre6">26</a></p>
<p class="indexmain">superclasses, <a href="#calibre_link-274" class="calibre6">168</a>. <em class="calibre3">See also</em> classes: inheritance</p>
<p class="indexmain"><em class="calibre3">survey.py</em>, <a href="#calibre_link-456" class="calibre6">217</a></p>
<p class="indexmain">syntax errors, <a href="#calibre_link-241" class="calibre6">24</a></p>
<p class="indexmain">syntax highlighting, <a href="#calibre_link-523" class="calibre6">16</a></p>
<h3 class="h2"><strong class="calibre2">T</strong></h3>
<p class="indexmain">tab (<span class="literal">\t</span>), <a href="#calibre_link-181" class="calibre6">22</a></p>
<p class="indexmain">testing code, <a href="#calibre_link-552" class="calibre6">209</a>&ndash;<a href="#calibre_link-553" class="calibre6">222</a></p>
<p class="indexsub">adding tests, <a href="#calibre_link-554" class="calibre6">214</a></p>
<p class="indexsub">assert methods, <a href="#calibre_link-246" class="calibre6">216</a></p>
<p class="indexsub">coverage, <a href="#calibre_link-555" class="calibre6">211</a></p>
<p class="indexsub">failing tests, <a href="#calibre_link-245" class="calibre6">212</a>&ndash;<a href="#calibre_link-554" class="calibre6">214</a></p>
<p class="indexsub">passing tests, <a href="#calibre_link-555" class="calibre6">211</a>&ndash;<a href="#calibre_link-245" class="calibre6">212</a></p>
<p class="indexsub"><span class="literal">setUp()</span> method, <a href="#calibre_link-556" class="calibre6">220</a></p>
<p class="indexsub">test case, <a href="#calibre_link-555" class="calibre6">211</a></p>
<p class="indexsub">testing classes, <a href="#calibre_link-246" class="calibre6">216</a>&ndash;<a href="#calibre_link-557" class="calibre6">221</a></p>
<p class="indexsub">testing functions, <a href="#calibre_link-505" class="calibre6">210</a>&ndash;<a href="#calibre_link-506" class="calibre6">215</a></p>
<p class="indexsub"><span class="literal">unittest</span> module, <a href="#calibre_link-552" class="calibre6">209</a></p>
<p class="indexsub">unit tests, <a href="#calibre_link-555" class="calibre6">211</a></p>
<p class="indexmain"><span type="pagebreak" id="calibre_link-1474" class="calibre"></span><em class="calibre3">test_name_function.py</em>, <a href="#calibre_link-555" class="calibre6">211</a>&ndash;<a href="#calibre_link-506" class="calibre6">215</a></p>
<p class="indexmain"><em class="calibre3">test_survey.py</em>, <a href="#calibre_link-558" class="calibre6">218</a>&ndash;<a href="#calibre_link-557" class="calibre6">221</a></p>
<p class="indexmain">text editors and IDEs</p>
<p class="indexsub">Atom, <a href="#calibre_link-406" class="calibre6">476</a></p>
<p class="indexsub">Emacs and Vim, <a href="#calibre_link-406" class="calibre6">476</a></p>
<p class="indexsub">Geany, <a href="#calibre_link-406" class="calibre6">476</a></p>
<p class="indexsub">IDLE, <a href="#calibre_link-441" class="calibre6">475</a></p>
<p class="indexsub">Jupyter Notebooks, <a href="#calibre_link-559" class="calibre6">477</a></p>
<p class="indexsub">PyCharm, <a href="#calibre_link-406" class="calibre6">476</a></p>
<p class="indexsub">Sublime Text, <a href="#calibre_link-531" class="calibre6">4</a>&ndash;<a href="#calibre_link-427" class="calibre6">10</a>, <a href="#calibre_link-551" class="calibre6">474</a>&ndash;<a href="#calibre_link-441" class="calibre6">475</a></p>
<p class="indexsub">Visual Studio Code, <a href="#calibre_link-406" class="calibre6">476</a></p>
<p class="indexmain"><em class="calibre3">toppings.py</em>, <a href="#calibre_link-177" class="calibre6">74</a>, <a href="#calibre_link-232" class="calibre6">83</a>&ndash;<a href="#calibre_link-447" class="calibre6">88</a></p>
<p class="indexmain">traceback, <a href="#calibre_link-560" class="calibre6">18</a></p>
<p class="indexmain"><span class="literal">try-except</span> blocks, <a href="#calibre_link-311" class="calibre6">194</a>&ndash;<a href="#calibre_link-369" class="calibre6">202</a>. <em class="calibre3">See also</em> exceptions</p>
<p class="indexmain">tuples, <a href="#calibre_link-387" class="calibre6">65</a>&ndash;<a href="#calibre_link-308" class="calibre6">67</a></p>
<p class="indexmain">type errors, <a href="#calibre_link-307" class="calibre6">66</a></p>
<h3 class="h2"><strong class="calibre2">U</strong></h3>
<p class="indexmain"><span class="literal">unittest</span> module, <a href="#calibre_link-552" class="calibre6">209</a></p>
<p class="indexmain">unit tests, <a href="#calibre_link-555" class="calibre6">211</a></p>
<p class="indexmain">Unix time, <a href="#calibre_link-240" class="calibre6">366</a></p>
<p class="indexmain"><em class="calibre3">user_profile.py</em>, <a href="#calibre_link-393" class="calibre6">148</a></p>
<h3 class="h2"><strong class="calibre2">V</strong></h3>
<p class="indexmain"><span class="literal">values()</span> method, <a href="#calibre_link-301" class="calibre6">104</a></p>
<p class="indexmain">variables, <a href="#calibre_link-523" class="calibre6">16</a>&ndash;<a href="#calibre_link-429" class="calibre6">19</a>, <a href="#calibre_link-279" class="calibre6">28</a></p>
<p class="indexsub">constants, <a href="#calibre_link-279" class="calibre6">28</a></p>
<p class="indexsub">as labels, <a href="#calibre_link-560" class="calibre6">18</a></p>
<p class="indexsub">multiple assignment, <a href="#calibre_link-279" class="calibre6">28</a></p>
<p class="indexsub">naming conventions, <a href="#calibre_link-504" class="calibre6">17</a></p>
<p class="indexsub">values, <a href="#calibre_link-523" class="calibre6">16</a></p>
<p class="indexmain">version control system, <a href="#calibre_link-561" class="calibre6">485</a>. <em class="calibre3">See also</em> Git</p>
<p class="indexmain">virtual environment (<span class="literal">venv</span>), <a href="#calibre_link-465" class="calibre6">380</a></p>
<p class="indexmain"><em class="calibre3">voting.py</em>, <a href="#calibre_link-445" class="calibre6">79</a>&ndash;<a href="#calibre_link-231" class="calibre6">80</a></p>
<h3 class="h2"><strong class="calibre2">W</strong></h3>
<p class="indexmain">weather data, <a href="#calibre_link-281" class="calibre6">334</a>&ndash;<a href="#calibre_link-453" class="calibre6">347</a></p>
<p class="indexmain">web framework, <a href="#calibre_link-312" class="calibre6">379</a></p>
<p class="indexmain"><span class="literal">while</span> loops, <a href="#calibre_link-280" class="calibre6">118</a>&ndash;<a href="#calibre_link-562" class="calibre6">127</a></p>
<p class="indexsub"><span class="literal">active</span> flag, <a href="#calibre_link-385" class="calibre6">120</a>&ndash;<a href="#calibre_link-260" class="calibre6">121</a></p>
<p class="indexsub"><span class="literal">break</span> statement, <a href="#calibre_link-260" class="calibre6">121</a></p>
<p class="indexsub">infinite, <a href="#calibre_link-180" class="calibre6">122</a></p>
<p class="indexsub">moving items between lists, <a href="#calibre_link-278" class="calibre6">124</a></p>
<p class="indexsub">quit values, <a href="#calibre_link-280" class="calibre6">118</a>&ndash;<a href="#calibre_link-385" class="calibre6">120</a></p>
<p class="indexmain">whitespace, <a href="#calibre_link-181" class="calibre6">22</a>&ndash;<a href="#calibre_link-241" class="calibre6">24</a></p>
<p class="indexmain">Windows</p>
<p class="indexsub">Hello World, running, <a href="#calibre_link-427" class="calibre6">10</a></p>
<p class="indexsub">Python</p>
<p class="indexsubsub">checking installed version, <a href="#calibre_link-532" class="calibre6">5</a></p>
<p class="indexsubsub">installing, <a href="#calibre_link-532" class="calibre6">5</a>&ndash;<a href="#calibre_link-533" class="calibre6">6</a>, <a href="#calibre_link-534" class="calibre6">467</a>&ndash;<a href="#calibre_link-439" class="calibre6">469</a></p>
<p class="indexsubsub">troubleshooting installation, <a href="#calibre_link-467" class="calibre6">11</a>, <a href="#calibre_link-534" class="calibre6">467</a>&ndash;<a href="#calibre_link-439" class="calibre6">469</a></p>
<p class="indexsub">Sublime Text, installing, <a href="#calibre_link-479" class="calibre6">7</a></p>
<p class="indexsub">terminal</p>
<p class="indexsubsub">running programs from, <a href="#calibre_link-131" class="calibre6">12</a></p>
<p class="indexsubsub">starting a Python session, <a href="#calibre_link-533" class="calibre6">6</a></p>
<p class="indexmain"><span class="literal">with</span> statement, <a href="#calibre_link-376" class="calibre6">185</a></p>
<p class="indexmain"><em class="calibre3">word_count.py</em>, <a href="#calibre_link-186" class="calibre6">199</a>&ndash;<a href="#calibre_link-370" class="calibre6">201</a></p>
<p class="indexmain"><em class="calibre3">write_message.py</em>, <a href="#calibre_link-383" class="calibre6">191</a>&ndash;<a href="#calibre_link-382" class="calibre6">193</a></p>
<p class="indexmain"><span class="literal">write()</span> method, <a href="#calibre_link-378" class="calibre6">192</a></p>
<h3 class="h2"><strong class="calibre2">Z</strong></h3>
<p class="indexmain">Zen of Python, <a href="#calibre_link-277" class="calibre6">30</a>&ndash;<a href="#calibre_link-536" class="calibre6">31</a></p>
<p class="indexmain"><span class="literal">ZeroDivisionError</span>, <a href="#calibre_link-311" class="calibre6">194</a></p>
</div>


<div class="calibre1" id="calibre_link-569">
<p class="noindent2"><span type="pagebreak" id="calibre_link-1475" class="calibre"></span><em class="calibre3">Python Crash Course, 2nd Edition</em> is set in New Baskerville, Futura, Dogma, and The Sans Mono Condensed.</p>
</div>


<div class="calibre1" id="calibre_link-104">
<div class="box" id="calibre_link-1476">
<p class="boxtitle-d"><span type="pagebreak" id="calibre_link-1477" class="calibre"></span><strong class="calibre2">RESOURCES</strong></p>
<p class="noindent">Visit <em class="calibre3"><a href="https://nostarch.com/pythoncrashcourse2e/" class="calibre6">https://nostarch.com/pythoncrashcourse2e/</a></em> for resources, errata, and more information.</p>
</div>
<div class="box1">
<p class="noindentb"><em class="calibre3">More no-nonsense books from</em> <img class="middle" src="images/000032.jpg" alt="Image" /> <strong class="calibre2">NO STARCH PRESS</strong></p>
<div class="image1"><img src="images/000053.jpg" alt="Image" class="calibre7" /></div>
<p class="caps"><strong class="calibre2">SERIOUS PYTHON</strong></p>
<p class="capsa"><strong class="calibre2">Black-Belt Advice on Deployment, Scalability, Testing, and More</strong></p>
<p class="capsa"><em class="calibre3">by</em> <small class="calibre5">JULIEN DANJOU</small><br class="calibre4" /><small class="calibre5">DECEMBER</small> 2018, 240 <small class="calibre5">PP.,</small> $34.95<br class="calibre4" /><small class="calibre5">ISBN</small> 978-1-59327-878-6</p>
<div class="image1"><img src="images/000059.jpg" alt="Image" class="calibre7" /></div>
<p class="caps"><strong class="calibre2">PYTHON FLASH CARDS</strong></p>
<p class="capsa"><strong class="calibre2">Syntax, Concepts, and Examples</strong></p>
<p class="capsa"><em class="calibre3">by</em> <small class="calibre5">ERIC MATTHES</small><br class="calibre4" /><small class="calibre5">JANUARY</small> 2019, 101 <small class="calibre5">CARDS</small>, $27.95<br class="calibre4" /><small class="calibre5">ISBN</small> 978-1-59327-896-0<br class="calibre4" /><em class="calibre3">full color</em></p>
<div class="image1"><img src="images/000065.jpg" alt="Image" class="calibre7" /></div>
<p class="caps"><strong class="calibre2">MATH ADVENTURES WITH PYTHON</strong></p>
<p class="capsa"><strong class="calibre2">An Illustrated Guide to Exploring Math with Code</strong></p>
<p class="capsa"><em class="calibre3">by</em> <small class="calibre5">PETER FARRELL</small><br class="calibre4" /><small class="calibre5">JANUARY</small> 2019, 304 <small class="calibre5">PP.,</small> $29.95<br class="calibre4" /><small class="calibre5">ISBN</small> 978-1-59327-867-0<br class="calibre4" /><em class="calibre3">full color</em></p>
<div class="image1"><img src="images/000002.jpg" alt="Image" class="calibre7" /></div>
<p class="caps"><strong class="calibre2">IMPRACTICAL PYTHON PROJECTS</strong></p>
<p class="capsa"><strong class="calibre2">Playful Programming Activities to Make You Smarter</strong></p>
<p class="capsa"><em class="calibre3">by</em> <small class="calibre5">LEE VAUGHAN</small><br class="calibre4" /><small class="calibre5">NOVEMBER</small> 2018, 424 <small class="calibre5">PP.,</small> $29.95<br class="calibre4" /><small class="calibre5">ISBN</small> 978-1-59327-890-8</p>
<div class="image1"><img src="images/000007.jpg" alt="Image" class="calibre7" /></div>
<p class="caps"><strong class="calibre2">LEARN ROBOTICS WITH RASPBERRY PI</strong></p>
<p class="capsa"><strong class="calibre2">Build and Code Your Own Moving, Sensing, Thinking Robots</strong></p>
<p class="capsa"><em class="calibre3">by</em> <small class="calibre5">MATT TIMMONS-BROWN</small><br class="calibre4" /><small class="calibre5">JANUARY</small> 2019, 240 <small class="calibre5">PP.,</small> $24.95<br class="calibre4" /><small class="calibre5">ISBN</small> 978-1-59327-920-2<br class="calibre4" /><em class="calibre3">full color</em></p>
<div class="image1"><img src="images/000012.jpg" alt="Image" class="calibre7" /></div>
<p class="caps"><strong class="calibre2">MISSION PYTHON</strong></p>
<p class="capsa"><strong class="calibre2">Code a Space Adventure Game!</strong></p>
<p class="capsa"><em class="calibre3">by</em> <small class="calibre5">SEAN McMANUS</small><br class="calibre4" /><small class="calibre5">OCTOBER</small> 2018, 280 <small class="calibre5">PP.,</small> $29.95<br class="calibre4" /><small class="calibre5">ISBN</small> 978-1-59327-857-1<br class="calibre4" /><em class="calibre3">full color</em></p>
<p class="noindent2"><strong class="calibre2">1.800.420.7240 or 1.415.863.9900 | <a href="mailto:sales@nostarch.com" class="calibre6">sales@nostarch.com</a> | <a href="http://www.nostarch.com" class="calibre6">www.nostarch.com</a></strong></p>
</div>
</div>


<div class="calibre1" id="calibre_link-32">
<h2 class="h"><strong class="calibre2">WORLDWIDE BEST SELLER<br class="calibre4" />OVER 500,000 COPIES SOLD</strong></h2>
<div class="imagec"><img src="images/000018.jpg" alt="image" class="calibre7" /></div>
<p class="center"><strong class="calibre2">LEARN PYTHON&mdash;FAST!</strong></p>
<p class="noindentt"><em class="calibre3">Python Crash Course</em> is the world’s best-selling guide to the Python programming language. This fast-paced, thorough introduction to programming with Python will have you writing programs, solving problems, and making things that work in no time.</p>
<p class="noindentt">In the first half of the book, you’ll learn basic programming concepts, such as variables, lists, classes, and loops, and practice writing clean code with exercises for each topic. You’ll also learn how to make your programs interactive and test your code safely before adding it to a project. In the second half, you’ll put your new knowledge into practice with three substantial projects: a <em class="calibre3">Space Invaders</em>&ndash;inspired arcade game, a set of data visualizations with Python’s handy libraries, and a simple web app you can deploy online.</p>
<p class="noindentt">As you work through the book, you’ll learn how to:</p>
<ul class="calibre8">
<li class="noindent1">Use powerful Python libraries and tools, including Pygame, Matplotlib, Plotly, and Django</li>
<li class="noindent1">Make 2D games that respond to keypresses and mouse clicks, and that increase in difficulty</li>
<li class="noindent1">Use data to generate interactive visualizations</li>
<li class="noindent1">Create and customize web apps and deploy them safely online</li>
<li class="noindent1">Deal with mistakes and errors so you can solve your own programming problems</li>
</ul>
<p class="noindentt">This <strong class="calibre2">updated second edition</strong> has been thoroughly revised to reflect the latest in Python code and practices. The first half of the book includes improved coverage of topics like f-strings, constants, and managing data. In the second half, the code for the projects has been updated with better structure, cleaner syntax, and more popular and up-to-date libraries and tools, like Plotly and the latest version of Django. (For a full list of updates, see the Preface.)</p>
<p class="noindentt">If you’ve been thinking about digging into programming, <em class="calibre3">Python Crash Course</em> will get you writing real programs fast. Why wait any longer? Start your engines and code!</p>
<h3 class="h3c"><strong class="calibre2">ABOUT THE AUTHOR</strong></h3>
<p class="noindent">Eric Matthes is a high school science, math, and programming teacher living in Alaska. He has been writing programs since he was five years old and is the author of the <em class="calibre3">Python Flash Cards</em>, also from No Starch Press.</p>
<p class="noindenta"><strong class="calibre2">COVERS PYTHON 3.X</strong></p>
<div class="image2"><img src="images/000025.jpg" alt="image" class="calibre7" /></div>
<p class="noindent"><em class="calibre3"><strong class="calibre2">THE FINEST IN GEEK ENTERTAINMENT™</strong></em></p>
<p class="noindent"><a href="http://www.nostarch.com" class="calibre6">www.nostarch.com</a></p>
</div>


</body></html>